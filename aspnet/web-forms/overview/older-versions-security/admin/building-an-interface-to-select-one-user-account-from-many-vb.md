---
uid: web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-vb
title: Création d’une Interface pour sélectionner un compte d’utilisateur à partir de nombreux (VB) | Documents Microsoft
author: rick-anderson
description: Dans ce didacticiel, nous allons créer une interface utilisateur avec une grille filtrable paginée. En particulier, notre interface utilisateur se compose d’une série de LinkButton pour...
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/01/2008
ms.topic: article
ms.assetid: da53380c-a16b-41c7-a20d-24343c735c52
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-vb
msc.type: authoredcontent
ms.openlocfilehash: 56f4d72993bfcb9629d6b4cd08efe0da6dea2486
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/06/2018
ms.locfileid: "30891202"
---
<a name="building-an-interface-to-select-one-user-account-from-many-vb"></a><span data-ttu-id="ef27c-104">Création d’une Interface pour sélectionner un compte d’utilisateur à partir de nombreux (VB)</span><span class="sxs-lookup"><span data-stu-id="ef27c-104">Building an Interface to Select One User Account from Many (VB)</span></span>
====================
<span data-ttu-id="ef27c-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ef27c-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ef27c-106">[Télécharger le Code](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/VB.12.zip) ou [télécharger le PDF](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial12_SelectUser_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="ef27c-106">[Download Code](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/VB.12.zip) or [Download PDF](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial12_SelectUser_vb.pdf)</span></span>

> <span data-ttu-id="ef27c-107">Dans ce didacticiel, nous allons créer une interface utilisateur avec une grille filtrable paginée.</span><span class="sxs-lookup"><span data-stu-id="ef27c-107">In this tutorial we will build a user interface with a paged, filterable grid.</span></span> <span data-ttu-id="ef27c-108">En particulier, notre interface utilisateur se compose d’une série de LinkButton pour le filtrage des résultats en fonction de la lettre initiale du nom d’utilisateur et un contrôle GridView pour afficher les utilisateurs correspondants.</span><span class="sxs-lookup"><span data-stu-id="ef27c-108">In particular, our user interface will consist of a series of LinkButtons for filtering the results based on the starting letter of the username, and a GridView control to show the matching users.</span></span> <span data-ttu-id="ef27c-109">Nous allons commencer en répertoriant tous les comptes d’utilisateur dans un GridView.</span><span class="sxs-lookup"><span data-stu-id="ef27c-109">We'll start by listing all of the user accounts in a GridView.</span></span> <span data-ttu-id="ef27c-110">Puis, à l’étape 3, nous allons ajouter le filtre LinkButton.</span><span class="sxs-lookup"><span data-stu-id="ef27c-110">Then, in Step 3, we will add the filter LinkButtons.</span></span> <span data-ttu-id="ef27c-111">Étape 4 présente les résultats filtrés de pagination.</span><span class="sxs-lookup"><span data-stu-id="ef27c-111">Step 4 looks at paging the filtered results.</span></span> <span data-ttu-id="ef27c-112">L’interface construit dans les étapes 2 à 4 sera utilisée dans les didacticiels suivants pour effectuer des tâches d’administration pour un compte d’utilisateur particulier.</span><span class="sxs-lookup"><span data-stu-id="ef27c-112">The interface constructed in Steps 2 through 4 will be used in the subsequent tutorials to perform administrative tasks for a particular user account.</span></span>


## <a name="introduction"></a><span data-ttu-id="ef27c-113">Introduction</span><span class="sxs-lookup"><span data-stu-id="ef27c-113">Introduction</span></span>

<span data-ttu-id="ef27c-114">Dans le <a id="_msoanchor_1"> </a> [ *affectation de rôles aux utilisateurs* ](../roles/assigning-roles-to-users-vb.md) didacticiel, nous avons créé une interface rudimentaire pour un administrateur de sélectionner un utilisateur et de gérer ses rôles.</span><span class="sxs-lookup"><span data-stu-id="ef27c-114">In the <a id="_msoanchor_1"></a>[*Assigning Roles to Users*](../roles/assigning-roles-to-users-vb.md) tutorial, we created a rudimentary interface for an administrator to select a user and manage her roles.</span></span> <span data-ttu-id="ef27c-115">Plus précisément, l’interface affiche l’administrateur une liste déroulante de tous les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="ef27c-115">Specifically, the interface presented the administrator with a drop-down list of all of the users.</span></span> <span data-ttu-id="ef27c-116">Une telle interface est appropriée quand il existe mais utilisateur une douzaine de comptes, mais est complexe pour les sites avec des centaines, voire des milliers de comptes.</span><span class="sxs-lookup"><span data-stu-id="ef27c-116">Such an interface is suitable when there are but a dozen or so user accounts, but is unwieldy for sites with hundreds or thousands of accounts.</span></span> <span data-ttu-id="ef27c-117">Une grille filtrable paginée est plus adapté interface utilisateur pour les sites Web avec des bases de l’utilisateur de grande taille.</span><span class="sxs-lookup"><span data-stu-id="ef27c-117">A paged, filterable grid is more suitable user interface for websites with large user bases.</span></span>

<span data-ttu-id="ef27c-118">Dans ce didacticiel, nous allons créer une interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ef27c-118">In this tutorial we will build such a user interface.</span></span> <span data-ttu-id="ef27c-119">En particulier, notre interface utilisateur se compose d’une série de LinkButton pour le filtrage des résultats en fonction de la lettre initiale du nom d’utilisateur et un contrôle GridView pour afficher les utilisateurs correspondants.</span><span class="sxs-lookup"><span data-stu-id="ef27c-119">In particular, our user interface will consist of a series of LinkButtons for filtering the results based on the starting letter of the username, and a GridView control to show the matching users.</span></span> <span data-ttu-id="ef27c-120">Nous allons commencer en répertoriant tous les comptes d’utilisateur dans un GridView.</span><span class="sxs-lookup"><span data-stu-id="ef27c-120">We'll start by listing all of the user accounts in a GridView.</span></span> <span data-ttu-id="ef27c-121">Puis, à l’étape 3, nous allons ajouter le filtre LinkButton.</span><span class="sxs-lookup"><span data-stu-id="ef27c-121">Then, in Step 3, we will add the filter LinkButtons.</span></span> <span data-ttu-id="ef27c-122">Étape 4 présente les résultats filtrés de pagination.</span><span class="sxs-lookup"><span data-stu-id="ef27c-122">Step 4 looks at paging the filtered results.</span></span> <span data-ttu-id="ef27c-123">L’interface construit dans les étapes 2 à 4 sera utilisée dans les didacticiels suivants pour effectuer des tâches d’administration pour un compte d’utilisateur particulier.</span><span class="sxs-lookup"><span data-stu-id="ef27c-123">The interface constructed in Steps 2 through 4 will be used in the subsequent tutorials to perform administrative tasks for a particular user account.</span></span>

<span data-ttu-id="ef27c-124">C’est parti !</span><span class="sxs-lookup"><span data-stu-id="ef27c-124">Let's get started!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="ef27c-125">Étape 1 : Ajout de nouvelles Pages ASP.NET</span><span class="sxs-lookup"><span data-stu-id="ef27c-125">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="ef27c-126">Dans ce didacticiel et les deux, nous étudierons différents associées à l’administration des fonctions et fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="ef27c-126">In this tutorial and the next two we will be examining various administration-related functions and capabilities.</span></span> <span data-ttu-id="ef27c-127">Nous devons une série de pages ASP.NET pour implémenter les rubriques examinées dans l’ensemble de ces didacticiels.</span><span class="sxs-lookup"><span data-stu-id="ef27c-127">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="ef27c-128">Nous allons créer ces pages et mettre à jour le plan de site.</span><span class="sxs-lookup"><span data-stu-id="ef27c-128">Let's create these pages and update the site map.</span></span>

<span data-ttu-id="ef27c-129">Commencez par créer un nouveau dossier dans le projet nommé `Administration`.</span><span class="sxs-lookup"><span data-stu-id="ef27c-129">Start by creating a new folder in the project named `Administration`.</span></span> <span data-ttu-id="ef27c-130">Ensuite, ajoutez deux nouvelles pages ASP.NET dans le dossier, en liant chaque page avec le `Site.master` page maître.</span><span class="sxs-lookup"><span data-stu-id="ef27c-130">Next, add two new ASP.NET pages to the folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="ef27c-131">Nommez les pages :</span><span class="sxs-lookup"><span data-stu-id="ef27c-131">Name the pages:</span></span>

- `ManageUsers.aspx`
- `UserInformation.aspx`

<span data-ttu-id="ef27c-132">Également ajouter deux pages pour le répertoire du site Web : `ChangePassword.aspx` et `RecoverPassword.aspx`.</span><span class="sxs-lookup"><span data-stu-id="ef27c-132">Also add two pages to the website's root directory: `ChangePassword.aspx` and `RecoverPassword.aspx`.</span></span>

<span data-ttu-id="ef27c-133">Ces quatre pages disposez à ce stade, deux contrôles de contenu de ContentPlaceHolders la page maître : `MainContent` et `LoginContent`.</span><span class="sxs-lookup"><span data-stu-id="ef27c-133">These four pages should, at this point, have two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample1.aspx)]

<span data-ttu-id="ef27c-134">Nous voulons afficher le balisage par défaut de la page maître pour la `LoginContent` ContentPlaceHolder pour ces pages.</span><span class="sxs-lookup"><span data-stu-id="ef27c-134">We want to show the master page's default markup for the `LoginContent` ContentPlaceHolder for these pages.</span></span> <span data-ttu-id="ef27c-135">Par conséquent, supprimez le balisage déclaratif pour la `Content2` contrôle de contenu.</span><span class="sxs-lookup"><span data-stu-id="ef27c-135">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="ef27c-136">Après cela, les balises des pages doivent contenir qu’un contrôle de contenu.</span><span class="sxs-lookup"><span data-stu-id="ef27c-136">After doing so, the pages' markup should contain just one Content control.</span></span>

<span data-ttu-id="ef27c-137">Les pages ASP.NET dans le `Administration` dossier sont destinés uniquement à des utilisateurs administratifs.</span><span class="sxs-lookup"><span data-stu-id="ef27c-137">The ASP.NET pages in the `Administration` folder are intended solely for administrative users.</span></span> <span data-ttu-id="ef27c-138">Nous avons ajouté un rôle d’administrateurs sur le système dans le <a id="_msoanchor_2"> </a> [ *création et gestion des rôles* ](../roles/creating-and-managing-roles-vb.md) didacticiel ; restreindre l’accès à ces deux pages à ce rôle.</span><span class="sxs-lookup"><span data-stu-id="ef27c-138">We added an Administrators role to the system in the <a id="_msoanchor_2"></a>[*Creating and Managing Roles*](../roles/creating-and-managing-roles-vb.md) tutorial; restrict access to these two pages to this role.</span></span> <span data-ttu-id="ef27c-139">Pour ce faire, ajoutez un `Web.config` de fichiers à la `Administration` dossier et configurer ses `<authorization>` élément admettez les utilisateurs du rôle Administrateurs et à refuser tous les autres.</span><span class="sxs-lookup"><span data-stu-id="ef27c-139">To accomplish this, add a `Web.config` file to the `Administration` folder and configure its `<authorization>` element to admit users in the Administrators role and to deny all others.</span></span>

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample2.xml)]

<span data-ttu-id="ef27c-140">À ce stade l’Explorateur de votre projet de solutions doit ressembler à l’écran : WordGame indiqué dans la Figure 1.</span><span class="sxs-lookup"><span data-stu-id="ef27c-140">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>


<span data-ttu-id="ef27c-141">[![Quatre nouvelles Pages et un fichier Web.config ont été ajoutés au site Web](building-an-interface-to-select-one-user-account-from-many-vb/_static/image2.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ef27c-141">[![Four New Pages and a Web.config File Have Been Added to the Website](building-an-interface-to-select-one-user-account-from-many-vb/_static/image2.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image1.png)</span></span>

<span data-ttu-id="ef27c-142">**Figure 1**: quatre nouvelles Pages et une `Web.config` fichier ont été ajoutés au site Web ([cliquez pour afficher l’image en taille réelle](building-an-interface-to-select-one-user-account-from-many-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="ef27c-142">**Figure 1**: Four New Pages and a `Web.config` File Have Been Added to the Website ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image3.png))</span></span>


<span data-ttu-id="ef27c-143">Enfin, mettre à jour le plan de site (`Web.sitemap`) pour inclure une entrée pour le `ManageUsers.aspx` page.</span><span class="sxs-lookup"><span data-stu-id="ef27c-143">Finally, update the site map (`Web.sitemap`) to include an entry to the `ManageUsers.aspx` page.</span></span> <span data-ttu-id="ef27c-144">Ajoutez le code XML suivant après le `<siteMapNode>` nous avons ajouté pour les didacticiels de rôles.</span><span class="sxs-lookup"><span data-stu-id="ef27c-144">Add the following XML after the `<siteMapNode>` we added for the Roles tutorials.</span></span>

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample3.xml)]

<span data-ttu-id="ef27c-145">Avec le plan de site mis à jour, visitez le site via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="ef27c-145">With the site map updated, visit the site through a browser.</span></span> <span data-ttu-id="ef27c-146">Comme le montre la Figure 2, le volet de navigation gauche maintenant inclut des éléments pour les didacticiels de l’Administration.</span><span class="sxs-lookup"><span data-stu-id="ef27c-146">As Figure 2 shows, the navigation on the left now includes items for the Administration tutorials.</span></span>


<span data-ttu-id="ef27c-147">[![Le plan de Site comprend un nœud intitulé Administration des utilisateurs](building-an-interface-to-select-one-user-account-from-many-vb/_static/image5.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="ef27c-147">[![The Site Map Includes a Node Titled User Administration](building-an-interface-to-select-one-user-account-from-many-vb/_static/image5.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image4.png)</span></span>

<span data-ttu-id="ef27c-148">**Figure 2**: le plan de Site comprend un nœud intitulé l’Administration des utilisateurs ([cliquez pour afficher l’image en taille réelle](building-an-interface-to-select-one-user-account-from-many-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="ef27c-148">**Figure 2**: The Site Map Includes a Node Titled User Administration ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image6.png))</span></span>


## <a name="step-2-listing-all-user-accounts-in-a-gridview"></a><span data-ttu-id="ef27c-149">Étape 2 : Répertorier tous les comptes d’utilisateur dans un contrôle GridView</span><span class="sxs-lookup"><span data-stu-id="ef27c-149">Step 2: Listing All User Accounts in a GridView</span></span>

<span data-ttu-id="ef27c-150">Notre objectif final pour ce didacticiel est pour créer une grille paginée, filtrée par le biais duquel un administrateur peut sélectionner un compte d’utilisateur à gérer.</span><span class="sxs-lookup"><span data-stu-id="ef27c-150">Our end goal for this tutorial is to create a paged, filterable grid through which an administrator can select a user account to manage.</span></span> <span data-ttu-id="ef27c-151">Commençons par liste *tous les* les utilisateurs dans un GridView.</span><span class="sxs-lookup"><span data-stu-id="ef27c-151">Let's start by listing *all* users in a GridView.</span></span> <span data-ttu-id="ef27c-152">Une fois cette opération terminée, nous allons ajouter le filtrage et de pagination interfaces et de fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="ef27c-152">Once this is complete, we will add the filtering and paging interfaces and functionality.</span></span>

<span data-ttu-id="ef27c-153">Ouvrir le `ManageUsers.aspx` page dans le `Administration` dossier et ajouter un contrôle GridView, son `ID` à `UserAccounts` dans un instant, nous allez écrire du code pour lier l’ensemble des comptes d’utilisateur pour le contrôle GridView à l’aide la `Membership` la classe `GetAllUsers` (méthode).</span><span class="sxs-lookup"><span data-stu-id="ef27c-153">Open the `ManageUsers.aspx` page in the `Administration` folder and add a GridView, setting its `ID` to `UserAccounts` In a moment, we will write code to bind the set of user accounts to the GridView using the `Membership` class's `GetAllUsers` method.</span></span> <span data-ttu-id="ef27c-154">Comme indiqué dans les didacticiels antérieures, le `GetAllUsers` méthode retourne un `MembershipUserCollection` objet, qui est une collection de `MembershipUser` objets.</span><span class="sxs-lookup"><span data-stu-id="ef27c-154">As discussed in earlier tutorials, the `GetAllUsers` method returns a `MembershipUserCollection` object, which is a collection of `MembershipUser` objects.</span></span> <span data-ttu-id="ef27c-155">Chaque `MembershipUser` dans la collection inclut des propriétés telles que `UserName`, `Email`, `IsApproved`, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="ef27c-155">Each `MembershipUser` in the collection includes properties like `UserName`, `Email`, `IsApproved`, and so on.</span></span>

<span data-ttu-id="ef27c-156">Pour afficher les informations de compte d’utilisateur de votre choix dans le GridView, définir de GridView `AutoGenerateColumns` propriété sur False et ajoutez BoundFields pour la `UserName`, `Email`, et `Comment` propriétés et CheckBoxFields pour le `IsApproved`, `IsLockedOut`, et `IsOnline` propriétés.</span><span class="sxs-lookup"><span data-stu-id="ef27c-156">In order to display the desired user account information in the GridView, set the GridView's `AutoGenerateColumns` property to False and add BoundFields for the `UserName`, `Email`, and `Comment` properties and CheckBoxFields for the `IsApproved`, `IsLockedOut`, and `IsOnline` properties.</span></span> <span data-ttu-id="ef27c-157">Cette configuration peut être appliquée via le balisage du contrôle déclaratif ou via la boîte de dialogue champs.</span><span class="sxs-lookup"><span data-stu-id="ef27c-157">This configuration can be applied through the control's declarative markup or via the Fields dialog box.</span></span> <span data-ttu-id="ef27c-158">Figure 3 illustre une capture d’écran des champs de la boîte de dialogue une fois que la case à cocher des champs de génération automatique a été désactivée et le BoundFields et CheckBoxFields ont été ajoutés et configurés.</span><span class="sxs-lookup"><span data-stu-id="ef27c-158">Figure 3 shows a screen shot of the Fields dialog box after the Auto-generate fields checkbox has been unchecked and the BoundFields and CheckBoxFields have been added and configured.</span></span>


<span data-ttu-id="ef27c-159">[![Ajouter trois BoundFields et trois CheckBoxFields au contrôle GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image8.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ef27c-159">[![Add Three BoundFields and Three CheckBoxFields to the GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image8.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image7.png)</span></span>

<span data-ttu-id="ef27c-160">**Figure 3**: ajout de trois BoundFields et trois CheckBoxFields au GridView ([cliquez pour afficher l’image en taille réelle](building-an-interface-to-select-one-user-account-from-many-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="ef27c-160">**Figure 3**: Add Three BoundFields and Three CheckBoxFields to the GridView ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image9.png))</span></span>


<span data-ttu-id="ef27c-161">Après avoir configuré votre GridView, assurez-vous que son balisage déclaratif ressemble à ceci :</span><span class="sxs-lookup"><span data-stu-id="ef27c-161">After configuring your GridView, ensure that its declarative markup resembles the following:</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample4.aspx)]

<span data-ttu-id="ef27c-162">Ensuite, nous avons besoin d’écrire du code qui lie les comptes d’utilisateur pour le contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="ef27c-162">Next, we need to write code that binds the user accounts to the GridView.</span></span> <span data-ttu-id="ef27c-163">Créez une méthode nommée `BindUserAccounts` pour effectuer cette tâche, puis appelez à partir du `Page_Load` Gestionnaire d’événements sur la première visite de page.</span><span class="sxs-lookup"><span data-stu-id="ef27c-163">Create a method named `BindUserAccounts` to perform this task and then call it from the `Page_Load` event handler on the first page visit.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample5.vb)]

<span data-ttu-id="ef27c-164">Prenez un moment pour tester la page via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="ef27c-164">Take a moment to test the page through a browser.</span></span> <span data-ttu-id="ef27c-165">Comme le montre la Figure 4, le `UserAccounts` GridView répertorie le nom d’utilisateur, adresse de messagerie et autres informations pertinentes compte pour tous les utilisateurs dans le système.</span><span class="sxs-lookup"><span data-stu-id="ef27c-165">As Figure 4 shows, the `UserAccounts` GridView lists the username, email address, and other pertinent account information for all users in the system.</span></span>


<span data-ttu-id="ef27c-166">[![Les comptes d’utilisateur sont répertoriés dans le contrôle GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image11.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="ef27c-166">[![The User Accounts are Listed in the GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image11.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image10.png)</span></span>

<span data-ttu-id="ef27c-167">**Figure 4**: les comptes d’utilisateur sont répertoriés dans le GridView ([cliquez pour afficher l’image en taille réelle](building-an-interface-to-select-one-user-account-from-many-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="ef27c-167">**Figure 4**: The User Accounts are Listed in the GridView ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image12.png))</span></span>


## <a name="step-3-filtering-the-results-by-the-first-letter-of-the-username"></a><span data-ttu-id="ef27c-168">Étape 3 : Filtrage des résultats selon la première lettre du nom d’utilisateur</span><span class="sxs-lookup"><span data-stu-id="ef27c-168">Step 3: Filtering the Results by the First Letter of the Username</span></span>

<span data-ttu-id="ef27c-169">Actuellement le `UserAccounts` GridView affiche *tous les* des comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ef27c-169">Currently the `UserAccounts` GridView shows *all* of the user accounts.</span></span> <span data-ttu-id="ef27c-170">Pour les sites Web avec des centaines, voire des milliers de comptes d’utilisateur, il est impératif que l’utilisateur soit en mesure de rapidement alléger les comptes affichés.</span><span class="sxs-lookup"><span data-stu-id="ef27c-170">For websites with hundreds or thousands of user accounts, it is imperative that user be able to quickly pare down the displayed accounts.</span></span> <span data-ttu-id="ef27c-171">Cela peut être accompli en ajoutant un filtrage LinkButton à la page.</span><span class="sxs-lookup"><span data-stu-id="ef27c-171">This can be accomplished by adding filtering LinkButtons to the page.</span></span> <span data-ttu-id="ef27c-172">Nous allons ajouter 27 LinkButton à la page : une intitulée tous en même temps qu’un LinkButton pour chaque lettre de l’alphabet.</span><span class="sxs-lookup"><span data-stu-id="ef27c-172">Let's add 27 LinkButtons to the page: one titled All along with one LinkButton for each letter of the alphabet.</span></span> <span data-ttu-id="ef27c-173">Si un visiteur clique sur le LinkButton tous, le contrôle GridView affiche tous les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="ef27c-173">If a visitor clicks the All LinkButton, the GridView will show all of the users.</span></span> <span data-ttu-id="ef27c-174">S’il clique sur une lettre particulière, seuls les utilisateurs dont nom d’utilisateur commence par la lettre sélectionnée seront affichera.</span><span class="sxs-lookup"><span data-stu-id="ef27c-174">If they click a particular letter, only those users whose username starts with the selected letter will be displayed.</span></span>

<span data-ttu-id="ef27c-175">Notre première tâche consiste à ajouter des contrôles LinkButton 27.</span><span class="sxs-lookup"><span data-stu-id="ef27c-175">Our first task is to add the 27 LinkButton controls.</span></span> <span data-ttu-id="ef27c-176">Est une option pour créer le 27 LinkButton de façon déclarative, à la fois.</span><span class="sxs-lookup"><span data-stu-id="ef27c-176">One option would be to create the 27 LinkButtons declaratively, one at a time.</span></span> <span data-ttu-id="ef27c-177">Une approche plus souple consiste à utiliser un contrôle de répéteur avec un `ItemTemplate` qui restitue un LinkButton et lie ensuite les options de filtrage pour le répéteur comme un `String` tableau.</span><span class="sxs-lookup"><span data-stu-id="ef27c-177">A more flexible approach is to use a Repeater control with an `ItemTemplate` that renders a LinkButton and then binds the filtering options to the Repeater as a `String` array.</span></span>

<span data-ttu-id="ef27c-178">Commencez par ajouter un contrôle du répéteur à la page ci-dessus le `UserAccounts` GridView.</span><span class="sxs-lookup"><span data-stu-id="ef27c-178">Start by adding a Repeater control to the page above the `UserAccounts` GridView.</span></span> <span data-ttu-id="ef27c-179">Définir de répéteur `ID` propriété `FilteringUI` configurer des modèles de répéteur afin que ses `ItemTemplate` restitue un LinkButton dont `Text` et `CommandName` propriétés sont liées à l’élément du tableau actuel.</span><span class="sxs-lookup"><span data-stu-id="ef27c-179">Set the Repeater's `ID` property to `FilteringUI` Configure the Repeater's templates so that its `ItemTemplate` renders a LinkButton whose `Text` and `CommandName` properties are bound to the current array element.</span></span> <span data-ttu-id="ef27c-180">Comme nous l’avons vu dans la <a id="_msoanchor_3"> </a> [ *affectation de rôles aux utilisateurs* ](../roles/assigning-roles-to-users-vb.md) didacticiel, cela peut être accompli à l’aide de la `Container.DataItem` syntaxe de liaison de données.</span><span class="sxs-lookup"><span data-stu-id="ef27c-180">As we saw in the <a id="_msoanchor_3"></a>[*Assigning Roles to Users*](../roles/assigning-roles-to-users-vb.md) tutorial, this can be accomplished using the `Container.DataItem` databinding syntax.</span></span> <span data-ttu-id="ef27c-181">Utilisation de répéteur `SeparatorTemplate` pour afficher une ligne verticale entre chaque lien.</span><span class="sxs-lookup"><span data-stu-id="ef27c-181">Use the Repeater's `SeparatorTemplate` to display a vertical line between each link.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample6.aspx)]

<span data-ttu-id="ef27c-182">Pour remplir cet répéteur avec les options de filtrage de votre choisis, créez une méthode nommée `BindFilteringUI`.</span><span class="sxs-lookup"><span data-stu-id="ef27c-182">To populate this Repeater with the desired filtering options, create a method named `BindFilteringUI`.</span></span> <span data-ttu-id="ef27c-183">Veillez à appeler cette méthode à partir de la `Page_Load` Gestionnaire d’événements sur le premier chargement de page.</span><span class="sxs-lookup"><span data-stu-id="ef27c-183">Be sure to call this method from the `Page_Load` event handler on the first page load.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample7.vb)]

<span data-ttu-id="ef27c-184">Cette méthode spécifie les options de filtrage en tant qu’éléments dans le `String` tableau `filterOptions` pour chaque élément du tableau, répéteur affichera un LinkButton avec son `Text` et `CommandName` propriétés assignées à la valeur du tableau élément.</span><span class="sxs-lookup"><span data-stu-id="ef27c-184">This method specifies the filtering options as elements in the `String` array `filterOptions` For each element in the array, the Repeater will render a LinkButton with its `Text` and `CommandName` properties assigned to the value of the array element.</span></span>

<span data-ttu-id="ef27c-185">La figure 5 illustre le `ManageUsers.aspx` page lorsqu’ils sont affichés via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="ef27c-185">Figure 5 shows the `ManageUsers.aspx` page when viewed through a browser.</span></span>


<span data-ttu-id="ef27c-186">[![Répéteur répertorie 27 LinkButton de filtrage](building-an-interface-to-select-one-user-account-from-many-vb/_static/image14.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="ef27c-186">[![The Repeater Lists 27 Filtering LinkButtons](building-an-interface-to-select-one-user-account-from-many-vb/_static/image14.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image13.png)</span></span>

<span data-ttu-id="ef27c-187">**Figure 5**: le répéteur répertorie 27 filtrage LinkButton ([cliquez pour afficher l’image en taille réelle](building-an-interface-to-select-one-user-account-from-many-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="ef27c-187">**Figure 5**: The Repeater Lists 27 Filtering LinkButtons ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image15.png))</span></span>


> [!NOTE]
> <span data-ttu-id="ef27c-188">Les noms d’utilisateur peut commencer par n’importe quel caractère, y compris des nombres et des signes de ponctuation.</span><span class="sxs-lookup"><span data-stu-id="ef27c-188">Usernames may start with any character, including numbers and punctuation.</span></span> <span data-ttu-id="ef27c-189">Pour afficher ces comptes, l’administrateur devra utiliser l’option LinkButton tous les.</span><span class="sxs-lookup"><span data-stu-id="ef27c-189">In order to view these accounts, the administrator will have to use the All LinkButton option.</span></span> <span data-ttu-id="ef27c-190">Ou bien, vous pouvez ajouter un LinkButton pour retourner tous les comptes d’utilisateur qui commencent par un chiffre.</span><span class="sxs-lookup"><span data-stu-id="ef27c-190">Alternatively, you could add a LinkButton to return all user accounts that start with a number.</span></span> <span data-ttu-id="ef27c-191">J’ai laisser ce champ comme un exercice pour le lecteur.</span><span class="sxs-lookup"><span data-stu-id="ef27c-191">I leave this as an exercise for the reader.</span></span>


<span data-ttu-id="ef27c-192">Cliquez simplement sur le LinkButton filtrage provoque une publication (postback) et déclenche de répéteur `ItemCommand` événement, mais il n’existe aucune modification de la grille, car nous avons encore à écrire du code pour filtrer les résultats.</span><span class="sxs-lookup"><span data-stu-id="ef27c-192">Clicking any of the filtering LinkButtons causes a postback and raises the Repeater's `ItemCommand` event, but there's no change in the grid because we've yet to write any code to filter the results.</span></span> <span data-ttu-id="ef27c-193">Le `Membership` classe inclut un [ `FindUsersByName` méthode](https://technet.microsoft.com/library/system.web.security.membership.findusersbyname.aspx) qui retourne ces comptes d’utilisateur dont nom d’utilisateur correspond à un modèle de recherche spécifié.</span><span class="sxs-lookup"><span data-stu-id="ef27c-193">The `Membership` class includes a [`FindUsersByName` method](https://technet.microsoft.com/library/system.web.security.membership.findusersbyname.aspx) that returns those user accounts whose username matches a specified search pattern.</span></span> <span data-ttu-id="ef27c-194">Nous pouvons utiliser cette méthode pour récupérer uniquement les comptes d’utilisateurs dont les noms commencent par la lettre spécifiée par la `CommandName` du contrôle LinkButton filtré que l’utilisateur a cliqué.</span><span class="sxs-lookup"><span data-stu-id="ef27c-194">We can use this method to retrieve just those user accounts whose usernames start with the letter specified by the `CommandName` of the filtered LinkButton that was clicked.</span></span>

<span data-ttu-id="ef27c-195">Commencez par mettre à jour le `ManageUser.aspx` de classe code-behind de la page afin qu’il inclue une propriété nommée `UsernameToMatch` cette propriété persiste la chaîne de filtre de nom d’utilisateur entre publications (postback) :</span><span class="sxs-lookup"><span data-stu-id="ef27c-195">Start by updating the `ManageUser.aspx` page's code-behind class so that it includes a property named `UsernameToMatch` This property persists the username filter string across postbacks:</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample8.vb)]

<span data-ttu-id="ef27c-196">Le `UsernameToMatch` propriété stocke sa valeur, il est attribué dans le `ViewState` collection à l’aide de la clé UsernameToMatch.</span><span class="sxs-lookup"><span data-stu-id="ef27c-196">The `UsernameToMatch` property stores its value it is assigned into the `ViewState` collection using the key �UsernameToMatch�.</span></span> <span data-ttu-id="ef27c-197">Lorsque la valeur de cette propriété est en lecture, il vérifie si une valeur existe dans le `ViewState` collection ; sinon, elle retourne la valeur par défaut, une chaîne vide.</span><span class="sxs-lookup"><span data-stu-id="ef27c-197">When this property's value is read, it checks to see if a value exists in the `ViewState` collection; if not, it returns the default value, an empty string.</span></span> <span data-ttu-id="ef27c-198">Le `UsernameToMatch` propriété expose un modèle commun, à savoir persistance d’une valeur pour l’état d’affichage afin que toute modification apportée à la propriété est conservées entre les publications (postback).</span><span class="sxs-lookup"><span data-stu-id="ef27c-198">The `UsernameToMatch` property exhibits a common pattern, namely persisting a value to view state so that any changes to the property are persisted across postbacks.</span></span> <span data-ttu-id="ef27c-199">Pour plus d’informations sur ce modèle, consultez [état d’affichage ASP.NET compréhension](https://msdn.microsoftn-us/library/ms972976.aspx).</span><span class="sxs-lookup"><span data-stu-id="ef27c-199">For more information on this pattern, read [Understanding ASP.NET View State](https://msdn.microsoftn-us/library/ms972976.aspx).</span></span>

<span data-ttu-id="ef27c-200">Ensuite, mettez à jour le `BindUserAccounts` méthode afin qu’au lieu de l’appel de `Membership.GetAllUsers`, il appelle `Membership.FindUsersByName`, en passant la valeur de la `UsernameToMatch` propriété ajoutée avec le caractère générique SQL, %.</span><span class="sxs-lookup"><span data-stu-id="ef27c-200">Next, update the `BindUserAccounts` method so that instead of calling `Membership.GetAllUsers`, it calls `Membership.FindUsersByName`, passing in the value of the `UsernameToMatch` property appended with the SQL wildcard character, %.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample9.vb)]

<span data-ttu-id="ef27c-201">Pour afficher uniquement les utilisateurs dont nom d’utilisateur commence par la lettre A, affectez le `UsernameToMatch` à une propriété, puis appelez `BindUserAccounts` cela entraînerait un appel à `Membership.FindUsersByName("A%")`, qui retourne tous les utilisateurs dont nom d’utilisateur commence A. de même, pour retourner *tous les* les utilisateurs, affectez une chaîne vide à la `UsernameToMatch` propriété afin que la `BindUserAccounts` méthode appelle `Membership.FindUsersByName("%")`, ce qui retournant tous les comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ef27c-201">To display just those users whose username starts with the letter A, set the `UsernameToMatch` property to A and then call `BindUserAccounts` This would result in a call to `Membership.FindUsersByName("A%")`, which will return all users whose username starts with A. Likewise, to return *all* users, assign an empty string to the `UsernameToMatch` property so that the `BindUserAccounts` method will invoke `Membership.FindUsersByName("%")`, thereby returning all user accounts.</span></span>

<span data-ttu-id="ef27c-202">Créer un gestionnaire d’événements pour l’opération de répétition `ItemCommand` événement.</span><span class="sxs-lookup"><span data-stu-id="ef27c-202">Create an event handler for the Repeater's `ItemCommand` event.</span></span> <span data-ttu-id="ef27c-203">Cet événement est déclenché chaque fois qu’un du filtre LinkButton est activé ; Il est passé le bouton de lien où vous avez cliqué `CommandName` valeur via la `RepeaterCommandEventArgs` objet.</span><span class="sxs-lookup"><span data-stu-id="ef27c-203">This event is raised whenever one of the filter LinkButtons is clicked; it is passed the clicked LinkButton's `CommandName` value through the `RepeaterCommandEventArgs` object.</span></span> <span data-ttu-id="ef27c-204">Nous avons besoin d’attribuer la valeur appropriée à la `UsernameToMatch` propriété, puis appelez le `BindUserAccounts` (méthode).</span><span class="sxs-lookup"><span data-stu-id="ef27c-204">We need to assign the appropriate value to the `UsernameToMatch` property and then call the `BindUserAccounts` method.</span></span> <span data-ttu-id="ef27c-205">Si le `CommandName` est All, affectez une chaîne vide à `UsernameToMatch` afin que tous les comptes d’utilisateur sont affichés.</span><span class="sxs-lookup"><span data-stu-id="ef27c-205">If the `CommandName` is All, assign an empty string to `UsernameToMatch` so that all user accounts are displayed.</span></span> <span data-ttu-id="ef27c-206">Sinon, assignez le `CommandName` de la valeur `UsernameToMatch`</span><span class="sxs-lookup"><span data-stu-id="ef27c-206">Otherwise, assign the `CommandName` value to `UsernameToMatch`</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample10.vb)]

<span data-ttu-id="ef27c-207">Ce code en place, de tester les fonctionnalités de filtrage.</span><span class="sxs-lookup"><span data-stu-id="ef27c-207">With this code in place, test out the filtering functionality.</span></span> <span data-ttu-id="ef27c-208">Lorsque la page est visitée en premier, tous les comptes d’utilisateur sont affichés (voir la Figure 5).</span><span class="sxs-lookup"><span data-stu-id="ef27c-208">When the page is first visited, all user accounts are displayed (refer back to Figure 5).</span></span> <span data-ttu-id="ef27c-209">En cliquant sur le bouton de lien A provoque une publication (postback) et filtre les résultats, affichant uniquement les comptes d’utilisateurs qui commencent par un.</span><span class="sxs-lookup"><span data-stu-id="ef27c-209">Clicking the A LinkButton causes a postback and filters the results, displaying only those user accounts that start with A .</span></span>


<span data-ttu-id="ef27c-210">[![Le filtrage LinkButton permet d’afficher les utilisateurs dont nom d’utilisateur commence par une lettre spécifique](building-an-interface-to-select-one-user-account-from-many-vb/_static/image17.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="ef27c-210">[![Use the Filtering LinkButtons to Display those Users Whose Username Starts with a Certain Letter](building-an-interface-to-select-one-user-account-from-many-vb/_static/image17.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image16.png)</span></span>

<span data-ttu-id="ef27c-211">**Figure 6**: le LinkButton de filtrage permet d’afficher les utilisateurs dont nom d’utilisateur commence par une lettre certaines ([cliquez pour afficher l’image en taille réelle](building-an-interface-to-select-one-user-account-from-many-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="ef27c-211">**Figure 6**: Use the Filtering LinkButtons to Display those Users Whose Username Starts with a Certain Letter ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image18.png))</span></span>


## <a name="step-4-updating-the-gridview-to-use-paging"></a><span data-ttu-id="ef27c-212">Étape 4 : Mise à jour le contrôle GridView pour utiliser la pagination</span><span class="sxs-lookup"><span data-stu-id="ef27c-212">Step 4: Updating the GridView to Use Paging</span></span>

<span data-ttu-id="ef27c-213">Le contrôle GridView indiqué dans les Figures 5 et 6 répertorie tous les enregistrements retournés à partir de la `FindUsersByName` (méthode).</span><span class="sxs-lookup"><span data-stu-id="ef27c-213">The GridView shown in Figures 5 and 6 lists all of the records returned from the `FindUsersByName` method.</span></span> <span data-ttu-id="ef27c-214">S’il existe des centaines, voire des milliers de comptes d’utilisateur, cela peut entraîner de surcharge d’informations lorsque vous affichez tous les comptes (comme c’est le cas lorsque vous cliquez sur le LinkButton tous les ou lors de la visite initialement de la page).</span><span class="sxs-lookup"><span data-stu-id="ef27c-214">If there are hundreds or thousands of user accounts this can lead to information overload when viewing all of the accounts (as is the case when clicking the All LinkButton or when initially visiting the page).</span></span> <span data-ttu-id="ef27c-215">Pour vous aider à présenter les comptes d’utilisateur dans les plus faciles à gérer, permet de configurer le contrôle GridView pour afficher les 10 comptes d’utilisateur à la fois.</span><span class="sxs-lookup"><span data-stu-id="ef27c-215">To help present the user accounts in more manageable chunks, let's configure the GridView to display 10 user accounts at a time.</span></span>

<span data-ttu-id="ef27c-216">Le contrôle GridView offre deux types de pagination :</span><span class="sxs-lookup"><span data-stu-id="ef27c-216">The GridView control offers two types of paging:</span></span>

- <span data-ttu-id="ef27c-217">**Pagination par défaut** - facile à implémenter, mais inefficace.</span><span class="sxs-lookup"><span data-stu-id="ef27c-217">**Default paging** - easy to implement, but inefficient.</span></span> <span data-ttu-id="ef27c-218">En bref, avec le contrôle GridView d’échange par défaut attend *tous les* des enregistrements à partir de sa source de données.</span><span class="sxs-lookup"><span data-stu-id="ef27c-218">In a nutshell, with default paging the GridView expects *all* of the records from its data source.</span></span> <span data-ttu-id="ef27c-219">Il affiche ensuite uniquement la page d’enregistrements appropriée.</span><span class="sxs-lookup"><span data-stu-id="ef27c-219">It then only displays the appropriate page of records.</span></span>
- <span data-ttu-id="ef27c-220">**La pagination personnalisée** -nécessite plus de travail à implémenter, mais est plus efficace que la pagination par défaut, car avec personnalisé paginer les données source retourne uniquement le jeu précis d’enregistrements à afficher.</span><span class="sxs-lookup"><span data-stu-id="ef27c-220">**Custom paging** - requires more work to implement, but is more efficient than default paging because with custom paging the data source returns only the precise set of records to display.</span></span>

<span data-ttu-id="ef27c-221">La différence de performances entre la valeur par défaut et la pagination personnalisée peut être très importante lors de la pagination des milliers d’enregistrements.</span><span class="sxs-lookup"><span data-stu-id="ef27c-221">The performance difference between default and custom paging can be quite substantial when paging through thousands of records.</span></span> <span data-ttu-id="ef27c-222">Étant donné que nous créons cette interface, en supposant qu’il peut être des centaines, voire des milliers de comptes d’utilisateur, nous allons utiliser la pagination personnalisée.</span><span class="sxs-lookup"><span data-stu-id="ef27c-222">Because we are building this interface assuming that there may be hundreds or thousands of user accounts, let's use custom paging.</span></span>

> [!NOTE]
> <span data-ttu-id="ef27c-223">Pour une discussion plus approfondie sur les différences entre la valeur par défaut et la pagination personnalisée, ainsi que les défis impliqués dans l’implémentation de la pagination personnalisée, consultez [efficacement la pagination via grandes quantités de données](https://asp.net/learn/data-access/tutorial-25-vb.aspx).</span><span class="sxs-lookup"><span data-stu-id="ef27c-223">For a more thorough discussion on the differences between default and custom paging, as well as the challenges involved in implementing custom paging, refer to [Efficiently Paging Through Large Amounts of Data](https://asp.net/learn/data-access/tutorial-25-vb.aspx).</span></span> <span data-ttu-id="ef27c-224">Pour une analyse de la différence de performances entre la valeur par défaut et la pagination personnalisée, consultez [la pagination personnalisée dans ASP.NET avec SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="ef27c-224">For some analysis of the performance difference between default and custom paging, see [Custom Paging in ASP.NET with SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx).</span></span>


<span data-ttu-id="ef27c-225">Pour implémenter la pagination personnalisée, nous devons tout d’abord un mécanisme permettant de récupérer le sous-ensemble précis d’enregistrements affiché par le contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="ef27c-225">To implement custom paging we first need some mechanism by which to retrieve the precise subset of records being displayed by the GridView.</span></span> <span data-ttu-id="ef27c-226">La bonne nouvelle est que le `Membership` de classe `FindUsersByName` méthode a une surcharge qui permet de spécifier l’index de page et la taille de page et retourne uniquement les comptes d’utilisateurs qui se trouvent dans la plage d’enregistrements.</span><span class="sxs-lookup"><span data-stu-id="ef27c-226">The good news is that the `Membership` class's `FindUsersByName` method has an overload that allows us to specify the page index and page size, and returns only those user accounts that fall within that range of records.</span></span>

<span data-ttu-id="ef27c-227">En particulier, cette surcharge possède la signature suivante : [ `FindUsersByName(usernameToMatch, pageIndex, pageSize, totalRecords)` ](https://msdn.microsoft.com/library/fa5st8b2.aspx).</span><span class="sxs-lookup"><span data-stu-id="ef27c-227">In particular, this overload has the following signature: [`FindUsersByName(usernameToMatch, pageIndex, pageSize, totalRecords)`](https://msdn.microsoft.com/library/fa5st8b2.aspx).</span></span>

<span data-ttu-id="ef27c-228">Le *pageIndex* paramètre spécifie la page des comptes d’utilisateur à retourner ; *pageSize* indique le nombre d’enregistrements à afficher par page.</span><span class="sxs-lookup"><span data-stu-id="ef27c-228">The *pageIndex* parameter specifies the page of user accounts to return; *pageSize* indicates how many records to display per page.</span></span> <span data-ttu-id="ef27c-229">Le *totalRecords* paramètre est un `ByRef` paramètre qui retourne le nombre de comptes utilisateur total dans le magasin de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ef27c-229">The *totalRecords* parameter is a `ByRef` parameter that returns the number of total user accounts in the user store.</span></span>

> [!NOTE]
> <span data-ttu-id="ef27c-230">Les données retournées par `FindUsersByName` est triée par nom d’utilisateur ; les critères de tri ne peut pas être personnalisées.</span><span class="sxs-lookup"><span data-stu-id="ef27c-230">The data returned by `FindUsersByName` is sorted by username; the sort criteria cannot be customized.</span></span>


<span data-ttu-id="ef27c-231">Le contrôle GridView peut être configuré pour utiliser la pagination personnalisée, mais uniquement lorsqu’elle est liée à un contrôle ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="ef27c-231">The GridView can be configured to utilize custom paging, but only when bound to an ObjectDataSource control.</span></span> <span data-ttu-id="ef27c-232">Pour le contrôle ObjectDataSource implémenter la pagination personnalisée, il requiert deux méthodes : une qui est passé à un index de ligne de début et le nombre maximal d’enregistrements à afficher, et retourne le sous-ensemble précis d’enregistrements qui sont comprises dans cette étendue ; et une méthode qui retourne le nombre total d’enregistrements en cours de pagination via.</span><span class="sxs-lookup"><span data-stu-id="ef27c-232">For the ObjectDataSource control to implement custom paging, it requires two methods: one that is passed a start row index and the maximum number of records to display, and returns the precise subset of records that fall within that span; and a method that returns the total number of records being paged through.</span></span> <span data-ttu-id="ef27c-233">Le `FindUsersByName` surcharge accepte un index de la page et la taille de la page et retourne le nombre total d’enregistrements via un `ByRef` paramètre.</span><span class="sxs-lookup"><span data-stu-id="ef27c-233">The `FindUsersByName` overload accepts a page index and page size, and returns the total number of records through a `ByRef` parameter.</span></span> <span data-ttu-id="ef27c-234">Il est donc une incompatibilité d’interface ici.</span><span class="sxs-lookup"><span data-stu-id="ef27c-234">So there is an interface mismatch here.</span></span>

<span data-ttu-id="ef27c-235">Est une option pour créer une classe proxy qui expose l’interface ObjectDataSource attend et appelle en interne la `FindUsersByName` (méthode).</span><span class="sxs-lookup"><span data-stu-id="ef27c-235">One option would be to create a proxy class that exposes the interface the ObjectDataSource expects, and then internally calls the `FindUsersByName` method.</span></span> <span data-ttu-id="ef27c-236">Une autre option et celui que nous allons utiliser pour cet article, consiste à créer votre propre interface la pagination et l’utiliser au lieu de l’interface de pagination de GridView intégré.</span><span class="sxs-lookup"><span data-stu-id="ef27c-236">Another option - and the one we'll use for this article - is to create our own paging interface and use that instead of the GridView's built-in paging interface.</span></span>

### <a name="creating-a-first-previous-next-last-paging-interface"></a><span data-ttu-id="ef27c-237">Création d’un premier, précédent, ensuite, la dernière Interface de pagination</span><span class="sxs-lookup"><span data-stu-id="ef27c-237">Creating a First, Previous, Next, Last Paging Interface</span></span>

<span data-ttu-id="ef27c-238">Commençons par créer une interface de pagination en premier, précédent, suivant et dernier LinkButton.</span><span class="sxs-lookup"><span data-stu-id="ef27c-238">Let's build a paging interface with First, Previous, Next, and Last LinkButtons.</span></span> <span data-ttu-id="ef27c-239">Le LinkButton premier, quand vous cliquez dessus, dirige l’utilisateur à la première page de données, tandis que le précédent lui renvoie à la page précédente.</span><span class="sxs-lookup"><span data-stu-id="ef27c-239">The First LinkButton, when clicked, will take the user to the first page of data, whereas Previous will return him to the previous page.</span></span> <span data-ttu-id="ef27c-240">De même, suivant et dernier déplacera l’utilisateur à la page suivante et le dernier, respectivement.</span><span class="sxs-lookup"><span data-stu-id="ef27c-240">Likewise, Next and Last will move the user to the next and last page, respectively.</span></span> <span data-ttu-id="ef27c-241">Ajoutez quatre contrôles LinkButton situés sous le `UserAccounts` GridView.</span><span class="sxs-lookup"><span data-stu-id="ef27c-241">Add the four LinkButton controls beneath the `UserAccounts` GridView.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample11.aspx)]

<span data-ttu-id="ef27c-242">Ensuite, créez un gestionnaire d’événements pour chacun de du bouton de lien `Click` événements.</span><span class="sxs-lookup"><span data-stu-id="ef27c-242">Next, create an event handler for each of the LinkButton's `Click` events.</span></span>

<span data-ttu-id="ef27c-243">Figure 7 montre le quatre LinkButton lorsqu’ils sont affichés dans la vue de Visual Web Developer Design.</span><span class="sxs-lookup"><span data-stu-id="ef27c-243">Figure 7 shows the four LinkButtons when viewed through the Visual Web Developer Design view.</span></span>


<span data-ttu-id="ef27c-244">[![Ajouter le premier, précédent, suivant et dernier LinkButton sous le contrôle GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image20.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="ef27c-244">[![Add First, Previous, Next, and Last LinkButtons Beneath the GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image20.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image19.png)</span></span>

<span data-ttu-id="ef27c-245">**Figure 7**: ajouter en premier, précédent, suivant et dernier LinkButton sous GridView ([cliquez pour afficher l’image en taille réelle](building-an-interface-to-select-one-user-account-from-many-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="ef27c-245">**Figure 7**: Add First, Previous, Next, and Last LinkButtons Beneath the GridView ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image21.png))</span></span>


### <a name="keeping-track-of-the-current-page-index"></a><span data-ttu-id="ef27c-246">Le suivi de l’Index de Page en cours</span><span class="sxs-lookup"><span data-stu-id="ef27c-246">Keeping Track of the Current Page Index</span></span>

<span data-ttu-id="ef27c-247">Lorsqu’un utilisateur visite tout d’abord le `ManageUsers.aspx` page ou clique sur un du filtrage boutons, que nous souhaitons afficher la première page de données dans le GridView.</span><span class="sxs-lookup"><span data-stu-id="ef27c-247">When a user first visits the `ManageUsers.aspx` page or clicks one of the filtering buttons, we want to display the first page of data in the GridView.</span></span> <span data-ttu-id="ef27c-248">Toutefois, lorsque l’utilisateur clique sur le volet de navigation LinkButton, nous devons mettre à jour l’index de page.</span><span class="sxs-lookup"><span data-stu-id="ef27c-248">When the user clicks one of the navigation LinkButtons, however, we need to update the page index.</span></span> <span data-ttu-id="ef27c-249">Pour conserver l’index de page et le nombre d’enregistrements à afficher par page, ajoutez les deux propriétés suivantes à la classe code-behind de la page :</span><span class="sxs-lookup"><span data-stu-id="ef27c-249">To maintain the page index and the number of records to display per page, add the following two properties to the page's code-behind class:</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample12.vb)]

<span data-ttu-id="ef27c-250">Comme le `UsernameToMatch` propriété, le `PageIndex` propriété persiste sa valeur à l’état d’affichage.</span><span class="sxs-lookup"><span data-stu-id="ef27c-250">Like the `UsernameToMatch` property, the `PageIndex` property persists its value to view state.</span></span> <span data-ttu-id="ef27c-251">En lecture seule `PageSize` propriété retourne une valeur codée en dur, 10.</span><span class="sxs-lookup"><span data-stu-id="ef27c-251">The read-only `PageSize` property returns a hard-coded value, 10.</span></span> <span data-ttu-id="ef27c-252">Inviter le lecteur intéressé pour mettre à jour de cette propriété pour utiliser le même modèle que `PageIndex`, puis d’augmenter le `ManageUsers.aspx` page de telle sorte que la personne visitant la page peut spécifier le nombre de comptes utilisateur à afficher par page.</span><span class="sxs-lookup"><span data-stu-id="ef27c-252">I invite the interested reader to update this property to use the same pattern as `PageIndex`, and then to augment the `ManageUsers.aspx` page such that the person visiting the page can specify how many user accounts to display per page.</span></span>

### <a name="retrieving-just-the-current-pages-records-updating-the-page-index-and-enabling-and-disabling-the-paging-interface-linkbuttons"></a><span data-ttu-id="ef27c-253">Récupérer uniquement les enregistrements de la Page active, de mise à jour de l’Index de Page et d’activation et de désactivation de la LinkButton d’Interface de pagination</span><span class="sxs-lookup"><span data-stu-id="ef27c-253">Retrieving Just the Current Page's Records, Updating the Page Index, and Enabling and Disabling the Paging Interface LinkButtons</span></span>

<span data-ttu-id="ef27c-254">Avec l’interface de pagination en place et la `PageIndex` et `PageSize` propriétés ajoutées, vous êtes prêt à mettre à jour le `BindUserAccounts` méthode afin qu’elle utilise les `FindUsersByName` de surcharge.</span><span class="sxs-lookup"><span data-stu-id="ef27c-254">With the paging interface in place and the `PageIndex` and `PageSize` properties added, we are ready to update the `BindUserAccounts` method so that it uses the appropriate `FindUsersByName` overload.</span></span> <span data-ttu-id="ef27c-255">En outre, nous devons disposer de cette méthode activer ou désactiver l’interface de pagination en fonction de la page s’affiche.</span><span class="sxs-lookup"><span data-stu-id="ef27c-255">Additionally, we need to have this method enable or disable the paging interface depending on what page is being displayed.</span></span> <span data-ttu-id="ef27c-256">Lors de l’affichage de la première page de données, les liens en premier et précédent doivent être désactivées ; Ensuite, la dernière doit être désactivée lors de l’affichage de la dernière page.</span><span class="sxs-lookup"><span data-stu-id="ef27c-256">When viewing the first page of data, the First and Previous links should be disabled; Next and Last should be disabled when viewing the last page.</span></span>

<span data-ttu-id="ef27c-257">Mettez à jour la méthode `BindUserAccounts` avec le code suivant :</span><span class="sxs-lookup"><span data-stu-id="ef27c-257">Update the `BindUserAccounts` method with the following code:</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample13.vb)]

<span data-ttu-id="ef27c-258">Notez que le nombre total d’enregistrements en cours par le biais de pagination est déterminé par le dernier paramètre de la `FindUsersByName` (méthode).</span><span class="sxs-lookup"><span data-stu-id="ef27c-258">Note that the total number of records being paged through is determined by the last parameter of the `FindUsersByName` method.</span></span> <span data-ttu-id="ef27c-259">Une fois que la page spécifiée des comptes d’utilisateur sont retournés, le quatre LinkButton est activés ou désactivés, selon si la première ou dernière page de données est affichée.</span><span class="sxs-lookup"><span data-stu-id="ef27c-259">After the specified page of user accounts are returned, the four LinkButtons are either enabled or disabled, depending on whether the first or last page of data is being viewed.</span></span>

<span data-ttu-id="ef27c-260">La dernière étape consiste à écrire le code pour les quatre LinkButton `Click` gestionnaires d’événements.</span><span class="sxs-lookup"><span data-stu-id="ef27c-260">The last step is to write the code for the four LinkButtons' `Click` event handlers.</span></span> <span data-ttu-id="ef27c-261">Ces gestionnaires d’événements doivent mettre à jour le `PageIndex` propriété, puis à relier les données au contrôle GridView via un appel à `BindUserAccounts` le premier, précédent et suivant gestionnaires d’événements sont très simples.</span><span class="sxs-lookup"><span data-stu-id="ef27c-261">These event handlers need to update the `PageIndex` property and then rebind the data to the GridView via a call to `BindUserAccounts` The First, Previous, and Next event handlers are very simple.</span></span> <span data-ttu-id="ef27c-262">Le `Click` Gestionnaire d’événements pour la dernière LinkButton, toutefois, est un peu plus complexe, car nous avons besoin déterminer le nombre d’enregistrements est affiché afin de déterminer le dernier index de la page.</span><span class="sxs-lookup"><span data-stu-id="ef27c-262">The `Click` event handler for the Last LinkButton, however, is a bit more complex because we need to determine how many records are being displayed in order to determine the last page index.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample14.vb)]

<span data-ttu-id="ef27c-263">Les chiffres 8 et 9 afficher l’interface de la pagination personnalisée en action.</span><span class="sxs-lookup"><span data-stu-id="ef27c-263">Figures 8 and 9 show the custom paging interface in action.</span></span> <span data-ttu-id="ef27c-264">La figure 8 illustre le `ManageUsers.aspx` page lors de l’affichage de la première page de données pour tous les comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="ef27c-264">Figure 8 shows the `ManageUsers.aspx` page when viewing the first page of data for all user accounts.</span></span> <span data-ttu-id="ef27c-265">Notez que seuls 10 des 13 comptes sont affichés.</span><span class="sxs-lookup"><span data-stu-id="ef27c-265">Note that only 10 of the 13 accounts are displayed.</span></span> <span data-ttu-id="ef27c-266">En cliquant sur le lien suivant ou dernier provoque une publication (postback), les mises à jour le `PageIndex` à 1 et lie la deuxième page de l’utilisateur des comptes à la grille (voir la Figure 9).</span><span class="sxs-lookup"><span data-stu-id="ef27c-266">Clicking the Next or Last link causes a postback, updates the `PageIndex` to 1, and binds the second page of user accounts to the grid (see Figure 9).</span></span>


<span data-ttu-id="ef27c-267">[![Les comptes d’utilisateur 10 premier sont affichés.](building-an-interface-to-select-one-user-account-from-many-vb/_static/image23.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="ef27c-267">[![The First 10 User Accounts are Displayed](building-an-interface-to-select-one-user-account-from-many-vb/_static/image23.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image22.png)</span></span>

<span data-ttu-id="ef27c-268">**Figure 8**: le premier comptes d’utilisateur de 10 sont affichés ([cliquez pour afficher l’image en taille réelle](building-an-interface-to-select-one-user-account-from-many-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="ef27c-268">**Figure 8**: The First 10 User Accounts are Displayed ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image24.png))</span></span>


<span data-ttu-id="ef27c-269">[![En cliquant sur le lien suivant affiche la deuxième Page de comptes d’utilisateur](building-an-interface-to-select-one-user-account-from-many-vb/_static/image26.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="ef27c-269">[![Clicking the Next Link Displays the Second Page of User Accounts](building-an-interface-to-select-one-user-account-from-many-vb/_static/image26.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image25.png)</span></span>

<span data-ttu-id="ef27c-270">**Figure 9**: en cliquant sur le lien suivant affiche la deuxième Page de comptes d’utilisateur ([cliquez pour afficher l’image en taille réelle](building-an-interface-to-select-one-user-account-from-many-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="ef27c-270">**Figure 9**: Clicking the Next Link Displays the Second Page of User Accounts ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image27.png))</span></span>


## <a name="summary"></a><span data-ttu-id="ef27c-271">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="ef27c-271">Summary</span></span>

<span data-ttu-id="ef27c-272">Administrateurs ont souvent besoin de sélectionner un utilisateur à partir de la liste des comptes.</span><span class="sxs-lookup"><span data-stu-id="ef27c-272">Administrators often need to select a user from the list of accounts.</span></span> <span data-ttu-id="ef27c-273">Dans les didacticiels précédents, nous avons étudié à l’aide d’une liste déroulante remplie avec les utilisateurs, mais cette approche n’évolue pas bien.</span><span class="sxs-lookup"><span data-stu-id="ef27c-273">In previous tutorials we looked at using a drop-down list populated with the users, but this approach does not scale well.</span></span> <span data-ttu-id="ef27c-274">Dans ce didacticiel, nous avons exploré une meilleure alternative : une interface filtrable dont les résultats sont affichés dans un GridView paginé.</span><span class="sxs-lookup"><span data-stu-id="ef27c-274">In this tutorial we explored a better alternative: a filterable interface whose results are displayed in a paged GridView.</span></span> <span data-ttu-id="ef27c-275">Avec cette interface utilisateur, les administrateurs peuvent rapidement et facilement localiser et sélectionner un compte d’utilisateur parmi des milliers.</span><span class="sxs-lookup"><span data-stu-id="ef27c-275">With this user interface, administrators can quickly and efficiently locate and select one user account among thousands.</span></span>

<span data-ttu-id="ef27c-276">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="ef27c-276">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="ef27c-277">informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="ef27c-277">Further Reading</span></span>

<span data-ttu-id="ef27c-278">Pour plus d’informations sur les sujets abordés dans ce didacticiel, consultez les ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="ef27c-278">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="ef27c-279">Pagination personnalisée dans ASP.NET avec SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="ef27c-279">Custom Paging in ASP.NET with SQL Server 2005</span></span>](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx)
- [<span data-ttu-id="ef27c-280">Efficacement la pagination des grandes quantités de données</span><span class="sxs-lookup"><span data-stu-id="ef27c-280">Efficiently Paging Through Large Amounts of Data</span></span>](https://asp.net/learn/data-access/tutorial-25-vb.aspx)
- [<span data-ttu-id="ef27c-281">Restauration de votre propre outil d’Administration de site Web</span><span class="sxs-lookup"><span data-stu-id="ef27c-281">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="ef27c-282">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="ef27c-282">About the Author</span></span>

<span data-ttu-id="ef27c-283">Scott Mitchell, auteur de plusieurs livres sur ASP/ASP.NET et créateur de 4GuysFromRolla.com, travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="ef27c-283">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ef27c-284">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="ef27c-284">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ef27c-285">Son dernier ouvrage est  *[SAM animer vous-même ASP.NET 2.0 des dernières 24 heures](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="ef27c-285">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="ef27c-286">Scott peut être atteint à [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) ou via son blog à [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="ef27c-286">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="ef27c-287">Remerciements</span><span class="sxs-lookup"><span data-stu-id="ef27c-287">Special Thanks To</span></span>

<span data-ttu-id="ef27c-288">Cette série de didacticiels a été révisée par plusieurs réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="ef27c-288">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="ef27c-289">Entraîner un réviseur pour ce didacticiel a été Alicja Maziarz.</span><span class="sxs-lookup"><span data-stu-id="ef27c-289">Lead reviewer for this tutorial was Alicja Maziarz.</span></span> <span data-ttu-id="ef27c-290">Vous souhaitez consulter mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="ef27c-290">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="ef27c-291">Dans ce cas, me supprimer une ligne à</span><span class="sxs-lookup"><span data-stu-id="ef27c-291">If so, drop me a line at</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ef27c-292">[Précédent](unlocking-and-approving-user-accounts-cs.md)
> [Suivant](recovering-and-changing-passwords-vb.md)</span><span class="sxs-lookup"><span data-stu-id="ef27c-292">[Previous](unlocking-and-approving-user-accounts-cs.md)
[Next](recovering-and-changing-passwords-vb.md)</span></span>
