---
uid: web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-vb
title: Validation des informations d’identification de l’utilisateur dans le magasin d’utilisateur d’appartenance (VB) | Documents Microsoft
author: rick-anderson
description: Dans ce didacticiel, nous allons examiner comment valider des informations d’identification d’un utilisateur sur le magasin d’utilisateur d’appartenance à l’aide de moyens par programme et le contrôle de connexion en cours...
ms.author: aspnetcontent
manager: wpickett
ms.date: 01/18/2008
ms.topic: article
ms.assetid: 17772912-b47b-4557-9ce9-80f22df642f7
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-vb
msc.type: authoredcontent
ms.openlocfilehash: f8d3de9736d901e02096d20345650b47c47897ae
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/06/2018
ms.locfileid: "30891332"
---
<a name="validating-user-credentials-against-the-membership-user-store-vb"></a><span data-ttu-id="f2f62-103">Validation des informations d’identification de l’utilisateur dans le magasin d’utilisateur d’appartenance (VB)</span><span class="sxs-lookup"><span data-stu-id="f2f62-103">Validating User Credentials Against the Membership User Store (VB)</span></span>
====================
<span data-ttu-id="f2f62-104">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f2f62-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f2f62-105">[Télécharger le Code](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_VB.zip) ou [télécharger le PDF](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="f2f62-105">[Download Code](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_VB.zip) or [Download PDF](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_vb.pdf)</span></span>

> <span data-ttu-id="f2f62-106">Dans ce didacticiel, nous allons examiner comment valider des informations d’identification d’un utilisateur sur le magasin d’utilisateur d’appartenance à l’aide de moyens par programme et le contrôle de connexion.</span><span class="sxs-lookup"><span data-stu-id="f2f62-106">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="f2f62-107">Nous examinerons également comment personnaliser l’apparence et le comportement du contrôle de connexion.</span><span class="sxs-lookup"><span data-stu-id="f2f62-107">We will also look at how to customize the login control's appearance and behavior.</span></span>


## <a name="introduction"></a><span data-ttu-id="f2f62-108">Introduction</span><span class="sxs-lookup"><span data-stu-id="f2f62-108">Introduction</span></span>

<span data-ttu-id="f2f62-109">Dans le <a id="Tutorial05"> </a> [didacticiel précédent](creating-user-accounts-vb.md) nous avons examiné comment créer un nouveau compte d’utilisateur dans le cadre de l’appartenance.</span><span class="sxs-lookup"><span data-stu-id="f2f62-109">In the <a id="Tutorial05"></a>[preceding tutorial](creating-user-accounts-vb.md) we looked at how to create a new user account in the Membership framework.</span></span> <span data-ttu-id="f2f62-110">Nous avons tout d’abord à créer par programme des comptes d’utilisateur via la `Membership` la classe `CreateUser` (méthode) et ensuite examiné à l’aide du contrôle CreateUserWizard Web.</span><span class="sxs-lookup"><span data-stu-id="f2f62-110">We first looked at programmatically creating user accounts via the `Membership` class's `CreateUser` method, and then examined using the CreateUserWizard Web control.</span></span> <span data-ttu-id="f2f62-111">Toutefois, la page de connexion valide actuellement les informations d’identification fournies par rapport à une liste codée en dur de paires nom d’utilisateur et mot de passe.</span><span class="sxs-lookup"><span data-stu-id="f2f62-111">However, the login page currently validates the supplied credentials against a hard-coded list of username and password pairs.</span></span> <span data-ttu-id="f2f62-112">Nous devons mettre à jour la logique de la page de connexion afin qu’il valide les informations d’identification dans le magasin de l’utilisateur de l’infrastructure d’appartenance.</span><span class="sxs-lookup"><span data-stu-id="f2f62-112">We need to update the login page's logic so that it validates credentials against the Membership framework's user store.</span></span>

<span data-ttu-id="f2f62-113">Beaucoup telles que de créer des comptes d’utilisateur, informations d’identification peuvent être validées par programme ou de façon déclarative.</span><span class="sxs-lookup"><span data-stu-id="f2f62-113">Much like with creating user accounts, credentials can be validated programmatically or declaratively.</span></span> <span data-ttu-id="f2f62-114">L’API d’appartenance inclut une méthode de validation par programmation les informations d’identification d’un utilisateur par rapport au magasin de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f2f62-114">The Membership API includes a method for programmatically validating a user's credentials against the user store.</span></span> <span data-ttu-id="f2f62-115">Et ASP.NET est fourni avec le contrôle de connexion Web, ce qui rend une interface utilisateur avec des zones de texte pour le nom d’utilisateur et mot de passe et un bouton pour vous connecter.</span><span class="sxs-lookup"><span data-stu-id="f2f62-115">And ASP.NET ships with the Login Web control, which renders a user interface with textboxes for the username and password and a button to log in.</span></span>

<span data-ttu-id="f2f62-116">Dans ce didacticiel, nous allons examiner comment valider des informations d’identification d’un utilisateur sur le magasin d’utilisateur d’appartenance à l’aide de moyens par programme et le contrôle de connexion.</span><span class="sxs-lookup"><span data-stu-id="f2f62-116">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="f2f62-117">Nous examinerons également comment personnaliser l’apparence et le comportement du contrôle de connexion.</span><span class="sxs-lookup"><span data-stu-id="f2f62-117">We will also look at how to customize the login control's appearance and behavior.</span></span> <span data-ttu-id="f2f62-118">C’est parti !</span><span class="sxs-lookup"><span data-stu-id="f2f62-118">Let's get started!</span></span>

## <a name="step-1-validating-credentials-against-the-membership-user-store"></a><span data-ttu-id="f2f62-119">Étape 1 : Validation des informations d’identification dans le magasin d’utilisateur d’appartenance</span><span class="sxs-lookup"><span data-stu-id="f2f62-119">Step 1: Validating Credentials Against the Membership User Store</span></span>

<span data-ttu-id="f2f62-120">Pour les sites web qui utilisent l’authentification par formulaire, un utilisateur ouvre une session sur le site Web en accédant à une page de connexion et en entrant leurs informations d’identification.</span><span class="sxs-lookup"><span data-stu-id="f2f62-120">For web sites that use forms authentication, a user logs on to the website by visiting a login page and entering their credentials.</span></span> <span data-ttu-id="f2f62-121">Ces informations d’identification sont ensuite comparées par rapport au magasin de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f2f62-121">These credentials are then compared against the user store.</span></span> <span data-ttu-id="f2f62-122">Si elles sont valides, l’utilisateur a un ticket d’authentification forms, qui est un jeton de sécurité qui indique l’identité et l’authenticité du visiteur.</span><span class="sxs-lookup"><span data-stu-id="f2f62-122">If they are valid, then the user is granted a forms authentication ticket, which is a security token that indicates the identity and authenticity of the visitor.</span></span>

<span data-ttu-id="f2f62-123">Pour valider un utilisateur par rapport à l’infrastructure d’appartenance, utilisez la `Membership` de classe [ `ValidateUser` méthode](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx).</span><span class="sxs-lookup"><span data-stu-id="f2f62-123">To validate a user against the Membership framework, use the `Membership` class's [`ValidateUser` method](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx).</span></span> <span data-ttu-id="f2f62-124">Le `ValidateUser` méthode accepte deux paramètres d’entrée - `username` et `password` - et retourne une valeur booléenne qui indique si les informations d’identification sont valides.</span><span class="sxs-lookup"><span data-stu-id="f2f62-124">The `ValidateUser` method takes in two input parameters - `username` and `password` - and returns a Boolean value indicating whether the credentials were valid.</span></span> <span data-ttu-id="f2f62-125">Par exemple lors de la `CreateUser` méthode que nous avons examiné dans le didacticiel précédent, le `ValidateUser` méthode délègue la validation réelle pour le fournisseur d’appartenances configuré.</span><span class="sxs-lookup"><span data-stu-id="f2f62-125">Like with the `CreateUser` method we examined in the previous tutorial, the `ValidateUser` method delegates the actual validation to the configured Membership provider.</span></span>

<span data-ttu-id="f2f62-126">Le `SqlMembershipProvider` valide les informations d’identification fournies en obtenant le mot de passe de l’utilisateur spécifié par le `aspnet_Membership_GetPasswordWithFormat` procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="f2f62-126">The `SqlMembershipProvider` validates the supplied credentials by obtaining the specified user's password via the `aspnet_Membership_GetPasswordWithFormat` stored procedure.</span></span> <span data-ttu-id="f2f62-127">N’oubliez pas que le `SqlMembershipProvider` stocke les mots de passe utilisateurs à l’aide d’un des trois formats : clair, chiffrés ou hachés.</span><span class="sxs-lookup"><span data-stu-id="f2f62-127">Recall that the `SqlMembershipProvider` stores users' passwords using one of three formats: clear, encrypted, or hashed.</span></span> <span data-ttu-id="f2f62-128">Le `aspnet_Membership_GetPasswordWithFormat` procédure stockée retourne le mot de passe dans son format brut.</span><span class="sxs-lookup"><span data-stu-id="f2f62-128">The `aspnet_Membership_GetPasswordWithFormat` stored procedure returns the password in its raw format.</span></span> <span data-ttu-id="f2f62-129">Les mots de passe chiffrés ou hachés, le `SqlMembershipProvider` transforme le `password` valeur passée dans le `ValidateUser` méthode en son équivalent chiffrés ou hachés d’état et les compare avec ce qui a été retourné à partir de la base de données.</span><span class="sxs-lookup"><span data-stu-id="f2f62-129">For encrypted or hashed passwords, the `SqlMembershipProvider` transforms the `password` value passed into the `ValidateUser` method into its equivalent encrypted or hashed state and then compares it with what was returned from the database.</span></span> <span data-ttu-id="f2f62-130">Si le mot de passe stocké dans la base de données correspond à la mise en forme mot de passe entré par l’utilisateur, les informations d’identification sont valides.</span><span class="sxs-lookup"><span data-stu-id="f2f62-130">If the password stored in the database matches the formatted password entered by the user, the credentials are valid.</span></span>

<span data-ttu-id="f2f62-131">Nous allons mettre à jour notre page de connexion (~ /`Login.aspx`) afin qu’il valide les informations d’identification fournies sur le magasin d’utilisateur d’appartenance framework.</span><span class="sxs-lookup"><span data-stu-id="f2f62-131">Let's update our login page (~/`Login.aspx`) so that it validates the supplied credentials against the Membership framework user store.</span></span> <span data-ttu-id="f2f62-132">Nous avons créé cette page de connexion dans le <a id="Tutorial02"> </a> [ *une vue d’ensemble de l’authentification par formulaire* ](../introduction/an-overview-of-forms-authentication-vb.md) didacticiel, la création d’une interface avec deux zones de texte pour le nom d’utilisateur et un mot de passe, un Mémoriser mes informations de case à cocher et un bouton de connexion (voir Figure 1).</span><span class="sxs-lookup"><span data-stu-id="f2f62-132">We created this login page back in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-vb.md) tutorial, creating an interface with two TextBoxes for the username and password, a Remember Me checkbox, and a Login button (see Figure 1).</span></span> <span data-ttu-id="f2f62-133">Le code valide les informations d’identification entrées par rapport à une liste codée en dur de paires nom d’utilisateur et mot de passe (Scott/mot de passe, Jisun/mot de passe et Sam/mot de passe).</span><span class="sxs-lookup"><span data-stu-id="f2f62-133">The code validates the entered credentials against a hard-coded list of username and password pairs (Scott/password, Jisun/password, and Sam/password).</span></span> <span data-ttu-id="f2f62-134">Dans le <a id="Tutorial03"> </a> [ *Configuration de l’authentification de formulaires et les rubriques avancées* ](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md) didacticiel nous mis à jour le code de la page de connexion pour stocker des informations supplémentaires dans les formulaires ticket d’authentification `UserData` propriété.</span><span class="sxs-lookup"><span data-stu-id="f2f62-134">In the <a id="Tutorial03"></a>[*Forms Authentication Configuration and Advanced Topics*](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md) tutorial we updated the login page's code to store additional information in the forms authentication ticket's `UserData` property.</span></span>


<span data-ttu-id="f2f62-135">[![Interface de la Page connexion inclut deux zones de texte, une liste case à cocher et un bouton](validating-user-credentials-against-the-membership-user-store-vb/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="f2f62-135">[![The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button](validating-user-credentials-against-the-membership-user-store-vb/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image1.png)</span></span>

<span data-ttu-id="f2f62-136">**Figure 1**: Interface inclut deux zones de texte de la Page connexion, une liste case à cocher et un bouton ([cliquez pour afficher l’image en taille réelle](validating-user-credentials-against-the-membership-user-store-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="f2f62-136">**Figure 1**: The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image3.png))</span></span>


<span data-ttu-id="f2f62-137">Interface utilisateur de la page de connexion peut rester inchangée, mais nous devons remplacer le bouton de connexion `Click` Gestionnaire d’événements avec le code qui valide l’utilisateur sur le magasin d’utilisateur d’appartenance framework.</span><span class="sxs-lookup"><span data-stu-id="f2f62-137">The login page's user interface can remain unchanged, but we need to replace the Login button's `Click` event handler with code that validates the user against the Membership framework user store.</span></span> <span data-ttu-id="f2f62-138">Mettre à jour le Gestionnaire d’événements afin que le code s’affiche comme suit :</span><span class="sxs-lookup"><span data-stu-id="f2f62-138">Update the event handler so that its code appears as follows:</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample1.vb)]

<span data-ttu-id="f2f62-139">Ce code est extrêmement simple.</span><span class="sxs-lookup"><span data-stu-id="f2f62-139">This code is remarkably simple.</span></span> <span data-ttu-id="f2f62-140">Nous allons commencer en appelant le `Membership.ValidateUser` méthode, en passant le nom d’utilisateur fourni et un mot de passe.</span><span class="sxs-lookup"><span data-stu-id="f2f62-140">We start by calling the `Membership.ValidateUser` method, passing in the supplied username and password.</span></span> <span data-ttu-id="f2f62-141">Si cette méthode retourne la valeur True, l’utilisateur est connecté au site via le `FormsAuthentication` méthode RedirectFromLoginPage de la classe.</span><span class="sxs-lookup"><span data-stu-id="f2f62-141">If that method returns True, then the user is signed into the site via the `FormsAuthentication` class's RedirectFromLoginPage method.</span></span> <span data-ttu-id="f2f62-142">(Comme expliqué dans la <a id="Tutorial02"> </a> [ *une vue d’ensemble de l’authentification par formulaire* ](../introduction/an-overview-of-forms-authentication-vb.md) (didacticiel), le `FormsAuthentication.RedirectFromLoginPage` crée les formulaires ticket d’authentification et redirige ensuite l’utilisateur à la page appropriée.) Si les informations d’identification ne sont pas valides, toutefois, le `InvalidCredentialsMessage` étiquette s’affiche, informant l’utilisateur que leur nom d’utilisateur ou le mot de passe est incorrect.</span><span class="sxs-lookup"><span data-stu-id="f2f62-142">(As we discussed in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-vb.md) tutorial, the `FormsAuthentication.RedirectFromLoginPage` creates the forms authentication ticket and then redirects the user to the appropriate page.) If the credentials are invalid, however, the `InvalidCredentialsMessage` Label is displayed, informing the user that their username or password was incorrect.</span></span>

<span data-ttu-id="f2f62-143">C’est tout cela !</span><span class="sxs-lookup"><span data-stu-id="f2f62-143">That's all there is to it!</span></span>

<span data-ttu-id="f2f62-144">Pour vérifier que la page de connexion fonctionne comme prévu, tentative de connexion avec l’un des comptes d’utilisateur que vous avez créé dans le didacticiel précédent.</span><span class="sxs-lookup"><span data-stu-id="f2f62-144">To test that the login page works as expected, attempt to login with one of the user accounts you created in the preceding tutorial.</span></span> <span data-ttu-id="f2f62-145">Ou, si vous n’avez pas encore créé un compte, pour commencer, créez-en un à partir de la `~/Membership/CreatingUserAccounts.aspx` page.</span><span class="sxs-lookup"><span data-stu-id="f2f62-145">Or, if you have not yet created an account, go ahead and create one from the `~/Membership/CreatingUserAccounts.aspx` page.</span></span>

> [!NOTE]
> <span data-ttu-id="f2f62-146">Lorsque l’utilisateur entre ses informations d’identification et envoie le formulaire de la page de connexion, les informations d’identification, y compris son mot de passe sont transmises via Internet au serveur web dans *en texte brut*.</span><span class="sxs-lookup"><span data-stu-id="f2f62-146">When the user enters her credentials and submits the login page form, the credentials, including her password, are transmitted over the Internet to the web server in *plain text*.</span></span> <span data-ttu-id="f2f62-147">Cela signifie que les pirates informatiques espionnant le trafic réseau peut voir le nom d’utilisateur et un mot de passe.</span><span class="sxs-lookup"><span data-stu-id="f2f62-147">That means any hacker sniffing the network traffic can see the username and password.</span></span> <span data-ttu-id="f2f62-148">Pour éviter cela, il est essentiel pour chiffrer le trafic réseau à l’aide de [SSL Secure Socket Layers ()](http://en.wikipedia.org/wiki/Secure_Sockets_Layer).</span><span class="sxs-lookup"><span data-stu-id="f2f62-148">To prevent this, it is essential to encrypt the network traffic by using [Secure Socket Layers (SSL)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer).</span></span> <span data-ttu-id="f2f62-149">Cela garantit que les informations d’identification (comme balisage HTML de la page entière) est chiffré dès l’instant où qu'ils quittent le navigateur jusqu'à ce qu’ils sont reçus par le serveur web.</span><span class="sxs-lookup"><span data-stu-id="f2f62-149">This will ensure that the credentials (as well as the entire page's HTML markup) are encrypted from the moment they leave the browser until they are received by the web server.</span></span>


### <a name="how-the-membership-framework-handles-invalid-login-attempts"></a><span data-ttu-id="f2f62-150">Comment le Framework d’appartenance gère les tentatives de connexion non valide</span><span class="sxs-lookup"><span data-stu-id="f2f62-150">How the Membership Framework Handles Invalid Login Attempts</span></span>

<span data-ttu-id="f2f62-151">Lorsqu’un visiteur atteint la page de connexion et envoie ses informations d’identification, son navigateur effectue une requête HTTP à la page de connexion.</span><span class="sxs-lookup"><span data-stu-id="f2f62-151">When a visitor reaches the login page and submits their credentials, their browser makes an HTTP request to the login page.</span></span> <span data-ttu-id="f2f62-152">Si les informations d’identification sont valides, la réponse HTTP inclut le ticket d’authentification dans un cookie.</span><span class="sxs-lookup"><span data-stu-id="f2f62-152">If the credentials are valid, the HTTP response includes the authentication ticket in a cookie.</span></span> <span data-ttu-id="f2f62-153">Par conséquent, un pirate tente de s’introduire dans votre site pourrait créer un programme qui envoie des requêtes HTTP à la page de connexion avec un nom d’utilisateur valide et une estimation sur le mot de passe de manière exhaustive.</span><span class="sxs-lookup"><span data-stu-id="f2f62-153">Therefore, a hacker attempting to break into your site could create a program that exhaustively sends HTTP requests to the login page with a valid username and a guess at the password.</span></span> <span data-ttu-id="f2f62-154">Si l’estimation de mot de passe est correcte, la page de connexion retourne le cookie de ticket d’authentification, alors le programme sait qu’il a persisté lors d’une paire nom d’utilisateur/mot de passe valide.</span><span class="sxs-lookup"><span data-stu-id="f2f62-154">If the password guess is correct, the login page will return the authentication ticket cookie, at which point the program knows it has stumbled upon a valid username/password pair.</span></span> <span data-ttu-id="f2f62-155">En force brute, un tel programme pourrez faites-nous de mot de passe d’un utilisateur, en particulier si le mot de passe est faible.</span><span class="sxs-lookup"><span data-stu-id="f2f62-155">Through brute force, such a program might be able to stumble upon a user's password, especially if the password is weak.</span></span>

<span data-ttu-id="f2f62-156">Pour empêcher ces attaques en force brute, l’infrastructure d’appartenance verrouille un utilisateur s’il existe un certain nombre de tentatives de connexion ayant échoué dans un certain temps.</span><span class="sxs-lookup"><span data-stu-id="f2f62-156">To prevent such brute force attacks, the Membership framework locks out a user if there are a certain number of unsuccessful login attempts within a certain period of time.</span></span> <span data-ttu-id="f2f62-157">Les paramètres exacts sont configurables via les paramètres de configuration de fournisseur de l’appartenance deux suivantes :</span><span class="sxs-lookup"><span data-stu-id="f2f62-157">The exact parameters are configurable through the following two Membership provider configuration settings:</span></span>

- <span data-ttu-id="f2f62-158">`maxInvalidPasswordAttempts` -Spécifie le mot de passe non valide combien tentatives sont autorisées pour l’utilisateur au sein de la période de temps avant que le compte est verrouillé. La valeur par défaut est 5.</span><span class="sxs-lookup"><span data-stu-id="f2f62-158">`maxInvalidPasswordAttempts` - specifies how many invalid password attempts are allowed for the user within the time period before the account is locked out. The default value is 5.</span></span>
- <span data-ttu-id="f2f62-159">`passwordAttemptWindow` -Indique la période de temps en minutes pendant lesquelles le nombre spécifié de tentatives de connexion non valide provoque le compte peuvent être verrouillés. La valeur par défaut est 10.</span><span class="sxs-lookup"><span data-stu-id="f2f62-159">`passwordAttemptWindow` - indicates the time period in minutes during which the specified number of invalid login attempts will cause the account to be locked out. The default value is 10.</span></span>

<span data-ttu-id="f2f62-160">Si un utilisateur a été verrouillé, elle ne peut pas se connecter jusqu'à ce qu’un administrateur déverrouille son compte.</span><span class="sxs-lookup"><span data-stu-id="f2f62-160">If a user has been locked out, she cannot login until an administrator unlocks her account.</span></span> <span data-ttu-id="f2f62-161">Lorsqu’un utilisateur est verrouillé, le `ValidateUser` méthode sera *toujours* retourner `False`, même si les informations d’identification valides sont fournies.</span><span class="sxs-lookup"><span data-stu-id="f2f62-161">When a user is locked out, the `ValidateUser` method will *always* return `False`, even if valid credentials are supplied.</span></span> <span data-ttu-id="f2f62-162">Alors que ce comportement réduit la probabilité qu’un pirate s’arrêtera dans votre site via des méthodes de force brute, il peut finir de verrouillage d’un utilisateur valide qui a oublié simplement son mot de passe ou accidentellement a verrouillage des majuscules ou ayant un jour de la saisie incorrect.</span><span class="sxs-lookup"><span data-stu-id="f2f62-162">While this behavior lessens the likelihood that a hacker will break into your site through brute force methods, it can end up locking out a valid user who has simply forgotten her password or accidentally has the Caps Lock on or is having a bad typing day.</span></span>

<span data-ttu-id="f2f62-163">Malheureusement, il n’existe aucun outil intégré pour le déverrouillage d’un compte d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f2f62-163">Unfortunately, there is no built-in tool for unlocking a user account.</span></span> <span data-ttu-id="f2f62-164">Pour déverrouiller un compte, vous pouvez modifier la base de données directement - modifier la `IsLockedOut` champ dans le `aspnet_Membership` de table pour le compte d’utilisateur approprié - ou créer une interface basée sur le web répertorie les comptes avec des options pour les déverrouiller verrouillée.</span><span class="sxs-lookup"><span data-stu-id="f2f62-164">In order to unlock an account, you can modify the database directly - change the `IsLockedOut` field in the `aspnet_Membership` table for the appropriate user account - or create a web-based interface that lists locked out accounts with options to unlock them.</span></span> <span data-ttu-id="f2f62-165">Nous allons examiner la création d’interfaces d’administration permettant d’accomplir des tâches liées au compte et un rôle d’utilisateur courantes dans un didacticiel futures.</span><span class="sxs-lookup"><span data-stu-id="f2f62-165">We will examine creating administrative interfaces for accomplishing common user account- and role-related tasks in a future tutorial.</span></span>

> [!NOTE]
> <span data-ttu-id="f2f62-166">Un des inconvénients de la `ValidateUser` méthode est que lorsque les informations d’identification fournies ne sont pas valides, il ne fournit pas d’explications sur la raison pour laquelle.</span><span class="sxs-lookup"><span data-stu-id="f2f62-166">One downside of the `ValidateUser` method is that when the supplied credentials are invalid, it does not provide any explanation as to why.</span></span> <span data-ttu-id="f2f62-167">Les informations d’identification peuvent être non valides, car il n’existe aucune paire nom d’utilisateur/mot de passe correspondant dans le magasin de l’utilisateur, ou parce que l’utilisateur n’a pas encore été approuvé, ou parce que l’utilisateur a été verrouillé. À l’étape 4, nous verrons comment afficher un message plus détaillé à l’utilisateur lors de leur tentative de connexion échoue.</span><span class="sxs-lookup"><span data-stu-id="f2f62-167">The credentials may be invalid because there is no matching username/password pair in the user store, or because the user has not yet been approved, or because the user has been locked out. In Step 4 we will see how to show a more detailed message to the user when their login attempt fails.</span></span>


## <a name="step-2-collecting-credentials-through-the-login-web-control"></a><span data-ttu-id="f2f62-168">Étape 2 : Collecte des informations d’identification via le contrôle Web de connexion</span><span class="sxs-lookup"><span data-stu-id="f2f62-168">Step 2: Collecting Credentials through the Login Web Control</span></span>

<span data-ttu-id="f2f62-169">Le [contrôle de connexion Web](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx) restitue une interface utilisateur par défaut très similaire à celui que nous avons créés dans le <a id="Tutorial02"> </a> [ *une vue d’ensemble de l’authentification par formulaire* ](../introduction/an-overview-of-forms-authentication-vb.md) didacticiel.</span><span class="sxs-lookup"><span data-stu-id="f2f62-169">The [Login Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx) renders a default user interface very similar to the one we created back in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-vb.md) tutorial.</span></span> <span data-ttu-id="f2f62-170">L’utilisation du contrôle de connexion nous enregistre les travaux de devoir créer l’interface pour collecter les informations d’identification du visiteur.</span><span class="sxs-lookup"><span data-stu-id="f2f62-170">Using the Login control saves us the work of having to create the interface to collect the visitor's credentials.</span></span> <span data-ttu-id="f2f62-171">En outre, le contrôle de connexion se connecte automatiquement l’utilisateur (en supposant que les informations d’identification soumises sont valides), ainsi l’enregistrement nous évite de devoir écrire du code.</span><span class="sxs-lookup"><span data-stu-id="f2f62-171">Moreover, the Login control automatically signs in the user (assuming the submitted credentials are valid), thereby saving us from having to write any code.</span></span>

<span data-ttu-id="f2f62-172">Nous allons mettre à jour `Login.aspx`, en remplaçant l’interface créée manuellement et de code avec un contrôle de connexion.</span><span class="sxs-lookup"><span data-stu-id="f2f62-172">Let's update `Login.aspx`, replacing the manually created interface and code with a Login control.</span></span> <span data-ttu-id="f2f62-173">Commencez par supprimer la balise existante et du code dans `Login.aspx`.</span><span class="sxs-lookup"><span data-stu-id="f2f62-173">Start by removing the existing markup and code in `Login.aspx`.</span></span> <span data-ttu-id="f2f62-174">Vous pouvez supprimer la ferme ou simplement commentez-le. Pour commenter le balisage déclaratif, placez-la entre avec la `<%--` et `--%>` délimiteurs.</span><span class="sxs-lookup"><span data-stu-id="f2f62-174">You may delete it outright, or simply comment it out. To comment out declarative markup, surround it with the `<%--` and `--%>` delimiters.</span></span> <span data-ttu-id="f2f62-175">Vous pouvez entrer manuellement ces délimiteurs, ou, comme le montre la Figure 2, vous pouvez sélectionner le texte à placer en commentaire, puis cliquez sur le commentaire pour l’icône de lignes sélectionnées dans la barre d’outils.</span><span class="sxs-lookup"><span data-stu-id="f2f62-175">You can enter these delimiters manually, or, as Figure 2 shows, you may select the text to comment out and then click the Comment out the selected lines icon in the Toolbar.</span></span> <span data-ttu-id="f2f62-176">De même, vous pouvez utiliser le commentaire pour l’icône de lignes sélectionnées en commentaire le code sélectionné dans la classe code-behind.</span><span class="sxs-lookup"><span data-stu-id="f2f62-176">Similarly, you can use the Comment out the selected lines icon to comment out the selected code in the code-behind class.</span></span>


<span data-ttu-id="f2f62-177">[![Commentez l’existant un balisage déclaratif et Code Source dans Login.aspx](validating-user-credentials-against-the-membership-user-store-vb/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="f2f62-177">[![Comment Out the Existing Declarative Markup and Source Code in Login.aspx](validating-user-credentials-against-the-membership-user-store-vb/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image4.png)</span></span>

<span data-ttu-id="f2f62-178">**Figure 2**: commentaire à l’existant balisage déclaratif et Code Source dans Login.aspx ([cliquez pour afficher l’image en taille réelle](validating-user-credentials-against-the-membership-user-store-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="f2f62-178">**Figure 2**: Comment Out the Existing Declarative Markup and Source Code in Login.aspx  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image6.png))</span></span>


> [!NOTE]
> <span data-ttu-id="f2f62-179">Le commentaire pour l’icône de lignes sélectionnées n’est pas disponible lorsque vous affichez le balisage déclaratif dans Visual Studio 2005.</span><span class="sxs-lookup"><span data-stu-id="f2f62-179">The Comment out the selected lines icon is not available when viewing the declarative markup in Visual Studio 2005.</span></span> <span data-ttu-id="f2f62-180">Si vous n’utilisez pas Visual Studio 2008, vous devez ajouter manuellement le `<%--` et `--%>` délimiteurs.</span><span class="sxs-lookup"><span data-stu-id="f2f62-180">If you are not using Visual Studio 2008 you will need to manually add the `<%--` and `--%>` delimiters.</span></span>


<span data-ttu-id="f2f62-181">Ensuite, faites glisser un contrôle de connexion à partir de la boîte à outils sur la page et définissez ses `ID` propriété `myLogin`.</span><span class="sxs-lookup"><span data-stu-id="f2f62-181">Next, drag a Login control from the Toolbox on to the page and set its `ID` property to `myLogin`.</span></span> <span data-ttu-id="f2f62-182">À ce stade votre écran doit ressembler à la Figure 3.</span><span class="sxs-lookup"><span data-stu-id="f2f62-182">At this point your screen should look similar to Figure 3.</span></span> <span data-ttu-id="f2f62-183">Notez que l’interface par défaut du contrôle connexion inclut des contrôles de zone de texte pour le nom d’utilisateur et mot de passe, un mémoriser case à cocher et un bouton dans le journal.</span><span class="sxs-lookup"><span data-stu-id="f2f62-183">Note that the Login control's default interface includes TextBox controls for the username and password, a Remember me next time CheckBox, and a Log In Button.</span></span> <span data-ttu-id="f2f62-184">Il existe également `RequiredFieldValidator` contrôles pour les deux zones de texte.</span><span class="sxs-lookup"><span data-stu-id="f2f62-184">There are also `RequiredFieldValidator` controls for the two TextBoxes.</span></span>


<span data-ttu-id="f2f62-185">[![Ajouter un contrôle de la connexion à la Page](validating-user-credentials-against-the-membership-user-store-vb/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="f2f62-185">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-vb/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image7.png)</span></span>

<span data-ttu-id="f2f62-186">**Figure 3**: ajouter un contrôle de la connexion à la Page ([cliquez pour afficher l’image en taille réelle](validating-user-credentials-against-the-membership-user-store-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="f2f62-186">**Figure 3**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image9.png))</span></span>


<span data-ttu-id="f2f62-187">Et nous avons terminé !</span><span class="sxs-lookup"><span data-stu-id="f2f62-187">And we're done!</span></span> <span data-ttu-id="f2f62-188">Clic sur bouton se connecter du contrôle de connexion, une publication (postback) se produit et le contrôle de connexion appellera la `Membership.ValidateUser` méthode, en passant le nom d’utilisateur entré et le mot de passe.</span><span class="sxs-lookup"><span data-stu-id="f2f62-188">When the Login control's Log In button is clicked, a postback will occur and the Login control will call the `Membership.ValidateUser` method, passing in the entered username and password.</span></span> <span data-ttu-id="f2f62-189">Si les informations d’identification ne sont pas valides, le contrôle de connexion affiche un message.</span><span class="sxs-lookup"><span data-stu-id="f2f62-189">If the credentials are invalid, the Login control displays a message stating such.</span></span> <span data-ttu-id="f2f62-190">Si, toutefois, les informations d’identification sont valides, le contrôle de connexion crée les formulaires ticket d’authentification et redirige l’utilisateur vers la page appropriée.</span><span class="sxs-lookup"><span data-stu-id="f2f62-190">If, however, the credentials are valid, then the Login control creates the forms authentication ticket and redirects the user to the appropriate page.</span></span>

<span data-ttu-id="f2f62-191">Le contrôle de connexion utilise quatre facteurs pour déterminer la page appropriée pour rediriger l’utilisateur lors d’une connexion réussie :</span><span class="sxs-lookup"><span data-stu-id="f2f62-191">The Login control uses four factors to determine the appropriate page to redirect the user to upon a successful login:</span></span>

- <span data-ttu-id="f2f62-192">Si le contrôle de connexion est sur la page de connexion comme défini par `loginUrl` est de valeur de valeur par défaut de ce paramètre dans la configuration de l’authentification de formulaires ; `Login.aspx`</span><span class="sxs-lookup"><span data-stu-id="f2f62-192">Whether the Login control is on the login page as defined by `loginUrl` setting in the forms authentication configuration; this setting's default value is `Login.aspx`</span></span>
- <span data-ttu-id="f2f62-193">La présence d’un `ReturnUrl` paramètre querystring</span><span class="sxs-lookup"><span data-stu-id="f2f62-193">The presence of a `ReturnUrl` querystring parameter</span></span>
- <span data-ttu-id="f2f62-194">La valeur du contrôle de connexion [ `DestinationUrl` propriété](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx)</span><span class="sxs-lookup"><span data-stu-id="f2f62-194">The value of the Login control's [`DestinationUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx)</span></span>
- <span data-ttu-id="f2f62-195">Le `defaultUrl` la valeur spécifiée dans les formulaires, les paramètres de configuration de l’authentification ; par défaut de ce paramètre est Default.aspx</span><span class="sxs-lookup"><span data-stu-id="f2f62-195">The `defaultUrl` value specified in the forms authentication configuration settings; this setting's default value is Default.aspx</span></span>

<span data-ttu-id="f2f62-196">La figure 4 illustre la façon dont le contrôle de connexion utilise ces quatre paramètres pour arriver à la décision de la page appropriée.</span><span class="sxs-lookup"><span data-stu-id="f2f62-196">Figure 4 depicts the how the Login control uses these four parameters to arrive at its appropriate page decision.</span></span>


<span data-ttu-id="f2f62-197">[![Ajouter un contrôle de la connexion à la Page](validating-user-credentials-against-the-membership-user-store-vb/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="f2f62-197">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-vb/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image10.png)</span></span>

<span data-ttu-id="f2f62-198">**Figure 4**: ajouter un contrôle de la connexion à la Page ([cliquez pour afficher l’image en taille réelle](validating-user-credentials-against-the-membership-user-store-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="f2f62-198">**Figure 4**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image12.png))</span></span>


<span data-ttu-id="f2f62-199">Prenez un moment pour tester le contrôle de connexion en visitant le site via un navigateur et connectez-vous en tant qu’un utilisateur existant dans le cadre de l’appartenance.</span><span class="sxs-lookup"><span data-stu-id="f2f62-199">Take a moment to test out the Login control by visiting the site through a browser and logging in as an existing user in the Membership framework.</span></span>

<span data-ttu-id="f2f62-200">Interface de rendu du contrôle de la connexion est hautement configurable.</span><span class="sxs-lookup"><span data-stu-id="f2f62-200">The Login control's rendered interface is highly configurable.</span></span> <span data-ttu-id="f2f62-201">Un certain nombre de propriétés qui influencent son apparence ; de plus, le contrôle de connexion peut être converti les éléments d’interface utilisateur dans un modèle pour un contrôle précis sur la disposition.</span><span class="sxs-lookup"><span data-stu-id="f2f62-201">There are a number of properties that influence its appearance; what's more, the Login control can be converted into a template for precise control over the layout the user interface elements.</span></span> <span data-ttu-id="f2f62-202">Le reste de cette étape montre comment personnaliser l’apparence et la disposition.</span><span class="sxs-lookup"><span data-stu-id="f2f62-202">The remainder of this step examines how to customize the appearance and layout.</span></span>

### <a name="customizing-the-login-controls-appearance"></a><span data-ttu-id="f2f62-203">Personnaliser l’apparence du contrôle de connexion</span><span class="sxs-lookup"><span data-stu-id="f2f62-203">Customizing the Login Control's Appearance</span></span>

<span data-ttu-id="f2f62-204">Paramètres de propriété par défaut du contrôle de connexion restituent une interface utilisateur avec un titre (journal), contrôles d’étiquette et de zone de texte pour les entrées de nom d’utilisateur et mot de passe, un Mémoriser mes informations au prochain case à cocher et un bouton se connecter.</span><span class="sxs-lookup"><span data-stu-id="f2f62-204">The Login control's default property settings render a user interface with a title ( Log In ), TextBox and Label controls for the username and password inputs, a Remember me next time CheckBox, and a Log In button.</span></span> <span data-ttu-id="f2f62-205">Les apparences de ces éléments sont tous configurables via les propriétés de nombreux du contrôle de la connexion.</span><span class="sxs-lookup"><span data-stu-id="f2f62-205">The appearances of these elements are all configurable through the Login control's numerous properties.</span></span> <span data-ttu-id="f2f62-206">En outre, les éléments d’interface utilisateur - telles qu’un lien vers une page pour créer un nouveau compte d’utilisateur - peuvent être ajoutés en définissant une propriété ou deux.</span><span class="sxs-lookup"><span data-stu-id="f2f62-206">Furthermore, additional user interface elements - such as a link to a page to create a new user account - can be added by setting a property or two.</span></span>

<span data-ttu-id="f2f62-207">Prenons quelques instants pour gussy l’apparence de notre contrôle de connexion.</span><span class="sxs-lookup"><span data-stu-id="f2f62-207">Let's spend a few moments to gussy up the appearance of our Login control.</span></span> <span data-ttu-id="f2f62-208">Étant donné que le `Login.aspx` page comporte déjà du texte en haut de la page indiquant que l’ouverture de session, le titre du contrôle de la connexion est superflue.</span><span class="sxs-lookup"><span data-stu-id="f2f62-208">Since the `Login.aspx` page already has text at the top of the page that says Login, the Login control's title is superfluous.</span></span> <span data-ttu-id="f2f62-209">Par conséquent, effacer le [ `TitleText` propriété](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx) valeur afin de supprimer le titre du contrôle de la connexion.</span><span class="sxs-lookup"><span data-stu-id="f2f62-209">Therefore, clear out the [`TitleText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx) value in order to remove the Login control's title.</span></span>

<span data-ttu-id="f2f62-210">: Le nom d’utilisateur et mot de passe : étiquettes à gauche des deux contrôles de zone de texte peuvent être personnalisés par le biais du [ `UserNameLabelText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx) et [ `PasswordLabelText` propriétés](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx), respectivement.</span><span class="sxs-lookup"><span data-stu-id="f2f62-210">The User Name: and Password: Labels to the left of the two TextBox controls can be customized through the [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx) and [`PasswordLabelText` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx), respectively.</span></span> <span data-ttu-id="f2f62-211">Nous allons modifier le nom d’utilisateur : étiquette de lire le nom d’utilisateur :.</span><span class="sxs-lookup"><span data-stu-id="f2f62-211">Let's change the User Name: Label to read Username:.</span></span> <span data-ttu-id="f2f62-212">Les styles de l’étiquette et la zone de texte sont configurables via les [ `LabelStyle` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx) et [ `TextBoxStyle` propriétés](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx), respectivement.</span><span class="sxs-lookup"><span data-stu-id="f2f62-212">The Label and TextBox styles are configurable through the [`LabelStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx) and [`TextBoxStyle` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx), respectively.</span></span>

<span data-ttu-id="f2f62-213">Mémoriser mon adresse Text (propriété) suivant temps la case à cocher peut être définie via le contrôle de connexion [ `RememberMeText` propriété](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx), et sa valeur par défaut vérifié l’état est configurable via le [ `RememberMeSet` propriété](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx)(les valeurs par défaut à False).</span><span class="sxs-lookup"><span data-stu-id="f2f62-213">The Remember me next time CheckBox's Text property can be set through the Login control's [`RememberMeText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx), and its default checked state is configurable through the [`RememberMeSet` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx) (which defaults to False).</span></span> <span data-ttu-id="f2f62-214">Pour commencer, définissez le `RememberMeSet` propriété sur True afin que la mémorisation au prochain case à cocher sera vérifiée par défaut.</span><span class="sxs-lookup"><span data-stu-id="f2f62-214">Go ahead and set the `RememberMeSet` property to True so that the Remember me next time CheckBox will be checked by default.</span></span>

<span data-ttu-id="f2f62-215">Le contrôle de connexion offre deux propriétés pour ajuster la disposition de ses contrôles d’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f2f62-215">The Login control offers two properties for adjusting the layout of its user interface controls.</span></span> <span data-ttu-id="f2f62-216">Le [ `TextLayout` propriété](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx) indique si le nom d’utilisateur : mot de passe et : étiquettes s’affichent à gauche de leurs zones de texte correspondante (la valeur par défaut), ou supérieur.</span><span class="sxs-lookup"><span data-stu-id="f2f62-216">The [`TextLayout` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx) indicates whether the Username: and Password: Labels appear to the left of their corresponding TextBoxes (the default), or above them.</span></span> <span data-ttu-id="f2f62-217">Le [ `Orientation` propriété](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx) indique si les entrées de nom d’utilisateur et mot de passe sont situées verticalement (un au-dessus de l’autre) ou horizontalement.</span><span class="sxs-lookup"><span data-stu-id="f2f62-217">The [`Orientation` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx) indicates whether the username and password inputs are situated vertically (one above the other) or horizontally.</span></span> <span data-ttu-id="f2f62-218">Je vais laisser ces deux propriétés leurs valeurs par défaut, mais nous vous invitons à essayer de définir ces deux propriétés à leurs valeurs par défaut pour voir l’effet obtenu.</span><span class="sxs-lookup"><span data-stu-id="f2f62-218">I am going to leave these two properties set to their defaults, but I encourage you to try setting these two properties to their non-default values to see the resulting effect.</span></span>

> [!NOTE]
> <span data-ttu-id="f2f62-219">Dans la section suivante, la configuration de mise en page de connexion du contrôle, nous allons nous intéresser à l’aide de modèles pour définir la disposition précise d’éléments d’interface utilisateur du contrôle de disposition.</span><span class="sxs-lookup"><span data-stu-id="f2f62-219">In the next section, Configuring the Login Control's Layout, we will look at using templates to define the precise layout of the Layout control's user interface elements.</span></span>


<span data-ttu-id="f2f62-220">Encapsuler des paramètres de propriété du contrôle de connexion en définissant le [ `CreateUserText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx) et [ `CreateUserUrl` propriétés](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx) à ne pas encore inscrit ?</span><span class="sxs-lookup"><span data-stu-id="f2f62-220">Wrap up the Login control's property settings by setting the [`CreateUserText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx) and [`CreateUserUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx) to Not registered yet?</span></span> <span data-ttu-id="f2f62-221">Créer un compte !</span><span class="sxs-lookup"><span data-stu-id="f2f62-221">Create an account!</span></span> <span data-ttu-id="f2f62-222">et `~/Membership/CreatingUserAccounts.aspx`, respectivement.</span><span class="sxs-lookup"><span data-stu-id="f2f62-222">and `~/Membership/CreatingUserAccounts.aspx`, respectively.</span></span> <span data-ttu-id="f2f62-223">Cela ajoute un lien hypertexte à l’interface du contrôle de connexion pointant vers la page est créée au cours de la <a id="Tutorial05"> </a> [didacticiel précédent](creating-user-accounts-vb.md).</span><span class="sxs-lookup"><span data-stu-id="f2f62-223">This adds a hyperlink to the Login control's interface pointing to the page we created in the <a id="Tutorial05"></a>[preceding tutorial](creating-user-accounts-vb.md).</span></span> <span data-ttu-id="f2f62-224">Le contrôle de connexion [ `HelpPageText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx) et [ `HelpPageUrl` propriétés](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx) et [ `PasswordRecoveryText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx) et [ `PasswordRecoveryUrl` depropriétés](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx) fonctionnent de la même manière, des liens vers une page d’aide et une page de récupération du mot de passe de rendu.</span><span class="sxs-lookup"><span data-stu-id="f2f62-224">The Login control's [`HelpPageText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx) and [`HelpPageUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx) and [`PasswordRecoveryText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx) and [`PasswordRecoveryUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx) work in the same manner, rendering links to a help page and a password recovery page.</span></span>

<span data-ttu-id="f2f62-225">Après avoir apporté ces modifications de propriété, balisage déclaratif et l’apparence de votre contrôle de connexion doivent ressembler à celui illustré dans la Figure 5.</span><span class="sxs-lookup"><span data-stu-id="f2f62-225">After making these property changes, your Login control's declarative markup and appearance should look similar to that shown in Figure 5.</span></span>


<span data-ttu-id="f2f62-226">[![Valeurs des propriétés du contrôle de connexion déterminent son apparence](validating-user-credentials-against-the-membership-user-store-vb/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="f2f62-226">[![The Login Control's Properties' Values Dictate Its Appearance](validating-user-credentials-against-the-membership-user-store-vb/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image13.png)</span></span>

<span data-ttu-id="f2f62-227">**Figure 5**: valeurs de dicter son apparence propriétés du contrôle connexion ([cliquez pour afficher l’image en taille réelle](validating-user-credentials-against-the-membership-user-store-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="f2f62-227">**Figure 5**: The Login Control's Properties' Values Dictate Its Appearance  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image15.png))</span></span>


### <a name="configuring-the-login-controls-layout"></a><span data-ttu-id="f2f62-228">Configuration de mise en page du contrôle de connexion</span><span class="sxs-lookup"><span data-stu-id="f2f62-228">Configuring the Login Control's Layout</span></span>

<span data-ttu-id="f2f62-229">Interface d’utilisateur du contrôle de la connexion Web par défaut est l’interface dans le code HTML disposé `<table>`.</span><span class="sxs-lookup"><span data-stu-id="f2f62-229">The Login Web control's default user interface lays out the interface in an HTML `<table>`.</span></span> <span data-ttu-id="f2f62-230">Mais que se passe-t-il si nous avons besoin de mieux contrôler la sortie rendue ?</span><span class="sxs-lookup"><span data-stu-id="f2f62-230">But what if we need finer control over the rendered output?</span></span> <span data-ttu-id="f2f62-231">Peut-être que vous voulez remplacer le `<table>` avec une série de `<div>` balises.</span><span class="sxs-lookup"><span data-stu-id="f2f62-231">Maybe we want to replace the `<table>` with a series of `<div>` tags.</span></span> <span data-ttu-id="f2f62-232">Ou bien, que se passe-t-il si notre application nécessite des informations d’identification supplémentaires pour l’authentification ?</span><span class="sxs-lookup"><span data-stu-id="f2f62-232">Or what if our application requires additional credentials for authentication?</span></span> <span data-ttu-id="f2f62-233">Par exemple, de nombreux sites Web financiers, imposent aux utilisateurs non seulement un nom d’utilisateur et mot de passe, mais également un numéro d’Identification personnel (PIN) ou autres informations d’identification.</span><span class="sxs-lookup"><span data-stu-id="f2f62-233">Many financial websites, for instance, require users to supply not only a username and password, but also a Personal Identification Number (PIN), or other identifying information.</span></span> <span data-ttu-id="f2f62-234">Quel que soit les raisons, il est possible de convertir le contrôle de connexion dans un modèle à partir de laquelle nous pouvons définir explicitement balisage déclaratif de l’interface.</span><span class="sxs-lookup"><span data-stu-id="f2f62-234">Whatever the reasons may be, it is possible to convert the Login control into a template, from which we can explicitly define the interface's declarative markup.</span></span>

<span data-ttu-id="f2f62-235">Nous devons faire deux choses pour mettre à jour le contrôle de connexion pour collecter les informations d’identification supplémentaires :</span><span class="sxs-lookup"><span data-stu-id="f2f62-235">We need to do two things in order to update the Login control to collect additional credentials:</span></span>

1. <span data-ttu-id="f2f62-236">Mettre à jour l’interface du contrôle de connexion pour inclure les contrôles Web pour collecter les informations d’identification supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="f2f62-236">Update the Login control's interface to include Web control(s) to collect the additional credentials.</span></span>
2. <span data-ttu-id="f2f62-237">Substituer la logique d’authentification interne du contrôle de connexion afin qu’un utilisateur est authentifié uniquement si leur nom d’utilisateur et un mot de passe est valide et leurs informations d’identification supplémentaires sont valides, trop.</span><span class="sxs-lookup"><span data-stu-id="f2f62-237">Override the Login control's internal authentication logic so that a user is only authenticated if their username and password is valid and their additional credentials are valid, too.</span></span>

<span data-ttu-id="f2f62-238">Pour mener à bien la première tâche, nous devons convertir le contrôle de connexion dans un modèle et ajouter des contrôles Web nécessaires.</span><span class="sxs-lookup"><span data-stu-id="f2f62-238">To accomplish the first task, we need to convert the Login control into a template and add the necessary Web controls.</span></span> <span data-ttu-id="f2f62-239">Comme pour la deuxième tâche, la connexion logique du contrôle d’authentification peut être remplacée en créant un gestionnaire d’événements du contrôle [ `Authenticate` événement](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span><span class="sxs-lookup"><span data-stu-id="f2f62-239">As for the second task, the Login control's authentication logic can be superseded by creating an event handler for the control's [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span>

<span data-ttu-id="f2f62-240">Nous allons mettre à jour le contrôle de connexion afin qu’il demande aux utilisateurs leur nom d’utilisateur, le mot de passe et l’adresse de messagerie et uniquement s’authentifie l’utilisateur si l’adresse de messagerie fournie correspond à leur adresse de messagerie sur le fichier.</span><span class="sxs-lookup"><span data-stu-id="f2f62-240">Let's update the Login control so that it prompts users for their username, password, and email address and only authenticates the user if the email address supplied matches their email address on file.</span></span> <span data-ttu-id="f2f62-241">Nous devons d’abord convertir l’interface de contrôle de la connexion à un modèle.</span><span class="sxs-lookup"><span data-stu-id="f2f62-241">We first need to convert the Login control's interface to a template.</span></span> <span data-ttu-id="f2f62-242">À partir de la balise du contrôle de connexion, sélectionnez l’option Convertir en modèle.</span><span class="sxs-lookup"><span data-stu-id="f2f62-242">From the Login control's Smart Tag, choose the Convert to template option.</span></span>


<span data-ttu-id="f2f62-243">[![Convertir le contrôle de connexion à un modèle](validating-user-credentials-against-the-membership-user-store-vb/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="f2f62-243">[![Convert the Login Control to a Template](validating-user-credentials-against-the-membership-user-store-vb/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image16.png)</span></span>

<span data-ttu-id="f2f62-244">**Figure 6**: convertir le contrôle de connexion à un modèle ([cliquez pour afficher l’image en taille réelle](validating-user-credentials-against-the-membership-user-store-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="f2f62-244">**Figure 6**: Convert the Login Control to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image18.png))</span></span>


> [!NOTE]
> <span data-ttu-id="f2f62-245">Pour rétablir le contrôle de la connexion à sa version préalable template, cliquez sur le lien de réinitialisation de la balise du contrôle.</span><span class="sxs-lookup"><span data-stu-id="f2f62-245">To revert the Login control to its pre-template version, click the Reset link from the control's Smart Tag.</span></span>


<span data-ttu-id="f2f62-246">Convertir le contrôle de connexion à un modèle ajoute une `LayoutTemplate` à la balise du contrôle déclarative avec les éléments HTML et les contrôles Web définition de l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f2f62-246">Converting the Login control to a template adds a `LayoutTemplate` to the control's declarative markup with HTML elements and Web controls defining the user interface.</span></span> <span data-ttu-id="f2f62-247">Comme le montre la Figure 7, la conversion du contrôle à un modèle supprime un nombre de propriétés à partir de la fenêtre Propriétés, telles que `TitleText`, `CreateUserUrl`, et ainsi de suite, étant donné que ces valeurs de propriété sont ignorés lors de l’utilisation d’un modèle.</span><span class="sxs-lookup"><span data-stu-id="f2f62-247">As Figure 7 shows, converting the control to a template removes a number of properties from the Properties window, such as `TitleText`, `CreateUserUrl`, and so forth, since these property values are ignored when using a template.</span></span>


<span data-ttu-id="f2f62-248">[![Moins de propriétés sont que disponibles lorsque le contrôle de connexion est converti en un modèle](validating-user-credentials-against-the-membership-user-store-vb/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="f2f62-248">[![Fewer Properties are Available When the Login Control is Converted to a Template](validating-user-credentials-against-the-membership-user-store-vb/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image19.png)</span></span>

<span data-ttu-id="f2f62-249">**Figure 7**: moins de propriétés sont disponibles lorsque le contrôle de connexion est converti en un modèle ([cliquez pour afficher l’image en taille réelle](validating-user-credentials-against-the-membership-user-store-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="f2f62-249">**Figure 7**: Fewer Properties are Available When the Login Control is Converted to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image21.png))</span></span>


<span data-ttu-id="f2f62-250">Le balisage HTML de la `LayoutTemplate` peut être modifié en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="f2f62-250">The HTML markup in the `LayoutTemplate` may be modified as needed.</span></span> <span data-ttu-id="f2f62-251">De même, n’hésitez pas à ajouter de nouveaux contrôles Web au modèle.</span><span class="sxs-lookup"><span data-stu-id="f2f62-251">Likewise, feel free to add any new Web controls to the template.</span></span> <span data-ttu-id="f2f62-252">Toutefois, il est important de contrôles Web de base du contrôle de cette connexion restent dans le modèle et conserver qui leur est affectée `ID` valeurs.</span><span class="sxs-lookup"><span data-stu-id="f2f62-252">However, it is important that Login control's core Web controls remain in the template and keep their assigned `ID` values.</span></span> <span data-ttu-id="f2f62-253">En particulier, supprimez ou ne renommez pas le `UserName` ou `Password` zones de texte, le `RememberMe` case à cocher, le `LoginButton` bouton, le `FailureText` étiquette, ou le `RequiredFieldValidator` contrôles.</span><span class="sxs-lookup"><span data-stu-id="f2f62-253">In particular, do not remove or rename the `UserName` or `Password` TextBoxes, the `RememberMe` CheckBox, the `LoginButton` Button, the `FailureText` Label, or the `RequiredFieldValidator` controls.</span></span>

<span data-ttu-id="f2f62-254">Pour collecter l’adresse de messagerie du visiteur, nous devons ajouter une zone de texte pour le modèle.</span><span class="sxs-lookup"><span data-stu-id="f2f62-254">To collect the visitor's email address, we need to add a TextBox to the template.</span></span> <span data-ttu-id="f2f62-255">Ajoutez le balisage déclaratif suivant entre la ligne de table (`<tr>`) qui contient le `Password` zone de texte et de la ligne de table qui contient le Mémoriser mes informations ensuite durée de case à cocher :</span><span class="sxs-lookup"><span data-stu-id="f2f62-255">Add the following declarative markup between the table row (`<tr>`) that contains the `Password` TextBox and the table row that holds the Remember me next time CheckBox:</span></span>

[!code-aspx[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample2.aspx)]

<span data-ttu-id="f2f62-256">Après avoir ajouté le `Email` zone de texte, visitez la page via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="f2f62-256">After adding the `Email` TextBox, visit the page through a browser.</span></span> <span data-ttu-id="f2f62-257">Comme le montre la Figure 8, interface utilisateur du contrôle de connexion inclut désormais une troisième zone de texte.</span><span class="sxs-lookup"><span data-stu-id="f2f62-257">As Figure 8 shows, the Login control's user interface now includes a third textbox.</span></span>


<span data-ttu-id="f2f62-258">[![Le contrôle de connexion inclut désormais une zone de texte pour l’adresse de messagerie de l’utilisateur](validating-user-credentials-against-the-membership-user-store-vb/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="f2f62-258">[![The Login Control Now Includes a Textbox for the User's Email Address](validating-user-credentials-against-the-membership-user-store-vb/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image22.png)</span></span>

<span data-ttu-id="f2f62-259">**Figure 8**: le contrôle de connexion inclut désormais une zone de texte pour l’adresse de messagerie de l’utilisateur ([cliquez pour afficher l’image en taille réelle](validating-user-credentials-against-the-membership-user-store-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="f2f62-259">**Figure 8**: The Login Control Now Includes a Textbox for the User's Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image24.png))</span></span>


<span data-ttu-id="f2f62-260">À ce stade, le contrôle de connexion est toujours à l’aide de la `Membership.ValidateUser` méthode pour valider les informations d’identification fournies.</span><span class="sxs-lookup"><span data-stu-id="f2f62-260">At this point, the Login control is still using the `Membership.ValidateUser` method to validate the supplied credentials.</span></span> <span data-ttu-id="f2f62-261">En conséquence, la valeur entrée dans le `Email` zone de texte n’a aucune incidence sur indique si l’utilisateur peut se connecter.</span><span class="sxs-lookup"><span data-stu-id="f2f62-261">Correspondingly, the value entered into the `Email` TextBox has no bearing on whether the user can log in.</span></span> <span data-ttu-id="f2f62-262">À l’étape 3, nous allons examiner comment remplacer la logique d’authentification du contrôle de connexion afin que les informations d’identification sont considéré comme valides si le nom d’utilisateur et un mot de passe sont valides et l’adresse de messagerie fournie correspond à l’adresse de messagerie sur le fichier.</span><span class="sxs-lookup"><span data-stu-id="f2f62-262">In Step 3 we will look at how to override the Login control's authentication logic so that the credentials are only considered valid if the username and password are valid and the supplied email address matches up with the email address on file.</span></span>

## <a name="step-3-modifying-the-login-controls-authentication-logic"></a><span data-ttu-id="f2f62-263">Étape 3 : Modification de la connexion d’accès logique du contrôle d’authentification</span><span class="sxs-lookup"><span data-stu-id="f2f62-263">Step 3: Modifying the Login Control's Authentication Logic</span></span>

<span data-ttu-id="f2f62-264">Lorsqu’un visiteur fournit son informations d’identification et clique sur que le bouton se connecter, une publication (postback) s’ensuit et la connexion de contrôle passent de son flux de travail de l’authentification.</span><span class="sxs-lookup"><span data-stu-id="f2f62-264">When a visitor supplies her credentials and clicks the Log In button, a postback ensues and the Login control progresses through its authentication workflow.</span></span> <span data-ttu-id="f2f62-265">Le flux de travail démarre en déclenchant le [ `LoggingIn` événement](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx).</span><span class="sxs-lookup"><span data-stu-id="f2f62-265">The workflow starts by raising the [`LoggingIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx).</span></span> <span data-ttu-id="f2f62-266">Les gestionnaires d’événements associés à cet événement peut être annulé le journal dans l’opération en définissant le `e.Cancel` propriété `True`.</span><span class="sxs-lookup"><span data-stu-id="f2f62-266">Any event handlers associated with this event may cancel the log in operation by setting the `e.Cancel` property to `True`.</span></span>

<span data-ttu-id="f2f62-267">Si le journal dans l’opération n’est pas annulé, le flux de travail passe en déclenchant le [ `Authenticate` événement](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span><span class="sxs-lookup"><span data-stu-id="f2f62-267">If the log in operation is not cancelled, the workflow progresses by raising the [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span> <span data-ttu-id="f2f62-268">S’il existe un gestionnaire d’événements pour le `Authenticate` événement, il est chargé de déterminer si les informations d’identification fournies sont valides ou non.</span><span class="sxs-lookup"><span data-stu-id="f2f62-268">If there is an event handler for the `Authenticate` event, then it is responsible for determining whether the supplied credentials are valid or not.</span></span> <span data-ttu-id="f2f62-269">Si aucun gestionnaire d’événements n’est spécifié, le contrôle de connexion utilise la `Membership.ValidateUser` méthode pour déterminer la validité des informations d’identification.</span><span class="sxs-lookup"><span data-stu-id="f2f62-269">If no event handler is specified, the Login control uses the `Membership.ValidateUser` method to determine the validity of the credentials.</span></span>

<span data-ttu-id="f2f62-270">Si les informations d’identification fournies sont valides, puis le ticket d’authentification par formulaires est créé, le [ `LoggedIn` événement](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx) est déclenché, et l’utilisateur est redirigé vers la page appropriée.</span><span class="sxs-lookup"><span data-stu-id="f2f62-270">If the supplied credentials are valid, then the forms authentication ticket is created, the [`LoggedIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx) is raised, and the user is redirected to the appropriate page.</span></span> <span data-ttu-id="f2f62-271">Si, toutefois, les informations d’identification sont considérées comme non valides, puis le [ `LoginError` événement](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx) est déclenché et un message s’affiche pour informer l’utilisateur que leurs informations d’identification n’étaient pas valides.</span><span class="sxs-lookup"><span data-stu-id="f2f62-271">If, however, the credentials are deemed invalid, then the [`LoginError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx) is raised and a message is displayed informing the user that their credentials were invalid.</span></span> <span data-ttu-id="f2f62-272">Par défaut, en cas d’échec de la connexion contrôle simplement définit son `FailureText` étiqueter la propriété de texte du contrôle à un message d’échec (votre tentative de connexion n’a pas réussi.</span><span class="sxs-lookup"><span data-stu-id="f2f62-272">By default, on failure the Login control simply sets its `FailureText` Label control's Text property to a failure message ( Your login attempt was not successful.</span></span> <span data-ttu-id="f2f62-273">Veuillez réessayer).</span><span class="sxs-lookup"><span data-stu-id="f2f62-273">Please try again ).</span></span> <span data-ttu-id="f2f62-274">Toutefois, si le contrôle de connexion [ `FailureAction` propriété](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx) a la valeur `RedirectToLoginPage`, puis les problèmes de contrôle de connexion un `Response.Redirect` à la page de connexion que l’ajout du paramètre querystring `loginfailure=1` (ce qui entraîne l’ouverture de session contrôle à afficher le message d’échec).</span><span class="sxs-lookup"><span data-stu-id="f2f62-274">However, if the Login control's [`FailureAction` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx) is set to `RedirectToLoginPage`, then the Login control issues a `Response.Redirect` to the login page appending the querystring parameter `loginfailure=1` (which causes the Login control to display the failure message).</span></span>

<span data-ttu-id="f2f62-275">Figure 9 propose un diagramme de flux du flux de travail d’authentification.</span><span class="sxs-lookup"><span data-stu-id="f2f62-275">Figure 9 offers a flow chart of the authentication workflow.</span></span>


<span data-ttu-id="f2f62-276">[![Flux de travail du contrôle de la connexion d’authentification](validating-user-credentials-against-the-membership-user-store-vb/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="f2f62-276">[![The Login Control's Authentication Workflow](validating-user-credentials-against-the-membership-user-store-vb/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image25.png)</span></span>

<span data-ttu-id="f2f62-277">**Figure 9**: flux de travail du contrôle compte de connexion d’authentification ([cliquez pour afficher l’image en taille réelle](validating-user-credentials-against-the-membership-user-store-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="f2f62-277">**Figure 9**: The Login Control's Authentication Workflow  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image27.png))</span></span>


> [!NOTE]
> <span data-ttu-id="f2f62-278">Si vous vous demandez lorsque vous utiliseriez le `FailureAction`de `RedirectToLogin` option page, considérez le scénario suivant.</span><span class="sxs-lookup"><span data-stu-id="f2f62-278">If you are wondering when you would use the `FailureAction`'s `RedirectToLogin` page option, consider the following scenario.</span></span> <span data-ttu-id="f2f62-279">Maintenant notre `Site.master` page maître a actuellement le texte Hello, stranger affiché dans la colonne de gauche lorsque visité par un utilisateur anonyme, mais supposons que nous voulons remplacer ce texte par un contrôle de connexion.</span><span class="sxs-lookup"><span data-stu-id="f2f62-279">Right now our `Site.master` master page currently has the text, Hello, stranger displayed in the left column when visited by an anonymous user, but imagine that we wanted to replace that text with a Login control.</span></span> <span data-ttu-id="f2f62-280">Ainsi, un utilisateur anonyme pour se connecter à partir de n’importe quelle page sur le site, au lieu de demander à consulter la page de connexion directement.</span><span class="sxs-lookup"><span data-stu-id="f2f62-280">This would allow an anonymous user to log in from any page on the site, instead of requiring them to visit the login page directly.</span></span> <span data-ttu-id="f2f62-281">Toutefois, si un utilisateur n’a pas pu se connecter via le contrôle de connexion rendu par la page maître, il peut être judicieux de les rediriger vers la page de connexion (`Login.aspx`), car cette page probable comprend des instructions supplémentaires, les liens et les autres aide - tels que des liens pour créer un nouveau compte ou récupérer un mot de passe - qui n’ont pas été ajoutés à la page maître.</span><span class="sxs-lookup"><span data-stu-id="f2f62-281">However, if a user was unable to log in via the Login control rendered by the master page, it might make sense to redirect them to the login page (`Login.aspx`) because that page likely includes additional instructions, links, and other help - such as links to create a new account or retrieve a lost password - that were not added to the master page.</span></span>


### <a name="creating-theauthenticateevent-handler"></a><span data-ttu-id="f2f62-282">Création de la`Authenticate`Gestionnaire d’événements</span><span class="sxs-lookup"><span data-stu-id="f2f62-282">Creating the`Authenticate`Event Handler</span></span>

<span data-ttu-id="f2f62-283">Pour brancher notre logique d’authentification personnalisée, nous devons créer un gestionnaire d’événements pour le contrôle de connexion `Authenticate` événement.</span><span class="sxs-lookup"><span data-stu-id="f2f62-283">In order to plug in our custom authentication logic, we need to create an event handler for the Login control's `Authenticate` event.</span></span> <span data-ttu-id="f2f62-284">Création d’un gestionnaire d’événements pour le `Authenticate` événement génère la définition de gestionnaire d’événements suivante :</span><span class="sxs-lookup"><span data-stu-id="f2f62-284">Creating an event handler for the `Authenticate` event will generate the following event handler definition:</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample3.vb)]

<span data-ttu-id="f2f62-285">Comme vous pouvez le voir, la `Authenticate` un objet de type est passé au gestionnaire d’événements [ `AuthenticateEventArgs` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx) comme deuxième paramètre d’entrée.</span><span class="sxs-lookup"><span data-stu-id="f2f62-285">As you can see, the `Authenticate` event handler is passed an object of type [`AuthenticateEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx) as its second input parameter.</span></span> <span data-ttu-id="f2f62-286">Le `AuthenticateEventArgs` classe contient une propriété booléenne nommée `Authenticated` qui permet de spécifier si les informations d’identification fournies sont valides.</span><span class="sxs-lookup"><span data-stu-id="f2f62-286">The `AuthenticateEventArgs` class contains a Boolean property named `Authenticated` that is used to specify whether the supplied credentials are valid.</span></span> <span data-ttu-id="f2f62-287">Notre tâche, est ensuite, pour écrire du code ici qui détermine si les informations d’identification fournies sont valides ou non et pour définir le `e.Authenticate` propriété en conséquence.</span><span class="sxs-lookup"><span data-stu-id="f2f62-287">Our task, then, is to write code here that determines whether the supplied credentials are valid or not, and to set the `e.Authenticate` property accordingly.</span></span>

### <a name="determining-and-validating-the-supplied-credentials"></a><span data-ttu-id="f2f62-288">Détermination et valider les informations d’identification fournies</span><span class="sxs-lookup"><span data-stu-id="f2f62-288">Determining and Validating the Supplied Credentials</span></span>

<span data-ttu-id="f2f62-289">Utilisez le contrôle de connexion [ `UserName` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx) et [ `Password` propriétés](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx) pour déterminer les informations d’identification de nom d’utilisateur et mot de passe entrées par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f2f62-289">Use the Login control's [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx) and [`Password` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx) to determine the username and password credentials entered by the user.</span></span> <span data-ttu-id="f2f62-290">Afin de déterminer les valeurs entrées dans les contrôles Web supplémentaires (telles que la `Email` TextBox, nous avons ajouté à l’étape précédente), utilisez `LoginControlID.FindControl`(«*`controlID`*») pour obtenir une référence de programmation pour le Web contrôle dans le modèle dont `ID` propriété est égale à *`controlID`*.</span><span class="sxs-lookup"><span data-stu-id="f2f62-290">In order to determine the values entered into any additional Web controls (such as the `Email` TextBox we added in the previous step), use `LoginControlID.FindControl`("*`controlID`*") to obtain a programmatic reference to the Web control in the template whose `ID` property is equal to *`controlID`*.</span></span> <span data-ttu-id="f2f62-291">Par exemple, pour obtenir une référence à la `Email` zone de texte, utilisez le code suivant :</span><span class="sxs-lookup"><span data-stu-id="f2f62-291">For example, to get a reference to the `Email` TextBox, use the following code:</span></span>

`Dim EmailTextBox As TextBox = CType(myLogin.FindControl("Email"), TextBox)`

<span data-ttu-id="f2f62-292">Afin de valider les informations d’identification de l’utilisateur, nous devons faire deux choses :</span><span class="sxs-lookup"><span data-stu-id="f2f62-292">In order to validate the user's credentials we need to do two things:</span></span>

1. <span data-ttu-id="f2f62-293">Vérifiez que le nom d’utilisateur fourni et un mot de passe sont valides</span><span class="sxs-lookup"><span data-stu-id="f2f62-293">Ensure that the provided username and password are valid</span></span>
2. <span data-ttu-id="f2f62-294">Assurez-vous que les adresse de messagerie entrée correspond à l’adresse de messagerie sur le fichier pour l’utilisateur tente de se connecter</span><span class="sxs-lookup"><span data-stu-id="f2f62-294">Ensure that email address entered matches the email address on file for the user attempting to log in</span></span>

<span data-ttu-id="f2f62-295">Pour accomplir la première vérification, nous pouvons utiliser simplement la `Membership.ValidateUser` méthode comme nous l’avons vu à l’étape 1.</span><span class="sxs-lookup"><span data-stu-id="f2f62-295">To accomplish the first check we can simply use the `Membership.ValidateUser` method like we saw in Step 1.</span></span> <span data-ttu-id="f2f62-296">Pour le second contrôle, nous devons déterminer l’adresse de messagerie de l’utilisateur afin que nous pouvons le comparer à l’adresse de messagerie qu’ils entrés dans le contrôle de zone de texte.</span><span class="sxs-lookup"><span data-stu-id="f2f62-296">For the second check, we need to determine the user's email address so that we can compare it to the email address they entered into the TextBox control.</span></span> <span data-ttu-id="f2f62-297">Pour obtenir plus d’informations sur un utilisateur particulier, utilisez le `Membership` de classe [ `GetUser` méthode](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx).</span><span class="sxs-lookup"><span data-stu-id="f2f62-297">To get information about a particular user, use the `Membership` class's [`GetUser` method](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx).</span></span>

<span data-ttu-id="f2f62-298">Le `GetUser` méthode a plusieurs surcharges.</span><span class="sxs-lookup"><span data-stu-id="f2f62-298">The `GetUser` method has a number of overloads.</span></span> <span data-ttu-id="f2f62-299">Si utilisée sans passer tous les paramètres, il retourne des informations sur l’utilisateur actuellement connecté.</span><span class="sxs-lookup"><span data-stu-id="f2f62-299">If used without passing in any parameters, it returns information about the currently logged in user.</span></span> <span data-ttu-id="f2f62-300">Pour obtenir plus d’informations sur un utilisateur particulier, appelez `GetUser` en passant son nom d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f2f62-300">To get information about a particular user, call `GetUser` passing in their username.</span></span> <span data-ttu-id="f2f62-301">Dans les deux cas, `GetUser` retourne un [ `MembershipUser` objet](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), qui possède des propriétés comme `UserName`, `Email`, `IsApproved`, `IsOnline`, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="f2f62-301">Either way, `GetUser` returns a [`MembershipUser` object](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), which has properties like `UserName`, `Email`, `IsApproved`, `IsOnline`, and so on.</span></span>

<span data-ttu-id="f2f62-302">Le code suivant implémente ces deux contrôles.</span><span class="sxs-lookup"><span data-stu-id="f2f62-302">The following code implements these two checks.</span></span> <span data-ttu-id="f2f62-303">Si les deux passez, puis `e.Authenticate` a la valeur `True`, sinon il est affecté `False`.</span><span class="sxs-lookup"><span data-stu-id="f2f62-303">If both pass, then `e.Authenticate` is set to `True`, otherwise it is assigned `False`.</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample4.vb)]

<span data-ttu-id="f2f62-304">Avec ce code en place, tentent de se connecter tant qu’utilisateur valid, entrez le nom d’utilisateur correct, le mot de passe et l’adresse de messagerie.</span><span class="sxs-lookup"><span data-stu-id="f2f62-304">With this code in place, attempt to log in as a valid user, entering the correct username, password, and email address.</span></span> <span data-ttu-id="f2f62-305">Essayez de nouveau, mais cette fois utiliser délibérément une adresse de messagerie incorrect (voir la Figure 10).</span><span class="sxs-lookup"><span data-stu-id="f2f62-305">Try it again, but this time purposefully use an incorrect email address (see Figure 10).</span></span> <span data-ttu-id="f2f62-306">Enfin, essayez une troisième fois à l’aide d’un nom d’utilisateur n’existe pas.</span><span class="sxs-lookup"><span data-stu-id="f2f62-306">Finally, try it a third time using a non-existent username.</span></span> <span data-ttu-id="f2f62-307">Dans le premier cas vous devez être correctement ouvert une session le site, mais dans les deux derniers cas vous devez voir le message d’informations d’identification non valide du contrôle de la connexion.</span><span class="sxs-lookup"><span data-stu-id="f2f62-307">In the first case you should be successfully logged on to the site, but in the last two cases you should see the Login control's invalid credentials message.</span></span>


<span data-ttu-id="f2f62-308">[![Tito ne peut pas se connecter lorsque vous fournissez une adresse de messagerie Incorrect](validating-user-credentials-against-the-membership-user-store-vb/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="f2f62-308">[![Tito Cannot Log In When Supplying an Incorrect Email Address](validating-user-credentials-against-the-membership-user-store-vb/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image28.png)</span></span>

<span data-ttu-id="f2f62-309">**La figure 10**: Tito ne peut pas journal dans lorsque en fournissant une adresse de messagerie Incorrect ([cliquez pour afficher l’image en taille réelle](validating-user-credentials-against-the-membership-user-store-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="f2f62-309">**Figure 10**: Tito Cannot Log In When Supplying an Incorrect Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image30.png))</span></span>


> [!NOTE]
> <span data-ttu-id="f2f62-310">Comme indiqué dans la section Comment l’appartenance au Framework gère non valide tentatives de connexion à l’étape 1, lorsque la `Membership.ValidateUser` méthode est appelée et reçoit des informations d’identification non valides, il effectue le suivi de la tentative de connexion non valide et verrouille l’utilisateur si elles dépassent une certaine seuil de tentatives non valides dans une fenêtre de temps spécifié.</span><span class="sxs-lookup"><span data-stu-id="f2f62-310">As discussed in the How the Membership Framework Handles Invalid Login Attempts section in Step 1, when the `Membership.ValidateUser` method is called and passed invalid credentials, it keeps track of the invalid login attempt and locks out the user if they exceed a certain threshold of invalid attempts within a specified time window.</span></span> <span data-ttu-id="f2f62-311">Depuis notre logique d’authentification personnalisée appelle le `ValidateUser` (méthode), un mot de passe pour un nom d’utilisateur valide incrémente le compteur de tentatives de connexion non valide, mais ce compteur n’est pas incrémenté dans le cas où le nom d’utilisateur et un mot de passe sont valides, mais le adresse de messagerie est incorrecte.</span><span class="sxs-lookup"><span data-stu-id="f2f62-311">Since our custom authentication logic calls the `ValidateUser` method, an incorrect password for a valid username will increment the invalid login attempt counter, but this counter is not incremented in the case where the username and password are valid, but the email address is incorrect.</span></span> <span data-ttu-id="f2f62-312">Sans doute, ce comportement est approprié, car il est peu probable qu’un pirate doit connaître le nom d’utilisateur et le mot de passe, mais devez utiliser des techniques de force brute pour déterminer l’adresse de messagerie de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f2f62-312">Chances are, this behavior is suitable, since it's unlikely that a hacker will know the username and password, but have to use brute force techniques to determine the user's email address.</span></span>


## <a name="step-4-improving-the-login-controls-invalid-credentials-message"></a><span data-ttu-id="f2f62-313">Étape 4 : Amélioration de Message d’informations d’identification non valide du contrôle de connexion</span><span class="sxs-lookup"><span data-stu-id="f2f62-313">Step 4: Improving the Login Control's Invalid Credentials Message</span></span>

<span data-ttu-id="f2f62-314">Lorsqu’un utilisateur tente de se connecter avec des informations d’identification non valides, le contrôle de connexion affiche un message expliquant que la tentative de connexion a échoué.</span><span class="sxs-lookup"><span data-stu-id="f2f62-314">When a user attempts to log on with invalid credentials, the Login control displays a message explaining that the login attempt was unsuccessful.</span></span> <span data-ttu-id="f2f62-315">En particulier, le contrôle affiche le message spécifié par son [ `FailureText` propriété](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx), qui a une valeur par défaut de votre tentative de connexion n’a pas réussi.</span><span class="sxs-lookup"><span data-stu-id="f2f62-315">In particular, the control displays the message specified by its [`FailureText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx), which has a default value of Your login attempt was not successful.</span></span> <span data-ttu-id="f2f62-316">Réessayez.</span><span class="sxs-lookup"><span data-stu-id="f2f62-316">Please try again.</span></span>

<span data-ttu-id="f2f62-317">Rappelez-vous qu’il existe de nombreuses raisons pour lesquelles les informations d’identification de l’utilisateur n’est pas valides :</span><span class="sxs-lookup"><span data-stu-id="f2f62-317">Recall that there are many reasons why a user's credentials may be invalid:</span></span>

- <span data-ttu-id="f2f62-318">Le nom d’utilisateur n’existe pas</span><span class="sxs-lookup"><span data-stu-id="f2f62-318">The username may not exist</span></span>
- <span data-ttu-id="f2f62-319">Le nom d’utilisateur existe, mais le mot de passe n’est pas valide</span><span class="sxs-lookup"><span data-stu-id="f2f62-319">The username exists, but the password is invalid</span></span>
- <span data-ttu-id="f2f62-320">Le nom d’utilisateur et un mot de passe sont valides, mais l’utilisateur n’est pas encore approuvé.</span><span class="sxs-lookup"><span data-stu-id="f2f62-320">The username and password are valid, but the user is not yet approved</span></span>
- <span data-ttu-id="f2f62-321">Le nom d’utilisateur et un mot de passe sont valides, mais l’utilisateur est verrouillé hors (très probablement parce qu’il a dépassé le nombre de tentatives de connexion non valide dans l’intervalle de temps spécifié)</span><span class="sxs-lookup"><span data-stu-id="f2f62-321">The username and password are valid, but the user is locked out (most likely because they exceeded the number of invalid login attempts within the specified time frame)</span></span>

<span data-ttu-id="f2f62-322">Et peut avoir d’autres raisons lors de l’utilisation de logique d’authentification personnalisée.</span><span class="sxs-lookup"><span data-stu-id="f2f62-322">And there may be other reasons when using custom authentication logic.</span></span> <span data-ttu-id="f2f62-323">Par exemple, avec le code que nous a écrit à l’étape 3, le nom d’utilisateur et mot de passe est valide, mais l’adresse de messagerie est peut-être incorrecte.</span><span class="sxs-lookup"><span data-stu-id="f2f62-323">For example, with the code we wrote in Step 3, the username and password may be valid, but the email address may be incorrect.</span></span>

<span data-ttu-id="f2f62-324">Quelle que soit la raison pour laquelle les informations d’identification ne sont pas valides, le contrôle de connexion affiche le même message d’erreur.</span><span class="sxs-lookup"><span data-stu-id="f2f62-324">Regardless of why the credentials are invalid, the Login control displays the same error message.</span></span> <span data-ttu-id="f2f62-325">Ce manque de commentaires peut prêter à confusion pour un utilisateur dont le compte n’a pas encore été approuvé ou qui a été verrouillé. Avec un peu de travail, cependant, nous ayons le contrôle de connexion affiche un message plus approprié.</span><span class="sxs-lookup"><span data-stu-id="f2f62-325">This lack of feedback can be confusing for a user whose account has not yet been approved or who has been locked out. With a little bit of work, though, we can have the Login control display a more appropriate message.</span></span>

<span data-ttu-id="f2f62-326">Chaque fois qu’un utilisateur tente de se connecter avec des informations d’identification non valides, le contrôle de connexion déclenche son `LoginError` événement.</span><span class="sxs-lookup"><span data-stu-id="f2f62-326">Whenever a user attempts to login with invalid credentials the Login control raises its `LoginError` event.</span></span> <span data-ttu-id="f2f62-327">Créer un gestionnaire d’événements pour cet événement et ajoutez le code suivant :</span><span class="sxs-lookup"><span data-stu-id="f2f62-327">Go ahead and create an event handler for this event, and add the following code:</span></span>

[!code-vb[Main](validating-user-credentials-against-the-membership-user-store-vb/samples/sample5.vb)]

<span data-ttu-id="f2f62-328">Le code ci-dessus démarre en définissant le contrôle de connexion `FailureText` propriété la valeur par défaut (votre tentative de connexion n’a pas réussi.</span><span class="sxs-lookup"><span data-stu-id="f2f62-328">The above code starts by setting the Login control's `FailureText` property to the default value ( Your login attempt was not successful.</span></span> <span data-ttu-id="f2f62-329">Veuillez réessayer).</span><span class="sxs-lookup"><span data-stu-id="f2f62-329">Please try again ).</span></span> <span data-ttu-id="f2f62-330">Il vérifie ensuite si le nom d’utilisateur fourni est mappé à un compte d’utilisateur existant.</span><span class="sxs-lookup"><span data-stu-id="f2f62-330">It then checks to see if the username supplied maps to an existing user account.</span></span> <span data-ttu-id="f2f62-331">Si, par conséquent, il consulte résultant `MembershipUser` l’objet `IsLockedOut` et `IsApproved` propriétés afin de déterminer si le compte a été verrouillé ou n’a pas encore été approuvé.</span><span class="sxs-lookup"><span data-stu-id="f2f62-331">If so, it consults the resulting `MembershipUser` object's `IsLockedOut` and `IsApproved` properties to determine if the account has been locked out or has not yet been approved.</span></span> <span data-ttu-id="f2f62-332">Dans les deux cas, le `FailureText` propriété est mise à jour à une valeur correspondante.</span><span class="sxs-lookup"><span data-stu-id="f2f62-332">In either case, the `FailureText` property is updated to a corresponding value.</span></span>

<span data-ttu-id="f2f62-333">Pour tester ce code, essayez de délibérément connectez-vous en tant qu’un utilisateur existant, mais d’utiliser un mot de passe incorrect.</span><span class="sxs-lookup"><span data-stu-id="f2f62-333">To test this code, purposefully attempt to log in as an existing user, but use an incorrect password.</span></span> <span data-ttu-id="f2f62-334">Effectuez cette opération cinq fois dans une ligne dans un délai de 10 minutes et le compte est verrouillé. Comme le montre la Figure 11, passe tentatives seront toujours (même avec le mot de passe), mais ne maintenant affiche plus descriptif votre compte a été verrouillé en raison de trop nombreuses tentatives de connexion non valide.</span><span class="sxs-lookup"><span data-stu-id="f2f62-334">Do this five times in a row within a 10 minute time frame and the account will be locked out. As Figure 11 shows, subsequent login attempts will always fail (even with the correct password), but will now display the more descriptive Your account has been locked out because of too many invalid login attempts.</span></span> <span data-ttu-id="f2f62-335">Contactez l’administrateur pour que votre message de déverrouillage de compte.</span><span class="sxs-lookup"><span data-stu-id="f2f62-335">Please contact the administrator to have your account unlocked message.</span></span>


<span data-ttu-id="f2f62-336">[![Tito effectué trop de tentatives de connexion non valide et a été verrouillé](validating-user-credentials-against-the-membership-user-store-vb/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="f2f62-336">[![Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out](validating-user-credentials-against-the-membership-user-store-vb/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-vb/_static/image31.png)</span></span>

<span data-ttu-id="f2f62-337">**Figure 11**: Tito effectuée trop nombreuses tentatives non valides connexion et a été verrouillé ([cliquez pour afficher l’image en taille réelle](validating-user-credentials-against-the-membership-user-store-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="f2f62-337">**Figure 11**: Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-vb/_static/image33.png))</span></span>


## <a name="summary"></a><span data-ttu-id="f2f62-338">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="f2f62-338">Summary</span></span>

<span data-ttu-id="f2f62-339">Préalable ce didacticiel, notre page de connexion validé les informations d’identification fournies par rapport à une liste codée en dur de paires nom d’utilisateur/mot de passe.</span><span class="sxs-lookup"><span data-stu-id="f2f62-339">Prior this tutorial, our login page validated the supplied credentials against a hard-coded list of username/password pairs.</span></span> <span data-ttu-id="f2f62-340">Dans ce didacticiel, nous avons mis à jour la page pour valider les informations d’identification dans le cadre de l’appartenance.</span><span class="sxs-lookup"><span data-stu-id="f2f62-340">In this tutorial, we updated the page to validate credentials against the Membership framework.</span></span> <span data-ttu-id="f2f62-341">À l’étape 1, nous avons étudié à l’aide de la `Membership.ValidateUser` méthode par programmation.</span><span class="sxs-lookup"><span data-stu-id="f2f62-341">In Step 1 we looked at using the `Membership.ValidateUser` method programmatically.</span></span> <span data-ttu-id="f2f62-342">À l’étape 2, nous avons remplacé notre interface utilisateur créé manuellement et le code avec le contrôle de connexion.</span><span class="sxs-lookup"><span data-stu-id="f2f62-342">In Step 2 we replaced our manually created user interface and code with the Login control.</span></span>

<span data-ttu-id="f2f62-343">Le contrôle de connexion affiche une interface utilisateur de connexion standard et valide automatiquement les informations d’identification de l’utilisateur par rapport à l’infrastructure d’appartenance.</span><span class="sxs-lookup"><span data-stu-id="f2f62-343">The Login control renders a standard login user interface and automatically validates the user's credentials against the Membership framework.</span></span> <span data-ttu-id="f2f62-344">En outre, en cas d’informations d’identification valides, le contrôle de connexion connecte l’utilisateur via l’authentification par formulaire.</span><span class="sxs-lookup"><span data-stu-id="f2f62-344">Moreover, in the event of valid credentials, the Login control signs the user in via forms authentication.</span></span> <span data-ttu-id="f2f62-345">En bref, une expérience utilisateur de connexion entièrement fonctionnel est disponible en faisant simplement glisser le contrôle de connexion sur une page, aucun balisage déclaratif supplémentaire ou le code nécessaire.</span><span class="sxs-lookup"><span data-stu-id="f2f62-345">In short, a fully functional login user experience is available by simply dragging the Login control onto a page, no extra declarative markup or code necessary.</span></span> <span data-ttu-id="f2f62-346">Plus, le contrôle de connexion est hautement personnalisable, ce qui permet un niveau précis de contrôle sur les deux le rendu utilisateur interface logique d’authentification et.</span><span class="sxs-lookup"><span data-stu-id="f2f62-346">What's more, the Login control is highly customizable, allowing for a fine degree of control over both the rendered user interface and authentication logic.</span></span>

<span data-ttu-id="f2f62-347">À ce stade les visiteurs de notre site Web peuvent créer un nouveau compte d’utilisateur et le journal dans le site, mais nous devons encore examiner de restreindre l’accès aux pages en fonction de l’utilisateur authentifié.</span><span class="sxs-lookup"><span data-stu-id="f2f62-347">At this point visitors to our website can create a new user account and log into the site, but we have yet to look at restricting access to pages based on the authenticated user.</span></span> <span data-ttu-id="f2f62-348">Actuellement, aucun utilisateur, authentifié ou anonyme, permettre afficher n’importe quelle page sur notre site.</span><span class="sxs-lookup"><span data-stu-id="f2f62-348">Currently, any user, authenticated or anonymous, can view any page on our site.</span></span> <span data-ttu-id="f2f62-349">En même temps que le contrôle de l’accès aux pages de notre site sur une base par utilisateur, nous pourrions avoir certaines pages dont la fonctionnalité dépend de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="f2f62-349">Along with controlling access to our site's pages on a user-by-user basis, we might have certain pages whose functionality depends on the user.</span></span> <span data-ttu-id="f2f62-350">Le didacticiel suivant explique comment limiter l’accès et les fonctionnalités dans la page en fonction de l’utilisateur connecté.</span><span class="sxs-lookup"><span data-stu-id="f2f62-350">The next tutorial looks at how to limit access and in-page functionality based on the logged in user.</span></span>

<span data-ttu-id="f2f62-351">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="f2f62-351">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="f2f62-352">informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="f2f62-352">Further Reading</span></span>

<span data-ttu-id="f2f62-353">Pour plus d’informations sur les sujets abordés dans ce didacticiel, consultez les ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="f2f62-353">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="f2f62-354">Affichage des Messages personnalisés à verrouillé et les utilisateurs Non approuvé</span><span class="sxs-lookup"><span data-stu-id="f2f62-354">Displaying Custom Messages to Locked Out and Non-Approved Users</span></span>](http://aspnet.4guysfromrolla.com/articles/050306-1.aspx)
- [<span data-ttu-id="f2f62-355">Examen de ASP.NET de 2.0 l’appartenance, rôles et profil</span><span class="sxs-lookup"><span data-stu-id="f2f62-355">Examining ASP.NET 2.0's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="f2f62-356">Comment : Créer une Page de connexion ASP.NET</span><span class="sxs-lookup"><span data-stu-id="f2f62-356">How To: Create an ASP.NET Login Page</span></span>](https://msdn.microsoft.com/library/ms178331.aspx)
- [<span data-ttu-id="f2f62-357">Documentation technique de contrôle de connexion</span><span class="sxs-lookup"><span data-stu-id="f2f62-357">Login Control Technical Documentation</span></span>](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx)
- [<span data-ttu-id="f2f62-358">L’utilisation des contrôles de connexion</span><span class="sxs-lookup"><span data-stu-id="f2f62-358">Using the Login Controls</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/security/login.aspx)

### <a name="about-the-author"></a><span data-ttu-id="f2f62-359">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="f2f62-359">About the Author</span></span>

<span data-ttu-id="f2f62-360">Scott Mitchell, auteur de plusieurs livres sur ASP/ASP.NET et créateur de 4GuysFromRolla.com, travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="f2f62-360">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f2f62-361">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="f2f62-361">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f2f62-362">Son dernier ouvrage est  *[SAM animer vous-même ASP.NET 2.0 des dernières 24 heures](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="f2f62-362">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="f2f62-363">Scott peut être atteint à [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) ou via son blog à [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="f2f62-363">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="f2f62-364">Remerciements</span><span class="sxs-lookup"><span data-stu-id="f2f62-364">Special Thanks To</span></span>

<span data-ttu-id="f2f62-365">Cette série de didacticiels a été révisée par plusieurs réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="f2f62-365">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f2f62-366">Les réviseurs tête pour ce didacticiel ont été Teresa Murphy et Michael Olivero.</span><span class="sxs-lookup"><span data-stu-id="f2f62-366">Lead reviewers for this tutorial were Teresa Murphy and Michael Olivero.</span></span> <span data-ttu-id="f2f62-367">Vous souhaitez consulter mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="f2f62-367">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f2f62-368">Dans ce cas, me supprimer une ligne à [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com).</span><span class="sxs-lookup"><span data-stu-id="f2f62-368">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="f2f62-369">[Précédent](creating-user-accounts-vb.md)
> [Suivant](user-based-authorization-vb.md)</span><span class="sxs-lookup"><span data-stu-id="f2f62-369">[Previous](creating-user-accounts-vb.md)
[Next](user-based-authorization-vb.md)</span></span>
