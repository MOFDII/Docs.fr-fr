---
uid: web-forms/overview/deployment/advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments
title: Déploiement de bases de données d’appartenance pour les environnements d’entreprise | Documents Microsoft
author: jrjlee
description: Cette rubrique explique les principales considérations et les défis que vous devrez résoudre lorsque vous configurez des bases de données ASP.NET application services (plus fréquent...
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/04/2012
ms.topic: article
ms.assetid: 3cf765df-d311-4f68-a295-c9685ceea830
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/deployment/advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments
msc.type: authoredcontent
ms.openlocfilehash: b783fcf57759f2a431480eec6902105f6d683408
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/06/2018
---
<a name="deploying-membership-databases-to-enterprise-environments"></a><span data-ttu-id="4724d-103">Déploiement de bases de données d’appartenance pour les environnements d’entreprise</span><span class="sxs-lookup"><span data-stu-id="4724d-103">Deploying Membership Databases to Enterprise Environments</span></span>
====================
<span data-ttu-id="4724d-104">par [Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="4724d-104">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="4724d-105">Télécharger le PDF</span><span class="sxs-lookup"><span data-stu-id="4724d-105">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="4724d-106">Cette rubrique explique les principales considérations et les défis que vous devrez résoudre lorsque les bases de données (plus communément appelé bases de données d’appartenance) dans des environnements de test, intermédiaire ou de production de services de configurer les applications ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="4724d-106">This topic explains the key considerations and challenges you'll need to overcome when you provision ASP.NET application services databases (more commonly referred to as membership databases) in test, staging, or production environments.</span></span> <span data-ttu-id="4724d-107">Elle décrit également les approches que vous permettent de relever ces défis.</span><span class="sxs-lookup"><span data-stu-id="4724d-107">It also describes approaches you can use to meet these challenges.</span></span>


<span data-ttu-id="4724d-108">Cette rubrique fait partie d’une série de didacticiels basées sur les spécifications de déploiement d’entreprise d’une société fictive nommée Fabrikam, Inc. Cette série de didacticiels utilise un exemple de solution&#x2014;le [solution Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;pour représenter une application web avec un niveau réaliste de complexité, y compris une application ASP.NET MVC 3, une Communication de Windows Service Foundation (WCF) et un projet de base de données.</span><span class="sxs-lookup"><span data-stu-id="4724d-108">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="4724d-109">La méthode de déploiement au cœur de ces didacticiels est basée sur l’approche de fichier de projet de fractionnement décrite dans [présentation du fichier de projet](../web-deployment-in-the-enterprise/understanding-the-project-file.md), dans lequel le processus de génération est contrôlé par deux fichiers de projet&#x2014;contenant un seul les instructions qui s’appliquent à chaque environnement de destination et celui qui contient les paramètres de génération et de déploiement spécifiques à l’environnement de génération.</span><span class="sxs-lookup"><span data-stu-id="4724d-109">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="4724d-110">Au moment de la génération, le fichier de projet spécifique à un environnement est fusionné dans le fichier de projet d’indépendant de l’environnement pour former un ensemble complet d’instructions de génération.</span><span class="sxs-lookup"><span data-stu-id="4724d-110">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="what-are-the-issues-when-you-deploy-a-membership-database"></a><span data-ttu-id="4724d-111">Quels sont les problèmes lorsque vous déployez une base de données d’appartenance ?</span><span class="sxs-lookup"><span data-stu-id="4724d-111">What Are the Issues When You Deploy a Membership Database?</span></span>

<span data-ttu-id="4724d-112">Dans la plupart des cas, lorsque vous concevez une stratégie de déploiement pour une base de données, la première chose que vous devez tenir compte est les données que vous souhaitez déployer.</span><span class="sxs-lookup"><span data-stu-id="4724d-112">In most cases, when you devise a deployment strategy for a database, the first thing you need to consider is what data you want to deploy.</span></span> <span data-ttu-id="4724d-113">Dans un environnement de développement ou de test, vous souhaiterez déployer des données de compte d’utilisateur pour faciliter le test de rapidement et facilement.</span><span class="sxs-lookup"><span data-stu-id="4724d-113">In a development or test environment, you might want to deploy user account data to facilitate quick and easy testing.</span></span> <span data-ttu-id="4724d-114">Dans un environnement intermédiaire ou de production, il est peu probable que vous pouvez déployer des données de compte d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4724d-114">In a staging or production environment, it's very unlikely that you'd want to deploy user account data.</span></span>

<span data-ttu-id="4724d-115">Malheureusement, les bases de données de l’appartenance ASP.NET présentent des défis spécifiques que vous prenez cette décision est beaucoup plus complexe :</span><span class="sxs-lookup"><span data-stu-id="4724d-115">Unfortunately, ASP.NET membership databases introduce some specific challenges that make this decision a lot more complex:</span></span>

- <span data-ttu-id="4724d-116">Un déploiement de schéma uniquement laisse la base de données d’appartenance dans un état non opérationnel.</span><span class="sxs-lookup"><span data-stu-id="4724d-116">A schema-only deployment will leave the membership database in a non-operational state.</span></span> <span data-ttu-id="4724d-117">Il s’agit, car la base de données d’appartenance inclut certaines données de configuration (dans le **aspnet\_SchemaVersions** table) que la base de données requiert pour fonctionner.</span><span class="sxs-lookup"><span data-stu-id="4724d-117">This is because the membership database includes some configuration data (in the **aspnet\_SchemaVersions** table) that the database requires in order to function.</span></span> <span data-ttu-id="4724d-118">Par conséquent, si vous effectuez un déploiement de schéma uniquement de votre base de données d’appartenance pour exclure les données de compte d’utilisateur, vous devez exécuter un script de post-déploiement pour ajouter les données de configuration essentielles.</span><span class="sxs-lookup"><span data-stu-id="4724d-118">As such, if you perform a schema-only deployment of your membership database in order to exclude user account data, you'll need to run a post-deployment script to add the essential configuration data.</span></span>
- <span data-ttu-id="4724d-119">Selon la configuration de votre base de données d’appartenance, le fournisseur d’appartenances peut utiliser la clé d’ordinateur pour chiffrer des mots de passe et les stocker dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="4724d-119">Depending on how your membership database is configured, the membership provider may use the machine key to encrypt passwords and store them in the database.</span></span> <span data-ttu-id="4724d-120">Dans ce cas, toutes les données de compte utilisateur que vous déployez la base de données ne seront plus utilisable sur le serveur de destination.</span><span class="sxs-lookup"><span data-stu-id="4724d-120">In this case, any user account data you deploy with the database will become unusable on the destination server.</span></span> <span data-ttu-id="4724d-121">Pour cette raison, il n’est pas un scénario pris en charge de déploiement de données de compte d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4724d-121">For this reason, deploying user account data is not a supported scenario.</span></span>

## <a name="choosing-a-membership-database-strategy"></a><span data-ttu-id="4724d-122">Choix d’une stratégie de base de données d’appartenance</span><span class="sxs-lookup"><span data-stu-id="4724d-122">Choosing a Membership Database Strategy</span></span>

<span data-ttu-id="4724d-123">Utilisez ces instructions lorsque vous choisissez la configuration d’une base de données d’appartenance dans un environnement de serveur d’entreprise :</span><span class="sxs-lookup"><span data-stu-id="4724d-123">Use these guidelines when you choose how to provision a membership database in an enterprise server environment:</span></span>

- <span data-ttu-id="4724d-124">Dans la mesure du possible, ne déployez pas les bases de données d’appartenance.</span><span class="sxs-lookup"><span data-stu-id="4724d-124">Wherever possible, do not deploy membership databases.</span></span> <span data-ttu-id="4724d-125">Au lieu de cela, créez la base de données d’appartenance manuellement sur le serveur de base de données cible.</span><span class="sxs-lookup"><span data-stu-id="4724d-125">Instead, create the membership database manually on the target database server.</span></span> <span data-ttu-id="4724d-126">Si vous n’avez pas personnalisé votre schéma de base de données d’abonnement, vous pouvez simplement créer un nouveau sur place à la destination à l’aide de la [ASP.NET SQL Server Registration Tool (aspnet\_regsql.exe)](https://msdn.microsoft.com/library/ms229862(v=vs.100).aspx).</span><span class="sxs-lookup"><span data-stu-id="4724d-126">If you haven't customized your membership database schema, you can simply create a new one in situ at the destination using the [ASP.NET SQL Server Registration Tool (aspnet\_regsql.exe)](https://msdn.microsoft.com/library/ms229862(v=vs.100).aspx).</span></span>
- <span data-ttu-id="4724d-127">Si vous ne disposez d’aucune option mais sur déployer une base de données d’appartenance&#x2014;par exemple, si vous avez apporté des modifications importantes au schéma de base de données&#x2014;vous devez effectuer un déploiement de schéma uniquement de la base de données d’appartenance pour exclure les données de compte d’utilisateur, puis exécuter un script de post-déploiement pour ajouter des données de configuration requis.</span><span class="sxs-lookup"><span data-stu-id="4724d-127">If you have no option but to deploy a membership database&#x2014;for example, if you've made extensive modifications to the database schema&#x2014;you should perform a schema-only deployment of the membership database, to exclude user account data, and then run a post-deployment script to add any required configuration data.</span></span> <span data-ttu-id="4724d-128">Vous trouverez des instructions générales sur ces approches dans [Comment : déployer les ASP.NET d’appartenance de base de données sans y compris les comptes d’utilisateur](https://msdn.microsoft.com/library/ff361972(v=vs.100).aspx).</span><span class="sxs-lookup"><span data-stu-id="4724d-128">You can find broad guidance on these approaches in [How to: Deploy the ASP.NET Membership Database Without Including User Accounts](https://msdn.microsoft.com/library/ff361972(v=vs.100).aspx).</span></span>

<span data-ttu-id="4724d-129">Il est important de se rappeler que *le schéma de votre base de données d’appartenance est susceptible d’être relativement statique*.</span><span class="sxs-lookup"><span data-stu-id="4724d-129">It's important to remember that *the schema of your membership database is likely to be fairly static*.</span></span> <span data-ttu-id="4724d-130">Même si vous avez personnalisé la base de données d’appartenance, il est peu probable que vous devez mettre à jour le schéma sur une base régulière&#x2014;il ne va pas être modifiés avec la même fréquence que le code dans une application web ou un projet de base de données.</span><span class="sxs-lookup"><span data-stu-id="4724d-130">Even if you've customized the membership database, it's unlikely that you'll need to update the schema on a regular basis&#x2014;it's not going to change with the same frequency as the code in a web application or a database project.</span></span> <span data-ttu-id="4724d-131">Par conséquent, vous devez ne doit pas inclure la base de données d’appartenance dans les processus de déploiement automatisé ou seule étape.</span><span class="sxs-lookup"><span data-stu-id="4724d-131">As such, you shouldn't need to include the membership database in any automated or single-step deployment processes.</span></span>

## <a name="using-vsdbcmd-to-update-a-membership-database-schema"></a><span data-ttu-id="4724d-132">À l’aide de VSDBCMD pour mettre à jour un schéma de base de données d’appartenance</span><span class="sxs-lookup"><span data-stu-id="4724d-132">Using VSDBCMD to Update a Membership Database Schema</span></span>

<span data-ttu-id="4724d-133">Si vous modifiez la structure de votre base de données d’appartenance après le premier déploiement, il pouvez que vous ne souhaitez pas l’outil de déploiement Web Internet Information Services (IIS) (Web Deploy) permet de redéployer la base de données.</span><span class="sxs-lookup"><span data-stu-id="4724d-133">If you modify the structure of your membership database after your first deployment, you may not want to use the Internet Information Services (IIS) Web Deployment Tool (Web Deploy) to redeploy the database.</span></span> <span data-ttu-id="4724d-134">La fonctionnalité de déploiement de base de données de Web Deploy n’inclut pas la possibilité de rendre des mises à jour différentielles à une base de données de destination&#x2014;au lieu de cela, Web Deploy doit supprimer et recréer la base de données.</span><span class="sxs-lookup"><span data-stu-id="4724d-134">The database deployment functionality in Web Deploy doesn't include the capability to make differential updates to a destination database&#x2014;instead, Web Deploy must drop and re-create the database.</span></span> <span data-ttu-id="4724d-135">Cela signifie que vous perdez les données de compte utilisateur existantes, ce qui ne sont généralement pas souhaitables dans des environnements de production ou intermédiaire.</span><span class="sxs-lookup"><span data-stu-id="4724d-135">This means that you lose any existing user account data, which is typically undesirable in staging or production environments.</span></span>

<span data-ttu-id="4724d-136">L’alternative consiste à utiliser l’utilitaire VSDBCMD pour mettre à jour le schéma de votre base de données de destination.</span><span class="sxs-lookup"><span data-stu-id="4724d-136">The alternative is to use the VSDBCMD utility to update the schema of your destination database.</span></span> <span data-ttu-id="4724d-137">VSDBCMD comprend deux fonctionnalités importantes.</span><span class="sxs-lookup"><span data-stu-id="4724d-137">VSDBCMD includes two important capabilities.</span></span> <span data-ttu-id="4724d-138">Tout d’abord, il peut importer le schéma de base de données existante dans un fichier .dbschema.</span><span class="sxs-lookup"><span data-stu-id="4724d-138">First, it can import the schema of an existing database into a .dbschema file.</span></span> <span data-ttu-id="4724d-139">En second lieu, il peut déployer un fichier .dbschema vers une base de données existante en tant que mise à jour différentiel, ce qui signifie que les modifications requises pour mettre la base de données à jour ne s’et vous ne perdez pas de données.</span><span class="sxs-lookup"><span data-stu-id="4724d-139">Second, it can deploy a .dbschema file to an existing database as a differential update, which means that it only makes the changes required to bring the target database up to date and you don't lose any data.</span></span>

<span data-ttu-id="4724d-140">Vous pouvez utiliser ces étapes pour mettre à jour un schéma de base de données d’appartenance :</span><span class="sxs-lookup"><span data-stu-id="4724d-140">You can use these high-level steps to update a membership database schema:</span></span>

1. <span data-ttu-id="4724d-141">Utilisez l’outil VSDBCMD **importation** action pour générer un fichier .dbschema pour votre base de données source d’appartenance.</span><span class="sxs-lookup"><span data-stu-id="4724d-141">Use the VSDBCMD **Import** action to generate a .dbschema file for your source membership database.</span></span> <span data-ttu-id="4724d-142">Cette procédure est décrite dans [Comment : importer un schéma à partir d’une invite de commandes](https://msdn.microsoft.com/library/dd172135.aspx).</span><span class="sxs-lookup"><span data-stu-id="4724d-142">This procedure is described in [How to: Import a Schema from a Command Prompt](https://msdn.microsoft.com/library/dd172135.aspx).</span></span>
2. <span data-ttu-id="4724d-143">Utilisez l’outil VSDBCMD **déployer** action pour déployer le fichier .dbschema à votre base de données d’appartenance de destination.</span><span class="sxs-lookup"><span data-stu-id="4724d-143">Use the VSDBCMD **Deploy** action to deploy the .dbschema file to your destination membership database.</span></span> <span data-ttu-id="4724d-144">Cette procédure est décrite dans [référence de ligne de commande pour VSDBCMD. EXE (déploiement et importation de schéma)](https://msdn.microsoft.com/library/dd193283.aspx).</span><span class="sxs-lookup"><span data-stu-id="4724d-144">This procedure is described in [Command-Line Reference for VSDBCMD.EXE (Deployment and Schema Import)](https://msdn.microsoft.com/library/dd193283.aspx).</span></span>

## <a name="conclusion"></a><span data-ttu-id="4724d-145">Conclusion</span><span class="sxs-lookup"><span data-stu-id="4724d-145">Conclusion</span></span>

<span data-ttu-id="4724d-146">Cette rubrique décrit les défis que vous pouvez rencontrer lorsque vous avez besoin configurer les bases de données de l’appartenance ASP.NET dans les environnements cibles différents.</span><span class="sxs-lookup"><span data-stu-id="4724d-146">This topic described some of the challenges you may face when you need to provision ASP.NET membership databases in various target environments.</span></span> <span data-ttu-id="4724d-147">En particulier, il explique pourquoi les déploiements de schéma uniquement laisser la base de données d’appartenance dans un état non opérationnel et pourquoi déployer des données de compte d’utilisateur n'est pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="4724d-147">In particular, it explained why schema-only deployments will leave the membership database in a non-operational state and why deploying user account data is not supported.</span></span> <span data-ttu-id="4724d-148">La rubrique a présenté également des conseils sur la façon de configurer, déployer et mettre à jour des bases de données d’appartenance dans différents scénarios.</span><span class="sxs-lookup"><span data-stu-id="4724d-148">The topic also presented guidance on how to provision, deploy, and update membership databases in different scenarios.</span></span>

## <a name="further-reading"></a><span data-ttu-id="4724d-149">informations supplémentaires</span><span class="sxs-lookup"><span data-stu-id="4724d-149">Further Reading</span></span>

<span data-ttu-id="4724d-150">Pour plus d’instructions et des exemples montrant comment utiliser VSDBCMD, consultez [référence de ligne de commande pour VSDBCMD. EXE (déploiement et importation de schéma)](https://msdn.microsoft.com/library/dd193283.aspx) et [Comment : importer un schéma à partir d’une invite de commandes](https://msdn.microsoft.com/library/dd172135.aspx).</span><span class="sxs-lookup"><span data-stu-id="4724d-150">For more guidance and examples of how to use VSDBCMD, see [Command-Line Reference for VSDBCMD.EXE (Deployment and Schema Import)](https://msdn.microsoft.com/library/dd193283.aspx) and [How to: Import a Schema from a Command Prompt](https://msdn.microsoft.com/library/dd172135.aspx).</span></span> <span data-ttu-id="4724d-151">Pour plus d’informations sur l’utilisation d’aspnet\_regsql.exe pour créer des bases de données d’appartenance, consultez [ASP.NET SQL Server Registration Tool (aspnet\_regsql.exe)](https://msdn.microsoft.com/library/ms229862(v=vs.100).aspx).</span><span class="sxs-lookup"><span data-stu-id="4724d-151">For more information on using aspnet\_regsql.exe to create membership databases, see [ASP.NET SQL Server Registration Tool (aspnet\_regsql.exe)](https://msdn.microsoft.com/library/ms229862(v=vs.100).aspx).</span></span> <span data-ttu-id="4724d-152">Pour obtenir des instructions plus générales sur le déploiement de bases de données d’appartenance, consultez [Comment : déployer les ASP.NET d’appartenance de base de données sans y compris les comptes d’utilisateur](https://msdn.microsoft.com/library/ff361972(v=vs.100).aspx).</span><span class="sxs-lookup"><span data-stu-id="4724d-152">For more general guidance on deploying membership databases, see [How to: Deploy the ASP.NET Membership Database Without Including User Accounts](https://msdn.microsoft.com/library/ff361972(v=vs.100).aspx).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="4724d-153">[Précédent](deploying-database-role-memberships-to-test-environments.md)
> [Suivant](excluding-files-and-folders-from-deployment.md)</span><span class="sxs-lookup"><span data-stu-id="4724d-153">[Previous](deploying-database-role-memberships-to-test-environments.md)
[Next](excluding-files-and-folders-from-deployment.md)</span></span>
