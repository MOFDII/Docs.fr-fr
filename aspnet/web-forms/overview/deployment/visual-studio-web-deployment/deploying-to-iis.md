---
uid: web-forms/overview/deployment/visual-studio-web-deployment/deploying-to-iis
title: 'Déploiement de Web ASP.NET à l’aide de Visual Studio : déploiement de Test | Microsoft Docs'
author: tdykstra
description: Cette série de didacticiels vous montre comment déployer (publier) un ASP.NET web application dans Azure App Service Web Apps ou à un fournisseur d’hébergement tiers, en utilisant des éléments...
ms.author: riande
ms.date: 03/23/2015
ms.assetid: 8bf2c4fb-4ee5-4841-bfc2-03462c1f7a7a
msc.legacyurl: /web-forms/overview/deployment/visual-studio-web-deployment/deploying-to-iis
msc.type: authoredcontent
ms.openlocfilehash: ce361d2826733d5ecb9005713993e5ecf7f11860
ms.sourcegitcommit: 45ac74e400f9f2b7dbded66297730f6f14a4eb25
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/16/2018
ms.locfileid: "41834999"
---
<a name="aspnet-web-deployment-using-visual-studio-deploying-to-test"></a><span data-ttu-id="99f28-103">Déploiement de Web ASP.NET à l’aide de Visual Studio : déploiement de Test</span><span class="sxs-lookup"><span data-stu-id="99f28-103">ASP.NET Web Deployment using Visual Studio: Deploying to Test</span></span>
====================
<span data-ttu-id="99f28-104">par [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="99f28-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

[<span data-ttu-id="99f28-105">Télécharger le projet de démarrage</span><span class="sxs-lookup"><span data-stu-id="99f28-105">Download Starter Project</span></span>](http://go.microsoft.com/fwlink/p/?LinkId=282627)

> <span data-ttu-id="99f28-106">Cette série de didacticiels vous montre comment déployer (publier) un ASP.NET web application dans Azure App Service Web Apps ou à un fournisseur d’hébergement tiers, à l’aide de Visual Studio 2012 ou Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="99f28-106">This tutorial series shows you how to deploy (publish) an ASP.NET web application to Azure App Service Web Apps or to a third-party hosting provider, by using Visual Studio 2012 or Visual Studio 2010.</span></span> <span data-ttu-id="99f28-107">Pour plus d’informations sur la série, consultez [le premier didacticiel de la série](introduction.md).</span><span class="sxs-lookup"><span data-stu-id="99f28-107">For information about the series, see [the first tutorial in the series](introduction.md).</span></span>


## <a name="overview"></a><span data-ttu-id="99f28-108">Vue d'ensemble</span><span class="sxs-lookup"><span data-stu-id="99f28-108">Overview</span></span>

<span data-ttu-id="99f28-109">Ce didacticiel montre comment déployer une application web ASP.NET sur IIS sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="99f28-109">This tutorial shows how to deploy an ASP.NET web application to IIS on the local computer.</span></span>

<span data-ttu-id="99f28-110">Lorsque vous développez une application, vous tester généralement en l’exécutant dans Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="99f28-110">When you develop an application, you generally test by running it in Visual Studio.</span></span> <span data-ttu-id="99f28-111">Par défaut, les projets d’application web dans Visual Studio 2012 utilisent IIS Express comme serveur web de développement.</span><span class="sxs-lookup"><span data-stu-id="99f28-111">By default, web application projects in Visual Studio 2012 use IIS Express as the development web server.</span></span> <span data-ttu-id="99f28-112">IIS Express se comporte davantage comme IIS complet que le serveur Visual Studio Development (également appelé « Cassini »), que Visual Studio 2010 utilise par défaut.</span><span class="sxs-lookup"><span data-stu-id="99f28-112">IIS Express behaves more like full IIS than the Visual Studio Development Server (also known as Cassini), which Visual Studio 2010 uses by default.</span></span> <span data-ttu-id="99f28-113">Mais aucun serveur web de développement fonctionne exactement comme IIS.</span><span class="sxs-lookup"><span data-stu-id="99f28-113">But neither development web server works exactly like IIS.</span></span> <span data-ttu-id="99f28-114">Par conséquent, il est possible qu’une application s’exécute correctement lorsque vous testez dans Visual Studio, mais échouer lorsqu’elle est déployée sur IIS.</span><span class="sxs-lookup"><span data-stu-id="99f28-114">As a result, it's possible that an application will run correctly when you test it in Visual Studio, but fail when it's deployed to IIS.</span></span>

<span data-ttu-id="99f28-115">Vous pouvez tester votre application plus fiable des façons suivantes :</span><span class="sxs-lookup"><span data-stu-id="99f28-115">You can test your application more reliably in these ways:</span></span>

1. <span data-ttu-id="99f28-116">Déployer l’application à IIS sur votre ordinateur de développement à l’aide du même processus que vous utiliserez ultérieurement pour le déployer dans votre environnement de production.</span><span class="sxs-lookup"><span data-stu-id="99f28-116">Deploy the application to IIS on your development computer by using the same process that you'll use later to deploy it to your production environment.</span></span> <span data-ttu-id="99f28-117">Vous pouvez configurer Visual Studio pour utiliser IIS lorsque vous exécutez un projet web, mais cela ne serait pas tester votre processus de déploiement.</span><span class="sxs-lookup"><span data-stu-id="99f28-117">You can configure Visual Studio to use IIS when you run a web project, but doing that would not test your deployment process.</span></span> <span data-ttu-id="99f28-118">Cette méthode valide votre processus de déploiement en plus de vérifier que votre application s’exécutera correctement sous IIS.</span><span class="sxs-lookup"><span data-stu-id="99f28-118">This method validates your deployment process in addition to validating that your application will run correctly under IIS.</span></span>
2. <span data-ttu-id="99f28-119">Déployer l’application sur un environnement de test est presque identique à votre environnement de production.</span><span class="sxs-lookup"><span data-stu-id="99f28-119">Deploy the application to a test environment that is nearly identical to your production environment.</span></span> <span data-ttu-id="99f28-120">Étant donné que l’environnement de production pour ces didacticiels est Web Apps dans Azure App Service, l’environnement de test idéal est une application web supplémentaire créée dans Azure App Service.</span><span class="sxs-lookup"><span data-stu-id="99f28-120">Since the production environment for these tutorials is Web Apps in Azure App Service, the ideal test environment is an additional web app created in Azure App Service.</span></span> <span data-ttu-id="99f28-121">Vous utiliseriez cette deuxième application web uniquement pour les tests, mais il serait configurée la même façon que l’application web de production.</span><span class="sxs-lookup"><span data-stu-id="99f28-121">You would use this second web app only for testing, but it would be set up the same way as the production web app.</span></span>

<span data-ttu-id="99f28-122">Option 2 est le moyen le plus fiable pour tester, et si vous procédez ainsi, vous ne sont pas nécessairement à option 1.</span><span class="sxs-lookup"><span data-stu-id="99f28-122">Option 2 is the most reliable way to test, and if you do that, you don't necessarily have to do option 1.</span></span> <span data-ttu-id="99f28-123">Toutefois, si vous déployez sur une option fournisseur d’hébergement tiers 2 peut ne pas être possible ou peut être coûteuse, par conséquent, cette série de didacticiels affiche les deux méthodes.</span><span class="sxs-lookup"><span data-stu-id="99f28-123">However, if you are deploying to a third-party hosting provider option 2 might not be feasible or might be expensive, so this tutorial series shows both methods.</span></span> <span data-ttu-id="99f28-124">Conseils pour l’option 2 sont fourni dans le [déploiement dans l’environnement de Production](deploying-to-production.md) didacticiel.</span><span class="sxs-lookup"><span data-stu-id="99f28-124">Guidance for option 2 is provided in the [Deploying to the Production Environment](deploying-to-production.md) tutorial.</span></span>

<span data-ttu-id="99f28-125">Pour plus d’informations sur l’utilisation de serveurs web dans Visual Studio, consultez [serveurs Web dans Visual Studio pour les projets Web ASP.NET](https://msdn.microsoft.com/library/58wxa9w5.aspx).</span><span class="sxs-lookup"><span data-stu-id="99f28-125">For more information about using web servers in Visual Studio, see [Web Servers in Visual Studio for ASP.NET Web Projects](https://msdn.microsoft.com/library/58wxa9w5.aspx).</span></span>

<span data-ttu-id="99f28-126">Rappel : Si vous obtenez un message d’erreur ou quelque chose ne fonctionne pas lorsque vous parcourez le didacticiel, veillez à consulter le [page Résolution des problèmes](troubleshooting.md).</span><span class="sxs-lookup"><span data-stu-id="99f28-126">Reminder: If you get an error message or something doesn't work as you go through the tutorial, be sure to check the [troubleshooting page](troubleshooting.md).</span></span>

## <a name="install-iis"></a><span data-ttu-id="99f28-127">Installer IIS</span><span class="sxs-lookup"><span data-stu-id="99f28-127">Install IIS</span></span>

<span data-ttu-id="99f28-128">Pour déployer sur IIS sur votre ordinateur de développement, vous devez disposer d’IIS et Web Deploy installé.</span><span class="sxs-lookup"><span data-stu-id="99f28-128">To deploy to IIS on your development computer, you must have IIS and Web Deploy installed.</span></span> <span data-ttu-id="99f28-129">Web Deploy est installé par défaut avec Visual Studio, mais IIS n’est pas inclus dans la configuration par défaut de Windows 8 ou Windows 7.</span><span class="sxs-lookup"><span data-stu-id="99f28-129">Web Deploy is installed by default with Visual Studio, but IIS is not included in the default Windows 8 or Windows 7 configuration.</span></span> <span data-ttu-id="99f28-130">Si vous avez déjà installé IIS et le pool d’applications par défaut est déjà défini sur .NET 4, passez à [la section suivante](#sqlexpress).</span><span class="sxs-lookup"><span data-stu-id="99f28-130">If you have already installed IIS and the default application pool is already set to .NET 4, skip to [the next section](#sqlexpress).</span></span>

1. <span data-ttu-id="99f28-131">À l’aide de la [Web Platform Installer](https://www.microsoft.com/web/downloads/platform.aspx) est la meilleure méthode pour installer IIS et Web Deploy, étant donné que le programme Web Platform Installer installe une configuration recommandée pour IIS et il installe automatiquement la configuration requise pour IIS et Web Déployez si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="99f28-131">Using the [Web Platform Installer](https://www.microsoft.com/web/downloads/platform.aspx) is the preferred way to install IIS and Web Deploy, because the Web Platform Installer installs a recommended configuration for IIS and it automatically installs the prerequisites for IIS and Web Deploy if necessary.</span></span>

    <span data-ttu-id="99f28-132">Pour exécuter Web Platform Installer pour installer IIS et Web Deploy, utilisez le lien suivant.</span><span class="sxs-lookup"><span data-stu-id="99f28-132">To run Web Platform Installer to install IIS and Web Deploy, use the following link.</span></span> <span data-ttu-id="99f28-133">Si vous avez déjà installé IIS, Web Deploy ou l’un de leurs composants obligatoires, le programme Web Platform Installer installe uniquement ce qui est manquant.</span><span class="sxs-lookup"><span data-stu-id="99f28-133">If you already have installed IIS, Web Deploy or any of their required components, the Web Platform Installer installs only what is missing.</span></span>

   - [<span data-ttu-id="99f28-134">Installer IIS et Web Deploy à l’aide de WebPI</span><span class="sxs-lookup"><span data-stu-id="99f28-134">Install IIS and Web Deploy using WebPI</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=IIS7;ASPNET;NETFramework4;WDeploy)

     <span data-ttu-id="99f28-135">Vous verrez des messages indiquant que IIS 7 sera installé.</span><span class="sxs-lookup"><span data-stu-id="99f28-135">You'll see messages indicating that IIS 7 will be installed.</span></span> <span data-ttu-id="99f28-136">Le fonctionnement de lien pour IIS 8 dans Windows 8, mais pour Windows 8 vous assurer que ASP.NET 4.5 est installé en effectuant les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="99f28-136">The link works for IIS 8 in Windows 8, but for Windows 8 make sure that ASP.NET 4.5 is installed by performing the following steps:</span></span>

   - <span data-ttu-id="99f28-137">Ouvrez **le panneau de configuration**, **programmes et fonctionnalités**, **ou désactiver des fonctionnalités Windows activer**.</span><span class="sxs-lookup"><span data-stu-id="99f28-137">Open **Control Panel**, **Programs and Features**, **Turn Windows features on or off**.</span></span>
   - <span data-ttu-id="99f28-138">Développez **Internet Information Services**, **Services World Wide Web**, et **fonctionnalités de développement d’applications**.</span><span class="sxs-lookup"><span data-stu-id="99f28-138">Expand **Internet Information Services**, **World Wide Web Services**, and **Application Development Features**.</span></span>
   - <span data-ttu-id="99f28-139">Assurez-vous que l’option **ASP.NET 4.5** est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="99f28-139">Make sure that **ASP.NET 4.5** is selected.</span></span>

      ![Sélectionnez ASP.NET 4.5](deploying-to-iis/_static/image1.png)

<span data-ttu-id="99f28-141">Après avoir installé IIS, exécutez **Gestionnaire des services Internet** pour vous assurer que le .NET Framework version 4 est affecté au pool d’applications par défaut.</span><span class="sxs-lookup"><span data-stu-id="99f28-141">After installing IIS, run **IIS Manager** to make sure that the .NET Framework version 4 is assigned to the default application pool.</span></span>

1. <span data-ttu-id="99f28-142">Appuyez sur la touche WINDOWS + R pour ouvrir la **exécuter** boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="99f28-142">Press WINDOWS+R to open the **Run** dialog box.</span></span>

    <span data-ttu-id="99f28-143">(Ou dans Windows 8 Entrez « exécuter » le **Démarrer** page ou dans Windows 7 sélectionnez **exécuter** à partir de la **Démarrer** menu.</span><span class="sxs-lookup"><span data-stu-id="99f28-143">(Or in Windows 8 enter "run" on the **Start** page, or in Windows 7 select **Run** from the **Start** menu.</span></span> <span data-ttu-id="99f28-144">Si **exécuter** n’est pas dans le **Démarrer** menu, avec le bouton droit de la barre des tâches, cliquez sur **propriétés**, sélectionnez le **Menu Démarrer** , cliquez sur **Personnaliser**, puis sélectionnez **exécuter la commande**.)</span><span class="sxs-lookup"><span data-stu-id="99f28-144">If **Run** isn't in the **Start** menu, right-click the taskbar, click **Properties**, select the **Start Menu** tab, click **Customize**, and select **Run command**.)</span></span>
2. <span data-ttu-id="99f28-145">Entrez « inetmgr », puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="99f28-145">Enter "inetmgr", and then click **OK**.</span></span>
3. <span data-ttu-id="99f28-146">Dans le **connexions** volet, développez le nœud du serveur, puis sélectionnez **Pools d’applications**.</span><span class="sxs-lookup"><span data-stu-id="99f28-146">In the **Connections** pane, expand the server node and select **Application Pools**.</span></span> <span data-ttu-id="99f28-147">Dans le **Pools d’applications** volet, si **DefaultAppPool** est attribué pour le .NET framework version 4, comme dans l’illustration suivante, passez à la section suivante.</span><span class="sxs-lookup"><span data-stu-id="99f28-147">In the **Application Pools** pane, if **DefaultAppPool** is assigned to the .NET framework version 4 as in the following illustration, skip to the next section.</span></span>

    <span data-ttu-id="99f28-148">[![Inetmgr_showing_4.0_app_pools](deploying-to-iis/_static/image3.png)](deploying-to-iis/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="99f28-148">[![Inetmgr_showing_4.0_app_pools](deploying-to-iis/_static/image3.png)](deploying-to-iis/_static/image2.png)</span></span>
4. <span data-ttu-id="99f28-149">Si vous voyez uniquement deux pools d’applications et de ces deux valeurs sont définies sur le .NET Framework 2.0, vous devez installer ASP.NET 4 dans IIS.</span><span class="sxs-lookup"><span data-stu-id="99f28-149">If you see only two application pools and both of them are set to the .NET Framework 2.0, you have to install ASP.NET 4 in IIS.</span></span>

    <span data-ttu-id="99f28-150">Pour Windows 8, consultez les instructions dans la précédente section pour s’assurer que ASP.NET 4.5 est installé, ou consultez [cet article de la base de connaissances](https://support.microsoft.com/kb/2736284).</span><span class="sxs-lookup"><span data-stu-id="99f28-150">For Windows 8, see the instructions in the previous section for making sure that ASP.NET 4.5 is installed, or see [this KB article](https://support.microsoft.com/kb/2736284).</span></span> <span data-ttu-id="99f28-151">Pour Windows 7, ouvrez une fenêtre d’invite de commandes en cliquant en **invite de commandes** dans le Windows **Démarrer** menu et en sélectionnant **exécuter en tant qu’administrateur**.</span><span class="sxs-lookup"><span data-stu-id="99f28-151">For Windows 7, open a command prompt window by right-clicking **Command Prompt** in the Windows **Start** menu and selecting **Run as Administrator**.</span></span> <span data-ttu-id="99f28-152">Puis exécutez [aspnet\_regiis.exe](https://msdn.microsoft.com/library/k6h9cz8h.aspx) pour installer ASP.NET 4 dans IIS, en utilisant les commandes suivantes.</span><span class="sxs-lookup"><span data-stu-id="99f28-152">Then run [aspnet\_regiis.exe](https://msdn.microsoft.com/library/k6h9cz8h.aspx) to install ASP.NET 4 in IIS, using the following commands.</span></span> <span data-ttu-id="99f28-153">(Dans les systèmes 32 bits, remplacez « Framework64 » avec « Framework »).</span><span class="sxs-lookup"><span data-stu-id="99f28-153">(In 32-bit systems, replace "Framework64" with "Framework".)</span></span>

    [!code-console[Main](deploying-to-iis/samples/sample1.cmd)]

    <span data-ttu-id="99f28-154">Cette commande crée les nouveaux pools d’applications pour le .NET Framework 4, mais le pool d’applications par défaut sera toujours égale à 2.0.</span><span class="sxs-lookup"><span data-stu-id="99f28-154">This command creates new application pools for the .NET Framework 4, but the default application pool will still be set to 2.0.</span></span> <span data-ttu-id="99f28-155">Vous allez déployer une application qui cible .NET 4 pour ce pool d’applications, donc vous devez modifier le pool d’applications pour .NET 4.</span><span class="sxs-lookup"><span data-stu-id="99f28-155">You'll be deploying an application that targets .NET 4 to that application pool, so you have to change the application pool to .NET 4.</span></span>
5. <span data-ttu-id="99f28-156">Si vous avez fermé **Gestionnaire des services Internet**, exécutez-le à nouveau, développez le nœud du serveur, puis cliquez sur **Pools d’applications** pour afficher le **Pools d’applications** volet à nouveau.</span><span class="sxs-lookup"><span data-stu-id="99f28-156">If you closed **IIS Manager**, run it again, expand the server node, and click **Application Pools** to display the **Application Pools** pane again.</span></span>
6. <span data-ttu-id="99f28-157">Dans le **Pools d’applications** volet, cliquez sur **DefaultAppPool**, puis, dans le **Actions** volet, cliquez sur **paramètres de base**.</span><span class="sxs-lookup"><span data-stu-id="99f28-157">In the **Application Pools** pane, click **DefaultAppPool**, and then in the **Actions** pane click **Basic Settings**.</span></span>

    <span data-ttu-id="99f28-158">[![Inetmgr_selecting_Basic_Settings_for_app_pool](deploying-to-iis/_static/image5.png)](deploying-to-iis/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="99f28-158">[![Inetmgr_selecting_Basic_Settings_for_app_pool](deploying-to-iis/_static/image5.png)](deploying-to-iis/_static/image4.png)</span></span>
7. <span data-ttu-id="99f28-159">Dans le **modifier le Pool d’Application** boîte de dialogue, choisissez **version du .NET Framework** à **.NET Framework v4.0.30319** et cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="99f28-159">In the **Edit Application Pool** dialog box, change **.NET Framework version** to **.NET Framework v4.0.30319** and click **OK**.</span></span>

    <span data-ttu-id="99f28-160">[![Selecting_.NET_4_for_DefaultAppPool](deploying-to-iis/_static/image7.png)](deploying-to-iis/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="99f28-160">[![Selecting_.NET_4_for_DefaultAppPool](deploying-to-iis/_static/image7.png)](deploying-to-iis/_static/image6.png)</span></span>

<span data-ttu-id="99f28-161">IIS est désormais prêt à publier une application web sur celle-ci, mais avant que vous pouvez le faire vous devez créer les bases de données que vous allez utiliser dans l’environnement de test.</span><span class="sxs-lookup"><span data-stu-id="99f28-161">IIS is now ready for you to publish a web application to it, but before you can do that you have to create the databases that you will use in the test environment.</span></span>

<a id="sqlexpress"></a>

## <a name="install-sql-server-express"></a><span data-ttu-id="99f28-162">Installer SQL Server Express</span><span class="sxs-lookup"><span data-stu-id="99f28-162">Install SQL Server Express</span></span>

<span data-ttu-id="99f28-163">Base de données locale n’est pas conçu pour fonctionner dans IIS, SQL Server Express est installé afin d’obtenir votre environnement de test.</span><span class="sxs-lookup"><span data-stu-id="99f28-163">LocalDB is not designed to work in IIS, so for your test environment you need to have SQL Server Express installed.</span></span> <span data-ttu-id="99f28-164">Si vous utilisez Visual Studio 2010 SQL Server Express est déjà installé par défaut.</span><span class="sxs-lookup"><span data-stu-id="99f28-164">If you are using Visual Studio 2010 SQL Server Express is already installed by default.</span></span> <span data-ttu-id="99f28-165">Si vous utilisez Visual Studio 2012, vous devez l’installer.</span><span class="sxs-lookup"><span data-stu-id="99f28-165">If you are using Visual Studio 2012, you have to install it.</span></span>

<span data-ttu-id="99f28-166">Pour installer SQL Server Express, installez-le à partir de [centre de téléchargement : Microsoft SQL Server 2012 Express](https://www.microsoft.com/download/details.aspx?id=29062) en cliquant sur [ENU\x64\SQLEXPR\_x64\_ENU.exe](https://download.microsoft.com/download/8/D/D/8DD7BDBA-CEF7-4D8E-8C16-D9F69527F909/ENU/x64/SQLEXPR_x64_ENU.exe) ou [ ENU\x86\SQLEXPR\_x86\_ENU.exe](https://download.microsoft.com/download/8/D/D/8DD7BDBA-CEF7-4D8E-8C16-D9F69527F909/ENU/x86/SQLEXPR_x86_ENU.exe).</span><span class="sxs-lookup"><span data-stu-id="99f28-166">To install SQL Server Express, install it from [Download Center: Microsoft SQL Server 2012 Express](https://www.microsoft.com/download/details.aspx?id=29062) by clicking [ENU\x64\SQLEXPR\_x64\_ENU.exe](https://download.microsoft.com/download/8/D/D/8DD7BDBA-CEF7-4D8E-8C16-D9F69527F909/ENU/x64/SQLEXPR_x64_ENU.exe) or [ENU\x86\SQLEXPR\_x86\_ENU.exe](https://download.microsoft.com/download/8/D/D/8DD7BDBA-CEF7-4D8E-8C16-D9F69527F909/ENU/x86/SQLEXPR_x86_ENU.exe).</span></span> <span data-ttu-id="99f28-167">Si vous choisissez une autre pour votre système, il n’est pas installer et vous pouvez essayez-en un autre.</span><span class="sxs-lookup"><span data-stu-id="99f28-167">If you choose the wrong one for your system it will fail to install and you can try the other one.</span></span>

<span data-ttu-id="99f28-168">Dans la première page du centre d’Installation de SQL Server, cliquez sur **nouvelle installation SQL Server autonome ou ajout de fonctionnalités à une installation existante**et suivez les instructions en acceptant les choix par défaut.</span><span class="sxs-lookup"><span data-stu-id="99f28-168">On the first page of the SQL Server Installation Center, click **New SQL Server stand-alone installation or add features to an existing installation**, and follow the instructions, accepting the default choices.</span></span> <span data-ttu-id="99f28-169">Dans l’Assistant installation, acceptez les paramètres par défaut.</span><span class="sxs-lookup"><span data-stu-id="99f28-169">In the installation wizard accept the default settings.</span></span> <span data-ttu-id="99f28-170">Pour plus d’informations sur les options d’installation, consultez [installer SQL Server 2012 à partir de l’Assistant Installation (Setup)](https://msdn.microsoft.com/library/ms143219.aspx).</span><span class="sxs-lookup"><span data-stu-id="99f28-170">For more information about installation options, see [Install SQL Server 2012 from the Installation Wizard (Setup)](https://msdn.microsoft.com/library/ms143219.aspx).</span></span>

## <a name="create-sql-server-express-databases-for-the-test-environment"></a><span data-ttu-id="99f28-171">Créer des bases de données SQL Server Express pour l’environnement de test</span><span class="sxs-lookup"><span data-stu-id="99f28-171">Create SQL Server Express databases for the test environment</span></span>

<span data-ttu-id="99f28-172">L’application Contoso University a deux bases de données : la base de données d’appartenance et de la base de données d’application.</span><span class="sxs-lookup"><span data-stu-id="99f28-172">The Contoso University application has two databases: the membership database and the application database.</span></span> <span data-ttu-id="99f28-173">Vous pouvez déployer ces bases de données pour les deux bases de données distinctes ou à une base de données unique.</span><span class="sxs-lookup"><span data-stu-id="99f28-173">You can deploy these databases to two separate databases or to a single database.</span></span> <span data-ttu-id="99f28-174">Vous souhaiterez peut-être les combiner afin de faciliter les jointures de bases de données entre votre base de données d’application et votre base de données d’appartenance.</span><span class="sxs-lookup"><span data-stu-id="99f28-174">You might want to combine them in order to facilitate database joins between your application database and your membership database.</span></span> <span data-ttu-id="99f28-175">Si vous déployez sur un fournisseur d’hébergement tiers, votre plan d’hébergement peut également fournir une raison de les combiner.</span><span class="sxs-lookup"><span data-stu-id="99f28-175">If you are deploying to a third-party hosting provider, your hosting plan might also provide a reason to combine them.</span></span> <span data-ttu-id="99f28-176">Par exemple, le fournisseur d’hébergement peut facturent plus pour plusieurs bases de données ou ne peut pas même permettre plusieurs bases de données.</span><span class="sxs-lookup"><span data-stu-id="99f28-176">For example, the hosting provider might charge more for multiple databases or might not even allow more than one database.</span></span>

<span data-ttu-id="99f28-177">Dans ce didacticiel, vous allez déployer deux bases de données dans l’environnement de test et une base de données dans les environnements intermédiaire et de production.</span><span class="sxs-lookup"><span data-stu-id="99f28-177">In this tutorial, you'll deploy to two databases in the test environment, and to one database in the staging and production environments.</span></span>

<span data-ttu-id="99f28-178">À partir de la **vue** menu dans Visual Studio, sélectionnez **Explorateur de serveurs** (**Explorateur de base de données** dans Visual Web Developer) et avec le bouton droit puis **des connexions de données**  et sélectionnez **créer une nouvelle base de données SQL Server**.</span><span class="sxs-lookup"><span data-stu-id="99f28-178">From the **View** menu in Visual Studio select **Server Explorer** (**Database Explorer** in Visual Web Developer), and then right-click **Data Connections** and select **Create New SQL Server Database**.</span></span>

![Selecting_Create_New_SQL_Server_Database](deploying-to-iis/_static/image8.png)

<span data-ttu-id="99f28-180">Dans le **créer une nouvelle base de données SQL Server** boîte de dialogue, entrez «. \SQLExpress » dans le **nom du serveur** zone et « aspnet-ContosoUniversity » dans le **nouveau nom de base de données** zone, puis Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="99f28-180">In the **Create New SQL Server Database** dialog box, enter ".\SQLExpress" in the **Server name** box and "aspnet-ContosoUniversity" in the **New database name** box, then click **OK**.</span></span>

![Créer aspnet-ContosoUniversity](deploying-to-iis/_static/image9.png)

<span data-ttu-id="99f28-182">Suivez la même procédure pour créer une nouvelle base de données SQL Server Express School nommé « ContosoUniversity ».</span><span class="sxs-lookup"><span data-stu-id="99f28-182">Follow the same procedure to create a new SQL Server Express School database named "ContosoUniversity".</span></span>

<span data-ttu-id="99f28-183">**Explorateur de serveurs** affiche maintenant les deux nouvelles bases de données.</span><span class="sxs-lookup"><span data-stu-id="99f28-183">**Server Explorer** now shows the two new databases.</span></span>

![Nouvelles bases de données dans l’Explorateur de serveurs](deploying-to-iis/_static/image10.png)

## <a name="create-a-grant-script-for-the-new-databases"></a><span data-ttu-id="99f28-185">Créer un script d’octroi de nouvelles bases de données</span><span class="sxs-lookup"><span data-stu-id="99f28-185">Create a grant script for the new databases</span></span>

<span data-ttu-id="99f28-186">Lorsque l’application s’exécute dans IIS sur votre ordinateur de développement, l’application accède à la base de données à l’aide des informations d’identification du pool d’applications par défaut.</span><span class="sxs-lookup"><span data-stu-id="99f28-186">When the application runs in IIS on your development computer, the application accesses the database by using the default application pool's credentials.</span></span> <span data-ttu-id="99f28-187">Toutefois, par défaut, l’identité du pool d’application n’a pas d’autorisation pour ouvrir les bases de données.</span><span class="sxs-lookup"><span data-stu-id="99f28-187">However, by default, the application pool identity does not have permission to open the databases.</span></span> <span data-ttu-id="99f28-188">Par conséquent, vous devez exécuter un script pour accorder cette autorisation.</span><span class="sxs-lookup"><span data-stu-id="99f28-188">So you have to run a script to grant that permission.</span></span> <span data-ttu-id="99f28-189">Dans cette section, vous créez le script que vous allez exécuter par la suite pour vous assurer que l’application peut ouvrir les bases de données lorsqu’elle s’exécute dans IIS.</span><span class="sxs-lookup"><span data-stu-id="99f28-189">In this section you create the script that you'll run later to make sure that the application can open the databases when it runs in IIS.</span></span>

<span data-ttu-id="99f28-190">Avec le bouton droit de la solution (pas un des projets), puis cliquez sur **ajouter un nouvel élément**, puis créez un nouveau **fichier SQL** nommé *Grant.sql*.</span><span class="sxs-lookup"><span data-stu-id="99f28-190">Right-click the solution (not one of the projects), and click **Add New Item**, and then create a new **SQL File** named *Grant.sql*.</span></span> <span data-ttu-id="99f28-191">Copiez les commandes SQL suivantes dans le fichier, puis enregistrez et fermez le fichier :</span><span class="sxs-lookup"><span data-stu-id="99f28-191">Copy the following SQL commands into the file, and then save and close the file:</span></span>

[!code-sql[Main](deploying-to-iis/samples/sample2.sql)]

> [!NOTE]
> <span data-ttu-id="99f28-192">Ce script est conçu pour fonctionner avec SQL Server Express 2012 et les paramètres IIS dans Windows 8 ou Windows 7 comme ils sont spécifiés dans ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="99f28-192">This script is designed to work with SQL Server Express 2012 and with the IIS settings in Windows 8 or Windows 7 as they are specified in this tutorial.</span></span> <span data-ttu-id="99f28-193">Si vous utilisez une version différente de SQL Server ou de Windows, ou si vous configurez IIS sur votre ordinateur différemment, les modifications apportées à ce script peuvent être nécessaire.</span><span class="sxs-lookup"><span data-stu-id="99f28-193">If you're using a different version of SQL Server or of Windows, or if you set up IIS on your computer differently, changes to this script might be required.</span></span> <span data-ttu-id="99f28-194">Pour plus d’informations sur les scripts SQL Server, consultez [la documentation en ligne de SQL Server](https://go.microsoft.com/fwlink/?LinkId=132511).</span><span class="sxs-lookup"><span data-stu-id="99f28-194">For more information about SQL Server scripts, see [SQL Server Books Online](https://go.microsoft.com/fwlink/?LinkId=132511).</span></span>


> [!NOTE] 
> 
> <span data-ttu-id="99f28-195">**Note de sécurité** ce script donne db\_autorisations de propriétaire sur l’utilisateur qui accède à la base de données au moment de l’exécution, ce qui est ce que vous aurez dans l’environnement de production.</span><span class="sxs-lookup"><span data-stu-id="99f28-195">**Security Note** This script gives db\_owner permissions to the user that accesses the database at run time, which is what you'll have in the production environment.</span></span> <span data-ttu-id="99f28-196">Dans certains scénarios, vous souhaiterez spécifier un utilisateur qui a le schéma de base de données complète mettre à jour des autorisations uniquement pour le déploiement, et spécifier pour le moment de l’exécution d’un autre utilisateur qui dispose des autorisations uniquement pour lire et écrire des données.</span><span class="sxs-lookup"><span data-stu-id="99f28-196">In some scenarios you might want to specify a user that has full database schema update permissions only for deployment, and specify for run time a different user that has permissions only to read and write data.</span></span> <span data-ttu-id="99f28-197">Pour plus d’informations, consultez [vérifié les modifications de Web.config automatique pour les Migrations Code First](#reviewingmigrations) plus loin dans ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="99f28-197">For more information, see [Reviewing the Automatic Web.config Changes for Code First Migrations](#reviewingmigrations) later in this tutorial.</span></span>


<a id="publish"></a>

## <a name="run-the-grant-script-in-the-application-database"></a><span data-ttu-id="99f28-198">Exécutez le script d’octroi dans la base de données d’application</span><span class="sxs-lookup"><span data-stu-id="99f28-198">Run the grant script in the application database</span></span>

<span data-ttu-id="99f28-199">Vous pouvez configurer le profil de publication pour exécuter le script d’octroi dans la base de données d’appartenance au cours du déploiement, car ce déploiement de base de données utilise le fournisseur dbDacFx.</span><span class="sxs-lookup"><span data-stu-id="99f28-199">You can configure the publish profile to run the grant script in the membership database during deployment because that database deployment uses the dbDacFx provider.</span></span> <span data-ttu-id="99f28-200">Vous ne pouvez pas exécuter des scripts pendant le déploiement de Migrations Code First, qui est la façon dont vous déployez la base de données d’application.</span><span class="sxs-lookup"><span data-stu-id="99f28-200">You can't run scripts during Code First Migrations deployment, which is how you're deploying the application database.</span></span> <span data-ttu-id="99f28-201">Par conséquent, vous devez exécuter manuellement le script avant le déploiement dans la base de données d’application.</span><span class="sxs-lookup"><span data-stu-id="99f28-201">Therefore, you have to manually run the script before deployment in the application database.</span></span>

1. <span data-ttu-id="99f28-202">Dans Visual Studio, ouvrez le *Grant.sql* fichier que vous avez créé précédemment.</span><span class="sxs-lookup"><span data-stu-id="99f28-202">In Visual Studio, open the *Grant.sql* file that you created earlier.</span></span>
2. <span data-ttu-id="99f28-203">Cliquez sur **Connexion**.</span><span class="sxs-lookup"><span data-stu-id="99f28-203">Click **Connect**.</span></span> 

    ![Bouton de connexion](deploying-to-iis/_static/image11.png)
3. <span data-ttu-id="99f28-205">Dans le **se connecter au serveur** boîte de dialogue, entrez *. \SQLExpress* en tant que le **nom du serveur**, puis cliquez sur **Connect**.</span><span class="sxs-lookup"><span data-stu-id="99f28-205">In the **Connect to Server** dialog box, enter *.\SQLExpress* as the **Server Name**, and then click **Connect**.</span></span>
4. <span data-ttu-id="99f28-206">Dans la liste déroulante de base de données Sélectionnez **ContosoUniversity**, puis cliquez sur **Execute**.</span><span class="sxs-lookup"><span data-stu-id="99f28-206">In the database drop-down list select **ContosoUniversity**, and then click **Execute**.</span></span> 

    ![](deploying-to-iis/_static/image12.png)

<span data-ttu-id="99f28-207">Désormais, l’identité de pool d’applications par défaut dispose des autorisations suffisantes dans la base de données d’application pour les Migrations Code First créer les tables de base de données lors de l’application s’exécute.</span><span class="sxs-lookup"><span data-stu-id="99f28-207">The default application pool identity now has sufficient permissions in the application database for Code First Migrations to create the database tables when the application runs.</span></span>

## <a name="publish-to-iis"></a><span data-ttu-id="99f28-208">Publier sur IIS</span><span class="sxs-lookup"><span data-stu-id="99f28-208">Publish to IIS</span></span>

<span data-ttu-id="99f28-209">Il existe plusieurs façons, que vous pouvez déployer sur IIS à l’aide de Visual Studio et Web Deploy :</span><span class="sxs-lookup"><span data-stu-id="99f28-209">There are several ways you can deploy to IIS using Visual Studio and Web Deploy:</span></span>

- <span data-ttu-id="99f28-210">Utilisez Visual Studio publication en un clic.</span><span class="sxs-lookup"><span data-stu-id="99f28-210">Use Visual Studio one-click publish.</span></span>
- <span data-ttu-id="99f28-211">Publier à partir de la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="99f28-211">Publish from the command line.</span></span>
- <span data-ttu-id="99f28-212">Créer un *package de déploiement* et installez-le à l’aide du Gestionnaire des services Internet UI.</span><span class="sxs-lookup"><span data-stu-id="99f28-212">Create a *deployment package* and install it using the IIS Manager UI.</span></span> <span data-ttu-id="99f28-213">Le package de déploiement se compose d’un *.zip* fichier qui contient tous les fichiers et les métadonnées nécessaires pour installer un site dans IIS.</span><span class="sxs-lookup"><span data-stu-id="99f28-213">The deployment package consists of a *.zip* file that contains all the files and metadata needed to install a site in IIS.</span></span>
- <span data-ttu-id="99f28-214">Créer un package de déploiement et l’installer à l’aide de la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="99f28-214">Create a deployment package and install it using the command line.</span></span>

<span data-ttu-id="99f28-215">Le processus que vous avez parcouru dans les didacticiels précédents pour configurer Visual Studio pour automatiser les tâches de déploiement s’applique à toutes ces méthodes.</span><span class="sxs-lookup"><span data-stu-id="99f28-215">The process you went through in the previous tutorials to set up Visual Studio to automate deployment tasks applies to all of these methods.</span></span> <span data-ttu-id="99f28-216">Dans ces didacticiels, vous allez utiliser les deux premiers de ces méthodes.</span><span class="sxs-lookup"><span data-stu-id="99f28-216">In these tutorials you'll use the first two of these methods.</span></span> <span data-ttu-id="99f28-217">Pour plus d’informations sur l’utilisation de packages de déploiement, consultez [déploiement d’une application web en créant et en installant un package de déploiement web](https://go.microsoft.com/fwlink/p/?LinkId=282413#package) dans le plan de contenu de déploiement Web pour Visual Studio et ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="99f28-217">For information about using deployment packages, see [Deploying a web application by creating and installing a web deployment package](https://go.microsoft.com/fwlink/p/?LinkId=282413#package) in the Web Deployment Content Map for Visual Studio and ASP.NET.</span></span>

<span data-ttu-id="99f28-218">Avant la publication, assurez-vous que vous exécutez Visual Studio en mode administrateur.</span><span class="sxs-lookup"><span data-stu-id="99f28-218">Before publishing, make sure that you are running Visual Studio in administrator mode.</span></span> <span data-ttu-id="99f28-219">Si vous ne voyez pas **(administrateur)** dans la barre de titre, fermez Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="99f28-219">If you don't see **(Administrator)** in the title bar, close Visual Studio.</span></span> <span data-ttu-id="99f28-220">Dans le Windows 8 **Démarrer** page ou le Kit Windows 7 **Démarrer** menu, cliquez sur l’icône pour la version de Visual Studio que vous utilisez et sélectionnez **exécuter en tant qu’administrateur**.</span><span class="sxs-lookup"><span data-stu-id="99f28-220">In the Windows 8 **Start** page or the Windows 7 **Start** menu, right-click the icon for the version of Visual Studio you're using and select **Run as Administrator**.</span></span> <span data-ttu-id="99f28-221">Le mode administrateur est requis pour la publication uniquement lorsque vous publiez sur IIS sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="99f28-221">Administrator mode is required for publishing only when you are publishing to IIS on the local computer.</span></span>

### <a name="create-the-publish-profile"></a><span data-ttu-id="99f28-222">Créer le profil de publication</span><span class="sxs-lookup"><span data-stu-id="99f28-222">Create the publish profile</span></span>

1. <span data-ttu-id="99f28-223">Dans **l’Explorateur de solutions**, cliquez sur le projet ContosoUniversity (pas le projet ContosoUniversity.DAL) et sélectionnez **publier**.</span><span class="sxs-lookup"><span data-stu-id="99f28-223">In **Solution Explorer**, right-click the ContosoUniversity project (not the ContosoUniversity.DAL project) and select **Publish**.</span></span>

    <span data-ttu-id="99f28-224">Le **publier le site Web** Assistant s’affiche.</span><span class="sxs-lookup"><span data-stu-id="99f28-224">The **Publish Web** wizard appears.</span></span>

    ![Publication : onglet Web Assistant profil](deploying-to-iis/_static/image13.png)
2. <span data-ttu-id="99f28-226">Dans la liste déroulante, sélectionnez  **&lt;nouveau... &gt;**.</span><span class="sxs-lookup"><span data-stu-id="99f28-226">In the drop-down list, select **&lt;New...&gt;**.</span></span> <span data-ttu-id="99f28-227">(Avec la dernière version de Visual Studio est installée, il n’existe aucune liste déroulante et le bouton sur lequel cliquer pour créer un nouveau profil à partir de zéro est **personnalisé**.)</span><span class="sxs-lookup"><span data-stu-id="99f28-227">(With the latest Visual Studio update installed, there is no drop-down list, and the button to click in order to create a new profile from scratch is **Custom**.)</span></span>
3. <span data-ttu-id="99f28-228">Dans le **nouveau profil** boîte de dialogue, entrez « Test », puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="99f28-228">In the **New Profile** dialog box, enter "Test", and then click **OK**.</span></span>

    <span data-ttu-id="99f28-229">L’Assistant passe automatiquement à la **connexion** onglet.</span><span class="sxs-lookup"><span data-stu-id="99f28-229">The wizard automatically advances to the **Connection** tab.</span></span>
4. <span data-ttu-id="99f28-230">Dans le **l’URL du Service** , entrez *localhost*.</span><span class="sxs-lookup"><span data-stu-id="99f28-230">In the **Service URL** box, enter *localhost*.</span></span>
5. <span data-ttu-id="99f28-231">Dans le **Site/application** , entrez *Default Web Site/ContosoUniversity*</span><span class="sxs-lookup"><span data-stu-id="99f28-231">In the **Site/application** box, enter *Default Web Site/ContosoUniversity*</span></span>
6. <span data-ttu-id="99f28-232">Dans le **URL de Destination** , entrez `http://localhost/ContosoUniversity`</span><span class="sxs-lookup"><span data-stu-id="99f28-232">In the **Destination URL** box, enter `http://localhost/ContosoUniversity`</span></span>

    <span data-ttu-id="99f28-233">Le **URL de Destination** paramètre n’est pas nécessaire.</span><span class="sxs-lookup"><span data-stu-id="99f28-233">The **Destination URL** setting isn't required.</span></span> <span data-ttu-id="99f28-234">Visual Studio a terminé de déployer l’application, il s’ouvre automatiquement votre navigateur par défaut à cette URL.</span><span class="sxs-lookup"><span data-stu-id="99f28-234">When Visual Studio finishes deploying the application, it automatically opens your default browser to this URL.</span></span> <span data-ttu-id="99f28-235">Si vous ne souhaitez pas le navigateur s’ouvre automatiquement après le déploiement, laissez cette zone vide.</span><span class="sxs-lookup"><span data-stu-id="99f28-235">If you don't want the browser to open automatically after deployment, leave this box blank.</span></span>
7. <span data-ttu-id="99f28-236">Cliquez sur **valider la connexion** pour vérifier que les paramètres sont corrects et que vous pouvez vous connecter à IIS sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="99f28-236">Click **Validate Connection** to verify that the settings are correct and you can connect to IIS on the local computer.</span></span>

    <span data-ttu-id="99f28-237">Une coche verte vérifie que la connexion est établie.</span><span class="sxs-lookup"><span data-stu-id="99f28-237">A green check mark verifies that the connection is successful.</span></span>

    ![Publication : onglet Web Assistant connexion](deploying-to-iis/_static/image14.png)
8. <span data-ttu-id="99f28-239">Cliquez sur **suivant** pour accéder à la **paramètres** onglet.</span><span class="sxs-lookup"><span data-stu-id="99f28-239">Click **Next** to advance to the **Settings** tab.</span></span>
9. <span data-ttu-id="99f28-240">Le **Configuration** zone de liste déroulante spécifie la configuration de build à déployer.</span><span class="sxs-lookup"><span data-stu-id="99f28-240">The **Configuration** drop-down box specifies the build configuration to deploy.</span></span> <span data-ttu-id="99f28-241">Conservez la valeur à la valeur par défaut de mise en production.</span><span class="sxs-lookup"><span data-stu-id="99f28-241">Leave it set to the default value of Release.</span></span> <span data-ttu-id="99f28-242">Dans ce didacticiel, vous ne déployer les versions Debug.</span><span class="sxs-lookup"><span data-stu-id="99f28-242">You won't be deploying Debug builds in this tutorial.</span></span>
10. <span data-ttu-id="99f28-243">Développez **Options de publication du fichier**, puis sélectionnez **exclure des fichiers de l’application\_dossier de données**.</span><span class="sxs-lookup"><span data-stu-id="99f28-243">Expand **File Publish Options**, and then select **Exclude files from the App\_Data folder**.</span></span>

    <span data-ttu-id="99f28-244">Dans l’environnement de test de l’application accéderont les bases de données que vous avez créé dans l’instance locale de SQL Server Express, pas le fichier .mdf de fichiers dans le *application\_données* dossier.</span><span class="sxs-lookup"><span data-stu-id="99f28-244">In the test environment the application will access the databases that you created in the local SQL Server Express instance, not the .mdf files in the *App\_Data* folder.</span></span>
11. <span data-ttu-id="99f28-245">Laissez le **précompiler durant la publication** et **supprimer les fichiers supplémentaires à la destination** cases à cocher désactivées.</span><span class="sxs-lookup"><span data-stu-id="99f28-245">Leave the **Precompile during publishing** and **Remove additional files at destination** check boxes cleared.</span></span>

    ![Options de publication du fichier dans l’onglet Paramètres](deploying-to-iis/_static/image15.png)

    <span data-ttu-id="99f28-247">La précompilation est une option qui est surtout utile pour les sites très volumineux ; elle peut réduire les temps de démarrage de page pour la première fois qu’une page est demandée une fois que le site est publié.</span><span class="sxs-lookup"><span data-stu-id="99f28-247">Precompiling is an option that is useful mainly for very large sites; it can reduce page startup time for the first time a page is requested after the site is published.</span></span>

    <span data-ttu-id="99f28-248">Vous n’avez pas besoin de supprimer les fichiers supplémentaires dans la mesure où votre premier déploiement il n’est tous les fichiers dans le dossier de destination encore.</span><span class="sxs-lookup"><span data-stu-id="99f28-248">You don't need to remove additional files since this is your first deployment and there won't be any files in the destination folder yet.</span></span>

    > [!NOTE] 
    > 
    > [!CAUTION]
    > <span data-ttu-id="99f28-249">Si vous sélectionnez **supprimer les fichiers supplémentaires** pour un déploiement suivant sur le même site, assurez-vous que vous utilisez la fonctionnalité d’aperçu que vous voyez à l’avance quels fichiers seront supprimés avant de déployer.</span><span class="sxs-lookup"><span data-stu-id="99f28-249">If you select **Remove additional files** for a subsequent deployment to the same site, make sure that you use the preview feature so that you see in advance which files will be deleted before you deploy.</span></span> <span data-ttu-id="99f28-250">Le comportement attendu est que Web Deploy entraînera la suppression les fichiers sur le serveur de destination que vous avez supprimées dans votre projet.</span><span class="sxs-lookup"><span data-stu-id="99f28-250">The expected behavior is that Web Deploy will delete files on the destination server that you have deleted in your project.</span></span> <span data-ttu-id="99f28-251">Toutefois, la structure de la totalité du dossier sous les dossiers source et destination est comparée, et dans certains scénarios Web Deploy peut supprimer des fichiers que vous ne souhaitez pas supprimer.</span><span class="sxs-lookup"><span data-stu-id="99f28-251">However, the entire folder structure under the source and destination folders is compared, and in some scenarios Web Deploy might delete files you don't want to delete.</span></span>
    > 
    > <span data-ttu-id="99f28-252">Par exemple, si vous disposez d’une application web dans un sous-dossier sur le serveur lorsque vous déployez un projet dans le dossier racine, le sous-dossier sera supprimé.</span><span class="sxs-lookup"><span data-stu-id="99f28-252">For example, if you have a web application in a subfolder on the server when you deploy a project to the root folder, the subfolder will be deleted.</span></span> <span data-ttu-id="99f28-253">Vous pouvez avoir un projet pour le site principal chez contoso.com et un autre projet pour un blog sur contoso.com/blog.</span><span class="sxs-lookup"><span data-stu-id="99f28-253">You might have one project for the main site at contoso.com and another project for a blog at contoso.com/blog.</span></span> <span data-ttu-id="99f28-254">L’application de blog est dans un sous-dossier.</span><span class="sxs-lookup"><span data-stu-id="99f28-254">The blog application is in a subfolder.</span></span> <span data-ttu-id="99f28-255">Si vous sélectionnez Supprimer les fichiers supplémentaires à la destination lorsque vous déployez le site principal, l’application de blog est supprimée.</span><span class="sxs-lookup"><span data-stu-id="99f28-255">If you select Remove additional files at destination when you deploy the main site, the blog application will be deleted.</span></span>
    > 
    > <span data-ttu-id="99f28-256">Pour un autre exemple, votre application\_dossier de données peut-être être supprimé de manière inattendue.</span><span class="sxs-lookup"><span data-stu-id="99f28-256">For another example, your App\_Data folder might get deleted unexpectedly.</span></span> <span data-ttu-id="99f28-257">Certaines bases de données telles que SQL Server Compact stockent les fichiers de base de données dans l’application\_dossier de données.</span><span class="sxs-lookup"><span data-stu-id="99f28-257">Certain databases such as SQL Server Compact store database files in the App\_Data folder.</span></span> <span data-ttu-id="99f28-258">Après le déploiement initial, vous souhaitez conserver copie des fichiers de base de données dans les déploiements suivants afin de vous excluez une application\_données sous l’onglet Package/Publication Web. Après quoi, si vous disposez de supprimer des fichiers supplémentaires à la destination sélectionnée, vos fichiers de base de données et l’application\_dossier de données lui-même sera supprimé la prochaine fois que vous publiez.</span><span class="sxs-lookup"><span data-stu-id="99f28-258">After the initial deployment you don't want to keep copying the database files in subsequent deployments so you select  Exclude App\_Data on the Package/Publish Web tab. After you do that, if you have Remove additional files at destination selected, your database files and the App\_Data folder itself will be deleted the next time you publish.</span></span>

### <a name="configure-deployment-for-the-membership-database"></a><span data-ttu-id="99f28-259">Configurer le déploiement de la base de données d’appartenance</span><span class="sxs-lookup"><span data-stu-id="99f28-259">Configure deployment for the membership database</span></span>

<span data-ttu-id="99f28-260">Les étapes suivantes s’appliquent à la **DefaultConnection** de base de données dans le **bases de données** section de la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="99f28-260">The following steps apply to the **DefaultConnection** database in the **Databases** section of the dialog box.</span></span>

1. <span data-ttu-id="99f28-261">Dans le **chaîne de connexion à distance** , entrez la chaîne de connexion qui pointe vers la nouvelle base de l’appartenance de SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="99f28-261">In the **Remote connection string** box, enter the following connection string that points to the new SQL Server Express membership database.</span></span>

    [!code-console[Main](deploying-to-iis/samples/sample3.cmd)]

    <span data-ttu-id="99f28-262">Le processus de déploiement placera cette chaîne de connexion dans le fichier Web.config déployé, car **utiliser cette chaîne de connexion lors de l’exécution** est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="99f28-262">The deployment process will put this connection string in the deployed Web.config file because **Use this connection string at runtime** is selected.</span></span>

    <span data-ttu-id="99f28-263">Vous pouvez également obtenir la chaîne de connexion **Explorateur de serveurs**.</span><span class="sxs-lookup"><span data-stu-id="99f28-263">You can also get the connection string from **Server Explorer**.</span></span> <span data-ttu-id="99f28-264">Dans **Explorateur de serveurs**, développez **des connexions de données** et sélectionnez le  **&lt;machinename&gt;\sqlexpress.aspnet-ContosoUniversity** base de données, puis à partir de la **propriétés** copie de la fenêtre la **chaîne de connexion** valeur.</span><span class="sxs-lookup"><span data-stu-id="99f28-264">In **Server Explorer**, expand **Data Connections** and select the **&lt;machinename&gt;\sqlexpress.aspnet-ContosoUniversity** database, then from the **Properties** window copy the **Connection String** value.</span></span> <span data-ttu-id="99f28-265">Qu’un seul paramètre supplémentaire que vous pouvez supprimer dans la chaîne de connexion : `Pooling=False`.</span><span class="sxs-lookup"><span data-stu-id="99f28-265">That connection string will have one additional setting that you can delete: `Pooling=False`.</span></span>
2. <span data-ttu-id="99f28-266">Sélectionnez **base de données de mise à jour**.</span><span class="sxs-lookup"><span data-stu-id="99f28-266">Select **Update database**.</span></span>

    <span data-ttu-id="99f28-267">Cela entraîne le schéma de base de données à créer dans la base de données de destination pendant le déploiement.</span><span class="sxs-lookup"><span data-stu-id="99f28-267">This will cause the database schema to be created in the destination database during deployment.</span></span> <span data-ttu-id="99f28-268">Dans les étapes suivantes, vous spécifiez des scripts supplémentaires dont vous avez besoin pour exécuter : une pour accorder l’accès de base de données vers le pool d’applications par défaut et pour déployer des données.</span><span class="sxs-lookup"><span data-stu-id="99f28-268">In the following steps you specify the additional scripts that you need to run: one to grant database access to the default application pool and one to deploy data.</span></span>
3. <span data-ttu-id="99f28-269">Cliquez sur **configurer des mises à jour de la base de données**.</span><span class="sxs-lookup"><span data-stu-id="99f28-269">Click **Configure database updates**.</span></span>
4. <span data-ttu-id="99f28-270">Dans le **configurer les mises à jour de base de données** boîte de dialogue, cliquez sur **ajouter un Script SQL** , puis accédez à la *Grant.sql* script que vous avez enregistré précédemment dans le dossier de solution.</span><span class="sxs-lookup"><span data-stu-id="99f28-270">In the **Configure Database Updates** dialog box, click **Add SQL Script** and then navigate to the *Grant.sql* script that you saved earlier in the solution folder.</span></span>
5. <span data-ttu-id="99f28-271">Répétez le processus pour ajouter le *aspnet-data-dev.sql* script.</span><span class="sxs-lookup"><span data-stu-id="99f28-271">Repeat the process to add the *aspnet-data-dev.sql* script.</span></span>

    ![Configurer les mises à jour de la base de données pour la base de données d’appartenance](deploying-to-iis/_static/image16.png)
6. <span data-ttu-id="99f28-273">Cliquez sur **Fermer**.</span><span class="sxs-lookup"><span data-stu-id="99f28-273">Click **Close**.</span></span>

### <a name="configure-deployment-for-the-application-database"></a><span data-ttu-id="99f28-274">Configurer le déploiement de la base de données d’application</span><span class="sxs-lookup"><span data-stu-id="99f28-274">Configure deployment for the application database</span></span>

<span data-ttu-id="99f28-275">Lorsque Visual Studio détecte un Entity Framework `DbContext` (classe), il crée une entrée dans le **bases de données** section a un **Execute Code First Migrations** au lieu de case à cocher une  **Mettre à jour de la base de données** case à cocher.</span><span class="sxs-lookup"><span data-stu-id="99f28-275">When Visual Studio detects an Entity Framework `DbContext` class, it creates an entry in the **Databases** section that has an **Execute Code First Migrations** check box instead of an **Update Database** check box.</span></span> <span data-ttu-id="99f28-276">Pour ce didacticiel, vous utiliserez cette case à cocher pour spécifier le déploiement de Migrations Code First.</span><span class="sxs-lookup"><span data-stu-id="99f28-276">For this tutorial you'll use that check box to specify Code First Migrations deployment.</span></span>

<span data-ttu-id="99f28-277">Dans certains scénarios, vous utilisez peut-être un `DbContext` base de données mais que vous souhaitez utiliser le fournisseur dbDacFx au lieu de Migrations pour déployer la base de données.</span><span class="sxs-lookup"><span data-stu-id="99f28-277">In some scenarios, you might be using a `DbContext` database but you want to use the dbDacFx provider instead of Migrations to deploy the database.</span></span> <span data-ttu-id="99f28-278">Dans ce cas, consultez [comment déployer une base de données Code First sans Migrations ?](https://msdn.microsoft.com/library/ee942158.aspx#deploy_code_first_without_migrations) dans le Forum aux questions de déploiement Web ASP.NET sur MSDN.</span><span class="sxs-lookup"><span data-stu-id="99f28-278">In that case, see [How do I deploy a Code First database without Migrations?](https://msdn.microsoft.com/library/ee942158.aspx#deploy_code_first_without_migrations) in the ASP.NET Web Deployment FAQ on MSDN.</span></span>

<span data-ttu-id="99f28-279">Les étapes suivantes s’appliquent à la **SchoolContext** de base de données dans le **bases de données** section de la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="99f28-279">The following steps apply to the **SchoolContext** database in the **Databases** section of the dialog box.</span></span>

1. <span data-ttu-id="99f28-280">Dans le **chaîne de connexion à distance** , entrez la chaîne de connexion qui pointe vers la nouvelle base d’application SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="99f28-280">In the **Remote connection string** box, enter the following connection string that points to the new SQL Server Express application database.</span></span>

    [!code-console[Main](deploying-to-iis/samples/sample4.cmd)]

    <span data-ttu-id="99f28-281">Le processus de déploiement placera cette chaîne de connexion dans le fichier Web.config déployé, car **utiliser cette chaîne de connexion lors de l’exécution** est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="99f28-281">The deployment process will put this connection string in the deployed Web.config file because **Use this connection string at runtime** is selected.</span></span>

    <span data-ttu-id="99f28-282">Vous pouvez également obtenir la chaîne de connexion de base de données application **Explorateur de serveurs** la même façon que vous avez obtenu l’appartenance de base de données de la chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="99f28-282">You can also get the application database connection string from **Server Explorer** the same way you got the membership database connection string.</span></span>
2. <span data-ttu-id="99f28-283">Sélectionnez **exécuter les Migrations Code First (s’exécute sur le démarrage de l’application)**.</span><span class="sxs-lookup"><span data-stu-id="99f28-283">Select **Execute Code First Migrations (runs on application start)**.</span></span>

    <span data-ttu-id="99f28-284">Cette option provoque le processus de déploiement configurer le fichier Web.config déployé pour spécifier le `MigrateDatabaseToLatestVersion` initialiseur.</span><span class="sxs-lookup"><span data-stu-id="99f28-284">This option causes the deployment process to configure the deployed Web.config file to specify the `MigrateDatabaseToLatestVersion` initializer.</span></span> <span data-ttu-id="99f28-285">Cet initialiseur met automatiquement à jour la base de données vers la dernière version lors de l’application accède à la base de données pour la première fois après le déploiement.</span><span class="sxs-lookup"><span data-stu-id="99f28-285">This initializer automatically updates the database to the latest version when the application accesses the database for the first time after deployment.</span></span>

### <a name="configure-publish-profile-transforms"></a><span data-ttu-id="99f28-286">Configurer des transformations de profil de publication</span><span class="sxs-lookup"><span data-stu-id="99f28-286">Configure publish profile transforms</span></span>

1. <span data-ttu-id="99f28-287">Cliquez sur **fermer**, puis cliquez sur **Oui** lorsque le système vous demande si vous souhaitez enregistrer les modifications.</span><span class="sxs-lookup"><span data-stu-id="99f28-287">Click **Close**, and then click **Yes** when you are asked if you want to save changes.</span></span>
2. <span data-ttu-id="99f28-288">Dans **l’Explorateur de solutions**, développez **propriétés**, développez **PublishProfiles**.</span><span class="sxs-lookup"><span data-stu-id="99f28-288">In **Solution Explorer**, expand **Properties**, expand **PublishProfiles**.</span></span>
3. <span data-ttu-id="99f28-289">Cliquez sur Rright *Test.pubxml,* puis cliquez sur **ajouter une transformation de Config**.</span><span class="sxs-lookup"><span data-stu-id="99f28-289">Rright-click *Test.pubxml,* and then click **Add Config Transform**.</span></span>

    ![Ajouter un menu de transformation de configuration](deploying-to-iis/_static/image17.png)

    <span data-ttu-id="99f28-291">Visual Studio crée le *Web.Test.config* fichier de transformation et l’ouvre.</span><span class="sxs-lookup"><span data-stu-id="99f28-291">Visual Studio creates the *Web.Test.config* transform file and opens it.</span></span>
4. <span data-ttu-id="99f28-292">Dans le *Web.Test.config* de transformer le fichier, insérez le code suivant immédiatement après l’ouverture balise de configuration.</span><span class="sxs-lookup"><span data-stu-id="99f28-292">In the *Web.Test.config* transform file, insert the following code immediately after the opening configuration tag.</span></span>

    [!code-xml[Main](deploying-to-iis/samples/sample5.xml)]

    <span data-ttu-id="99f28-293">Lorsque vous utilisez le Test de profil de publication, cette transformation permet de définir l’indicateur d’environnement à « Test ».</span><span class="sxs-lookup"><span data-stu-id="99f28-293">When you use the Test publish profile, this transform sets the environment indicator to "Test".</span></span> <span data-ttu-id="99f28-294">Dans le site déployé, vous voyez « (Test) » après le titre H1 de « Contoso University ».</span><span class="sxs-lookup"><span data-stu-id="99f28-294">In the deployed site you'll see "(Test)" after the "Contoso University" H1 heading.</span></span>
5. <span data-ttu-id="99f28-295">Enregistrez et fermez le fichier.</span><span class="sxs-lookup"><span data-stu-id="99f28-295">Save and close the file.</span></span>
6. <span data-ttu-id="99f28-296">Avec le bouton droit le *Web.Test.config* de fichier et cliquez sur **aperçu transformer** pour vous assurer que la transformation que vous avez codée produit les modifications attendues.</span><span class="sxs-lookup"><span data-stu-id="99f28-296">Right-click the *Web.Test.config* file and click **Preview Transform** to make sure that the transform you coded produces the expected changes.</span></span>

    <span data-ttu-id="99f28-297">Le **Web.config aperçu** fenêtre affiche le résultat de l’appliquer à la fois le *Web.Release.config* transforme et *Web.Test.config* transforme.</span><span class="sxs-lookup"><span data-stu-id="99f28-297">The **Web.config Preview** window shows the result of applying both the *Web.Release.config* transforms and the *Web.Test.config* transforms.</span></span>

### <a name="preview-the-deployment-updates"></a><span data-ttu-id="99f28-298">Afficher un aperçu du déploiement de mises à jour</span><span class="sxs-lookup"><span data-stu-id="99f28-298">Preview the deployment updates</span></span>

1. <span data-ttu-id="99f28-299">Ouvrez le **publier le site Web** Assistant (cliquez sur le projet ContosoUniversity et cliquez sur **publier**).</span><span class="sxs-lookup"><span data-stu-id="99f28-299">Open the **Publish Web** wizard again (right-click the ContosoUniversity project and click **Publish**).</span></span>
2. <span data-ttu-id="99f28-300">Dans le **aperçu** onglet, assurez-vous que le **Test** profil est toujours sélectionné, puis cliquez sur **démarrer l’aperçu** pour afficher la liste des fichiers qui seront copiés.</span><span class="sxs-lookup"><span data-stu-id="99f28-300">In the **Preview** tab, make sure that the **Test** profile is still selected, and then click **Start Preview** to see a list of the files that will be copied.</span></span>

    ![Bouton d’aperçu](deploying-to-iis/_static/image18.png)

    ![Aperçu de la publication](deploying-to-iis/_static/image19.png)

    <span data-ttu-id="99f28-303">Vous pouvez également cliquer sur le **base de données de la version préliminaire** lien pour afficher les scripts qui seront exécute dans la base de données d’appartenance.</span><span class="sxs-lookup"><span data-stu-id="99f28-303">You can also click the **Preview database** link to see the scripts that will run in the membership database.</span></span> <span data-ttu-id="99f28-304">(Aucune scripts ne sont exécutés pour le déploiement de Migrations Code First, donc rien pour afficher un aperçu de la base de données d’application.)</span><span class="sxs-lookup"><span data-stu-id="99f28-304">(No scripts are run for Code First Migrations deployment, so there is nothing to preview for the application database.)</span></span>
3. <span data-ttu-id="99f28-305">Cliquez sur **Publier**.</span><span class="sxs-lookup"><span data-stu-id="99f28-305">Click **Publish**.</span></span>

    <span data-ttu-id="99f28-306">Si Visual Studio n’est pas en mode administrateur, vous pouvez obtenir un message d’erreur qui indique une erreur d’autorisations.</span><span class="sxs-lookup"><span data-stu-id="99f28-306">If Visual Studio is not in administrator mode, you might get an error message that indicates a permissions error.</span></span> <span data-ttu-id="99f28-307">Dans ce cas, fermez Visual Studio, ouvrez-le en mode administrateur et réessayez la publication.</span><span class="sxs-lookup"><span data-stu-id="99f28-307">In that case, close Visual Studio, open it in administrator mode, and try to publish again.</span></span>

    <span data-ttu-id="99f28-308">Si Visual Studio est en mode administrateur, le **sortie** rapports réussie de la fenêtre générer et publier.</span><span class="sxs-lookup"><span data-stu-id="99f28-308">If Visual Studio is in administrator mode, the **Output** window reports successful build and publish.</span></span>

    ![Output_window_publish_Test](deploying-to-iis/_static/image20.png)

    <span data-ttu-id="99f28-310">Si vous avez entré l’URL dans le **URL de Destination** boîte sur le profil de publication **connexion** onglet, le navigateur s’ouvre automatiquement à la page d’accueil de l’Université de Contoso s’exécutant dans IIS sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="99f28-310">If you entered the URL in the **Destination URL** box on the publish profile **Connection** tab, the browser automatically opens to the Contoso University Home page running in IIS on the local computer.</span></span>

## <a name="test-in-the-test-environment"></a><span data-ttu-id="99f28-311">Tester dans l’environnement de test</span><span class="sxs-lookup"><span data-stu-id="99f28-311">Test in the test environment</span></span>

<span data-ttu-id="99f28-312">Notez que l’indicateur de l’environnement affiche « (Test) » au lieu de « (Dev) », qui montre que le *Web.config* transformation pour l’indicateur de l’environnement a réussi.</span><span class="sxs-lookup"><span data-stu-id="99f28-312">Notice that the environment indicator shows "(Test)" instead of "(Dev)", which shows that the *Web.config* transformation for the environment indicator was successful.</span></span>

<span data-ttu-id="99f28-313">Exécutez le **formateurs** page pour vérifier que le premier Code amorcée avec des données de l’instructeur.</span><span class="sxs-lookup"><span data-stu-id="99f28-313">Run the **Instructors** page to verify that Code First seeded the database with instructor data.</span></span> <span data-ttu-id="99f28-314">Lorsque vous sélectionnez cette page, il peut prendre quelques minutes à charger, car le Code First crée la base de données, puis exécute le `Seed` (méthode).</span><span class="sxs-lookup"><span data-stu-id="99f28-314">When you select this page, it may take a few minutes to load because Code First creates the database and then runs the `Seed` method.</span></span> <span data-ttu-id="99f28-315">(Il n’a pas le faire quand vous étiez sur la page d’accueil, car l’application n’a pas tenter d’accéder à la base de données encore.)</span><span class="sxs-lookup"><span data-stu-id="99f28-315">(It didn't do that when you were on the home page because the application didn't try to access the database yet.)</span></span>

<span data-ttu-id="99f28-316">Cliquez sur le **étudiants** onglet pour vérifier ne qu’aucun étudiant à la base de données déployée.</span><span class="sxs-lookup"><span data-stu-id="99f28-316">Click the **Students** tab to verify that the deployed database has no students.</span></span>

<span data-ttu-id="99f28-317">Sélectionnez **étudiants ajouter** à partir de la **étudiants** menu, ajouter un étudiant et afficher le nouvel étudiant dans la **étudiants** page pour vérifier que vous pouvez écrire avec succès à la base de données .</span><span class="sxs-lookup"><span data-stu-id="99f28-317">Select **Add Students** from the **Students** menu, add a student, and then view the new student in the **Students** page to verify that you can successfully write to the database.</span></span>

<span data-ttu-id="99f28-318">À partir de la **cours** menu, sélectionnez **crédits de la mise à jour**.</span><span class="sxs-lookup"><span data-stu-id="99f28-318">From the **Courses** menu, select **Update Credits**.</span></span> <span data-ttu-id="99f28-319">Le **crédits de la mise à jour** page requiert des autorisations d’administrateur, par conséquent, le **Log In** page s’affiche.</span><span class="sxs-lookup"><span data-stu-id="99f28-319">The **Update Credits** page requires administrator permissions, so the **Log In** page is displayed.</span></span> <span data-ttu-id="99f28-320">Entrez les informations d’identification du compte administrateur que vous avez créé plus haut (« admin » et « devpwd »).</span><span class="sxs-lookup"><span data-stu-id="99f28-320">Enter the administrator account credentials that you created earlier ("admin" and "devpwd").</span></span> <span data-ttu-id="99f28-321">Le **mise à jour crédits** page s’affiche, qui vérifie que le compte d’administrateur que vous avez créé dans le didacticiel précédent a été correctement déployé sur l’environnement de test.</span><span class="sxs-lookup"><span data-stu-id="99f28-321">The **Update Credits** page is displayed, which verifies that the administrator account that you created in the previous tutorial was correctly deployed to the test environment.</span></span>

<span data-ttu-id="99f28-322">Vérifiez qu’un *Elmah* dossier existe dans le *c:\inetpub\wwwroot\ContosoUniversity* dossier avec uniquement le fichier d’espace réservé qu’il contient.</span><span class="sxs-lookup"><span data-stu-id="99f28-322">Verify that an *Elmah* folder exists in the *c:\inetpub\wwwroot\ContosoUniversity* folder with only the placeholder file in it.</span></span>

<a id="reviewingmigrations"></a>

## <a name="review-the-automatic-webconfig-changes-for-code-first-migrations"></a><span data-ttu-id="99f28-323">Passez en revue les modifications de Web.config automatique pour les Migrations Code First</span><span class="sxs-lookup"><span data-stu-id="99f28-323">Review the automatic Web.config changes for Code First Migrations</span></span>

<span data-ttu-id="99f28-324">Ouvrez le *Web.config* fichier dans l’application déployée sur *C:\inetpub\wwwroot\ContosoUniversity* et vous pouvez voir où le processus de déploiement configuré Migrations Code First pour automatiquement mettre à jour la base de données vers la dernière version.</span><span class="sxs-lookup"><span data-stu-id="99f28-324">Open the *Web.config* file in the deployed application at *C:\inetpub\wwwroot\ContosoUniversity* and you can see where the deployment process configured Code First Migrations to automatically update the database to the latest version.</span></span>

![](deploying-to-iis/_static/image21.png)

<span data-ttu-id="99f28-325">Le processus de déploiement créé également une nouvelle chaîne de connexion pour les Migrations Code First à utiliser exclusivement pour la mise à jour le schéma de base de données :</span><span class="sxs-lookup"><span data-stu-id="99f28-325">The deployment process also created a new connection string for Code First Migrations to use exclusively for updating the database schema:</span></span>

![Chaîne de connexion Database_Publish](deploying-to-iis/_static/image22.png)

<span data-ttu-id="99f28-327">Cette chaîne de connexion supplémentaires vous permet de spécifier un compte d’utilisateur pour les mises à jour du schéma de base de données et un autre compte d’utilisateur pour l’accès de données d’application.</span><span class="sxs-lookup"><span data-stu-id="99f28-327">This additional connection string enables you to specify one user account for database schema updates, and a different user account for application data access.</span></span> <span data-ttu-id="99f28-328">Par exemple, vous pouvez attribuer le **db\_propriétaire** rôle pour les Migrations Code First, et **db\_datareader** et **db\_datawriter**rôles à l’application.</span><span class="sxs-lookup"><span data-stu-id="99f28-328">For example, you could assign the **db\_owner** role to Code First Migrations, and **db\_datareader** and **db\_datawriter** roles to the application.</span></span> <span data-ttu-id="99f28-329">Il s’agit d’un modèle courant dans défense qui empêche le code potentiellement malveillant dans l’application à partir de la modification du schéma de base de données.</span><span class="sxs-lookup"><span data-stu-id="99f28-329">This is a common defense-in-depth pattern that prevents potentially malicious code in the application from changing the database schema.</span></span> <span data-ttu-id="99f28-330">(Par exemple, cela peut se produire dans une attaque d’injection SQL.) Ce modèle n’est pas utilisé par ces didacticiels.</span><span class="sxs-lookup"><span data-stu-id="99f28-330">(For example, this might happen in a successful SQL injection attack.) This pattern is not used by these tutorials.</span></span> <span data-ttu-id="99f28-331">Si vous souhaitez implémenter ce modèle dans votre scénario, vous pouvez le faire en effectuant les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="99f28-331">If you want to implement this pattern in your scenario, you can do it by performing the following steps:</span></span>

1. <span data-ttu-id="99f28-332">Dans le **paramètres** onglet de la **publier le site Web** Assistant, entrez la chaîne de connexion qui spécifie un utilisateur avec les autorisations de mise à jour de schéma de base de données complète et désactivez le **utiliser cette chaîne de connexion lors de l’exécution** case à cocher.</span><span class="sxs-lookup"><span data-stu-id="99f28-332">In the **Settings** tab of the **Publish Web** wizard, enter the connection string that specifies a user with full database schema update permissions, and clear the **Use this connection string at runtime** check box.</span></span> <span data-ttu-id="99f28-333">Dans le fichier Web.config déployé, cela devient le `DatabasePublish` chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="99f28-333">In the deployed Web.config file, this becomes the `DatabasePublish` connection string.</span></span>
2. <span data-ttu-id="99f28-334">Créer une transformation du fichier Web.config pour la chaîne de connexion que vous souhaitez que l’application à utiliser au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="99f28-334">Create a Web.config file transformation for the connection string that you want the application to use at run time.</span></span>

## <a name="summary"></a><span data-ttu-id="99f28-335">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="99f28-335">Summary</span></span>

<span data-ttu-id="99f28-336">Vous avez maintenant déployé votre application à IIS sur votre ordinateur de développement et testée il.</span><span class="sxs-lookup"><span data-stu-id="99f28-336">You have now deployed your application to IIS on your development computer and tested it there.</span></span>

![Page d’accueil dans le Test](deploying-to-iis/_static/image23.png)

<span data-ttu-id="99f28-338">Cela vérifie que le processus de déploiement copie le contenu de l’application vers l’emplacement approprié (à l’exclusion de fichiers que vous ne voulez pas déployer) et également que Web Deploy IIS correctement configuré pendant le déploiement.</span><span class="sxs-lookup"><span data-stu-id="99f28-338">This verifies that the deployment process copied the application's content to the right location (excluding the files that you did not want to deploy), and also that Web Deploy configured IIS correctly during deployment.</span></span> <span data-ttu-id="99f28-339">Dans le didacticiel suivant, vous allez exécuter un test supplémentaire qui recherche une tâche de déploiement qui n’a pas encore été effectuée : définition des autorisations de dossier sur le *Elmah* dossier.</span><span class="sxs-lookup"><span data-stu-id="99f28-339">In the next tutorial, you'll run one more test that finds a deployment task that has not yet been done: setting folder permissions on the *Elmah* folder.</span></span>

## <a name="more-information"></a><span data-ttu-id="99f28-340">Complément d'information</span><span class="sxs-lookup"><span data-stu-id="99f28-340">More information</span></span>

<span data-ttu-id="99f28-341">Pour plus d’informations sur l’exécution d’IIS ou IIS Express dans Visual Studio, consultez les ressources suivantes :</span><span class="sxs-lookup"><span data-stu-id="99f28-341">For information about running IIS or IIS Express in Visual Studio, see the following resources:</span></span>

- <span data-ttu-id="99f28-342">[Présentation d’IIS Express](https://www.iis.net/learn/extensions/introduction-to-iis-express/iis-express-overview) sur le site IIS.net.</span><span class="sxs-lookup"><span data-stu-id="99f28-342">[IIS Express Overview](https://www.iis.net/learn/extensions/introduction-to-iis-express/iis-express-overview) on the IIS.net site.</span></span>
- <span data-ttu-id="99f28-343">[Présentation d’IIS Express](https://weblogs.asp.net/scottgu/archive/2010/06/28/introducing-iis-express.aspx) sur le blog Guthrie.</span><span class="sxs-lookup"><span data-stu-id="99f28-343">[Introducing IIS Express](https://weblogs.asp.net/scottgu/archive/2010/06/28/introducing-iis-express.aspx) on Scott Guthrie's blog.</span></span>
- <span data-ttu-id="99f28-344">[Web des serveurs dans Visual Studio pour les projets Web ASP.NET](https://msdn.microsoft.com/library/58wxa9w5.aspx).</span><span class="sxs-lookup"><span data-stu-id="99f28-344">[Web Servers in Visual Studio for ASP.NET Web Projects](https://msdn.microsoft.com/library/58wxa9w5.aspx).</span></span>
- <span data-ttu-id="99f28-345">[Principales différences entre IIS et le serveur de développement ASP.NET](../../older-versions-getting-started/deploying-web-site-projects/core-differences-between-iis-and-the-asp-net-development-server-cs.md) sur le site ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="99f28-345">[Core Differences Between IIS and the ASP.NET Development Server](../../older-versions-getting-started/deploying-web-site-projects/core-differences-between-iis-and-the-asp-net-development-server-cs.md) on the ASP.NET site.</span></span>

<span data-ttu-id="99f28-346">Pour plus d’informations sur les problèmes pouvant survenir lorsque votre application s’exécute en mode de confiance moyenne, consultez [hébergeant les Applications ASP.NET en mode de confiance moyenne](http://www.4guysfromrolla.com/articles/100307-1.aspx) sur les 4 Guys Rolla site.</span><span class="sxs-lookup"><span data-stu-id="99f28-346">For information about what issues might arise when your application runs in medium trust, see [Hosting ASP.NET Applications in Medium Trust](http://www.4guysfromrolla.com/articles/100307-1.aspx) on the 4 Guys from Rolla site.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="99f28-347">[Précédent](project-properties.md)
> [Suivant](setting-folder-permissions.md)</span><span class="sxs-lookup"><span data-stu-id="99f28-347">[Previous](project-properties.md)
[Next](setting-folder-permissions.md)</span></span>
