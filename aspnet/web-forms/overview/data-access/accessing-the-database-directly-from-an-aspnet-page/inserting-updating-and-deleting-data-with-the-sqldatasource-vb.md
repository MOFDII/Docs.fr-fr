---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/inserting-updating-and-deleting-data-with-the-sqldatasource-vb
title: Insertion, mise à jour et suppression de données avec le SqlDataSource (VB) | Documents Microsoft
author: rick-anderson
description: Dans les didacticiels précédents, nous avons appris comment le contrôle ObjectDataSource est autorisée pour l’insertion, de mise à jour et de suppression de données. Le contrôle SqlDataSource prend en charge t...
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2007
ms.topic: article
ms.assetid: 9673bef3-892c-45ba-a7d8-0da3d6f48ec5
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/inserting-updating-and-deleting-data-with-the-sqldatasource-vb
msc.type: authoredcontent
ms.openlocfilehash: 92d195c3e1e349cd82e0625cf9a6c5a82644b5db
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/06/2018
ms.locfileid: "30877942"
---
<a name="inserting-updating-and-deleting-data-with-the-sqldatasource-vb"></a><span data-ttu-id="52948-104">Insertion, mise à jour et suppression de données avec le SqlDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="52948-104">Inserting, Updating, and Deleting Data with the SqlDataSource (VB)</span></span>
====================
<span data-ttu-id="52948-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="52948-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="52948-106">[Télécharger l’exemple d’application](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_49_VB.exe) ou [télécharger le PDF](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/datatutorial49vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="52948-106">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_49_VB.exe) or [Download PDF](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/datatutorial49vb1.pdf)</span></span>

> <span data-ttu-id="52948-107">Dans les didacticiels précédents, nous avons appris comment le contrôle ObjectDataSource est autorisée pour l’insertion, de mise à jour et de suppression de données.</span><span class="sxs-lookup"><span data-stu-id="52948-107">In previous tutorials we learned how the ObjectDataSource control allowed for inserting, updating, and deleting of data.</span></span> <span data-ttu-id="52948-108">Le contrôle SqlDataSource prend en charge les mêmes opérations, mais l’approche est différente, et ce didacticiel montre comment configurer le SqlDataSource pour insérer, mettre à jour et supprimer des données.</span><span class="sxs-lookup"><span data-stu-id="52948-108">The SqlDataSource control supports the same operations, but the approach is different, and this tutorial shows how to configure the SqlDataSource to insert, update, and delete data.</span></span>


## <a name="introduction"></a><span data-ttu-id="52948-109">Introduction</span><span class="sxs-lookup"><span data-stu-id="52948-109">Introduction</span></span>

<span data-ttu-id="52948-110">Comme indiqué dans [une vue d’ensemble d’insertion, mise à jour et suppression de](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md), le contrôle GridView fournit une mise à jour intégrée et prend en charge les fonctionnalités de suppression, tandis que les contrôles DetailsView et FormView incluent insertion avec modification et suppression de fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="52948-110">As discussed in [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md), the GridView control provides built-in updating and deleting capabilities, while the DetailsView and FormView controls include inserting support along with editing and deleting functionality.</span></span> <span data-ttu-id="52948-111">Ces fonctionnalités de modification de données peuvent être connectées directement à un contrôle de source de données sans une ligne de code devant être écrit.</span><span class="sxs-lookup"><span data-stu-id="52948-111">These data modification capabilities can be plugged directly into a data source control without a line of code needing to be written.</span></span> <span data-ttu-id="52948-112">[Une vue d’ensemble d’insertion, mise à jour et suppression](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) examiné à l’aide de ObjectDataSource pour faciliter l’insertion, de mise à jour et de suppression avec les contrôles GridView, DetailsView et FormView.</span><span class="sxs-lookup"><span data-stu-id="52948-112">[An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) examined using the ObjectDataSource to facilitate inserting, updating, and deleting with the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="52948-113">Le SqlDataSource peut également être utilisé à la place de ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="52948-113">Alternatively, the SqlDataSource can be used in place of the ObjectDataSource.</span></span>

<span data-ttu-id="52948-114">N’oubliez pas que pour prendre en charge d’insertion, de mise à jour et de suppression, avec ObjectDataSource dont nous avions besoin pour spécifier les méthodes de la couche objet pour appeler pour effectuer l’insertion, mise à jour ou supprimer l’action.</span><span class="sxs-lookup"><span data-stu-id="52948-114">Recall that to support inserting, updating, and deleting, with the ObjectDataSource we needed to specify the object layer methods to invoke to perform the insert, update, or delete action.</span></span> <span data-ttu-id="52948-115">Avec le SqlDataSource, nous devons fournir `INSERT`, `UPDATE`, et `DELETE` SQL instructions (ou les procédures stockées) à exécuter.</span><span class="sxs-lookup"><span data-stu-id="52948-115">With the SqlDataSource, we need to provide `INSERT`, `UPDATE`, and `DELETE` SQL statements (or stored procedures) to execute.</span></span> <span data-ttu-id="52948-116">Comme nous allons le voir dans ce didacticiel, ces instructions peuvent être créées manuellement ou peuvent être générées automatiquement par l’Assistant Configurer la Source de données de s SqlDataSource.</span><span class="sxs-lookup"><span data-stu-id="52948-116">As we'll see in this tutorial, these statements can be created manually or can be automatically generated by the SqlDataSource s Configure Data Source wizard.</span></span>

> [!NOTE]
> <span data-ttu-id="52948-117">Depuis que nous avons présenté précédemment l’insertion, modification et suppression des fonctionnalités du contrôle GridView, DetailsView et contrôle du FormView, ce didacticiel se concentrera sur la configuration du contrôle SqlDataSource pour prendre en charge ces opérations.</span><span class="sxs-lookup"><span data-stu-id="52948-117">Since we ve already discussed the inserting, editing, and deleting capabilities of the GridView, DetailsView, and FormView controls, this tutorial will focus on configuring the SqlDataSource control to support these operations.</span></span> <span data-ttu-id="52948-118">Si vous souhaitez rafraîchir vos connaissances sur l’implémentation de ces fonctionnalités dans le GridView, DetailsView et FormView, le retour pour les didacticiels de modification, d’insertion et de suppression des données, en commençant par [une vue d’ensemble d’insertion, mise à jour et suppression de](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md).</span><span class="sxs-lookup"><span data-stu-id="52948-118">If you need to brush up on implementing these features within the GridView, DetailsView, and FormView, return to the Editing, Inserting, and Deleting Data tutorials, starting with [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md).</span></span>


## <a name="step-1-specifyinginsertupdate-anddeletestatements"></a><span data-ttu-id="52948-119">Étape 1 : Spécifier`INSERT`,`UPDATE`, et`DELETE`instructions</span><span class="sxs-lookup"><span data-stu-id="52948-119">Step 1: Specifying`INSERT`,`UPDATE`, and`DELETE`Statements</span></span>

<span data-ttu-id="52948-120">Comme nous avons vu dans les deux derniers didacticiels, pour récupérer des données à partir d’un contrôle SqlDataSource que nous devons définir deux propriétés :</span><span class="sxs-lookup"><span data-stu-id="52948-120">As we ve seen in the past two tutorials, to retrieve data from a SqlDataSource control we need to set two properties:</span></span>

1. <span data-ttu-id="52948-121">`ConnectionString`, qui spécifie ce que la base de données pour envoyer la requête, et</span><span class="sxs-lookup"><span data-stu-id="52948-121">`ConnectionString`, which specifies what database to send the query to, and</span></span>
2. <span data-ttu-id="52948-122">`SelectCommand`, qui spécifie l’instruction SQL d’ad hoc ou le nom de la procédure stockée à exécuter pour retourner les résultats.</span><span class="sxs-lookup"><span data-stu-id="52948-122">`SelectCommand`, which specifies the ad-hoc SQL statement or stored procedure name to execute to return the results.</span></span>

<span data-ttu-id="52948-123">Pour `SelectCommand` valeurs avec des paramètres, le paramètre de valeurs sont spécifiées via le s SqlDataSource `SelectParameters` collection et peuvent inclure des valeurs codées en dur, les valeurs des paramètres communs source (champs querystring, variables de session, les valeurs de contrôle Web, et ainsi de suite), ou peut être affecté par programme.</span><span class="sxs-lookup"><span data-stu-id="52948-123">For `SelectCommand` values with parameters, the parameter values are specified via the SqlDataSource s `SelectParameters` collection and can include hard-coded values, common parameter source values (querystring fields, session variables, Web control values, and so on), or can be programmatically assigned.</span></span> <span data-ttu-id="52948-124">Lorsque le contrôle le SqlDataSource s `Select()` méthode est appelée automatiquement ou par programme à partir d’un contrôle Web de données est d’établir une connexion à la base de données, les valeurs de paramètre sont assignées à la requête et la commande est le déclenchement à la base de données.</span><span class="sxs-lookup"><span data-stu-id="52948-124">When the SqlDataSource control s `Select()` method is invoked either programmatically or automatically from a data Web control a connection to the database is established, the parameter values are assigned to the query, and the command is shuttled off to the database.</span></span> <span data-ttu-id="52948-125">Les résultats sont retournés puis comme un jeu de données ou un DataReader, selon la valeur de la commande s `DataSourceMode` propriété.</span><span class="sxs-lookup"><span data-stu-id="52948-125">The results are then returned as either a DataSet or DataReader, depending on the value of the control s `DataSourceMode` property.</span></span>

<span data-ttu-id="52948-126">En même temps que la sélection de données, le contrôle de SqlDataSource peut être utilisé pour insérer, mettre à jour et supprimer des données, vous devez fournir `INSERT`, `UPDATE`, et `DELETE` les instructions SQL de la même façon.</span><span class="sxs-lookup"><span data-stu-id="52948-126">Along with selecting data, the SqlDataSource control can be used to insert, update, and delete data by supplying `INSERT`, `UPDATE`, and `DELETE` SQL statements in much the same way.</span></span> <span data-ttu-id="52948-127">Il vous suffit d’affecter la `InsertCommand`, `UpdateCommand`, et `DeleteCommand` propriétés le `INSERT`, `UPDATE`, et `DELETE` les instructions SQL à exécuter.</span><span class="sxs-lookup"><span data-stu-id="52948-127">Simply assign the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties the `INSERT`, `UPDATE`, and `DELETE` SQL statements to execute.</span></span> <span data-ttu-id="52948-128">Si les instructions ont des paramètres (car ils ne seront plus toujours), les inclure dans le `InsertParameters`, `UpdateParameters`, et `DeleteParameters` collections.</span><span class="sxs-lookup"><span data-stu-id="52948-128">If the statements have parameters (as they most always will), include them in the `InsertParameters`, `UpdateParameters`, and `DeleteParameters` collections.</span></span>

<span data-ttu-id="52948-129">Une fois un `InsertCommand`, `UpdateCommand`, ou `DeleteCommand` valeur a été spécifiée, l’option Activer l’insertion, activer la modification ou suppression de l’activer dans les données correspondantes de balise active du contrôle s Web devient disponible.</span><span class="sxs-lookup"><span data-stu-id="52948-129">Once an `InsertCommand`, `UpdateCommand`, or `DeleteCommand` value has been specified, the Enable Inserting, Enable Editing, or Enable Deleting option in the corresponding data Web control s smart tag will become available.</span></span> <span data-ttu-id="52948-130">Pour illustrer cela, permettent de s Prenons l’exemple à partir de la `Querying.aspx` page que nous avons créé dans le [interrogation des données avec le contrôle SqlDataSource](querying-data-with-the-sqldatasource-control-vb.md) didacticiel et accroître cela pour inclure la suppression de fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="52948-130">To illustrate this, let s take an example from the `Querying.aspx` page we created in the [Querying Data with the SqlDataSource Control](querying-data-with-the-sqldatasource-control-vb.md) tutorial and augment it to include delete capabilities.</span></span>

<span data-ttu-id="52948-131">Commencez par ouvrir le `InsertUpdateDelete.aspx` et `Querying.aspx` les pages à partir du `SqlDataSource` dossier.</span><span class="sxs-lookup"><span data-stu-id="52948-131">Start by opening the `InsertUpdateDelete.aspx` and `Querying.aspx` pages from the `SqlDataSource` folder.</span></span> <span data-ttu-id="52948-132">À partir du concepteur sur le `Querying.aspx` , sélectionnez le SqlDataSource et GridView dans le premier exemple (le `ProductsDataSource` et `GridView1` contrôles).</span><span class="sxs-lookup"><span data-stu-id="52948-132">From the Designer on the `Querying.aspx` page, select the SqlDataSource and GridView from the first example (the `ProductsDataSource` and `GridView1` controls).</span></span> <span data-ttu-id="52948-133">Après avoir sélectionné les deux contrôles, accédez au menu Edition et choisissez Copier (ou simplement appuyer sur Ctrl + C).</span><span class="sxs-lookup"><span data-stu-id="52948-133">After selecting the two controls, go to the Edit menu and choose Copy (or just hit Ctrl+C).</span></span> <span data-ttu-id="52948-134">Ensuite, accédez au Concepteur de `InsertUpdateDelete.aspx` et collez dans les contrôles.</span><span class="sxs-lookup"><span data-stu-id="52948-134">Next, go to the Designer of `InsertUpdateDelete.aspx` and paste in the controls.</span></span> <span data-ttu-id="52948-135">Après avoir déplacé les deux contrôles à `InsertUpdateDelete.aspx`, tester la page dans un navigateur.</span><span class="sxs-lookup"><span data-stu-id="52948-135">After you have moved the two controls over to `InsertUpdateDelete.aspx`, test out the page in a browser.</span></span> <span data-ttu-id="52948-136">Vous devez voir les valeurs de la `ProductID`, `ProductName`, et `UnitPrice` colonnes pour tous les enregistrements dans la `Products` table de base de données.</span><span class="sxs-lookup"><span data-stu-id="52948-136">You should see the values of the `ProductID`, `ProductName`, and `UnitPrice` columns for all of the records in the `Products` database table.</span></span>


<span data-ttu-id="52948-137">[![Tous les produits répertoriés, classés par ProductID](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="52948-137">[![All of the Products are Listed, Ordered by ProductID](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.png)</span></span>

<span data-ttu-id="52948-138">**Figure 1**: tous les produits répertoriés, classés par `ProductID` ([cliquez pour afficher l’image en taille réelle](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="52948-138">**Figure 1**: All of the Products are Listed, Ordered by `ProductID` ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image2.png))</span></span>


## <a name="adding-the-sqldatasource-sdeletecommandanddeleteparametersproperties"></a><span data-ttu-id="52948-139">Ajout de la s SqlDataSource`DeleteCommand`et`DeleteParameters`propriétés</span><span class="sxs-lookup"><span data-stu-id="52948-139">Adding the SqlDataSource s`DeleteCommand`and`DeleteParameters`Properties</span></span>

<span data-ttu-id="52948-140">À ce stade, nous avons un SqlDataSource qui renvoie simplement tous les enregistrements à partir de la `Products` table et un GridView qui affiche ces données.</span><span class="sxs-lookup"><span data-stu-id="52948-140">At this point we have a SqlDataSource that simply returns all of the records from the `Products` table and a GridView that renders this data.</span></span> <span data-ttu-id="52948-141">Notre objectif est d’étendre cet exemple pour autoriser l’utilisateur à supprimer des produits via le contrôle GridView.</span><span class="sxs-lookup"><span data-stu-id="52948-141">Our goal is to extend this example to allow for the user to delete products via the GridView.</span></span> <span data-ttu-id="52948-142">Pour cela nous avons besoin de spécifier des valeurs pour le contrôle SqlDataSource s `DeleteCommand` et `DeleteParameters` propriétés, puis configurer le contrôle GridView pour prendre en charge la suppression.</span><span class="sxs-lookup"><span data-stu-id="52948-142">To accomplish this we need to specify values for the SqlDataSource control s `DeleteCommand` and `DeleteParameters` properties and then configure the GridView to support deleting.</span></span>

<span data-ttu-id="52948-143">Le `DeleteCommand` et `DeleteParameters` propriétés peuvent être spécifiées de plusieurs manières :</span><span class="sxs-lookup"><span data-stu-id="52948-143">The `DeleteCommand` and `DeleteParameters` properties can be specified in a number of ways:</span></span>

- <span data-ttu-id="52948-144">Via la syntaxe déclarative</span><span class="sxs-lookup"><span data-stu-id="52948-144">Through the declarative syntax</span></span>
- <span data-ttu-id="52948-145">Dans la fenêtre Propriétés dans le Concepteur</span><span class="sxs-lookup"><span data-stu-id="52948-145">From the Properties window in the Designer</span></span>
- <span data-ttu-id="52948-146">À partir de l’écran de procédure stockée dans l’Assistant Configurer la Source de données ou de spécifier une instruction SQL personnalisée</span><span class="sxs-lookup"><span data-stu-id="52948-146">From the Specify a custom SQL statement or stored procedure screen in the Configure Data Source wizard</span></span>
- <span data-ttu-id="52948-147">Via le bouton Avancé dans les spécifiez les colonnes d’une table de l’écran d’affichage dans l’Assistant Configurer la Source de données, ce qui génère réellement automatiquement le `DELETE` collection d’instructions et des paramètres SQL utilisée dans les `DeleteCommand` et `DeleteParameters` propriétés</span><span class="sxs-lookup"><span data-stu-id="52948-147">Via the Advanced button in the Specify columns from a table of view screen in the Configure Data Source wizard, which will actually automatically generate the `DELETE` SQL statement and parameter collection used in the `DeleteCommand` and `DeleteParameters` properties</span></span>

<span data-ttu-id="52948-148">Nous allons examiner comment disposent automatiquement de la `DELETE` instruction créée à l’étape 2.</span><span class="sxs-lookup"><span data-stu-id="52948-148">We'll examine how to automatically have the `DELETE` statement created in Step 2.</span></span> <span data-ttu-id="52948-149">Pour l’instant, permettent de s utiliser la fenêtre Propriétés dans le concepteur, bien que l’Assistant Configurer la Source de données ou l’option de la syntaxe déclarative fonctionne aussi bien.</span><span class="sxs-lookup"><span data-stu-id="52948-149">For now, let s use the Properties window in the Designer, although the Configure Data Source wizard or declarative syntax option would work just as well.</span></span>

<span data-ttu-id="52948-150">À partir du concepteur dans `InsertUpdateDelete.aspx`, cliquez sur le `ProductsDataSource` SqlDataSource puis affichez la fenêtre Propriétés (dans le menu Affichage, cliquez sur fenêtre Propriétés, ou simplement appuyer sur F4).</span><span class="sxs-lookup"><span data-stu-id="52948-150">From the Designer in `InsertUpdateDelete.aspx`, click on the `ProductsDataSource` SqlDataSource and then bring up the Properties window (from the View menu, choose Properties window, or simply hit F4).</span></span> <span data-ttu-id="52948-151">Sélectionnez la propriété DeleteQuery, qui fera apparaître un ensemble de points de suspension.</span><span class="sxs-lookup"><span data-stu-id="52948-151">Select the DeleteQuery property, which will bring up a set of ellipses.</span></span>


![Sélectionnez la propriété DeleteQuery à partir de la fenêtre Propriétés](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image2.gif)

<span data-ttu-id="52948-153">**Figure 2**: sélectionnez la propriété DeleteQuery à partir de la fenêtre Propriétés</span><span class="sxs-lookup"><span data-stu-id="52948-153">**Figure 2**: Select the DeleteQuery Property from the Properties Window</span></span>


> [!NOTE]
> <span data-ttu-id="52948-154">Le SqlDataSource n’a une propriété DeleteQuery.</span><span class="sxs-lookup"><span data-stu-id="52948-154">The SqlDataSource doesn t have a DeleteQuery property.</span></span> <span data-ttu-id="52948-155">Au lieu de cela, DeleteQuery est une combinaison de la `DeleteCommand` et `DeleteParameters` propriétés et est uniquement répertorié dans la fenêtre Propriétés lors de l’affichage de la fenêtre via le concepteur.</span><span class="sxs-lookup"><span data-stu-id="52948-155">Rather, DeleteQuery is a combination of the `DeleteCommand` and `DeleteParameters` properties and is only listed in the Properties window when viewing the window through the Designer.</span></span> <span data-ttu-id="52948-156">Si vous examinez la fenêtre Propriétés de la vue de Source, vous trouverez le `DeleteCommand` propriété à la place.</span><span class="sxs-lookup"><span data-stu-id="52948-156">If you are looking at the Properties window in the Source view, you'll find the `DeleteCommand` property instead.</span></span>


<span data-ttu-id="52948-157">Cliquez sur le bouton de sélection dans la propriété DeleteQuery pour afficher la boîte de dialogue Éditeur de commandes et paramètre zone (voir Figure 3).</span><span class="sxs-lookup"><span data-stu-id="52948-157">Click the ellipses in the DeleteQuery property to bring up the Command and Parameter Editor dialog box (see Figure 3).</span></span> <span data-ttu-id="52948-158">À partir de cette boîte de dialogue, vous pouvez spécifier la `DELETE` instruction SQL et spécifiez les paramètres.</span><span class="sxs-lookup"><span data-stu-id="52948-158">From this dialog box you can specify the `DELETE` SQL statement and specify the parameters.</span></span> <span data-ttu-id="52948-159">Entrez la requête suivante dans le `DELETE` zone de texte de commande (soit manuellement ou en utilisant le Générateur de requêtes, si vous préférez) :</span><span class="sxs-lookup"><span data-stu-id="52948-159">Enter the following query into the `DELETE` command textbox (either manually or using the Query Builder, if you prefer):</span></span>

[!code-sql[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/samples/sample1.sql)]

<span data-ttu-id="52948-160">Ensuite, cliquez sur le bouton Actualiser les paramètres pour ajouter le `@ProductID` paramètre à la liste des paramètres ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="52948-160">Next, click the Refresh Parameters button to add the `@ProductID` parameter to the list of parameters below.</span></span>


<span data-ttu-id="52948-161">[![Sélectionnez la propriété DeleteQuery à partir de la fenêtre Propriétés](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="52948-161">[![Select the DeleteQuery Property from the Properties Window](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.png)</span></span>

<span data-ttu-id="52948-162">**Figure 3**: sélectionnez la propriété DeleteQuery à partir de la fenêtre Propriétés ([cliquez pour afficher l’image en taille réelle](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="52948-162">**Figure 3**: Select the DeleteQuery Property from the Properties Window ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.png))</span></span>


<span data-ttu-id="52948-163">Faire *pas* fournir une valeur pour ce paramètre (laisser son paramètre source à None).</span><span class="sxs-lookup"><span data-stu-id="52948-163">Do *not* provide a value for this parameter (leave its Parameter source at None ).</span></span> <span data-ttu-id="52948-164">Une fois que nous ajoutons la prise en charge de suppression pour le contrôle GridView, le contrôle GridView fournit automatiquement cette valeur de paramètre, à l’aide de la valeur de son `DataKeys` collection de la ligne dont bouton Supprimer.</span><span class="sxs-lookup"><span data-stu-id="52948-164">Once we add deleting support to the GridView, the GridView will automatically supply this parameter value, using the value of its `DataKeys` collection for the row whose Delete button was clicked.</span></span>

> [!NOTE]
> <span data-ttu-id="52948-165">Le nom du paramètre utilisé dans le `DELETE` requête *doit* être le même que le nom de la `DataKeyNames` valeur dans le GridView, DetailsView ou FormView.</span><span class="sxs-lookup"><span data-stu-id="52948-165">The parameter name used in the `DELETE` query *must* be the same as the name of the `DataKeyNames` value in the GridView, DetailsView, or FormView.</span></span> <span data-ttu-id="52948-166">Autrement dit, le paramètre dans le `DELETE` instruction délibérément nommée `@ProductID` (au lieu de, par exemple, `@ID`), car le nom de colonne de clé primaire dans la table Products (et, par conséquent, la valeur DataKeyNames dans le GridView) est `ProductID`.</span><span class="sxs-lookup"><span data-stu-id="52948-166">That is, the parameter in the `DELETE` statement is purposefully named `@ProductID` (instead of, say, `@ID`), because the primary key column name in the Products table (and therefore the DataKeyNames value in the GridView) is `ProductID`.</span></span>


<span data-ttu-id="52948-167">Si le nom du paramètre et `DataKeyNames` correspondance de t ne valeur, le contrôle GridView ne peut pas affecter automatiquement le paramètre de la valeur à partir de la `DataKeys` collection.</span><span class="sxs-lookup"><span data-stu-id="52948-167">If the parameter name and `DataKeyNames` value doesn t match, the GridView cannot automatically assign the parameter the value from the `DataKeys` collection.</span></span>

<span data-ttu-id="52948-168">Après avoir entré les informations relatives à la suppression dans la boîte de dialogue Éditeur de commandes et paramètres, cliquez sur OK et accédez à la vue de Source pour examiner le balisage déclaratif résultant :</span><span class="sxs-lookup"><span data-stu-id="52948-168">After entering the delete-related information into the Command and Parameter Editor dialog box click OK and go to the Source view to examine the resulting declarative markup:</span></span>

[!code-aspx[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/samples/sample2.aspx)]

<span data-ttu-id="52948-169">Notez l’ajout de la `DeleteCommand` propriété, ainsi que les `<DeleteParameters>` section et l’objet de paramètre nommé `productID`.</span><span class="sxs-lookup"><span data-stu-id="52948-169">Note the addition of the `DeleteCommand` property as well as the `<DeleteParameters>` section and the Parameter object named `productID`.</span></span>

## <a name="configuring-the-gridview-for-deleting"></a><span data-ttu-id="52948-170">Configurer le contrôle GridView pour la suppression</span><span class="sxs-lookup"><span data-stu-id="52948-170">Configuring the GridView for Deleting</span></span>

<span data-ttu-id="52948-171">Avec le `DeleteCommand` propriété ajoutée, la balise active de GridView s contient désormais la possibilité d’activer la suppression.</span><span class="sxs-lookup"><span data-stu-id="52948-171">With the `DeleteCommand` property added, the GridView s smart tag now contains the Enable Deleting option.</span></span> <span data-ttu-id="52948-172">Pour commencer, activez cette case à cocher.</span><span class="sxs-lookup"><span data-stu-id="52948-172">Go ahead and check this checkbox.</span></span> <span data-ttu-id="52948-173">Comme indiqué dans [une vue d’ensemble d’insertion, mise à jour et suppression](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md), cela entraîne le contrôle GridView à ajouter un CommandField avec son `ShowDeleteButton` propriété `True`.</span><span class="sxs-lookup"><span data-stu-id="52948-173">As discussed in [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md), this causes the GridView to add a CommandField with its `ShowDeleteButton` property set to `True`.</span></span> <span data-ttu-id="52948-174">Comme la Figure 4 montre, lorsque la page est visitée via un navigateur, un bouton Supprimer est inclus.</span><span class="sxs-lookup"><span data-stu-id="52948-174">As Figure 4 shows, when the page is visited through a browser a Delete button is included.</span></span> <span data-ttu-id="52948-175">Cette page de test en supprimant certains produits.</span><span class="sxs-lookup"><span data-stu-id="52948-175">Test this page out by deleting some products.</span></span>


<span data-ttu-id="52948-176">[![Chaque ligne GridView inclut désormais un bouton Supprimer](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="52948-176">[![Each GridView Row Now Includes a Delete Button](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image5.png)</span></span>

<span data-ttu-id="52948-177">**Figure 4**: chaque ligne GridView inclut désormais un bouton Supprimer ([cliquez pour afficher l’image en taille réelle](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="52948-177">**Figure 4**: Each GridView Row Now Includes a Delete Button ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.png))</span></span>


<span data-ttu-id="52948-178">Lorsque vous cliquez sur un bouton Supprimer, une publication (postback) se produit, le contrôle GridView affecte le `ProductID` paramètre la valeur de la `DataKeys` valeur de la collection pour la ligne dont bouton Supprimer l’utilisateur a cliqué et appelle les opérations de mappage SqlDataSource `Delete()` (méthode).</span><span class="sxs-lookup"><span data-stu-id="52948-178">Upon clicking a Delete button, a postback occurs, the GridView assigns the `ProductID` parameter the value of the `DataKeys` collection value for the row whose Delete button was clicked, and invokes the SqlDataSource s `Delete()` method.</span></span> <span data-ttu-id="52948-179">Le contrôle SqlDataSource, puis se connecte à la base de données et exécute la `DELETE` instruction.</span><span class="sxs-lookup"><span data-stu-id="52948-179">The SqlDataSource control then connects to the database and executes the `DELETE` statement.</span></span> <span data-ttu-id="52948-180">Le contrôle GridView puis relie pour le SqlDataSource, récupérer et afficher l’ensemble actuel des produits (qui n’inclut plus l’enregistrement juste en cours de suppression).</span><span class="sxs-lookup"><span data-stu-id="52948-180">The GridView then rebinds to the SqlDataSource, getting back and displaying the current set of products (which no longer includes the just-deleted record).</span></span>

> [!NOTE]
> <span data-ttu-id="52948-181">Étant donné que le contrôle GridView utilise son `DataKeys` collection pour remplir les paramètres SqlDataSource, il s vitales qui s GridView `DataKeyNames` propriété être définie sur l’ou les colonnes qui constituent la clé primaire et que le s SqlDataSource `SelectCommand` retourne ces colonnes.</span><span class="sxs-lookup"><span data-stu-id="52948-181">Since the GridView uses its `DataKeys` collection to populate the SqlDataSource parameters, it s vital that the GridView s `DataKeyNames` property be set to the column(s) that constitute the primary key and that the SqlDataSource s `SelectCommand` returns these columns.</span></span> <span data-ttu-id="52948-182">En outre, il s important que le paramètre de nom dans le s SqlDataSource `DeleteCommand` a la valeur `@ProductID`.</span><span class="sxs-lookup"><span data-stu-id="52948-182">Moreover, it s important that the parameter name in the SqlDataSource s `DeleteCommand` is set to `@ProductID`.</span></span> <span data-ttu-id="52948-183">Si le `DataKeyNames` propriété n’est pas définie ou le paramètre n’est pas nommé `@ProductsID`, en cliquant sur le bouton Supprimer une publication (postback), tout en t gagné / supprimer un enregistrement.</span><span class="sxs-lookup"><span data-stu-id="52948-183">If the `DataKeyNames` property is not set or the parameter is not named `@ProductsID`, clicking the Delete button will cause a postback, but won t actually delete any record.</span></span>


<span data-ttu-id="52948-184">La figure 5 illustre cette interaction sous forme graphique.</span><span class="sxs-lookup"><span data-stu-id="52948-184">Figure 5 depicts this interaction graphically.</span></span> <span data-ttu-id="52948-185">Faire référence à la [examiner les événements associés insertion, mise à jour et suppression](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) didacticiel pour une présentation plus détaillée sur la chaîne d’événements associé d’insertion, de mise à jour et de suppression d’un contrôle Web de données.</span><span class="sxs-lookup"><span data-stu-id="52948-185">Refer back to the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial for a more detailed discussion on the chain of events associated with inserting, updating, and deleting from a data Web control.</span></span>


![Cliquez sur le bouton Supprimer dans le GridView appelle la méthode de Delete() s SqlDataSource](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image5.gif)

<span data-ttu-id="52948-187">**Figure 5**: en cliquant sur le bouton Supprimer dans le GridView appelle le s SqlDataSource `Delete()` (méthode)</span><span class="sxs-lookup"><span data-stu-id="52948-187">**Figure 5**: Clicking the Delete Button in the GridView Invokes the SqlDataSource s `Delete()` Method</span></span>


## <a name="step-2-automatically-generating-theinsertupdate-anddeletestatements"></a><span data-ttu-id="52948-188">Étape 2 : Générer automatiquement le`INSERT`,`UPDATE`, et`DELETE`instructions</span><span class="sxs-lookup"><span data-stu-id="52948-188">Step 2: Automatically Generating the`INSERT`,`UPDATE`, and`DELETE`Statements</span></span>

<span data-ttu-id="52948-189">En tant qu’étape 1 est examiné, `INSERT`, `UPDATE`, et `DELETE` instructions SQL peuvent être spécifiées via la fenêtre Propriétés ou de la syntaxe déclarative du contrôle s.</span><span class="sxs-lookup"><span data-stu-id="52948-189">As Step 1 examined, `INSERT`, `UPDATE`, and `DELETE` SQL statements can be specified through the Properties window or the control s declarative syntax.</span></span> <span data-ttu-id="52948-190">Toutefois, cette approche requiert que nous manuellement écrire les instructions SQL à la main, qui peut être monotones et sujette à erreurs.</span><span class="sxs-lookup"><span data-stu-id="52948-190">However, this approach requires that we manually write out the SQL statements by hand, which can be monotonous and error-prone.</span></span> <span data-ttu-id="52948-191">Heureusement, l’Assistant Configurer la Source de données fournit une option pour que le `INSERT`, `UPDATE`, et `DELETE` instructions générées automatiquement lorsque vous utilisez les spécifiez les colonnes d’une table de l’écran d’affichage.</span><span class="sxs-lookup"><span data-stu-id="52948-191">Fortunately, the Configure Data Source wizard provides an option to have the `INSERT`, `UPDATE`, and `DELETE` statements automatically generated when using the Specify columns from a table of view screen.</span></span>

<span data-ttu-id="52948-192">Permettent de s Explorer cette option de génération automatique.</span><span class="sxs-lookup"><span data-stu-id="52948-192">Let s explore this automatic generation option.</span></span> <span data-ttu-id="52948-193">Ajouter un contrôle DetailsView au concepteur dans `InsertUpdateDelete.aspx` et définir son `ID` propriété `ManageProducts`.</span><span class="sxs-lookup"><span data-stu-id="52948-193">Add a DetailsView to the Designer in `InsertUpdateDelete.aspx` and set its `ID` property to `ManageProducts`.</span></span> <span data-ttu-id="52948-194">Ensuite, à partir de la balise active de s DetailsView, choisissez Créer une nouvelle source de données et de créer un SqlDataSource nommé `ManageProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="52948-194">Next, from the DetailsView s smart tag, choose to create a new data source and create a SqlDataSource named `ManageProductsDataSource`.</span></span>


<span data-ttu-id="52948-195">[![Créer un nouveau SqlDataSource nommé ManageProductsDataSource](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="52948-195">[![Create a New SqlDataSource Named ManageProductsDataSource](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.png)</span></span>

<span data-ttu-id="52948-196">**Figure 6**: créer un nouveau nommé de SqlDataSource `ManageProductsDataSource` ([cliquez pour afficher l’image en taille réelle](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="52948-196">**Figure 6**: Create a New SqlDataSource Named `ManageProductsDataSource` ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image8.png))</span></span>


<span data-ttu-id="52948-197">À partir de l’Assistant Configurer la Source de données, choisir d’utiliser le `NORTHWINDConnectionString` connexion de chaîne et cliquez sur Suivant.</span><span class="sxs-lookup"><span data-stu-id="52948-197">From the Configure Data Source wizard, opt to use the `NORTHWINDConnectionString` connection string and click Next.</span></span> <span data-ttu-id="52948-198">À partir de la configuration de l’écran de l’instruction Select, laissez les spécifiez les colonnes à partir d’une case de table ou la vue sélectionnée et choisir le `Products` table dans la liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="52948-198">From the Configure the Select Statement screen, leave the Specify columns from a table or view radio button selected and pick the `Products` table from the drop-down list.</span></span> <span data-ttu-id="52948-199">Sélectionnez le `ProductID`, `ProductName`, `UnitPrice`, et `Discontinued` colonnes dans la liste de case à cocher.</span><span class="sxs-lookup"><span data-stu-id="52948-199">Select the `ProductID`, `ProductName`, `UnitPrice`, and `Discontinued` columns from the checkbox list.</span></span>


<span data-ttu-id="52948-200">[![À l’aide de la Table Products, retourner le ProductID, ProductName, UnitPrice et les colonnes supprimées](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="52948-200">[![Using the Products Table, Return the ProductID, ProductName, UnitPrice, and Discontinued Columns](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.png)</span></span>

<span data-ttu-id="52948-201">**Figure 7**: à l’aide de la `Products` Table, retournez le `ProductID`, `ProductName`, `UnitPrice`, et `Discontinued` colonnes ([cliquez pour afficher l’image en taille réelle](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="52948-201">**Figure 7**: Using the `Products` Table, Return the `ProductID`, `ProductName`, `UnitPrice`, and `Discontinued` Columns ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image10.png))</span></span>


<span data-ttu-id="52948-202">Pour générer automatiquement `INSERT`, `UPDATE`, et `DELETE` instructions basées sur la table sélectionnée et les colonnes, cliquez sur le bouton Avancé et vérifiez la génération `INSERT`, `UPDATE`, et `DELETE` instructions case.</span><span class="sxs-lookup"><span data-stu-id="52948-202">To automatically generate `INSERT`, `UPDATE`, and `DELETE` statements based on the selected table and columns, click the Advanced button and check the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox.</span></span>


![Vérifiez les instructions case à cocher Générer INSERT, UPDATE et DELETE](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image8.gif)

<span data-ttu-id="52948-204">**Figure 8**: Vérifiez la génération `INSERT`, `UPDATE`, et `DELETE` instructions case à cocher</span><span class="sxs-lookup"><span data-stu-id="52948-204">**Figure 8**: Check the Generate `INSERT`, `UPDATE`, and `DELETE` statements Checkbox</span></span>


<span data-ttu-id="52948-205">La génération `INSERT`, `UPDATE`, et `DELETE` instructions case sera peut être activée uniquement si la table sélectionnée a une clé primaire et la colonne de clé primaire (ou les colonnes) sont incluses dans la liste des colonnes retournées.</span><span class="sxs-lookup"><span data-stu-id="52948-205">The Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox will only be checkable if the table selected has a primary key and the primary key column (or columns) are included in the list of returned columns.</span></span> <span data-ttu-id="52948-206">La case utiliser l’accès concurrentiel optimiste, qui peut être sélectionnée une fois la génération `INSERT`, `UPDATE`, et `DELETE` case à cocher des instructions ont été vérifiés, sera augmenter la `WHERE` clauses dans la boîte `UPDATE` et `DELETE` instructions pour fournir un contrôle d’accès concurrentiel optimiste.</span><span class="sxs-lookup"><span data-stu-id="52948-206">The Use optimistic concurrency checkbox, which becomes selectable once the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox has been checked, will augment the `WHERE` clauses in the resulting `UPDATE` and `DELETE` statements to provide optimistic concurrency control.</span></span> <span data-ttu-id="52948-207">Pour l’instant, laissez cette case à cocher désactivée ; Nous allons aborder l’accès concurrentiel optimiste avec le contrôle SqlDataSource dans le didacticiel suivant.</span><span class="sxs-lookup"><span data-stu-id="52948-207">For now, leave this checkbox unchecked; we'll examine optimistic concurrency with the SqlDataSource control in the next tutorial.</span></span>

<span data-ttu-id="52948-208">Après avoir vérifié la générer `INSERT`, `UPDATE`, et `DELETE` case à cocher des instructions, cliquez sur OK pour revenir à l’écran de configurer l’instruction Select, puis cliquez sur Suivant, puis terminez l’Assistant Configurer la Source de données.</span><span class="sxs-lookup"><span data-stu-id="52948-208">After checking the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox, click OK to return to the Configure Select Statement screen, then click Next, and then Finish, to complete the Configure Data Source wizard.</span></span> <span data-ttu-id="52948-209">À la fin de l’Assistant, Visual Studio ajoute BoundFields au contrôle DetailsView pour le `ProductID`, `ProductName`, et `UnitPrice` colonnes et un CheckBoxField pour la `Discontinued` colonne.</span><span class="sxs-lookup"><span data-stu-id="52948-209">Upon completing the wizard, Visual Studio will add BoundFields to the DetailsView for the `ProductID`, `ProductName`, and `UnitPrice` columns and a CheckBoxField for the `Discontinued` column.</span></span> <span data-ttu-id="52948-210">À partir de la balise active de s DetailsView, activez l’option Activer la pagination afin que l’utilisateur visite de cette page peut parcourir les produits.</span><span class="sxs-lookup"><span data-stu-id="52948-210">From the DetailsView s smart tag, check the Enable Paging option so that the user visiting this page can step through the products.</span></span> <span data-ttu-id="52948-211">Effacer également le DetailsView s `Width` et `Height` propriétés.</span><span class="sxs-lookup"><span data-stu-id="52948-211">Also clear out the DetailsView s `Width` and `Height` properties.</span></span>

<span data-ttu-id="52948-212">Notez que la balise active les options Activer l’insertion, activer la modification et activer la suppression disponibles.</span><span class="sxs-lookup"><span data-stu-id="52948-212">Notice that the smart tag has the Enable Inserting, Enable Editing, and Enable Deleting options available.</span></span> <span data-ttu-id="52948-213">Il s’agit, car le SqlDataSource contient des valeurs pour ses `InsertCommand`, `UpdateCommand`, et `DeleteCommand`, comme le montre la syntaxe déclarative suivante :</span><span class="sxs-lookup"><span data-stu-id="52948-213">This is because the SqlDataSource contains values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand`, as the following declarative syntax shows:</span></span>

[!code-aspx[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/samples/sample3.aspx)]

<span data-ttu-id="52948-214">Notez comment le contrôle SqlDataSource a des valeurs définies automatiquement pour son `InsertCommand`, `UpdateCommand`, et `DeleteCommand` propriétés.</span><span class="sxs-lookup"><span data-stu-id="52948-214">Note how the SqlDataSource control has had values automatically set for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="52948-215">Le jeu de colonnes référencées dans la `InsertCommand` et `UpdateCommand` propriétés sont basées sur celles de la `SELECT` instruction.</span><span class="sxs-lookup"><span data-stu-id="52948-215">The set of columns referenced in the `InsertCommand` and `UpdateCommand` properties are based on those in the `SELECT` statement.</span></span> <span data-ttu-id="52948-216">Autrement dit, plutôt qu’une *chaque* colonne de produits dans le `InsertCommand` et `UpdateCommand`, il existe uniquement les colonnes spécifiées dans le `SelectCommand` (moins `ProductID`, qui est omis, car il s une [ `IDENTITY` colonne](http://www.sqlteam.com/item.asp?ItemID=102), dont la valeur ne peut pas être modifiée lors de la modification et qui est automatiquement attribué lors de l’insertion).</span><span class="sxs-lookup"><span data-stu-id="52948-216">That is, rather than having *every* Products column in the `InsertCommand` and `UpdateCommand`, there are only those columns specified in the `SelectCommand` (less `ProductID`, which is omitted because it s an [`IDENTITY` column](http://www.sqlteam.com/item.asp?ItemID=102), whose value cannot be changed when edited and which is automatically assigned when inserting).</span></span> <span data-ttu-id="52948-217">En outre, pour chaque paramètre dans le `InsertCommand`, `UpdateCommand`, et `DeleteCommand` propriétés des paramètres correspondants dans le `InsertParameters`, `UpdateParameters`, et `DeleteParameters` collections.</span><span class="sxs-lookup"><span data-stu-id="52948-217">Moreover, for each parameter in the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties there are corresponding parameters in the `InsertParameters`, `UpdateParameters`, and `DeleteParameters` collections.</span></span>

<span data-ttu-id="52948-218">Pour activer les fonctionnalités de modification de données s DetailsView, vérifiez les activer l’insertion, activer la modification et activer la suppression des options dans sa balise active.</span><span class="sxs-lookup"><span data-stu-id="52948-218">To turn on the DetailsView s data modification features, check the Enable Inserting, Enable Editing, and Enable Deleting options in its smart tag.</span></span> <span data-ttu-id="52948-219">Cette opération ajoute une CommandField avec son `ShowInsertButton`, `ShowEditButton`, et `ShowDeleteButton` propriétés définies sur `True`.</span><span class="sxs-lookup"><span data-stu-id="52948-219">This adds a CommandField with its `ShowInsertButton`, `ShowEditButton`, and `ShowDeleteButton` properties set to `True`.</span></span>

<span data-ttu-id="52948-220">Visitez la page dans un navigateur et notez la modifier, supprimer et nouveaux boutons inclus dans le contrôle DetailsView.</span><span class="sxs-lookup"><span data-stu-id="52948-220">Visit the page in a browser and note the Edit, Delete, and New buttons included in the DetailsView.</span></span> <span data-ttu-id="52948-221">En cliquant sur le bouton modifier Active le contrôle DetailsView en mode édition, qui affiche chaque BoundField dont `ReadOnly` est définie sur `False` (la valeur par défaut) en tant qu’une zone de texte et le CheckBoxField comme une case à cocher.</span><span class="sxs-lookup"><span data-stu-id="52948-221">Clicking the Edit button turns the DetailsView into edit mode, which displays each BoundField whose `ReadOnly` property is set to `False` (the default) as a TextBox, and the CheckBoxField as a checkbox.</span></span>


<span data-ttu-id="52948-222">[![Le DetailsView s par défaut l’Interface de modification](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="52948-222">[![The DetailsView s Default Editing Interface](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image11.png)</span></span>

<span data-ttu-id="52948-223">**Figure 9**: le contrôle DetailsView s Interface de modification par défaut ([cliquez pour afficher l’image en taille réelle](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="52948-223">**Figure 9**: The DetailsView s Default Editing Interface ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image12.png))</span></span>


<span data-ttu-id="52948-224">De même, vous pouvez supprimer le produit sélectionné ou ajouter un nouveau produit dans le système.</span><span class="sxs-lookup"><span data-stu-id="52948-224">Similarly, you can delete the currently selected product or add a new product to the system.</span></span> <span data-ttu-id="52948-225">Étant donné que la `InsertCommand` instruction fonctionne uniquement avec les `ProductName`, `UnitPrice`, et `Discontinued` des colonnes, les autres colonnes ont soit `NULL` ou leur valeur par défaut affectée par la base de données à l’insertion.</span><span class="sxs-lookup"><span data-stu-id="52948-225">Since the `InsertCommand` statement only works with the `ProductName`, `UnitPrice`, and `Discontinued` columns, the other columns have either `NULL` or their default value assigned by the database upon insert.</span></span> <span data-ttu-id="52948-226">Tout comme avec ObjectDataSource, si le `InsertCommand` manque de n’importe quelle table de base de données que les colonnes qui ne pas autorisent `NULL` s et ne pas ayant une valeur par défaut, une erreur SQL se produit lorsque vous tentez d’exécuter la `INSERT` instruction.</span><span class="sxs-lookup"><span data-stu-id="52948-226">Just like with the ObjectDataSource, if the `InsertCommand` is missing any database table columns that don t allow `NULL` s and don t have a default value, a SQL error will occur when attempting to execute the `INSERT` statement.</span></span>

> [!NOTE]
> <span data-ttu-id="52948-227">S DetailsView insertion et la modification des interfaces ne disposent pas de validation ou de personnalisation quelconque.</span><span class="sxs-lookup"><span data-stu-id="52948-227">The DetailsView s inserting and editing interfaces lack any sort of customization or validation.</span></span> <span data-ttu-id="52948-228">Pour ajouter des contrôles de validation ou de personnaliser les interfaces, vous devez convertir le BoundFields TemplateField.</span><span class="sxs-lookup"><span data-stu-id="52948-228">To add validation controls or to customize the interfaces, you need to convert the BoundFields to TemplateFields.</span></span> <span data-ttu-id="52948-229">Reportez-vous à la [Ajout de contrôles de Validation à la modification et l’insertion des Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) et [personnalisation de l’Interface de Modification de données](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) didacticiels pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="52948-229">Refer to the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) and [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorials for more information.</span></span>


<span data-ttu-id="52948-230">Gardez à l’esprit que pour la mise à jour et la suppression, le contrôle DetailsView utilise le produit actuel s `DataKey` valeur, qui n’est présent que si le `DataKeyNames` propriété est configurée.</span><span class="sxs-lookup"><span data-stu-id="52948-230">Also, keep in mind that for updating and deleting, the DetailsView uses the current product s `DataKey` value, which is only present if the `DataKeyNames` property is configured.</span></span> <span data-ttu-id="52948-231">Si la modification ou la suppression semble n’ont aucun effet, vérifiez que le `DataKeyNames` est définie.</span><span class="sxs-lookup"><span data-stu-id="52948-231">If editing or deleting appears to have no effect, ensure that the `DataKeyNames` property is set.</span></span>

## <a name="limitations-of-automatically-generating-sql-statements"></a><span data-ttu-id="52948-232">Limitations de générer automatiquement des instructions SQL</span><span class="sxs-lookup"><span data-stu-id="52948-232">Limitations of Automatically Generating SQL Statements</span></span>

<span data-ttu-id="52948-233">Depuis la génération `INSERT`, `UPDATE`, et `DELETE` instructions option est disponible uniquement lors de la sélection des colonnes d’une table, pour les requêtes plus complexes que vous devez écrire votre propre `INSERT`, `UPDATE`, et `DELETE` instructions comme nous l’avons fait à l’étape 1.</span><span class="sxs-lookup"><span data-stu-id="52948-233">Since the Generate `INSERT`, `UPDATE`, and `DELETE` statements option is only available when picking columns from a table, for more complex queries you will have to write your own `INSERT`, `UPDATE`, and `DELETE` statements like we did in Step 1.</span></span> <span data-ttu-id="52948-234">Généralement, SQL `SELECT` instructions utilisent `JOIN` s pour le ramener à des fins d’affichage des données à partir d’une ou plusieurs tables de choix pour (tels que remettant la `Categories` table s `CategoryName` champ lors de l’affichage des informations sur les produits).</span><span class="sxs-lookup"><span data-stu-id="52948-234">Commonly, SQL `SELECT` statements use `JOIN` s to bring back data from one or more lookup tables for display purposes (such as bringing back the `Categories` table s `CategoryName` field when displaying product information).</span></span> <span data-ttu-id="52948-235">En même temps, nous voulons autoriser l’utilisateur à modifier, mettre à jour ou insérer des données dans la table de base (`Products`, dans ce cas).</span><span class="sxs-lookup"><span data-stu-id="52948-235">At the same time, we might want to allow the user to edit, update, or insert data into the core table (`Products`, in this case).</span></span>

<span data-ttu-id="52948-236">Alors que le `INSERT`, `UPDATE`, et `DELETE` instructions peuvent être entrées manuellement, envisagez de l’info-bulle fait gagner du temps suivant.</span><span class="sxs-lookup"><span data-stu-id="52948-236">While the `INSERT`, `UPDATE`, and `DELETE` statements can be entered manually, consider the following time-saving tip.</span></span> <span data-ttu-id="52948-237">Initialement le programme d’installation le SqlDataSource afin qu’il extrait des données uniquement dans le `Products` table.</span><span class="sxs-lookup"><span data-stu-id="52948-237">Initially setup the SqlDataSource so that it pulls back data just from the `Products` table.</span></span> <span data-ttu-id="52948-238">Utilisez les configuration de Source de données Assistant s Spécifiez les colonnes à partir d’un écran de la table ou la vue afin que vous pouvez générer automatiquement la `INSERT`, `UPDATE`, et `DELETE` instructions.</span><span class="sxs-lookup"><span data-stu-id="52948-238">Use the Configure Data Source wizard s Specify columns from a table or view screen so that you can automatically generate the `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="52948-239">Puis, après la fin de l’Assistant, choisissez le SelectQuery à partir de la fenêtre Propriétés de configuration (ou, vous pouvez également revenir à l’Assistant Configurer la Source de données, mais la spécifier une instruction SQL personnalisée ou une option de procédure stockée).</span><span class="sxs-lookup"><span data-stu-id="52948-239">Then, after completing the wizard, choose to configure the SelectQuery from the Properties window (or, alternatively, go back to the Configure Data Source wizard, but use the Specify a custom SQL statement or stored procedure option).</span></span> <span data-ttu-id="52948-240">Mettre à jour le `SELECT` instruction à inclure le `JOIN` syntaxe.</span><span class="sxs-lookup"><span data-stu-id="52948-240">Then update the `SELECT` statement to include the `JOIN` syntax.</span></span> <span data-ttu-id="52948-241">Cette technique offre les avantages de gagner du temps et des instructions SQL générés automatiquement et permet une plus personnalisée `SELECT` instruction.</span><span class="sxs-lookup"><span data-stu-id="52948-241">This technique offers the time-saving benefits of the automatically generated SQL statements and allows for a more customized `SELECT` statement.</span></span>

<span data-ttu-id="52948-242">Une autre limitation de générer automatiquement le `INSERT`, `UPDATE`, et `DELETE` instructions qui correspond aux colonnes de la `INSERT` et `UPDATE` instructions sont basées sur les colonnes retournées par la `SELECT` instruction.</span><span class="sxs-lookup"><span data-stu-id="52948-242">Another limitation of automatically generating the `INSERT`, `UPDATE`, and `DELETE` statements is that the columns in the `INSERT` and `UPDATE` statements are based on the columns returned by the `SELECT` statement.</span></span> <span data-ttu-id="52948-243">Nous devons mettre à jour ou insérer des champs plus ou moins, toutefois.</span><span class="sxs-lookup"><span data-stu-id="52948-243">We may need to update or insert more or fewer fields, however.</span></span> <span data-ttu-id="52948-244">Par exemple, dans l’exemple à l’étape 2, peut-être que nous voulons avoir la `UnitPrice` BoundField être en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="52948-244">For example, in the example from Step 2, maybe we want to have the `UnitPrice` BoundField be read-only.</span></span> <span data-ttu-id="52948-245">Dans ce cas, il ne doit pas dater t s’affichent dans le `UpdateCommand`.</span><span class="sxs-lookup"><span data-stu-id="52948-245">In that case, it shouldn t appear in the `UpdateCommand`.</span></span> <span data-ttu-id="52948-246">Ou bien, nous pouvons choisir de définir la valeur d’un champ de table qui n’apparaît pas dans le GridView.</span><span class="sxs-lookup"><span data-stu-id="52948-246">Or we may want to set the value of a table field that does not appear in the GridView.</span></span> <span data-ttu-id="52948-247">Par exemple, lorsque vous ajoutez un nouvel enregistrement nous voulons que la `QuantityPerUnit` valeur TODO.</span><span class="sxs-lookup"><span data-stu-id="52948-247">For example, when adding a new record we may want the `QuantityPerUnit` value set to TODO .</span></span>

<span data-ttu-id="52948-248">Si ces personnalisations sont requises, vous devez effectuer manuellement, par le biais de la fenêtre Propriétés, spécifiez une instruction SQL personnalisée ou option de procédure stockée dans l’Assistant, ou via la syntaxe déclarative.</span><span class="sxs-lookup"><span data-stu-id="52948-248">If such customizations are required, you need to make them manually, either through the Properties window, the Specify a custom SQL statement or stored procedure option in the wizard, or via the declarative syntax.</span></span>

> [!NOTE]
> <span data-ttu-id="52948-249">Lors de l’ajout de paramètres qui n’ont pas de champs correspondants dans les données de contrôle Web, gardez à l’esprit que ces valeurs de paramètres devrez attribuer des valeurs dans un mode quelconque.</span><span class="sxs-lookup"><span data-stu-id="52948-249">When adding parameters that do not have corresponding fields in the data Web control, keep in mind that these parameters values will need to be assigned values in some manner.</span></span> <span data-ttu-id="52948-250">Ces valeurs peuvent être : codé en dur directement dans le `InsertCommand` ou `UpdateCommand`; peuvent provenir d’une source prédéfinie (chaîne de requête, l’état de session, les contrôles Web sur la page et ainsi de suite) ; peuvent être affectés ou par programme, comme nous l’avons vu dans le didacticiel précédent.</span><span class="sxs-lookup"><span data-stu-id="52948-250">These values can be: hard-coded directly in the `InsertCommand` or `UpdateCommand`; can come from some pre-defined source (the querystring, session state, Web controls on the page, and so on); or can be assigned programmatically, as we saw in the preceding tutorial.</span></span>


## <a name="summary"></a><span data-ttu-id="52948-251">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="52948-251">Summary</span></span>

<span data-ttu-id="52948-252">Dans l’ordre pour les données de que contrôles Web afin d’utiliser leurs intégrées d’insertion, la modification et la suppression de fonctionnalités, le contrôle de source de données qu’ils sont liés à doit offrir.</span><span class="sxs-lookup"><span data-stu-id="52948-252">In order for the data Web controls to utilize their built-in inserting, editing, and deleting capabilities, the data source control they are bound to must offer such functionality.</span></span> <span data-ttu-id="52948-253">Pour le SqlDataSource, cela signifie que `INSERT`, `UPDATE`, et `DELETE` instructions SQL doivent être affectées à la `InsertCommand`, `UpdateCommand`, et `DeleteCommand` propriétés.</span><span class="sxs-lookup"><span data-stu-id="52948-253">For the SqlDataSource, this means that `INSERT`, `UPDATE`, and `DELETE` SQL statements must be assigned to the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="52948-254">Ces propriétés et les collections de paramètres correspondants, peuvent être ajoutées manuellement ou générées automatiquement via l’Assistant Configurer la Source de données.</span><span class="sxs-lookup"><span data-stu-id="52948-254">These properties, and the corresponding parameters collections, can be added manually or generated automatically through the Configure Data Source wizard.</span></span> <span data-ttu-id="52948-255">Dans ce didacticiel, nous avons examiné ces deux techniques.</span><span class="sxs-lookup"><span data-stu-id="52948-255">In this tutorial we examined both techniques.</span></span>

<span data-ttu-id="52948-256">Nous avons examiné à l’aide de l’accès concurrentiel optimiste avec ObjectDataSource dans le [implémentation de l’accès concurrentiel optimiste](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-vb.md) didacticiel.</span><span class="sxs-lookup"><span data-stu-id="52948-256">We examined using optimistic concurrency with the ObjectDataSource in the [Implementing Optimistic Concurrency](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-vb.md) tutorial.</span></span> <span data-ttu-id="52948-257">Le contrôle SqlDataSource fournit également la prise en charge de l’accès concurrentiel optimiste.</span><span class="sxs-lookup"><span data-stu-id="52948-257">The SqlDataSource control also provides optimistic concurrency support.</span></span> <span data-ttu-id="52948-258">Comme indiqué à l’étape 2, lorsque vous générez automatiquement le `INSERT`, `UPDATE`, et `DELETE` instructions, l’Assistant propose une option d’utilisation d’accès concurrentiel optimiste.</span><span class="sxs-lookup"><span data-stu-id="52948-258">As noted in Step 2, when automatically generating the `INSERT`, `UPDATE`, and `DELETE` statements, the wizard offers a Use optimistic concurrency option.</span></span> <span data-ttu-id="52948-259">Comme nous le verrons dans le didacticiel suivant, à l’aide de l’accès concurrentiel optimiste avec le SqlDataSource modifie le `WHERE` clauses dans la `UPDATE` et `DELETE` instructions pour vous assurer que les valeurs des autres colonnes vous n avez encore t modifié les données depuis le derniers affiche sur la page.</span><span class="sxs-lookup"><span data-stu-id="52948-259">As we'll see in the next tutorial, using optimistic concurrency with the SqlDataSource modifies the `WHERE` clauses in the `UPDATE` and `DELETE` statements to ensure that the values for the other columns haven t changed since the data was last displayed on the page.</span></span>

<span data-ttu-id="52948-260">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="52948-260">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="52948-261">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="52948-261">About the Author</span></span>

<span data-ttu-id="52948-262">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept manuels ASP/ASP.NET et créateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="52948-262">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="52948-263">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="52948-263">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="52948-264">Son dernier ouvrage est [ *SAM animer vous-même ASP.NET 2.0 des dernières 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="52948-264">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="52948-265">Il peut être atteint à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) ou via son blog, qui se trouvent à [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="52948-265">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="52948-266">[Précédent](using-parameterized-queries-with-the-sqldatasource-vb.md)
> [Suivant](implementing-optimistic-concurrency-with-the-sqldatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="52948-266">[Previous](using-parameterized-queries-with-the-sqldatasource-vb.md)
[Next](implementing-optimistic-concurrency-with-the-sqldatasource-vb.md)</span></span>
