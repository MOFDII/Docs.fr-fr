---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/limiting-data-modification-functionality-based-on-the-user-vb
title: Limitant les fonctionnalités de Modification de données basé sur l’utilisateur (VB) | Documents Microsoft
author: rick-anderson
description: Dans une application web qui permet aux utilisateurs de modifier des données, différents comptes d’utilisateurs peuvent avoir des privilèges de modification de données différents. Dans ce didacticiel, nous allons examiner comment t...
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/17/2006
ms.topic: article
ms.assetid: 9dc264a6-feb8-474b-8b91-008c50708065
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/limiting-data-modification-functionality-based-on-the-user-vb
msc.type: authoredcontent
ms.openlocfilehash: eccb8e114e0ecf772680a2e5b36a761736cf8025
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/06/2018
ms.locfileid: "30887871"
---
<a name="limiting-data-modification-functionality-based-on-the-user-vb"></a><span data-ttu-id="121e7-104">Limitant les fonctionnalités de Modification de données en fonction de l’utilisateur (VB)</span><span class="sxs-lookup"><span data-stu-id="121e7-104">Limiting Data Modification Functionality Based on the User (VB)</span></span>
====================
<span data-ttu-id="121e7-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="121e7-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="121e7-106">[Télécharger l’exemple d’application](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_23_VB.exe) ou [télécharger le PDF](limiting-data-modification-functionality-based-on-the-user-vb/_static/datatutorial23vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="121e7-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_23_VB.exe) or [Download PDF](limiting-data-modification-functionality-based-on-the-user-vb/_static/datatutorial23vb1.pdf)</span></span>

> <span data-ttu-id="121e7-107">Dans une application web qui permet aux utilisateurs de modifier des données, différents comptes d’utilisateurs peuvent avoir des privilèges de modification de données différents.</span><span class="sxs-lookup"><span data-stu-id="121e7-107">In a web application that allows users to edit data, different user accounts may have different data-editing privileges.</span></span> <span data-ttu-id="121e7-108">Dans ce didacticiel, nous allons examiner comment ajuster dynamiquement les fonctionnalités de modification de données en fonction de l’utilisateur visite.</span><span class="sxs-lookup"><span data-stu-id="121e7-108">In this tutorial we'll examine how to dynamically adjust the data modification capabilities based on the visiting user.</span></span>


## <a name="introduction"></a><span data-ttu-id="121e7-109">Introduction</span><span class="sxs-lookup"><span data-stu-id="121e7-109">Introduction</span></span>

<span data-ttu-id="121e7-110">Un nombre d’applications web prennent en charge les comptes d’utilisateur et fournit des différentes options, les rapports et les fonctionnalités basées sur l’utilisateur connecté.</span><span class="sxs-lookup"><span data-stu-id="121e7-110">A number of web applications support user accounts and provide different options, reports, and functionality based on the logged in user.</span></span> <span data-ttu-id="121e7-111">Par exemple, avec nos didacticiels souhaitions permettent aux utilisateurs des sociétés à ouvrir une session sur les site et mise à jour des informations générales sur leurs produits - leur nom et la quantité par unité, peut-être, ainsi que les informations du fournisseur, telles que leur nom de société, fournisseur adresse, les informations de la personne à contacter s et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="121e7-111">For example, with our tutorials we might want to allow users from the supplier companies to log on to the site and update general information about their products - their name and quantity per unit, perhaps - along with supplier information, such as their company name, address, the contact person s information, and so on.</span></span> <span data-ttu-id="121e7-112">En outre, nous pouvons si vous le souhaitez inclure certains comptes d’utilisateur pour les personnes à partir de notre société afin qu’ils puissent se connecter et mettre à jour des informations sur les produits comme unités en stock, niveau de réapprovisionnement et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="121e7-112">Furthermore, we might want to include some user accounts for people from our company so that they can log on and update product information like units on stock, reorder level, and so forth.</span></span> <span data-ttu-id="121e7-113">Notre application web a également peut autoriser des utilisateurs anonymes à visiter (personnes n’êtes pas connecté), mais les limite à afficher uniquement les données.</span><span class="sxs-lookup"><span data-stu-id="121e7-113">Our web application might also allow anonymous users to visit (people who have not logged on), but would limit them to just viewing data.</span></span> <span data-ttu-id="121e7-114">Avec un tel utilisateur compte système en place, nous voulons les données des contrôles Web dans nos pages ASP.NET permet d’offrir l’insertion, modification et suppression des privilèges appropriés pour l’utilisateur actuellement connecté.</span><span class="sxs-lookup"><span data-stu-id="121e7-114">With such a user account system in place, we would want the data Web controls in our ASP.NET pages to offer the inserting, editing, and deleting capabilities appropriate for the currently logged on user.</span></span>

<span data-ttu-id="121e7-115">Dans ce didacticiel, nous allons examiner comment ajuster dynamiquement les fonctionnalités de modification de données en fonction de l’utilisateur visite.</span><span class="sxs-lookup"><span data-stu-id="121e7-115">In this tutorial we'll examine how to dynamically adjust the data modification capabilities based on the visiting user.</span></span> <span data-ttu-id="121e7-116">En particulier, nous allons créer une page qui affiche les informations de fournisseurs dans un contrôle modifiable DetailsView avec un GridView qui répertorie les produits fournis par le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="121e7-116">In particular, we'll create a page that displays the suppliers information in an editable DetailsView along with a GridView that lists the products provided by the supplier.</span></span> <span data-ttu-id="121e7-117">Si l’utilisateur visite de la page est à partir de notre entreprise, ils peuvent : afficher des informations de fournisseur s ; modifier leur adresse ; et modifier les informations pour tous les produits fournis par le fournisseur.</span><span class="sxs-lookup"><span data-stu-id="121e7-117">If the user visiting the page is from our company, they can: view any supplier s information; edit their address; and edit the information for any product provided by the supplier.</span></span> <span data-ttu-id="121e7-118">Si, toutefois, l’utilisateur est d’une société particulière, ils peuvent uniquement afficher et modifier leurs propres informations d’adresse et ne peuvent modifier leurs produits qui n’ont pas été marqués comme étant suspendus.</span><span class="sxs-lookup"><span data-stu-id="121e7-118">If, however, the user is from a particular company, they can only view and edit their own address information and can only edit their products that have not been marked as discontinued.</span></span>


<span data-ttu-id="121e7-119">[![Un utilisateur à partir de notre société peut modifier les informations relatives aux fournisseurs s](limiting-data-modification-functionality-based-on-the-user-vb/_static/image2.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="121e7-119">[![A User from Our Company Can Edit Any Supplier s Information](limiting-data-modification-functionality-based-on-the-user-vb/_static/image2.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image1.png)</span></span>

<span data-ttu-id="121e7-120">**Figure 1**: un utilisateur à partir de notre société peut modifier n’importe quel fournisseur s informations ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="121e7-120">**Figure 1**: A User from Our Company Can Edit Any Supplier s Information ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image3.png))</span></span>


<span data-ttu-id="121e7-121">[![Un utilisateur à partir d’un fournisseur donné peut uniquement afficher et les modifier leurs informations](limiting-data-modification-functionality-based-on-the-user-vb/_static/image5.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="121e7-121">[![A User from a Particular Supplier Can Only View and Edit their Information](limiting-data-modification-functionality-based-on-the-user-vb/_static/image5.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image4.png)</span></span>

<span data-ttu-id="121e7-122">**Figure 2**: un utilisateur à partir d’un particulier fournisseur peuvent uniquement afficher et modifier leurs informations ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="121e7-122">**Figure 2**: A User from a Particular Supplier Can Only View and Edit their Information ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image6.png))</span></span>


<span data-ttu-id="121e7-123">Let s commencer !</span><span class="sxs-lookup"><span data-stu-id="121e7-123">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="121e7-124">ASP.NET 2.0 système d’appartenance s fournit une plateforme standardisée et extensible pour la création, la gestion et la validation des comptes d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="121e7-124">ASP.NET 2.0 s membership system provides a standardized, extensible platform for creating, managing, and validating user accounts.</span></span> <span data-ttu-id="121e7-125">Un examen du système d’appartenance étant dépasse le cadre de ces didacticiels, ce didacticiel à la place « fakes » l’appartenance en autorisant les visiteurs anonymes à choisir s’ils sont d’un fournisseur particulier ou à partir de notre entreprise.</span><span class="sxs-lookup"><span data-stu-id="121e7-125">Since an examination of the membership system is beyond the scope of these tutorials, this tutorial instead "fakes" membership by allowing anonymous visitors to choose whether they are from a particular supplier or from our company.</span></span> <span data-ttu-id="121e7-126">Pour plus d’informations sur l’appartenance, reportez-vous à mon [examen ASP.NET 2.0 s l’appartenance, rôles et profil](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx) série d’articles.</span><span class="sxs-lookup"><span data-stu-id="121e7-126">For more on membership, refer to my [Examining ASP.NET 2.0 s Membership, Roles, and Profile](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx) article series.</span></span>


## <a name="step-1-allowing-the-user-to-specify-their-access-rights"></a><span data-ttu-id="121e7-127">Étape 1 : Permettant à l’utilisateur de spécifier leurs droits d’accès</span><span class="sxs-lookup"><span data-stu-id="121e7-127">Step 1: Allowing the User to Specify their Access Rights</span></span>

<span data-ttu-id="121e7-128">Dans une application web du monde réel, les informations de compte d’utilisateur s inclurait si tout a fonctionné pour notre société ou d’un fournisseur particulier, et ces informations peuvent être accessibles par programme à partir de nos pages ASP.NET, une fois que l’utilisateur a ouvert une session le site.</span><span class="sxs-lookup"><span data-stu-id="121e7-128">In a real-world web application, a user s account information would include whether they worked for our company or for a particular supplier, and this information would be programmatically accessible from our ASP.NET pages once the user has logged on to the site.</span></span> <span data-ttu-id="121e7-129">Cette information peut être capturée via le système de rôles ASP.NET 2.0 s, en tant qu’informations de compte au niveau de l’utilisateur via le système de profil, ou par des moyens personnalisés.</span><span class="sxs-lookup"><span data-stu-id="121e7-129">This information could be captured through ASP.NET 2.0 s roles system, as user-level account information through the profile system, or through some custom means.</span></span>

<span data-ttu-id="121e7-130">Étant donné que l’objectif de ce didacticiel est d’illustrer l’ajustement de la modification des données en fonction de l’utilisateur connecté et n’est pas destiné à l’appartenance de s showcase ASP.NET 2.0, les rôles et les systèmes de profil, nous allons utiliser un mécanisme très simple pour déterminer le fonctionnalités de l’utilisateur sur la page - DropDownList à partir de laquelle l’utilisateur peut indiquer si elles doivent être en mesure de les afficher et modifier les informations des fournisseurs ou, vous pouvez également ce que les informations de fournisseur particulier s’ils peuvent afficher et modifier.</span><span class="sxs-lookup"><span data-stu-id="121e7-130">Since the aim of this tutorial is to demonstrate adjusting the data modification capabilities based on the logged on user, and is not meant to showcase ASP.NET 2.0 s membership, roles, and profile systems, we'll use a very simply mechanism to determine the capabilities for the user visiting the page - a DropDownList from which the user can indicate if they should be able to view and edit any of the suppliers information or, alternatively, what particular supplier s information they can view and edit.</span></span> <span data-ttu-id="121e7-131">Si l’utilisateur indique qu’elle peut afficher et modifier toutes les informations de fournisseur (la valeur par défaut), elle peut parcourir tous les fournisseurs, modifiez toutes les informations d’adresse fournisseur s et modifier le nom et la quantité par unité pour tous les produits fournis par le fournisseur sélectionné.</span><span class="sxs-lookup"><span data-stu-id="121e7-131">If the user indicates that she can view and edit all supplier information (the default), she can page through all suppliers, edit any supplier s address information, and edit the name and quantity per unit for any product provided by the selected supplier.</span></span> <span data-ttu-id="121e7-132">Si l’utilisateur indique qu’elle peut uniquement afficher et modifier un fournisseur particulier, toutefois, puis elle peut uniquement afficher les détails et les produits pour qu’un fournisseur et peut uniquement mettre à jour le nom et la quantité par les informations d’unité pour les produits qui sont *pas* abandonné.</span><span class="sxs-lookup"><span data-stu-id="121e7-132">If the user indicates that she can only view and edit a particular supplier, however, then she can only view the details and products for that one supplier and can only update the name and quantity per unit information for those products that are *not* discontinued.</span></span>

<span data-ttu-id="121e7-133">Notre première étape de ce didacticiel, est ensuite, pour créer cette DropDownList et le remplir avec les fournisseurs dans le système.</span><span class="sxs-lookup"><span data-stu-id="121e7-133">Our first step in this tutorial, then, is to create this DropDownList and populate it with the suppliers in the system.</span></span> <span data-ttu-id="121e7-134">Ouvrez le `UserLevelAccess.aspx` page dans le `EditInsertDelete` dossier, ajouter une liste déroulante dont `ID` est définie sur `Suppliers`et lier cette DropDownList pour un nouveau ObjectDataSource nommé `AllSuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="121e7-134">Open the `UserLevelAccess.aspx` page in the `EditInsertDelete` folder, add a DropDownList whose `ID` property is set to `Suppliers`, and bind this DropDownList to a new ObjectDataSource named `AllSuppliersDataSource`.</span></span>


<span data-ttu-id="121e7-135">[![Créer un nouveau ObjectDataSource nommé AllSuppliersDataSource](limiting-data-modification-functionality-based-on-the-user-vb/_static/image8.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="121e7-135">[![Create a New ObjectDataSource Named AllSuppliersDataSource](limiting-data-modification-functionality-based-on-the-user-vb/_static/image8.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image7.png)</span></span>

<span data-ttu-id="121e7-136">**Figure 3**: créer un nouveau nommé de ObjectDataSource `AllSuppliersDataSource` ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="121e7-136">**Figure 3**: Create a New ObjectDataSource Named `AllSuppliersDataSource` ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image9.png))</span></span>


<span data-ttu-id="121e7-137">Étant donné que nous voulons que ce DropDownList pour inclure tous les fournisseurs, configurer ObjectDataSource pour appeler le `SuppliersBLL` classe s `GetSuppliers()` (méthode).</span><span class="sxs-lookup"><span data-stu-id="121e7-137">Since we want this DropDownList to include all suppliers, configure the ObjectDataSource to invoke the `SuppliersBLL` class s `GetSuppliers()` method.</span></span> <span data-ttu-id="121e7-138">Vérifiez que le s ObjectDataSource `Update()` méthode mappée à la `SuppliersBLL` classe s `UpdateSupplierAddress` (méthode), comme cette ObjectDataSource sera également être utilisé par le contrôle DetailsView à l’étape 2, nous allons ajouter.</span><span class="sxs-lookup"><span data-stu-id="121e7-138">Also ensure that the ObjectDataSource s `Update()` method is mapped to the `SuppliersBLL` class s `UpdateSupplierAddress` method, as this ObjectDataSource will also be used by the DetailsView we'll be adding in Step 2.</span></span>

<span data-ttu-id="121e7-139">Après avoir terminé l’Assistant ObjectDataSource, effectuez les étapes en configurant le `Suppliers` DropDownList tel qu’il indique le `CompanyName` champ de données et utilise le `SupplierID` comme valeur pour chaque champ des données `ListItem`.</span><span class="sxs-lookup"><span data-stu-id="121e7-139">After completing the ObjectDataSource wizard, complete the steps by configuring the `Suppliers` DropDownList such that it shows the `CompanyName` data field and uses the `SupplierID` data field as the value for each `ListItem`.</span></span>


<span data-ttu-id="121e7-140">[![Configurer les fournisseurs DropDownList pour utiliser les champs de données de SupplierID CompanyName](limiting-data-modification-functionality-based-on-the-user-vb/_static/image11.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="121e7-140">[![Configure the Suppliers DropDownList to Use the CompanyName and SupplierID Data Fields](limiting-data-modification-functionality-based-on-the-user-vb/_static/image11.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image10.png)</span></span>

<span data-ttu-id="121e7-141">**Figure 4**: configurer le `Suppliers` DropDownList à utiliser le `CompanyName` et `SupplierID` des champs de données ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="121e7-141">**Figure 4**: Configure the `Suppliers` DropDownList to Use the `CompanyName` and `SupplierID` Data Fields ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image12.png))</span></span>


<span data-ttu-id="121e7-142">À ce stade, DropDownList répertorie les noms de société des fournisseurs dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="121e7-142">At this point, the DropDownList lists the company names of the suppliers in the database.</span></span> <span data-ttu-id="121e7-143">Toutefois, nous devons également inclure une option « Afficher/modifier tous les fournisseurs » pour DropDownList.</span><span class="sxs-lookup"><span data-stu-id="121e7-143">However, we also need to include a "Show/Edit ALL Suppliers" option to the DropDownList.</span></span> <span data-ttu-id="121e7-144">Pour ce faire, affectez le `Suppliers` DropDownList s `AppendDataBoundItems` propriété `true` , puis ajoutez un `ListItem` dont `Text` propriété est « Afficher/modifier tous les fournisseurs » et dont la valeur est `-1`.</span><span class="sxs-lookup"><span data-stu-id="121e7-144">To accomplish this, set the `Suppliers` DropDownList s `AppendDataBoundItems` property to `true` and then add a `ListItem` whose `Text` property is "Show/Edit ALL Suppliers" and whose value is `-1`.</span></span> <span data-ttu-id="121e7-145">Il peut être ajouté directement via le balisage déclaratif ou via le concepteur en accédant à la fenêtre Propriétés en cliquant sur le bouton de sélection dans le s DropDownList `Items` propriété.</span><span class="sxs-lookup"><span data-stu-id="121e7-145">This can be added directly through the declarative markup or through the Designer by going to the Properties window and clicking on the ellipses in the DropDownList s `Items` property.</span></span>

> [!NOTE]
> <span data-ttu-id="121e7-146">Faire référence à la [ *filtrage de maître/détail avec un DropDownList* ](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) didacticiel pour plus d’informations sur l’ajout d’un élément Select All à un lié aux données DropDownList.</span><span class="sxs-lookup"><span data-stu-id="121e7-146">Refer back to the [*Master/Detail Filtering With a DropDownList*](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) tutorial for a more detailed discussion on adding a Select All item to a databound DropDownList.</span></span>


<span data-ttu-id="121e7-147">Après le `AppendDataBoundItems` propriété a été définie et la `ListItem` ajouté, le balisage déclaratif de s DropDownList doit ressembler à :</span><span class="sxs-lookup"><span data-stu-id="121e7-147">After the `AppendDataBoundItems` property has been set and the `ListItem` added, the DropDownList s declarative markup should look like:</span></span>


[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample1.aspx)]

<span data-ttu-id="121e7-148">La figure 5 illustre une capture d’écran de notre progression en cours, lorsqu’ils sont affichés via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="121e7-148">Figure 5 shows a screen shot of our current progress, when viewed through a browser.</span></span>


<span data-ttu-id="121e7-149">[![DropDownList fournisseurs contient un diaporama ListItem tous, Plus un pour chaque fournisseur](limiting-data-modification-functionality-based-on-the-user-vb/_static/image14.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="121e7-149">[![The Suppliers DropDownList Contains a Show ALL ListItem, Plus One for Each Supplier](limiting-data-modification-functionality-based-on-the-user-vb/_static/image14.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image13.png)</span></span>

<span data-ttu-id="121e7-150">**Figure 5**: le `Suppliers` DropDownList contient afficher tout `ListItem`, Plus un pour chaque fournisseur ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="121e7-150">**Figure 5**: The `Suppliers` DropDownList Contains a Show ALL `ListItem`, Plus One for Each Supplier ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image15.png))</span></span>


<span data-ttu-id="121e7-151">Étant donné que vous souhaitez mettre à jour l’interface utilisateur immédiatement après que l’utilisateur a changé sa sélection, définir le `Suppliers` DropDownList s `AutoPostBack` propriété `true`.</span><span class="sxs-lookup"><span data-stu-id="121e7-151">Since we want to update the user interface immediately after the user has changed their selection, set the `Suppliers` DropDownList s `AutoPostBack` property to `true`.</span></span> <span data-ttu-id="121e7-152">À l’étape 2, nous allons créer un contrôle DetailsView qui affiche les informations pour les fournisseurs en fonction de la sélection DropDownList.</span><span class="sxs-lookup"><span data-stu-id="121e7-152">In Step 2 we'll create a DetailsView control that will show the information for the supplier(s) based on the DropDownList selection.</span></span> <span data-ttu-id="121e7-153">Puis, à l’étape 3, nous allons créer un gestionnaire d’événements pour ce s DropDownList `SelectedIndexChanged` événement, dans lequel nous allons ajouter le code qui lie les informations de fournisseur approprié pour le contrôle DetailsView basé sur le fournisseur sélectionné.</span><span class="sxs-lookup"><span data-stu-id="121e7-153">Then, in Step 3, we'll create an event handler for this DropDownList s `SelectedIndexChanged` event, in which we'll add code that binds the appropriate supplier information to the DetailsView based upon the selected supplier.</span></span>

## <a name="step-2-adding-a-detailsview-control"></a><span data-ttu-id="121e7-154">Étape 2 : Ajout d’un contrôle DetailsView</span><span class="sxs-lookup"><span data-stu-id="121e7-154">Step 2: Adding a DetailsView Control</span></span>

<span data-ttu-id="121e7-155">Permettent d’utiliser un contrôle DetailsView pour afficher les informations de fournisseur s.</span><span class="sxs-lookup"><span data-stu-id="121e7-155">Let s use a DetailsView to show supplier information.</span></span> <span data-ttu-id="121e7-156">Pour l’utilisateur qui peut afficher et modifier tous les fournisseurs, le contrôle DetailsView prendra en charge la pagination, permettant à l’utilisateur de parcourir la fournisseur d’informations d’un enregistrement à la fois.</span><span class="sxs-lookup"><span data-stu-id="121e7-156">For the user who can view and edit all suppliers, the DetailsView will support paging, allowing the user to step through the supplier information one record at a time.</span></span> <span data-ttu-id="121e7-157">Si l’utilisateur travaille pour un fournisseur particulier, toutefois, le contrôle DetailsView affiche uniquement ce fournisseur des informations sur s et n’inclut pas une interface de pagination.</span><span class="sxs-lookup"><span data-stu-id="121e7-157">If the user works for a particular supplier, however, the DetailsView will show only that particular supplier s information and will not include a paging interface.</span></span> <span data-ttu-id="121e7-158">Dans les deux cas, le contrôle DetailsView doit autoriser l’utilisateur à modifier le fournisseur s’adresse, ville et des champs de pays.</span><span class="sxs-lookup"><span data-stu-id="121e7-158">In either case, the DetailsView needs to allow the user to edit the supplier s address, city, and country fields.</span></span>

<span data-ttu-id="121e7-159">Ajouter un contrôle DetailsView à la page sous le `Suppliers` DropDownList, définissez son `ID` propriété `SupplierDetails`, puis liez-le à le `AllSuppliersDataSource` ObjectDataSource créé à l’étape précédente.</span><span class="sxs-lookup"><span data-stu-id="121e7-159">Add a DetailsView to the page beneath the `Suppliers` DropDownList, set its `ID` property to `SupplierDetails`, and bind it to the `AllSuppliersDataSource` ObjectDataSource created in the previous step.</span></span> <span data-ttu-id="121e7-160">Ensuite, vérifiez les cases à cocher Activer la pagination et activer la modification de la balise active de DetailsView s.</span><span class="sxs-lookup"><span data-stu-id="121e7-160">Next, check the Enable Paging and Enable Editing checkboxes from the DetailsView s smart tag.</span></span>

> [!NOTE]
> <span data-ttu-id="121e7-161">Si vous ne pas voir une option Activer la modification dans le s DetailsView Active marquer s, car vous n’avez pas mappé les s ObjectDataSource `Update()` méthode à la `SuppliersBLL` classe s `UpdateSupplierAddress` (méthode).</span><span class="sxs-lookup"><span data-stu-id="121e7-161">If you don t see an Enable Editing option in the DetailsView s smart tag it s because you did not map the ObjectDataSource s `Update()` method to the `SuppliersBLL` class s `UpdateSupplierAddress` method.</span></span> <span data-ttu-id="121e7-162">Prenez un moment pour revenir en arrière et modifier cette configuration, après laquelle l’option Activer la modification doit apparaître dans la balise active de DetailsView s.</span><span class="sxs-lookup"><span data-stu-id="121e7-162">Take a moment to go back and make this configuration change, after which the Enable Editing option should appear in the DetailsView s smart tag.</span></span>


<span data-ttu-id="121e7-163">Étant donné que la `SuppliersBLL` classe s `UpdateSupplierAddress` méthode n’accepte quatre paramètres - `supplierID`, `address`, `city`, et `country` -modifier le s DetailsView BoundFields afin que le `CompanyName` et `Phone` BoundFields sont en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="121e7-163">Since the `SuppliersBLL` class s `UpdateSupplierAddress` method only accepts four parameters - `supplierID`, `address`, `city`, and `country` - modify the DetailsView s BoundFields so that the `CompanyName` and `Phone` BoundFields are read-only.</span></span> <span data-ttu-id="121e7-164">En outre, supprimez le `SupplierID` BoundField complètement.</span><span class="sxs-lookup"><span data-stu-id="121e7-164">Additionally, remove the `SupplierID` BoundField altogether.</span></span> <span data-ttu-id="121e7-165">Enfin, le `AllSuppliersDataSource` ObjectDataSource a actuellement son `OldValuesParameterFormatString` propriété `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="121e7-165">Finally, the `AllSuppliersDataSource` ObjectDataSource currently has its `OldValuesParameterFormatString` property set to `original_{0}`.</span></span> <span data-ttu-id="121e7-166">Prenez un moment pour supprimer ce paramètre de propriété complètement de la syntaxe déclarative ou affectez-lui la valeur par défaut, `{0}`.</span><span class="sxs-lookup"><span data-stu-id="121e7-166">Take a moment to remove this property setting from the declarative syntax altogether, or set it to the default value, `{0}`.</span></span>

<span data-ttu-id="121e7-167">Après avoir configuré le `SupplierDetails` DetailsView et `AllSuppliersDataSource` ObjectDataSource, nous devons le balisage déclaratif suivant :</span><span class="sxs-lookup"><span data-stu-id="121e7-167">After configuring the `SupplierDetails` DetailsView and `AllSuppliersDataSource` ObjectDataSource, we will have the following declarative markup:</span></span>


[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample2.aspx)]

<span data-ttu-id="121e7-168">À ce stade, le contrôle DetailsView peut être contacté par le biais, et les informations d’adresse fournisseur sélectionné s peuvent être mis à jour, quelle que soit la sélection effectuée dans le `Suppliers` DropDownList (voir Figure 6).</span><span class="sxs-lookup"><span data-stu-id="121e7-168">At this point the DetailsView can be paged through and the selected supplier s address information can be updated, regardless of the selection made in the `Suppliers` DropDownList (see Figure 6).</span></span>


<span data-ttu-id="121e7-169">[![Les fournisseurs d’informations peuvent être affichées, et son adresse mise à jour](limiting-data-modification-functionality-based-on-the-user-vb/_static/image17.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="121e7-169">[![Any Suppliers Information Can Be Viewed, and Its Address Updated](limiting-data-modification-functionality-based-on-the-user-vb/_static/image17.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image16.png)</span></span>

<span data-ttu-id="121e7-170">**Figure 6**: Any fournisseurs informations peuvent être consultées et son adresse mise à jour ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="121e7-170">**Figure 6**: Any Suppliers Information Can Be Viewed, and Its Address Updated ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image18.png))</span></span>


## <a name="step-3-displaying-only-the-selected-supplier-s-information"></a><span data-ttu-id="121e7-171">Étape 3 : Afficher uniquement les informations de s fournisseur sélectionné</span><span class="sxs-lookup"><span data-stu-id="121e7-171">Step 3: Displaying Only the Selected Supplier s Information</span></span>

<span data-ttu-id="121e7-172">Actuellement, notre page affiche les informations pour tous les fournisseurs, indépendamment de si un fournisseur a été sélectionné à partir de la `Suppliers` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="121e7-172">Our page currently displays the information for all suppliers regardless of whether a particular supplier has been selected from the `Suppliers` DropDownList.</span></span> <span data-ttu-id="121e7-173">Afin d’afficher uniquement les informations de fournisseur pour le fournisseur sélectionné, nous devons ajouter un autre ObjectDataSource à notre page, qui Récupère des informations sur un fournisseur particulier.</span><span class="sxs-lookup"><span data-stu-id="121e7-173">In order to display just the supplier information for the selected supplier we need to add another ObjectDataSource to our page, one that retrieves information about a particular supplier.</span></span>

<span data-ttu-id="121e7-174">Ajouter un nouveau ObjectDataSource à la page, en le nommant `SingleSupplierDataSource`.</span><span class="sxs-lookup"><span data-stu-id="121e7-174">Add a new ObjectDataSource to the page, naming it `SingleSupplierDataSource`.</span></span> <span data-ttu-id="121e7-175">À partir de sa balise active, cliquez sur le lien configurer la Source de données et il avoir à utiliser le `SuppliersBLL` classe s `GetSupplierBySupplierID(supplierID)` (méthode).</span><span class="sxs-lookup"><span data-stu-id="121e7-175">From its smart tag, click the Configure Data Source link and have it use the `SuppliersBLL` class s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="121e7-176">Comme avec la `AllSuppliersDataSource` ObjectDataSource, ont le `SingleSupplierDataSource` ObjectDataSource s `Update()` méthode mappée à la `SuppliersBLL` classe s `UpdateSupplierAddress` (méthode).</span><span class="sxs-lookup"><span data-stu-id="121e7-176">As with the `AllSuppliersDataSource` ObjectDataSource, have the `SingleSupplierDataSource` ObjectDataSource s `Update()` method mapped to the `SuppliersBLL` class s `UpdateSupplierAddress` method.</span></span>


<span data-ttu-id="121e7-177">[![Configurer pour utiliser la méthode GetSupplierBySupplierID(supplierID) SingleSupplierDataSource ObjectDataSource](limiting-data-modification-functionality-based-on-the-user-vb/_static/image20.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="121e7-177">[![Configure the SingleSupplierDataSource ObjectDataSource to Use the GetSupplierBySupplierID(supplierID) Method](limiting-data-modification-functionality-based-on-the-user-vb/_static/image20.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image19.png)</span></span>

<span data-ttu-id="121e7-178">**Figure 7**: configurer le `SingleSupplierDataSource` ObjectDataSource à utiliser le `GetSupplierBySupplierID(supplierID)` (méthode) ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="121e7-178">**Figure 7**: Configure the `SingleSupplierDataSource` ObjectDataSource to Use the `GetSupplierBySupplierID(supplierID)` Method ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image21.png))</span></span>


<span data-ttu-id="121e7-179">Ensuite, nous re invité à spécifier le paramètre source pour le `GetSupplierBySupplierID(supplierID)` méthode s `supplierID` paramètre d’entrée.</span><span class="sxs-lookup"><span data-stu-id="121e7-179">Next, we re prompted to specify the parameter source for the `GetSupplierBySupplierID(supplierID)` method s `supplierID` input parameter.</span></span> <span data-ttu-id="121e7-180">Étant donné que vous voulez afficher les informations pour le fournisseur sélectionné dans la liste déroulante, utilisez la `Suppliers` DropDownList s `SelectedValue` propriété en tant que le paramètre source.</span><span class="sxs-lookup"><span data-stu-id="121e7-180">Since we want to show the information for the supplier selected from the DropDownList, use the `Suppliers` DropDownList s `SelectedValue` property as the parameter source.</span></span>


<span data-ttu-id="121e7-181">[![Utiliser des fournisseurs DropDownList en tant que Source du paramètre supplierID](limiting-data-modification-functionality-based-on-the-user-vb/_static/image23.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="121e7-181">[![Use the Suppliers DropDownList as the supplierID Parameter Source](limiting-data-modification-functionality-based-on-the-user-vb/_static/image23.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image22.png)</span></span>

<span data-ttu-id="121e7-182">**Figure 8**: utilisez le `Suppliers` DropDownList en tant que le `supplierID` Source du paramètre ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="121e7-182">**Figure 8**: Use the `Suppliers` DropDownList as the `supplierID` Parameter Source ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image24.png))</span></span>


<span data-ttu-id="121e7-183">Même avec cette ObjectDataSource deuxième ajouté, le contrôle DetailsView est actuellement configuré pour toujours utiliser le `AllSuppliersDataSource` ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="121e7-183">Even with this second ObjectDataSource added, the DetailsView control is currently configured to always use the `AllSuppliersDataSource` ObjectDataSource.</span></span> <span data-ttu-id="121e7-184">Nous devons ajouter la logique pour ajuster la source de données utilisée par le contrôle DetailsView selon le `Suppliers` DropDownList élément sélectionné.</span><span class="sxs-lookup"><span data-stu-id="121e7-184">We need to add logic to adjust the data source used by the DetailsView depending on the `Suppliers` DropDownList item selected.</span></span> <span data-ttu-id="121e7-185">Pour ce faire, créez un `SelectedIndexChanged` Gestionnaire d’événements pour les fournisseurs DropDownList.</span><span class="sxs-lookup"><span data-stu-id="121e7-185">To accomplish this, create a `SelectedIndexChanged` event handler for the Suppliers DropDownList.</span></span> <span data-ttu-id="121e7-186">Il est possible que celle-ci peut être plus facilement créée en double-cliquant sur DropDownList dans le concepteur.</span><span class="sxs-lookup"><span data-stu-id="121e7-186">This can most easily be created by double-clicking the DropDownList in the Designer.</span></span> <span data-ttu-id="121e7-187">Ce gestionnaire d’événements doit déterminer quelle source de données à utiliser et doit lier de nouveau les données au contrôle DetailsView.</span><span class="sxs-lookup"><span data-stu-id="121e7-187">This event handler needs to determine what data source to use and must rebind the data to the DetailsView.</span></span> <span data-ttu-id="121e7-188">Cela est accompli par le code suivant :</span><span class="sxs-lookup"><span data-stu-id="121e7-188">This is accomplished with the following code:</span></span>


[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample3.vb)]

<span data-ttu-id="121e7-189">Le Gestionnaire d’événements commence en déterminant si l’option « Afficher/modifier tous les fournisseurs » a été sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="121e7-189">The event handler begins by determining whether the "Show/Edit ALL Suppliers" option was selected.</span></span> <span data-ttu-id="121e7-190">S’il est, elle définit le `SupplierDetails` DetailsView s `DataSourceID` à `AllSuppliersDataSource` et renvoie l’utilisateur vers le premier enregistrement dans le jeu de fournisseurs en définissant le `PageIndex` 0 à la propriété.</span><span class="sxs-lookup"><span data-stu-id="121e7-190">If it was, it sets the `SupplierDetails` DetailsView s `DataSourceID` to `AllSuppliersDataSource` and returns the user to the first record in the set of suppliers by setting the `PageIndex` property to 0.</span></span> <span data-ttu-id="121e7-191">Si, toutefois, l’utilisateur a sélectionné un fournisseur dans la liste déroulante, le contrôle DetailsView s `DataSourceID` est affectée à `SingleSuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="121e7-191">If, however, the user has selected a particular supplier from the DropDownList, the DetailsView s `DataSourceID` is assigned to `SingleSuppliersDataSource`.</span></span> <span data-ttu-id="121e7-192">Quel que soit les données source est utilisée, le `SuppliersDetails` mode est restauré vers le mode lecture seule et les données sont reliées au contrôle DetailsView par un appel à la `SuppliersDetails` contrôle s `DataBind()` (méthode).</span><span class="sxs-lookup"><span data-stu-id="121e7-192">Regardless of what data source is used, the `SuppliersDetails` mode is reverted back to the read-only mode and the data is rebound to the DetailsView by a call to the `SuppliersDetails` control s `DataBind()` method.</span></span>

<span data-ttu-id="121e7-193">Avec ce gestionnaire d’événements en place, le contrôle DetailsView affiche maintenant le fournisseur sélectionné, sauf si l’option « Afficher/modifier tous les fournisseurs » a été sélectionnée, auquel cas des fournisseurs peuvent être consultés via l’interface de pagination.</span><span class="sxs-lookup"><span data-stu-id="121e7-193">With this event handler in place, the DetailsView control now shows the selected supplier, unless the "Show/Edit ALL Suppliers" option was selected, in which case all of the suppliers can be viewed through the paging interface.</span></span> <span data-ttu-id="121e7-194">La figure 9 illustre la page avec l’option « Afficher/modifier tous les fournisseurs » sélectionnée ; Notez que l’interface de la pagination est présent, permettant à l’utilisateur à consulter et mettre à jour n’importe quel fournisseur.</span><span class="sxs-lookup"><span data-stu-id="121e7-194">Figure 9 shows the page with the "Show/Edit ALL Suppliers" option selected; note that the paging interface is present, allowing the user to visit and update any supplier.</span></span> <span data-ttu-id="121e7-195">La figure 10 illustre la page avec le fournisseur de Ma Maison sélectionné.</span><span class="sxs-lookup"><span data-stu-id="121e7-195">Figure 10 shows the page with the Ma Maison supplier selected.</span></span> <span data-ttu-id="121e7-196">Seules les informations de s Ma Maison sont visibles et modifiables dans ce cas.</span><span class="sxs-lookup"><span data-stu-id="121e7-196">Only Ma Maison s information is viewable and editable in this case.</span></span>


<span data-ttu-id="121e7-197">[![Toutes les informations de fournisseurs peuvent être affichées et modifiées](limiting-data-modification-functionality-based-on-the-user-vb/_static/image26.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="121e7-197">[![All of the Suppliers Information Can Be Viewed and Edited](limiting-data-modification-functionality-based-on-the-user-vb/_static/image26.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image25.png)</span></span>

<span data-ttu-id="121e7-198">**Figure 9**: tous les fournisseurs d’informations peuvent être affichées et modifiées ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="121e7-198">**Figure 9**: All of the Suppliers Information Can Be Viewed and Edited ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image27.png))</span></span>


<span data-ttu-id="121e7-199">[![Seules les informations du fournisseur sélectionné s peuvent être affichées et modifiées](limiting-data-modification-functionality-based-on-the-user-vb/_static/image29.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="121e7-199">[![Only the Selected Supplier s Information Can Be Viewed and Edited](limiting-data-modification-functionality-based-on-the-user-vb/_static/image29.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image28.png)</span></span>

<span data-ttu-id="121e7-200">**La figure 10**: seules les opérations de mappage sélectionné un fournisseur d’informations peuvent être affichage et modifiée ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="121e7-200">**Figure 10**: Only the Selected Supplier s Information Can Be Viewed and Edited ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image30.png))</span></span>


> [!NOTE]
> <span data-ttu-id="121e7-201">Pour ce didacticiel, le contrôle DetailsView et DropDownList contrôlent s `EnableViewState` doit avoir la valeur `true` (la valeur par défaut), car le s DropDownList `SelectedIndex` et le contrôle DetailsView `DataSourceID` modifications apportées aux propriétés s doit être mémorisées entre publications (postback).</span><span class="sxs-lookup"><span data-stu-id="121e7-201">For this tutorial, both the DropDownList and DetailsView control s `EnableViewState` must be set to `true` (the default) because the DropDownList s `SelectedIndex` and the DetailsView s `DataSourceID` property s changes must be remembered across postbacks.</span></span>


## <a name="step-4-listing-the-suppliers-products-in-an-editable-gridview"></a><span data-ttu-id="121e7-202">Étape 4 : Répertorier les fournisseurs de produits dans un GridView modifiable</span><span class="sxs-lookup"><span data-stu-id="121e7-202">Step 4: Listing the Suppliers Products in an Editable GridView</span></span>

<span data-ttu-id="121e7-203">Avec le contrôle DetailsView terminé, l’étape suivante est d’inclure un GridView modifiable qui répertorie les produits fournis par le fournisseur sélectionné.</span><span class="sxs-lookup"><span data-stu-id="121e7-203">With the DetailsView complete, our next step is to include an editable GridView that lists those products provided by the selected supplier.</span></span> <span data-ttu-id="121e7-204">Ce contrôle GridView doit autoriser les modifications aux seuls le `ProductName` et `QuantityPerUnit` champs.</span><span class="sxs-lookup"><span data-stu-id="121e7-204">This GridView should allow edits to only the `ProductName` and `QuantityPerUnit` fields.</span></span> <span data-ttu-id="121e7-205">En outre, si l’utilisateur sur la page provient d’un fournisseur particulier, il ne doit autoriser les mises à jour sur les produits qui sont *pas* abandonné.</span><span class="sxs-lookup"><span data-stu-id="121e7-205">Moreover, if the user visiting the page is from a particular supplier, it should only allow updates to those products that are *not* discontinued.</span></span> <span data-ttu-id="121e7-206">Pour y parvenir nous devez tout d’abord ajouter une surcharge de la `ProductsBLL` classe s `UpdateProducts` méthode qui accepte uniquement le `ProductID`, `ProductName`, et `QuantityPerUnit` champs en tant qu’entrées.</span><span class="sxs-lookup"><span data-stu-id="121e7-206">To accomplish this we'll need to first add an overload of the `ProductsBLL` class s `UpdateProducts` method that takes in just the `ProductID`, `ProductName`, and `QuantityPerUnit` fields as inputs.</span></span> <span data-ttu-id="121e7-207">Nous ve à ce processus pas au préalable dans nombreux didacticiels, laissez donc s seulement rechercher ici, le code qui doit être ajouté à `ProductsBLL`:</span><span class="sxs-lookup"><span data-stu-id="121e7-207">We ve stepped through this process beforehand in numerous tutorials, so let s just look at the code here, which should be added to `ProductsBLL`:</span></span>


[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample4.vb)]

<span data-ttu-id="121e7-208">Avec cette surcharge créée, nous re prêt à ajouter le contrôle GridView et son ObjectDataSource associé.</span><span class="sxs-lookup"><span data-stu-id="121e7-208">With this overload created, we re ready to add the GridView control and its associated ObjectDataSource.</span></span> <span data-ttu-id="121e7-209">Ajouter un nouveau GridView à la page, définissez son `ID` propriété `ProductsBySupplier`et le configurer pour utiliser un nouveau ObjectDataSource nommé `ProductsBySupplierDataSource`.</span><span class="sxs-lookup"><span data-stu-id="121e7-209">Add a new GridView to the page, set its `ID` property to `ProductsBySupplier`, and configure it to use a new ObjectDataSource named `ProductsBySupplierDataSource`.</span></span> <span data-ttu-id="121e7-210">Étant donné que nous voulons que ce contrôle GridView à répertorier les produits par le fournisseur sélectionné, utilisez le `ProductsBLL` classe s `GetProductsBySupplierID(supplierID)` (méthode).</span><span class="sxs-lookup"><span data-stu-id="121e7-210">Since we want this GridView to list those products by the selected supplier, use the `ProductsBLL` class s `GetProductsBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="121e7-211">Également mapper les `Update()` (méthode) vers le nouveau `UpdateProduct` surcharge que nous venons de créer.</span><span class="sxs-lookup"><span data-stu-id="121e7-211">Also map the `Update()` method to the new `UpdateProduct` overload we just created.</span></span>


<span data-ttu-id="121e7-212">[![Configurer l’ObjectDataSource pour utiliser la surcharge UpdateProduct venez de créer](limiting-data-modification-functionality-based-on-the-user-vb/_static/image32.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="121e7-212">[![Configure the ObjectDataSource to Use the UpdateProduct Overload Just Created](limiting-data-modification-functionality-based-on-the-user-vb/_static/image32.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image31.png)</span></span>

<span data-ttu-id="121e7-213">**Figure 11**: configurer l’ObjectDataSource à utiliser le `UpdateProduct` surcharge venez de créer ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="121e7-213">**Figure 11**: Configure the ObjectDataSource to Use the `UpdateProduct` Overload Just Created ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image33.png))</span></span>


<span data-ttu-id="121e7-214">Nous re vous y êtes invité à sélectionner la source de paramètre pour le `GetProductsBySupplierID(supplierID)` méthode s `supplierID` paramètre d’entrée.</span><span class="sxs-lookup"><span data-stu-id="121e7-214">We re prompted to select the parameter source for the `GetProductsBySupplierID(supplierID)` method s `supplierID` input parameter.</span></span> <span data-ttu-id="121e7-215">Étant donné que nous voulons afficher les produits pour le fournisseur sélectionné dans le contrôle DetailsView, utilisez le `SuppliersDetails` le contrôle DetailsView s `SelectedValue` propriété en tant que le paramètre source.</span><span class="sxs-lookup"><span data-stu-id="121e7-215">Since we want to show the products for the supplier selected in the DetailsView, use the `SuppliersDetails` DetailsView control s `SelectedValue` property as the parameter source.</span></span>


<span data-ttu-id="121e7-216">[![Utilisez la propriété SelectedValue de s SuppliersDetails DetailsView comme Source du paramètre](limiting-data-modification-functionality-based-on-the-user-vb/_static/image35.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="121e7-216">[![Use the SuppliersDetails DetailsView s SelectedValue Property as the Parameter Source](limiting-data-modification-functionality-based-on-the-user-vb/_static/image35.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image34.png)</span></span>

<span data-ttu-id="121e7-217">**Figure 12**: utilisez le `SuppliersDetails` DetailsView s `SelectedValue` propriété comme Source du paramètre ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="121e7-217">**Figure 12**: Use the `SuppliersDetails` DetailsView s `SelectedValue` Property as the Parameter Source ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image36.png))</span></span>


<span data-ttu-id="121e7-218">Retour au GridView, supprimez tous les champs à l’exception de GridView `ProductName`, `QuantityPerUnit`, et `Discontinued`, marquage le `Discontinued` CheckBoxField en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="121e7-218">Returning to the GridView, remove all of the GridView fields except for `ProductName`, `QuantityPerUnit`, and `Discontinued`, marking the `Discontinued` CheckBoxField as read-only.</span></span> <span data-ttu-id="121e7-219">Vérifiez également l’option Activer la modification de la balise active de GridView s.</span><span class="sxs-lookup"><span data-stu-id="121e7-219">Also, check the Enable Editing option from the GridView s smart tag.</span></span> <span data-ttu-id="121e7-220">Après ont apporté ces modifications, le balisage déclaratif pour le contrôle GridView et ObjectDataSource doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="121e7-220">After these changes have been made, the declarative markup for the GridView and ObjectDataSource should look similar to the following:</span></span>


[!code-aspx[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample5.aspx)]

<span data-ttu-id="121e7-221">Comme avec notre ObjectDataSources précédente, ce un s `OldValuesParameterFormatString` est définie sur `original_{0}`, ce qui entraîne des problèmes lorsque vous tentez de mettre à jour un nom de produit s ou de la quantité par unité.</span><span class="sxs-lookup"><span data-stu-id="121e7-221">As with our previous ObjectDataSources, this one s `OldValuesParameterFormatString` property is set to `original_{0}`, which will cause problems when attempting to update a product s name or quantity per unit.</span></span> <span data-ttu-id="121e7-222">Supprimez cette propriété à partir de la syntaxe déclarative entièrement ou lui affectez la valeur par défaut, `{0}`.</span><span class="sxs-lookup"><span data-stu-id="121e7-222">Remove this property from the declarative syntax altogether or set it to its default, `{0}`.</span></span>

<span data-ttu-id="121e7-223">Avec cette configuration terminée, notre page répertorie maintenant les produits fournis par le fournisseur sélectionné dans le contrôle GridView (voir la Figure 13).</span><span class="sxs-lookup"><span data-stu-id="121e7-223">With this configuration complete, our page now lists the products provided by the supplier selected in the GridView (see Figure 13).</span></span> <span data-ttu-id="121e7-224">Actuellement *tout* quantité par unité ou nom de produit s peut être mis à jour.</span><span class="sxs-lookup"><span data-stu-id="121e7-224">Currently *any* product s name or quantity per unit can be updated.</span></span> <span data-ttu-id="121e7-225">Toutefois, nous devons mettre à jour notre logique de page afin que cette fonctionnalité est interdite pour les produits supprimées pour les utilisateurs associés à un fournisseur particulier.</span><span class="sxs-lookup"><span data-stu-id="121e7-225">However, we need to update our page logic so that such functionality is prohibited for discontinued products for users associated with a particular supplier.</span></span> <span data-ttu-id="121e7-226">Nous allons aborder cette dernière partie à l’étape 5.</span><span class="sxs-lookup"><span data-stu-id="121e7-226">We'll tackle this final piece in Step 5.</span></span>


<span data-ttu-id="121e7-227">[![Les produits fournis par le fournisseur sélectionné sont affichés.](limiting-data-modification-functionality-based-on-the-user-vb/_static/image38.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="121e7-227">[![The Products Provided by the Selected Supplier are Displayed](limiting-data-modification-functionality-based-on-the-user-vb/_static/image38.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image37.png)</span></span>

<span data-ttu-id="121e7-228">**Figure 13**: les produits fournis par le fournisseur sélectionné sont affichés ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="121e7-228">**Figure 13**: The Products Provided by the Selected Supplier are Displayed ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image39.png))</span></span>


> [!NOTE]
> <span data-ttu-id="121e7-229">Avec l’ajout de ce contrôle GridView modifiable le `Suppliers` DropDownList s `SelectedIndexChanged` Gestionnaire d’événements doit être mis à jour pour retourner le contrôle GridView à l’état en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="121e7-229">With the addition of this editable GridView the `Suppliers` DropDownList s `SelectedIndexChanged` event handler should be updated to return the GridView to a read-only state.</span></span> <span data-ttu-id="121e7-230">Sinon, si un autre fournisseur est sélectionné au milieu de la modification des informations de produit, l’index correspondant dans le GridView pour le nouveau fournisseur est également modifiables.</span><span class="sxs-lookup"><span data-stu-id="121e7-230">Otherwise, if a different supplier is selected while in the middle of editing product information, the corresponding index in the GridView for the new supplier will also be editable.</span></span> <span data-ttu-id="121e7-231">Pour éviter ce problème, définissez simplement le GridView s `EditIndex` propriété `-1` dans le `SelectedIndexChanged` Gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="121e7-231">To prevent this, simply set the GridView s `EditIndex` property to `-1` in the `SelectedIndexChanged` event handler.</span></span>


<span data-ttu-id="121e7-232">En outre, rappelez-vous qu’il est important que le contrôle GridView s vue état activé (comportement par défaut).</span><span class="sxs-lookup"><span data-stu-id="121e7-232">Also, recall that it is important that the GridView s view state be enabled (the default behavior).</span></span> <span data-ttu-id="121e7-233">Si vous définissez le GridView s `EnableViewState` propriété `false`, vous courez le risque d’avoir des utilisateurs simultanés involontairement supprimer ou de modifier des enregistrements.</span><span class="sxs-lookup"><span data-stu-id="121e7-233">If you set the GridView s `EnableViewState` property to `false`, you run the risk of having concurrent users unintentionally deleting or editing records.</span></span> <span data-ttu-id="121e7-234">Consultez [Avertissement : problème de concurrence avec ASP.NET 2.0 contrôles GridView/DetailsView/FormViews cette modification de la prise en charge et/ou la suppression et la dont l’état d’affichage est désactivé](http://scottonwriting.net/sowblog/posts/10054.aspx) pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="121e7-234">See [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/posts/10054.aspx) for more information.</span></span>

## <a name="step-5-disallow-editing-for-discontinued-products-when-showedit-all-suppliers-is-not-selected"></a><span data-ttu-id="121e7-235">Étape 5 : Interdire la modification pour abandonné produits quand afficher/modifier tous les fournisseurs n’est pas sélectionnée</span><span class="sxs-lookup"><span data-stu-id="121e7-235">Step 5: Disallow Editing for Discontinued Products When Show/Edit ALL Suppliers is Not Selected</span></span>

<span data-ttu-id="121e7-236">Alors que le `ProductsBySupplier` GridView est entièrement fonctionnelle, il actuellement accorde un trop grand nombre d’accès aux utilisateurs d’un fournisseur particulier.</span><span class="sxs-lookup"><span data-stu-id="121e7-236">While the `ProductsBySupplier` GridView is fully functional, it currently grants too much access to those users who are from a particular supplier.</span></span> <span data-ttu-id="121e7-237">Par ses règles d’entreprise, ces utilisateurs ne doivent pas être en mesure de mettre à jour des produits abandonnés.</span><span class="sxs-lookup"><span data-stu-id="121e7-237">Per our business rules, such users should not be able to update discontinued products.</span></span> <span data-ttu-id="121e7-238">Pour appliquer cette recommandation, nous pouvons masquer (ou désactiver) le bouton Modifier dans les lignes de GridView avec les produits supprimées lorsque la page est en cours visitée par un utilisateur à partir d’un fournisseur.</span><span class="sxs-lookup"><span data-stu-id="121e7-238">To enforce this, we can hide (or disable) the Edit button in those GridView rows with discontinued products when the page is being visited by a user from a supplier.</span></span>

<span data-ttu-id="121e7-239">Créer un gestionnaire d’événements pour le contrôle GridView s `RowDataBound` événement.</span><span class="sxs-lookup"><span data-stu-id="121e7-239">Create an event handler for the GridView s `RowDataBound` event.</span></span> <span data-ttu-id="121e7-240">Dans ce gestionnaire d’événements, nous devons déterminer si l’utilisateur est associé à un fournisseur, qui, pour ce didacticiel, peut être déterminé en vérifiant le s fournisseurs DropDownList `SelectedValue` propriété - si elle s quelque chose d’autre que -1, l’utilisateur est associé à un fournisseur particulier.</span><span class="sxs-lookup"><span data-stu-id="121e7-240">In this event handler we need to determine whether or not the user is associated with a particular supplier, which, for this tutorial, can be determined by checking the Suppliers DropDownList s `SelectedValue` property - if it s something other than -1, then the user is associated with a particular supplier.</span></span> <span data-ttu-id="121e7-241">Dans ce cas, nous devons déterminer si le produit n’est plus disponible.</span><span class="sxs-lookup"><span data-stu-id="121e7-241">For such users, we then need to determine whether or not the product is discontinued.</span></span> <span data-ttu-id="121e7-242">Nous pouvons saisir une référence à l’élément réel `ProductRow` instance liée à la ligne GridView via la `e.Row.DataItem` propriété, comme indiqué dans le [ *affichant des informations de résumé dans le pied de page/s GridView* ](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) didacticiel.</span><span class="sxs-lookup"><span data-stu-id="121e7-242">We can grab a reference to the actual `ProductRow` instance bound to the GridView row via the `e.Row.DataItem` property, as discussed in the [*Displaying Summary Information in the GridView s Footer*](../custom-formatting/displaying-summary-information-in-the-gridview-s-footer-vb.md) tutorial.</span></span> <span data-ttu-id="121e7-243">Si le produit n’est plus disponible, nous pouvons saisir une référence de programmation pour le bouton Modifier dans le s GridView CommandField utilisant les techniques présentées dans le didacticiel précédent, [ *Ajout côté Client Confirmation lors de la suppression de* ](adding-client-side-confirmation-when-deleting-vb.md).</span><span class="sxs-lookup"><span data-stu-id="121e7-243">If the product is discontinued, we can grab a programmatic reference to the Edit button in the GridView s CommandField using the techniques discussed in the previous tutorial, [*Adding Client-Side Confirmation When Deleting*](adding-client-side-confirmation-when-deleting-vb.md).</span></span> <span data-ttu-id="121e7-244">Une fois que nous avons une référence, nous pouvons ensuite masquer ou désactiver le bouton.</span><span class="sxs-lookup"><span data-stu-id="121e7-244">Once we have a reference we can then hide or disable the button.</span></span>


[!code-vb[Main](limiting-data-modification-functionality-based-on-the-user-vb/samples/sample6.vb)]

<span data-ttu-id="121e7-245">Avec cet événement gestionnaire en place, lorsque vous visitez cette page en tant qu’utilisateur auprès d’un fournisseur spécifique les produits qui sont supprimés ne sont pas modifiables, comme le bouton Modifier est masquée pour ces produits.</span><span class="sxs-lookup"><span data-stu-id="121e7-245">With this event handler in place, when visiting this page as a user from a specific supplier those products that are discontinued are not editable, as the Edit button is hidden for these products.</span></span> <span data-ttu-id="121e7-246">Par exemple, Chef Anton s Gumbo Mix est un produit supprimée pour le fournisseur New Orleans Cajun Delights.</span><span class="sxs-lookup"><span data-stu-id="121e7-246">For example, Chef Anton s Gumbo Mix is a discontinued product for the New Orleans Cajun Delights supplier.</span></span> <span data-ttu-id="121e7-247">Lorsque vous visitez la page pour ce fournisseur, le bouton Modifier pour ce produit est masqué (voir Figure 14).</span><span class="sxs-lookup"><span data-stu-id="121e7-247">When visiting the page for this particular supplier, the Edit button for this product is hidden from sight (see Figure 14).</span></span> <span data-ttu-id="121e7-248">Toutefois, lors de la visite à l’aide de la « afficher/modifier tous les fournisseurs », le bouton Modifier est disponible (voir Figure 15).</span><span class="sxs-lookup"><span data-stu-id="121e7-248">However, when visiting using the "Show/Edit ALL Suppliers," the Edit button is available (see Figure 15).</span></span>


<span data-ttu-id="121e7-249">[![Pour les utilisateurs de fournisseur spécifique, le bouton Modifier pour Chef Anton s Gumbo Mix est masqué](limiting-data-modification-functionality-based-on-the-user-vb/_static/image41.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="121e7-249">[![For Supplier-Specific Users the Edit Button for Chef Anton s Gumbo Mix is Hidden](limiting-data-modification-functionality-based-on-the-user-vb/_static/image41.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image40.png)</span></span>

<span data-ttu-id="121e7-250">**La figure 14**: des utilisateurs de fournisseurs le bouton Modifier pour Chef Anton s Gumbo Mix est masqué ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="121e7-250">**Figure 14**: For Supplier-Specific Users the Edit Button for Chef Anton s Gumbo Mix is Hidden ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image42.png))</span></span>


<span data-ttu-id="121e7-251">[![Pour afficher/modifier tous les fournisseurs s’affiche le bouton Modifier pour Chef Anton s Gumbo Mix](limiting-data-modification-functionality-based-on-the-user-vb/_static/image44.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="121e7-251">[![For Show/Edit ALL Suppliers Users, the Edit Button for Chef Anton s Gumbo Mix is Displayed](limiting-data-modification-functionality-based-on-the-user-vb/_static/image44.png)](limiting-data-modification-functionality-based-on-the-user-vb/_static/image43.png)</span></span>

<span data-ttu-id="121e7-252">**Figure 15**: pour afficher/modifier tous les fournisseurs les utilisateurs, le bouton Modifier pour s Chef Anton Gumbo Mix s’affiche ([cliquez pour afficher l’image en taille réelle](limiting-data-modification-functionality-based-on-the-user-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="121e7-252">**Figure 15**: For Show/Edit ALL Suppliers Users, the Edit Button for Chef Anton s Gumbo Mix is Displayed ([Click to view full-size image](limiting-data-modification-functionality-based-on-the-user-vb/_static/image45.png))</span></span>


## <a name="checking-for-access-rights-in-the-business-logic-layer"></a><span data-ttu-id="121e7-253">La vérification des droits d’accès de la couche de logique métier</span><span class="sxs-lookup"><span data-stu-id="121e7-253">Checking for Access Rights in the Business Logic Layer</span></span>

<span data-ttu-id="121e7-254">Dans ce didacticiel ASP.NET page gère toute la logique en ce qui concerne les informations que l’utilisateur peut voir et les produits qu’il peut mettre à jour.</span><span class="sxs-lookup"><span data-stu-id="121e7-254">In this tutorial the ASP.NET page handles all logic with regards to what information the user can see and what products he can update.</span></span> <span data-ttu-id="121e7-255">Dans l’idéal, cette logique serait également présente au niveau de la couche de logique métier.</span><span class="sxs-lookup"><span data-stu-id="121e7-255">Ideally, this logic would also be present at the Business Logic Layer.</span></span> <span data-ttu-id="121e7-256">Par exemple, le `SuppliersBLL` classe s `GetSuppliers()` (méthode) (qui retourne tous les fournisseurs) peut inclure une vérification pour vous assurer que l’utilisateur actuellement connecté est *pas* associé à un fournisseur spécifique.</span><span class="sxs-lookup"><span data-stu-id="121e7-256">For example, the `SuppliersBLL` class s `GetSuppliers()` method (which returns all suppliers) might include a check to ensure that the currently logged on user is *not* associated with a specific supplier.</span></span> <span data-ttu-id="121e7-257">De même, la `UpdateSupplierAddress` méthode peut inclure une vérification pour vous assurer que l’utilisateur actuellement connecté, soit travaillé pour notre société (et par conséquent peut mettre à jour toutes les informations d’adresse de fournisseurs) ou est associé avec le fournisseur dont les données sont en cours de mise à jour.</span><span class="sxs-lookup"><span data-stu-id="121e7-257">Likewise, the `UpdateSupplierAddress` method could include a check to ensure that the currently logged on user either worked for our company (and therefore can update all suppliers address information) or is associated with the supplier whose data is being updated.</span></span>

<span data-ttu-id="121e7-258">Je n’incluait pas ces contrôles de la couche BLL ici, car notre didacticiel les droits d’utilisateur s sont déterminées par une liste déroulante dans la page, les classes de la couche BLL ne peut pas accéder.</span><span class="sxs-lookup"><span data-stu-id="121e7-258">I did not include such BLL-layer checks here because in our tutorial the user s rights are determined by a DropDownList on the page, which the BLL classes cannot access.</span></span> <span data-ttu-id="121e7-259">Lorsque vous utilisez le système d’appartenance ou un des schémas d’authentification hors à l’emploi fournies par ASP.NET (par exemple, l’authentification Windows), actuellement connecté sur utilisateur s plus d’informations et des informations sur les rôles sont accessibles à partir de la couche BLL, rendant ce type d’accès droits vérifie possible à la présentation et les couches de la couche BLL.</span><span class="sxs-lookup"><span data-stu-id="121e7-259">When using the membership system or one of the out-of-the box authentication schemes provided by ASP.NET (such as Windows authentication), the currently logged on user s information and roles information can be accessed from the BLL, thereby making such access rights checks possible at both the presentation and BLL layers.</span></span>

## <a name="summary"></a><span data-ttu-id="121e7-260">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="121e7-260">Summary</span></span>

<span data-ttu-id="121e7-261">La plupart des sites qui fournissent des comptes d’utilisateur doivent personnaliser l’interface de modification de données en fonction de l’utilisateur connecté.</span><span class="sxs-lookup"><span data-stu-id="121e7-261">Most sites that provide user accounts need to customize the data modification interface based upon the logged in user.</span></span> <span data-ttu-id="121e7-262">Les utilisateurs administratifs peuvent être en mesure de supprimer et de modifier n’importe quel enregistrement, alors que les utilisateurs non-administrateurs peuvent être limités à uniquement la mise à jour ou supprimer des enregistrements, ils ont créés eux-mêmes.</span><span class="sxs-lookup"><span data-stu-id="121e7-262">Administrative users may be able to delete and edit any record, whereas non-administrative users may be limited to only updating or deleting records they created themselves.</span></span> <span data-ttu-id="121e7-263">Quel que soit le scénario peut être, les contrôles Web, ObjectDataSource, données et classes de la couche de logique métier peuvent être étendues pour ajouter ou de refus de certaines fonctionnalités en fonction de l’utilisateur connecté.</span><span class="sxs-lookup"><span data-stu-id="121e7-263">Whatever the scenario may be, the data Web controls, ObjectDataSource, and Business Logic Layer classes can be extended to add or deny certain functionality based on the logged on user.</span></span> <span data-ttu-id="121e7-264">Dans ce didacticiel, nous avons vu comment limiter les données visibles et modifiables selon si l’utilisateur a été associé à un fournisseur particulier ou si tout a fonctionné pour notre société.</span><span class="sxs-lookup"><span data-stu-id="121e7-264">In this tutorial we saw how to limit the viewable and editable data depending on whether the user was associated with a particular supplier or if they worked for our company.</span></span>

<span data-ttu-id="121e7-265">Ce didacticiel conclut notre examen d’insertion, de mise à jour et de suppression des données à l’aide de contrôles GridView, DetailsView et FormView.</span><span class="sxs-lookup"><span data-stu-id="121e7-265">This tutorial concludes our examination of inserting, updating, and deleting data using the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="121e7-266">À partir de l’étape suivante du didacticiel, nous allons notre attention à l’ajout de la pagination et le tri de prise en charge.</span><span class="sxs-lookup"><span data-stu-id="121e7-266">Starting with the next tutorial, we'll turn our attention to adding paging and sorting support.</span></span>

<span data-ttu-id="121e7-267">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="121e7-267">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="121e7-268">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="121e7-268">About the Author</span></span>

<span data-ttu-id="121e7-269">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept manuels ASP/ASP.NET et créateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="121e7-269">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="121e7-270">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="121e7-270">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="121e7-271">Son dernier ouvrage est [ *SAM animer vous-même ASP.NET 2.0 des dernières 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="121e7-271">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="121e7-272">Il peut être atteint à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) ou via son blog, qui se trouvent à [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="121e7-272">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="121e7-273">Précédent</span><span class="sxs-lookup"><span data-stu-id="121e7-273">Previous</span></span>](adding-client-side-confirmation-when-deleting-vb.md)
