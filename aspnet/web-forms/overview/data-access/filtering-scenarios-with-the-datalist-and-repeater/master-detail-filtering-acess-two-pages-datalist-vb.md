---
uid: web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-filtering-acess-two-pages-datalist-vb
title: Maître/détail, le filtrage entre les deux Pages (VB) | Documents Microsoft
author: rick-anderson
description: Dans ce didacticiel, nous allons comment séparer un rapport maître/détail sur deux pages. Dans la page « master », nous utilisons un contrôle du répéteur pour afficher une liste de categ...
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/30/2010
ms.topic: article
ms.assetid: f1a1be2c-6fd9-4a09-916e-aa1b98d5cf17
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/filtering-scenarios-with-the-datalist-and-repeater/master-detail-filtering-acess-two-pages-datalist-vb
msc.type: authoredcontent
ms.openlocfilehash: 2afc216de3b6894cfdd112787ab92d7483198ecc
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/06/2018
---
<a name="masterdetail-filtering-across-two-pages-vb"></a><span data-ttu-id="2cfb8-104">Maître/détail, le filtrage entre les deux Pages (VB)</span><span class="sxs-lookup"><span data-stu-id="2cfb8-104">Master/Detail Filtering Across Two Pages (VB)</span></span>
====================
<span data-ttu-id="2cfb8-105">par [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2cfb8-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2cfb8-106">[Télécharger l’exemple d’application](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_34_VB.exe) ou [télécharger le PDF](master-detail-filtering-acess-two-pages-datalist-vb/_static/datatutorial34vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="2cfb8-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_34_VB.exe) or [Download PDF](master-detail-filtering-acess-two-pages-datalist-vb/_static/datatutorial34vb1.pdf)</span></span>

> <span data-ttu-id="2cfb8-107">Dans ce didacticiel, nous allons comment séparer un rapport maître/détail sur deux pages.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-107">In this tutorial we look at how to separate a master/detail report across two pages.</span></span> <span data-ttu-id="2cfb8-108">Dans la page « maître », nous utilisons un contrôle du répéteur pour afficher une liste de catégories qui, lorsque vous cliquez sur, dirige l’utilisateur à la page « Détails » où un contrôle DataList deux colonnes affiche les produits appartenant à la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-108">In the "master" page we use a Repeater control to render a list of categories that, when clicked, will take the user to the "details" page where a two-column DataList shows those products belonging to the selected category.</span></span>


## <a name="introduction"></a><span data-ttu-id="2cfb8-109">Introduction</span><span class="sxs-lookup"><span data-stu-id="2cfb8-109">Introduction</span></span>

<span data-ttu-id="2cfb8-110">Dans le [filtrage de maître/détail entre les deux Pages](../masterdetail/master-detail-filtering-across-two-pages-vb.md) didacticiel, nous avons examiné ce modèle à l’aide d’un contrôle GridView pour afficher tous les fournisseurs dans le système.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-110">In the [Master/Detail Filtering Across Two Pages](../masterdetail/master-detail-filtering-across-two-pages-vb.md) tutorial, we examined this pattern using a GridView to display all of the suppliers in the system.</span></span> <span data-ttu-id="2cfb8-111">Ce contrôle GridView inclus un HyperLinkField, ce qui est restitué sous la forme d’un lien vers une deuxième page, en passant le `SupplierID` dans la chaîne de requête.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-111">This GridView included a HyperLinkField, which rendered as a link to a second page, passing along the `SupplierID` in the querystring.</span></span> <span data-ttu-id="2cfb8-112">La deuxième page permet de répertorier les produits fournis par le fournisseur sélectionné un GridView.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-112">The second page used a GridView to list those products provided by the selected supplier.</span></span>

<span data-ttu-id="2cfb8-113">Ces rapports de deux pages maître/détail peuvent être accomplies à l’aide de contrôles DataList et répéteur.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-113">Such two-page master/detail reports can be accomplished using DataList and Repeater controls as well.</span></span> <span data-ttu-id="2cfb8-114">La seule différence est que le contrôle DataList, ni le répéteur prend en charge le contrôle HyperLinkField.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-114">The only difference is that neither the DataList nor the Repeater provides support for the HyperLinkField control.</span></span> <span data-ttu-id="2cfb8-115">Au lieu de cela, nous devons ajouter un contrôle de lien hypertexte Web ou un élément d’ancrage HTML (`<a>`) au sein du contrôle `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-115">Instead, we must add a HyperLink Web control or an anchor HTML element (`<a>`) within the control's `ItemTemplate`.</span></span> <span data-ttu-id="2cfb8-116">Du lien hypertexte `NavigateUrl` propriété ou le point d’ancrage `href` attribut peut ensuite être personnalisé à l’aide d’approches déclaratives ou par programme.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-116">The HyperLink's `NavigateUrl` property or the anchor's `href` attribute can then be customized using declarative or programmatic approaches.</span></span>

<span data-ttu-id="2cfb8-117">Dans ce didacticiel, nous allons explorer un exemple qui répertorie les catégories dans une liste à puces sur une page à l’aide d’un contrôle du répéteur.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-117">In this tutorial we'll explore an example that lists the categories in a bulleted list on one page using a Repeater control.</span></span> <span data-ttu-id="2cfb8-118">Chaque élément de liste inclut le nom et la description, de la catégorie avec le nom de catégorie affiché sous la forme d’un lien vers une deuxième page.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-118">Each list item will include the category's name and description, with the category name displayed as a link to a second page.</span></span> <span data-ttu-id="2cfb8-119">En cliquant sur ce lien sera tous l’utilisateur à la deuxième page, où un contrôle DataList affiche les produits qui appartiennent à la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-119">Clicking on this link will whisk the user to the second page, where a DataList will show those products that belong to the selected category.</span></span>

## <a name="step-1-displaying-the-categories-in-a-bulleted-list"></a><span data-ttu-id="2cfb8-120">Étape 1 : Afficher les catégories dans une liste à puces</span><span class="sxs-lookup"><span data-stu-id="2cfb8-120">Step 1: Displaying the Categories in a Bulleted List</span></span>

<span data-ttu-id="2cfb8-121">La première étape dans la création de n’importe quel rapport maître/détail consiste à démarrer en affichant les enregistrements « maîtres ».</span><span class="sxs-lookup"><span data-stu-id="2cfb8-121">The first step in creating any master/detail report is to start by displaying the "master" records.</span></span> <span data-ttu-id="2cfb8-122">Par conséquent, la première tâche est pour afficher les catégories dans la page « maître ».</span><span class="sxs-lookup"><span data-stu-id="2cfb8-122">Therefore, our first task is to display the categories in the "master" page.</span></span> <span data-ttu-id="2cfb8-123">Ouvrez le `CategoryListMaster.aspx` page dans le `DataListRepeaterFiltering` dossier, ajoutez un contrôle du répéteur et, à partir de la balise active, choisir d’ajouter un nouveau ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-123">Open the `CategoryListMaster.aspx` page in the `DataListRepeaterFiltering` folder, add a Repeater control, and, from the smart tag, opt to add a new ObjectDataSource.</span></span> <span data-ttu-id="2cfb8-124">Configurer le nouveau ObjectDataSource afin qu’il accède à ses données à partir de la `CategoriesBLL` la classe `GetCategories` (méthode) (voir Figure 1).</span><span class="sxs-lookup"><span data-stu-id="2cfb8-124">Configure the new ObjectDataSource so that it accesses its data from the `CategoriesBLL` class's `GetCategories` method (see Figure 1).</span></span>


<span data-ttu-id="2cfb8-125">[![Configurer pour utiliser méthode la classe CategoriesBLL GetCategories ObjectDataSource](master-detail-filtering-acess-two-pages-datalist-vb/_static/image2.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="2cfb8-125">[![Configure the ObjectDataSource to Use the CategoriesBLL Class's GetCategories Method](master-detail-filtering-acess-two-pages-datalist-vb/_static/image2.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image1.png)</span></span>

<span data-ttu-id="2cfb8-126">**Figure 1**: configurer l’ObjectDataSource à utiliser le `CategoriesBLL` de classe `GetCategories` (méthode) ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-acess-two-pages-datalist-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="2cfb8-126">**Figure 1**: Configure the ObjectDataSource to Use the `CategoriesBLL` Class's `GetCategories` Method ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image3.png))</span></span>


<span data-ttu-id="2cfb8-127">Ensuite, définissez les modèles de répéteur tel qu’il affiche chaque nom de catégorie et la description sous la forme d’un élément dans une liste à puces.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-127">Next, define the Repeater's templates such that it displays each category name and description as an item in a bulleted list.</span></span> <span data-ttu-id="2cfb8-128">Nous allons pas encore soucier chaque catégorie de lien vers la page de détails.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-128">Let's not yet worry about having each category link to the details page.</span></span> <span data-ttu-id="2cfb8-129">Vous trouverez ci-dessous le balisage déclaratif pour le répéteur et ObjectDataSource :</span><span class="sxs-lookup"><span data-stu-id="2cfb8-129">The following shows the declarative markup for the Repeater and ObjectDataSource:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample1.aspx)]

<span data-ttu-id="2cfb8-130">Avec ce balisage terminé, prenez un moment pour afficher la progression via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-130">With this markup complete, take a moment to view our progress through a browser.</span></span> <span data-ttu-id="2cfb8-131">Comme le montre la Figure 2, la répétition est rendu sous la forme d’une liste à puces montrant le nom et la description de chaque catégorie.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-131">As Figure 2 shows, the Repeater renders as a bulleted list showing each category's name and description.</span></span>


<span data-ttu-id="2cfb8-132">[![Chaque catégorie est affiché comme un élément de liste à puces](master-detail-filtering-acess-two-pages-datalist-vb/_static/image5.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="2cfb8-132">[![Each Category is Displayed as a Bulleted List Item](master-detail-filtering-acess-two-pages-datalist-vb/_static/image5.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image4.png)</span></span>

<span data-ttu-id="2cfb8-133">**Figure 2**: chaque catégorie est affiché comme un élément de liste à puces ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-acess-two-pages-datalist-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="2cfb8-133">**Figure 2**: Each Category is Displayed as a Bulleted List Item ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image6.png))</span></span>


## <a name="step-2-turning-the-category-name-into-a-link-to-the-details-page"></a><span data-ttu-id="2cfb8-134">Étape 2 : Activer le nom de catégorie dans un lien vers la Page de détails</span><span class="sxs-lookup"><span data-stu-id="2cfb8-134">Step 2: Turning the Category Name into a Link to the Details Page</span></span>

<span data-ttu-id="2cfb8-135">Pour autoriser un utilisateur afficher les informations de « détails » pour une catégorie donnée, nous devons ajouter un lien à chaque liste à puces d’élément qui, lorsque vous cliquez sur, dirige l’utilisateur à la deuxième page (`ProductsForCategoryDetails.aspx`).</span><span class="sxs-lookup"><span data-stu-id="2cfb8-135">To allow a user to display the "details" information for a given category, we need to add a link to each bulleted list item that, when clicked, will take the user to the second page (`ProductsForCategoryDetails.aspx`).</span></span> <span data-ttu-id="2cfb8-136">Cette seconde page puis affichera les produits pour la catégorie sélectionnée à l’aide d’un contrôle DataList.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-136">This second page will then display the products for the selected category using a DataList.</span></span> <span data-ttu-id="2cfb8-137">Afin de déterminer la catégorie dont le lien de l’utilisateur a cliqué, vous devez transmettre la catégorie d’un clic sur `CategoryID` à la deuxième page via un mécanisme.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-137">In order to determine the category whose link was clicked, we need to pass the clicked category's `CategoryID` to the second page through some mechanism.</span></span> <span data-ttu-id="2cfb8-138">La façon la plus simple, plus simple pour transférer des données scalaires à partir d’une page à l’autre est dans la chaîne de requête, qui est l’option que nous allons utiliser dans ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-138">The simplest, most straightforward way to transfer scalar data from one page to another is through the querystring, which is the option we'll use in this tutorial.</span></span> <span data-ttu-id="2cfb8-139">En particulier, la `ProductsForCategoryDetails.aspx` page attendra sélectionné *`categoryID`* valeur doit être passé à un champ de chaîne de requête nommé `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-139">In particular, the `ProductsForCategoryDetails.aspx` page will expect the selected *`categoryID`* value to be passed through a querystring field named `CategoryID`.</span></span> <span data-ttu-id="2cfb8-140">Par exemple, pour afficher les produits pour la catégorie boissons, qui a un `CategoryID` 1, un utilisateur visite `ProductsForCategoryDetails.aspx?CategoryID=1`.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-140">For example, to view the products for the Beverages category, which has a `CategoryID` of 1, a user would visit `ProductsForCategoryDetails.aspx?CategoryID=1`.</span></span>

<span data-ttu-id="2cfb8-141">Pour créer un lien hypertexte pour chaque élément de liste à puces dans le répéteur, nous devons ajouter un contrôle de lien hypertexte Web ou un élément d’ancrage HTML (`<a>`) pour le `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-141">To create a hyperlink for each bulleted list item in the Repeater we need to either add a HyperLink Web control or an HTML anchor element (`<a>`) to the `ItemTemplate`.</span></span> <span data-ttu-id="2cfb8-142">Dans les scénarios où le lien hypertexte est affichent la même pour chaque ligne, une de ces méthodes seront suffisante.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-142">In scenarios where the hyperlink is displayed the same for each row, either approach will suffice.</span></span> <span data-ttu-id="2cfb8-143">Pour répéteurs, je préfère à l’aide de l’élément d’ancrage.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-143">For Repeaters, I prefer using the anchor element.</span></span> <span data-ttu-id="2cfb8-144">Pour utiliser l’élément d’ancrage, mise à jour ItemTemplate de répéteur :</span><span class="sxs-lookup"><span data-stu-id="2cfb8-144">To use the anchor element, update the Repeater's ItemTemplate to:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample2.aspx)]

<span data-ttu-id="2cfb8-145">Notez que la `CategoryID` peuvent être ajoutées directement au sein de l’élément d’ancrage `href` attribut ; Toutefois, pour veillez donc à délimiter la `href` valeur de l’attribut avec les apostrophes (et notez les guillemets) depuis le `Eval` (méthode) dans le `href` attribut délimite sa chaîne (`"CategoryID"`) avec des guillemets.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-145">Note that the `CategoryID` can be injected directly within the anchor element's `href` attribute; however, to do so be certain to delimit the `href` attribute's value with apostrophes (and note quotation marks) since the `Eval` method within the `href` attribute delimits its string (`"CategoryID"`) with quotation marks.</span></span> <span data-ttu-id="2cfb8-146">Un contrôle de lien hypertexte Web peut également être utilisé à la place :</span><span class="sxs-lookup"><span data-stu-id="2cfb8-146">Alternatively, a HyperLink Web control can be used instead:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample3.aspx)]

<span data-ttu-id="2cfb8-147">Notez comment la partie statique de l’URL : `ProductsForCategoryDetails.aspx?CategoryID` , est ajouté au résultat de `Eval("CategoryID")` directement dans la syntaxe de liaison de données à l’aide de la concaténation de chaînes.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-147">Note how the static portion of the URL — `ProductsForCategoryDetails.aspx?CategoryID` — is appended to the result of `Eval("CategoryID")` directly within the databinding syntax using string concatenation.</span></span>

<span data-ttu-id="2cfb8-148">L’un des avantages de l’utilisation du contrôle de lien hypertexte sont qu’il par programmation accessibles à partir de répéteur `ItemDataBound` Gestionnaire d’événements, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-148">One benefit of using the HyperLink control is that it can be programmatically accessed from the Repeater's `ItemDataBound` event handler, if needed.</span></span> <span data-ttu-id="2cfb8-149">Par exemple, vous souhaiterez afficher le nom de catégorie sous forme de texte plutôt que comme un lien pour les catégories avec aucun produit associé.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-149">For example, you might want to display the category name as text rather than as a link for categories with no associated products.</span></span> <span data-ttu-id="2cfb8-150">Cette vérification puisse être effectuée par programmation dans le `ItemDataBound` Gestionnaire d’événements pour des catégories sans aucune associés produits, le lien hypertexte `NavigateUrl` propriété peut être définie sur une chaîne vide, entraînant de ce nom de catégorie rendu en tant que texte brut (plutôt que sous forme de lien).</span><span class="sxs-lookup"><span data-stu-id="2cfb8-150">Such a check could be programmatically performed in the `ItemDataBound` event handler; for categories with no associated products, the HyperLink's `NavigateUrl` property could be set to a blank string, thereby resulting in that particular category name rendering as plain text (rather than as a link).</span></span> <span data-ttu-id="2cfb8-151">Faire référence à la [mise en forme le contrôle DataList et données répéteur en fonction de](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb.md) didacticiel pour plus d’informations sur la mise en forme le contrôle DataList et du répéteur contenu basé sur la logique de programmation via la `ItemDataBound` Gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-151">Refer back to the [Formatting the DataList and Repeater Based Upon Data](../displaying-data-with-the-datalist-and-repeater/formatting-the-datalist-and-repeater-based-upon-data-vb.md) tutorial for more information on formatting the DataList and Repeater's contents based on programmatic logic through the `ItemDataBound` event handler.</span></span>

<span data-ttu-id="2cfb8-152">Si vous suivez le long, n’hésitez pas à utiliser un élément d’ancrage ou une approche de contrôle de lien hypertexte dans votre page.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-152">If you are following along, feel free to use either the anchor element or HyperLink control approach in your page.</span></span> <span data-ttu-id="2cfb8-153">Quelle que soit l’approche, lors de l’affichage de la page via un navigateur chaque nom de catégorie doit être restitué sous la forme d’un lien vers `ProductsForCategoryDetails.aspx`, en passant l’applicable `CategoryID` valeur (voir Figure 3).</span><span class="sxs-lookup"><span data-stu-id="2cfb8-153">Regardless of the approach, when viewing the page through a browser each category name should be rendered as a link to `ProductsForCategoryDetails.aspx`, passing in the applicable `CategoryID` value (see Figure 3).</span></span>


<span data-ttu-id="2cfb8-154">[![Les noms de catégorie maintenant lier à ProductsForCategoryDetails.aspx](master-detail-filtering-acess-two-pages-datalist-vb/_static/image8.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="2cfb8-154">[![The Category Names Now Link to ProductsForCategoryDetails.aspx](master-detail-filtering-acess-two-pages-datalist-vb/_static/image8.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image7.png)</span></span>

<span data-ttu-id="2cfb8-155">**Figure 3**: la catégorie noms lien maintenant à `ProductsForCategoryDetails.aspx` ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-acess-two-pages-datalist-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="2cfb8-155">**Figure 3**: The Category Names Now Link to `ProductsForCategoryDetails.aspx` ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image9.png))</span></span>


## <a name="step-3-listing-the-products-that-belong-to-the-selected-category"></a><span data-ttu-id="2cfb8-156">Étape 3 : Liste des produits qui appartiennent à la catégorie sélectionnée</span><span class="sxs-lookup"><span data-stu-id="2cfb8-156">Step 3: Listing the Products that Belong to the Selected Category</span></span>

<span data-ttu-id="2cfb8-157">Avec la `CategoryListMaster.aspx` page terminée, nous pouvons activer notre attention sur l’implémentation de la page « Détails », `ProductsForCategoryDetails.aspx`.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-157">With the `CategoryListMaster.aspx` page complete, we're ready to turn our attention to implementing the "details" page, `ProductsForCategoryDetails.aspx`.</span></span> <span data-ttu-id="2cfb8-158">Ouvrir cette page, faites glisser un contrôle DataList à partir de la boîte à outils vers le concepteur et définir son `ID` propriété `ProductsInCategory`.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-158">Open this page, drag a DataList from the Toolbox onto the Designer, and set its `ID` property to `ProductsInCategory`.</span></span> <span data-ttu-id="2cfb8-159">Ensuite, choisissez de balise du contrôle DataList ajouter un nouveau ObjectDataSource à la page, en le nommant `ProductsInCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-159">Next, from the DataList's smart tag choose to add a new ObjectDataSource to the page, naming it `ProductsInCategoryDataSource`.</span></span> <span data-ttu-id="2cfb8-160">Configurez-le de sorte qu’elle appelle la `ProductsBLL` de classe `GetProductsByCategoryID(categoryID)` méthode ; l’ensemble de la liste déroulante répertorie dans les onglets INSERT, UPDATE et DELETE à (None).</span><span class="sxs-lookup"><span data-stu-id="2cfb8-160">Configure it such that it calls the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method; set the drop-down lists in the INSERT, UPDATE, and DELETE tabs to (None).</span></span>


<span data-ttu-id="2cfb8-161">[![Configurer pour utiliser GetProductsByCategoryID(categoryID) méthode la classe ProductsBLL ObjectDataSource](master-detail-filtering-acess-two-pages-datalist-vb/_static/image11.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="2cfb8-161">[![Configure the ObjectDataSource to Use the ProductsBLL Class's GetProductsByCategoryID(categoryID) Method](master-detail-filtering-acess-two-pages-datalist-vb/_static/image11.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image10.png)</span></span>

<span data-ttu-id="2cfb8-162">**Figure 4**: configurer l’ObjectDataSource à utiliser le `ProductsBLL` de classe `GetProductsByCategoryID(categoryID)` (méthode) ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-acess-two-pages-datalist-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="2cfb8-162">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class's `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image12.png))</span></span>


<span data-ttu-id="2cfb8-163">Étant donné que la `GetProductsByCategoryID(categoryID)` méthode accepte un paramètre d’entrée (*`categoryID`*), l’Assistant de choisir la Source de données nous offre la possibilité de spécifier la source du paramètre.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-163">Since the `GetProductsByCategoryID(categoryID)` method accepts an input parameter (*`categoryID`*), the Choose Data Source wizard offers us an opportunity to specify the parameter's source.</span></span> <span data-ttu-id="2cfb8-164">Définissez la source de paramètre de chaîne de requête à l’aide de la QueryStringField `CategoryID`.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-164">Set the parameter source to QueryString using the QueryStringField `CategoryID`.</span></span>


<span data-ttu-id="2cfb8-165">[![Utilisez la champ Querystring CategoryID en tant que la Source du paramètre](master-detail-filtering-acess-two-pages-datalist-vb/_static/image14.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="2cfb8-165">[![Use the Querystring Field CategoryID as the Parameter's Source](master-detail-filtering-acess-two-pages-datalist-vb/_static/image14.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image13.png)</span></span>

<span data-ttu-id="2cfb8-166">**Figure 5**: Querystring Field `CategoryID` en tant que la Source du paramètre ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-acess-two-pages-datalist-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="2cfb8-166">**Figure 5**: Use the Querystring Field `CategoryID` as the Parameter's Source ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image15.png))</span></span>


<span data-ttu-id="2cfb8-167">Comme nous l’avons vu dans les didacticiels précédents, après la fin de l’Assistant de choisir la Source de données, Visual Studio crée automatiquement un `ItemTemplate` pour le contrôle DataList qui répertorie chaque nom de champ de données et la valeur.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-167">As we've seen in previous tutorials, after completing the Choose Data Source wizard, Visual Studio automatically creates an `ItemTemplate` for the DataList that lists each data field name and value.</span></span> <span data-ttu-id="2cfb8-168">Remplacez ce modèle par un qui répertorie uniquement du produit nom du fournisseur et prix.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-168">Replace this template with one that lists only the product's name, supplier, and price.</span></span> <span data-ttu-id="2cfb8-169">En outre, valeur de DataList `RepeatColumns` propriété à 2.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-169">Also, set the DataList's `RepeatColumns` property to 2.</span></span> <span data-ttu-id="2cfb8-170">Après ces modifications, votre DataList et un du ObjectDataSource balisage déclaratif doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="2cfb8-170">After these changes, your DataList and ObjectDataSource's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample4.aspx)]

<span data-ttu-id="2cfb8-171">Pour afficher cette page en action, démarrez à partir de la `CategoryListMaster.aspx` page ; ensuite, cliquez sur un lien dans la liste à puces de catégories.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-171">To view this page in action, start from the `CategoryListMaster.aspx` page; next, click on a link in the categories bulleted list.</span></span> <span data-ttu-id="2cfb8-172">Cela vous accédez à `ProductsForCategoryDetails.aspx`, en passant le long de le `CategoryID` via la chaîne de requête.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-172">Doing so will take you to `ProductsForCategoryDetails.aspx`, passing along the `CategoryID` through the querystring.</span></span> <span data-ttu-id="2cfb8-173">Le `ProductsInCategoryDataSource` ObjectDataSource dans `ProductsForCategoryDetails.aspx` ensuite obtenir uniquement les produits de la catégorie spécifiée et les afficher dans le contrôle DataList, ce qui rend les deux produits par ligne.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-173">The `ProductsInCategoryDataSource` ObjectDataSource in `ProductsForCategoryDetails.aspx` will then get just those products for the specified category and display them in the DataList, which renders two products per row.</span></span> <span data-ttu-id="2cfb8-174">La figure 6 illustre une capture d’écran de `ProductsForCategoryDetails.aspx` lorsque vous affichez les boissons.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-174">Figure 6 shows a screenshot of `ProductsForCategoryDetails.aspx` when viewing the Beverages.</span></span>


<span data-ttu-id="2cfb8-175">[![Les boissons sont affichés, deux par ligne](master-detail-filtering-acess-two-pages-datalist-vb/_static/image17.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="2cfb8-175">[![The Beverages are Displayed, Two per Row](master-detail-filtering-acess-two-pages-datalist-vb/_static/image17.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image16.png)</span></span>

<span data-ttu-id="2cfb8-176">**Figure 6**: les boissons sont affichés, deux par ligne ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-acess-two-pages-datalist-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="2cfb8-176">**Figure 6**: The Beverages are Displayed, Two per Row ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image18.png))</span></span>


## <a name="step-4-displaying-category-information-on-productsforcategorydetailsaspx"></a><span data-ttu-id="2cfb8-177">Étape 4 : Affichage des informations de catégorie sur ProductsForCategoryDetails.aspx</span><span class="sxs-lookup"><span data-stu-id="2cfb8-177">Step 4: Displaying Category Information on ProductsForCategoryDetails.aspx</span></span>

<span data-ttu-id="2cfb8-178">Lorsqu’un utilisateur clique sur une catégorie dans `CategoryListMaster.aspx`, il est dirigé vers `ProductsForCategoryDetails.aspx` et affiche les produits qui appartiennent à la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-178">When a user clicks on a category in `CategoryListMaster.aspx`, they are taken to `ProductsForCategoryDetails.aspx` and shown the products that belong to the selected category.</span></span> <span data-ttu-id="2cfb8-179">Toutefois, dans `ProductsForCategoryDetails.aspx` il n’y aucun des signaux visuels à quelle catégorie a été sélectionné.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-179">However, in `ProductsForCategoryDetails.aspx` there are no visual cues as to what category was selected.</span></span> <span data-ttu-id="2cfb8-180">Un utilisateur destiné à cliquer sur les boissons, mais les Condiments accidentellement un clic sur, qui n’a aucun moyen de se rendre compte de son erreur une fois qu’ils atteignent `ProductsForCategoryDetails.aspx`.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-180">A user that meant to click Beverages, but accidentally clicked Condiments, has no way of realizing their mistake once they reach `ProductsForCategoryDetails.aspx`.</span></span> <span data-ttu-id="2cfb8-181">Pour atténuer ce problème potentiel, nous pouvons afficher plus d’informations sur la catégorie sélectionnée, son nom et sa description, en haut de la `ProductsForCategoryDetails.aspx` page.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-181">To alleviate this potential problem, we can display information about the selected category — its name and description — at the top of the `ProductsForCategoryDetails.aspx` page.</span></span>

<span data-ttu-id="2cfb8-182">Pour ce faire, ajoutez un FormView au-dessus du contrôle du répéteur dans `ProductsForCategoryDetails.aspx`.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-182">To accomplish this, add a FormView above the Repeater control in `ProductsForCategoryDetails.aspx`.</span></span> <span data-ttu-id="2cfb8-183">Ensuite, ajoutez un nouveau ObjectDataSource à la page à partir de la balise FormView nommé `CategoryDataSource` et configurez-le pour utiliser le `CategoriesBLL` la classe `GetCategoryByCategoryID(categoryID)` (méthode).</span><span class="sxs-lookup"><span data-stu-id="2cfb8-183">Next, add a new ObjectDataSource to the page from the FormView's smart tag named `CategoryDataSource` and configure it to use the `CategoriesBLL` class's `GetCategoryByCategoryID(categoryID)` method.</span></span>


<span data-ttu-id="2cfb8-184">[![Accéder aux informations sur la catégorie par le biais GetCategoryByCategoryID(categoryID) (méthode de la classe CategoriesBLL)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image20.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="2cfb8-184">[![Access Information about the Category through the CategoriesBLL Class's GetCategoryByCategoryID(categoryID) Method](master-detail-filtering-acess-two-pages-datalist-vb/_static/image20.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image19.png)</span></span>

<span data-ttu-id="2cfb8-185">**Figure 7**: accéder aux informations sur la catégorie via la `CategoriesBLL` de classe `GetCategoryByCategoryID(categoryID)` (méthode) ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-acess-two-pages-datalist-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="2cfb8-185">**Figure 7**: Access Information about the Category through the `CategoriesBLL` Class's `GetCategoryByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image21.png))</span></span>


<span data-ttu-id="2cfb8-186">Comme avec la `ProductsInCategoryDataSource` ObjectDataSource ajouté à l’étape 3, le `CategoryDataSource`d’Assistant Configurer la Source de données nous invite pour une source de la `GetCategoryByCategoryID(categoryID)` paramètre d’entrée (méthode).</span><span class="sxs-lookup"><span data-stu-id="2cfb8-186">As with the `ProductsInCategoryDataSource` ObjectDataSource added in Step 3, the `CategoryDataSource`'s Configure Data Source wizard prompts us for a source for the `GetCategoryByCategoryID(categoryID)` method's input parameter.</span></span> <span data-ttu-id="2cfb8-187">Utiliser les mêmes paramètres comme précédemment, la définition de la source de paramètre à la chaîne de requête et à la valeur QueryStringField `CategoryID` (voir la Figure 5).</span><span class="sxs-lookup"><span data-stu-id="2cfb8-187">Use the exact same settings as before, setting the parameter source to QueryString and the QueryStringField value to `CategoryID` (refer back to Figure 5).</span></span>

<span data-ttu-id="2cfb8-188">Après la fin de l’Assistant, Visual Studio crée automatiquement un `ItemTemplate`, `EditItemTemplate`, et `InsertItemTemplate` pour le FormView.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-188">After completing the wizard, Visual Studio automatically creates an `ItemTemplate`, `EditItemTemplate`, and `InsertItemTemplate` for the FormView.</span></span> <span data-ttu-id="2cfb8-189">Étant donné que nous fournissons une interface en lecture seule, n’hésitez pas à supprimer la `EditItemTemplate` et `InsertItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-189">Since we're providing a read-only interface, feel free to remove the `EditItemTemplate` and `InsertItemTemplate`.</span></span> <span data-ttu-id="2cfb8-190">En outre, n’hésitez pas à personnaliser les FormView `ItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-190">Also, feel free to customize the FormView's `ItemTemplate`.</span></span> <span data-ttu-id="2cfb8-191">Après avoir supprimé les modèles superflus et personnalisation de l’ItemTemplate, les FormView ObjectDataSource balisage déclaratif doit ressembler à ce qui suit :</span><span class="sxs-lookup"><span data-stu-id="2cfb8-191">After removing the superfluous templates and customizing the ItemTemplate, your FormView and ObjectDataSource's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample5.aspx)]

<span data-ttu-id="2cfb8-192">La figure 8 illustre un capture d’écran lors afficher cette page via un navigateur.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-192">Figure 8 shows a screen shot when viewing this page through a browser.</span></span>

> [!NOTE]
> <span data-ttu-id="2cfb8-193">Outre le FormView, j’ai également ajouté un contrôle de lien hypertexte au-dessus du FormView qui dirige l’utilisateur à la liste des catégories (`CategoryListMaster.aspx`).</span><span class="sxs-lookup"><span data-stu-id="2cfb8-193">In addition to the FormView, I've also added a HyperLink control above the FormView that will take the user back to the list of categories (`CategoryListMaster.aspx`).</span></span> <span data-ttu-id="2cfb8-194">N’hésitez pas à placer ce lien ailleurs ou à ne pas l’utiliser.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-194">Feel free to place this link elsewhere or to omit it altogether.</span></span>


<span data-ttu-id="2cfb8-195">[![Les informations de catégorie sont maintenant affichée en haut de la Page](master-detail-filtering-acess-two-pages-datalist-vb/_static/image23.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="2cfb8-195">[![Category Information is Now Displayed at the Top of the Page](master-detail-filtering-acess-two-pages-datalist-vb/_static/image23.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image22.png)</span></span>

<span data-ttu-id="2cfb8-196">**Figure 8**: les informations de catégorie est maintenant affichée en haut de la Page ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-acess-two-pages-datalist-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="2cfb8-196">**Figure 8**: Category Information is Now Displayed at the Top of the Page ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image24.png))</span></span>


## <a name="step-5-displaying-a-message-if-no-products-belong-to-the-selected-category"></a><span data-ttu-id="2cfb8-197">Étape 5 : Affichage d’un Message si aucun produit n’appartiennent à la catégorie sélectionnée</span><span class="sxs-lookup"><span data-stu-id="2cfb8-197">Step 5: Displaying a Message if No Products Belong to the Selected Category</span></span>

<span data-ttu-id="2cfb8-198">Le `CategoryListMaster.aspx` page répertorie toutes les catégories dans le système, quel que soit s’il existe des associés des produits.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-198">The `CategoryListMaster.aspx` page lists all categories in the system, regardless of whether there are any associated products.</span></span> <span data-ttu-id="2cfb8-199">Si un utilisateur clique sur une catégorie avec aucune produits associés, du contrôle DataList dans `ProductsForCategoryDetails.aspx` ne seront pas rendues, comme sa source de données n’aura pas tous les éléments.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-199">If a user clicks on a category with no associated products, the DataList in `ProductsForCategoryDetails.aspx` will not be rendered, as its data source will not have any items.</span></span> <span data-ttu-id="2cfb8-200">Comme nous l’avons vu dans ces didacticiels, le contrôle GridView fournit un `EmptyDataText` propriété qui peut être utilisée pour spécifier un message texte à afficher si aucun enregistrement n’est dans sa source de données.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-200">As we've seen in past tutorials, the GridView provides an `EmptyDataText` property that can be used to specify a text message to display if there are no records in its data source.</span></span> <span data-ttu-id="2cfb8-201">Malheureusement, répéteur ni DataList a une telle propriété.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-201">Unfortunately, neither the DataList nor Repeater has such a property.</span></span>

<span data-ttu-id="2cfb8-202">Pour afficher un message informant l’utilisateur qu’aucun produit correspondant pour la catégorie sélectionnée, nous devons ajouter une étiquette de contrôle à la page dont `Text` le message à afficher dans le cas où aucun produit correspondant est assignée à la propriété.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-202">In order to display a message informing the user that there are no matching products for the selected category, we need to add a Label control to the page whose `Text` property is assigned the message to display in the event that there are no matching products.</span></span> <span data-ttu-id="2cfb8-203">Nous devons définir par programmation son `Visible` propriété basée sur ou non du contrôle DataList contienne des éléments.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-203">We then need to programmatically set its `Visible` property based on whether or not the DataList contains any items.</span></span>

<span data-ttu-id="2cfb8-204">Pour ce faire, commencez par ajouter une étiquette en dessous du contrôle DataList.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-204">To accomplish this, start by adding a Label beneath the DataList.</span></span> <span data-ttu-id="2cfb8-205">Définir son `ID` propriété `NoProductsMessage` et son `Text` propriété « Il n’existe aucun produit de la catégorie sélectionnée... »</span><span class="sxs-lookup"><span data-stu-id="2cfb8-205">Set its `ID` property to `NoProductsMessage` and its `Text` property to "There are no products for the selected category…"</span></span> <span data-ttu-id="2cfb8-206">Ensuite, nous devons définir par programme de cette étiquette `Visible` propriété basée sur ou non des données a été liées à la `ProductsInCategory` DataList.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-206">Next, we need to programmatically set this Label's `Visible` property based on whether or not any data was bound to the `ProductsInCategory` DataList.</span></span> <span data-ttu-id="2cfb8-207">Cette attribution doit être effectuée après que les données a été liées au contrôle DataList.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-207">This assignment must be made after the data has been bound to the DataList.</span></span> <span data-ttu-id="2cfb8-208">Pour le contrôle GridView, DetailsView et FormView, nous pourrions créer un gestionnaire d’événements du contrôle `DataBound` événement qui se déclenche lorsque la liaison de données est terminée.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-208">For the GridView, DetailsView, and FormView, we could create an event handler for the control's `DataBound` event, which fires after databinding has completed.</span></span> <span data-ttu-id="2cfb8-209">Toutefois, le contrôle DataList, ni le répéteur a un `DataBound` événements disponibles.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-209">However, neither the DataList nor the Repeater has a `DataBound` event available.</span></span>

<span data-ttu-id="2cfb8-210">Pour cet exemple particulier, nous pouvons attribuer l’étiquette `Visible` propriété dans le `Page_Load` Gestionnaire d’événements, dans la mesure où les données seront ont reçu du contrôle DataList avant de la page `Load` événement.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-210">For this particular example we can assign the Label's `Visible` property in the `Page_Load` event handler, since the data will have been assigned to the DataList prior to the page's `Load` event.</span></span> <span data-ttu-id="2cfb8-211">Toutefois, cette approche ne fonctionne pas dans le cas général, comme les données à partir de ObjectDataSource peuvent être liées à du contrôle DataList plus loin dans le cycle de vie de la page.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-211">However, this approach would not work in the general case, as the data from the ObjectDataSource might be bound to the DataList later in the page's lifecycle.</span></span> <span data-ttu-id="2cfb8-212">Par exemple, si les données affichées sont basées sur la valeur dans un autre contrôle, telle qu’elle est lors de l’affichage d’un rapport maître/détail à l’aide d’une liste déroulante contenant les enregistrements « maîtres », les données ne peuvent pas reliée au contrôle Web de données jusqu'à ce que le `PreRender` à l’étape dans le cycle de vie de la page.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-212">For example, if the displayed data is based upon the value in another control, such as it is when displaying a master/detail report using a DropDownList to hold the "master" records, the data may not rebound to the data Web control until the `PreRender` stage in the page's life cycle.</span></span>

<span data-ttu-id="2cfb8-213">Une solution qui fonctionne pour tous les cas consiste à affecter la `Visible` propriété `False` dans le contrôle de DataList `ItemDataBound` (ou `ItemCreated`) lors de la liaison d’un type d’élément de gestionnaire d’événements `Item` ou `AlternatingItem`.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-213">One solution which will work for all cases is to assign the `Visible` property to `False` in the DataList's `ItemDataBound` (or `ItemCreated`) event handler when binding an item type of `Item` or `AlternatingItem`.</span></span> <span data-ttu-id="2cfb8-214">Dans ce cas nous savons qu’il existe au moins un élément dans la source de données et qu’elle peut par conséquent masquer le `NoProductsMessage` étiquette.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-214">In such a case we know that there is at least one data item in the data source and therefore can hide the `NoProductsMessage` Label.</span></span> <span data-ttu-id="2cfb8-215">En plus de ce gestionnaire d’événements, nous devons également un gestionnaire d’événements pour le contrôle de DataList `DataBinding` événement, où nous initialiser l’étiquette `Visible` propriété `True`.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-215">In addition to this event handler, we also need an event handler for the DataList's `DataBinding` event, where we initialize the Label's `Visible` property to `True`.</span></span> <span data-ttu-id="2cfb8-216">Étant donné que la `DataBinding` événement est déclenché avant la `ItemDataBound` d’événements, l’étiquette `Visible` propriété sera initialement définie `True`; s’il existe des éléments de données, toutefois, elle sera définie `False`.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-216">Since the `DataBinding` event fires before the `ItemDataBound` events, the Label's `Visible` property will initially be set to `True`; if there are any data items, however, it will be set to `False`.</span></span> <span data-ttu-id="2cfb8-217">Le code suivant met en œuvre cette logique :</span><span class="sxs-lookup"><span data-stu-id="2cfb8-217">The following code implements this logic:</span></span>

[!code-vb[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample6.vb)]

<span data-ttu-id="2cfb8-218">Toutes les catégories dans la base de données Northwind sont associés à un ou plusieurs produits.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-218">All of the categories in the Northwind database are associated with one or more products.</span></span> <span data-ttu-id="2cfb8-219">Pour tester cette fonctionnalité, j’ai ajustée manuellement la base de données Northwind pour ce didacticiel, la réaffectation de tous les produits de la catégorie de produit (`CategoryID` = 7) à la catégorie Seafood (`CategoryID` = 8).</span><span class="sxs-lookup"><span data-stu-id="2cfb8-219">To test this feature, I've manually adjusted the Northwind database for this tutorial, reassigning all products associated with the Produce category (`CategoryID` = 7) to the Seafood category (`CategoryID` = 8).</span></span> <span data-ttu-id="2cfb8-220">Cela peut être accompli en choisissant nouvelle requête et à l’aide de ce qui suit à partir de l’Explorateur de serveurs `UPDATE` instruction :</span><span class="sxs-lookup"><span data-stu-id="2cfb8-220">This can be accomplished from the Server Explorer by choosing New Query and using the following `UPDATE` statement:</span></span>

[!code-sql[Main](master-detail-filtering-acess-two-pages-datalist-vb/samples/sample7.sql)]

<span data-ttu-id="2cfb8-221">Après la mise à jour de la base de données en conséquence, revenir à la `CategoryListMaster.aspx` page, puis cliquez sur le lien du produit.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-221">After updating the database accordingly, return to the `CategoryListMaster.aspx` page and click on the Produce link.</span></span> <span data-ttu-id="2cfb8-222">Étant donné que n’est plus tous les produits appartenant à la catégorie de produit, vous devez voir le « Il n’existe aucun produit de la catégorie sélectionnée... »</span><span class="sxs-lookup"><span data-stu-id="2cfb8-222">Since there are no longer any products belonging to the Produce category, you should see the "There are no products for the selected category…"</span></span> <span data-ttu-id="2cfb8-223">message, comme indiqué dans la Figure 9.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-223">message, as shown in Figure 9.</span></span>


<span data-ttu-id="2cfb8-224">[![Un Message s’affiche s’il n’y aucune faisant partie de produits à la catégorie sélectionnée](master-detail-filtering-acess-two-pages-datalist-vb/_static/image26.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="2cfb8-224">[![A Message is Displayed if there are No Products Belonging to the Selected Category](master-detail-filtering-acess-two-pages-datalist-vb/_static/image26.png)](master-detail-filtering-acess-two-pages-datalist-vb/_static/image25.png)</span></span>

<span data-ttu-id="2cfb8-225">**Figure 9**: un Message s’affiche s’il n’y aucune faisant partie de produits à la catégorie sélectionnée ([cliquez pour afficher l’image en taille réelle](master-detail-filtering-acess-two-pages-datalist-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="2cfb8-225">**Figure 9**: A Message is Displayed if there are No Products Belonging to the Selected Category ([Click to view full-size image](master-detail-filtering-acess-two-pages-datalist-vb/_static/image27.png))</span></span>


## <a name="summary"></a><span data-ttu-id="2cfb8-226">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="2cfb8-226">Summary</span></span>

<span data-ttu-id="2cfb8-227">Alors que les rapports maître/détail peuvent afficher les enregistrements maître et détail sur une seule page, dans de nombreux sites Web qu’ils sont séparés sur deux pages web.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-227">While master/detail reports can display both the master and detail records on a single page, in many websites they are separated out across two web pages.</span></span> <span data-ttu-id="2cfb8-228">Dans ce didacticiel, nous avons étudié comment implémenter un tel rapport maître/détail en ayant des catégories répertoriées dans une liste à puces à l’aide d’un répéteur dans la page web « maître » et les produits associés, répertoriés dans la page « Détails ».</span><span class="sxs-lookup"><span data-stu-id="2cfb8-228">In this tutorial we looked at how to implement such a master/detail report by having the categories listed in a bulleted list using a Repeater in the "master" web page and the associated products listed in the "details" page.</span></span> <span data-ttu-id="2cfb8-229">Chaque élément de liste dans la page maître web contenait un lien vers la page de détails passé le long de la ligne `CategoryID` valeur.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-229">Each list item in the master web page contained a link to the details page that passed along the row's `CategoryID` value.</span></span>

<span data-ttu-id="2cfb8-230">Dans la page Détails de la récupération de ces produits pour le fournisseur spécifié a été effectuée via la `ProductsBLL` la classe `GetProductsByCategoryID(categoryID)` (méthode).</span><span class="sxs-lookup"><span data-stu-id="2cfb8-230">In the details page retrieving those products for the specified supplier was accomplished through the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="2cfb8-231">Le *`categoryID`* la valeur du paramètre a été spécifiée de façon déclarative à l’aide de la `CategoryID` valeur querystring comme source du paramètre.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-231">The *`categoryID`* parameter value was specified declaratively using the `CategoryID` querystring value as the parameter source.</span></span> <span data-ttu-id="2cfb8-232">Nous avons étudié également comment afficher les détails de catégorie dans la page de détails à l’aide d’un FormView et comment afficher un message si aucun produit appartenant à la catégorie sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-232">We also looked at how to display category details in the details page using a FormView and how to display a message if there were no products belonging to the selected category.</span></span>

<span data-ttu-id="2cfb8-233">Bonne programmation !</span><span class="sxs-lookup"><span data-stu-id="2cfb8-233">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="2cfb8-234">À propos de l’auteur</span><span class="sxs-lookup"><span data-stu-id="2cfb8-234">About the Author</span></span>

<span data-ttu-id="2cfb8-235">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), auteur de sept manuels ASP/ASP.NET et créateur de [4GuysFromRolla.com](http://www.4guysfromrolla.com), travaille avec les technologies Web Microsoft depuis 1998.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-235">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="2cfb8-236">Scott fonctionne comme un consultant indépendant, formateur et writer.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-236">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="2cfb8-237">Son dernier ouvrage est [ *SAM animer vous-même ASP.NET 2.0 des dernières 24 heures*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="2cfb8-237">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="2cfb8-238">Il peut être atteint à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) ou via son blog, qui se trouvent à [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="2cfb8-238">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="2cfb8-239">Remerciements particuliers à...</span><span class="sxs-lookup"><span data-stu-id="2cfb8-239">Special Thanks To…</span></span>

<span data-ttu-id="2cfb8-240">Cette série de didacticiels a été révisée par plusieurs réviseurs utiles.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-240">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="2cfb8-241">Les réviseurs tête pour ce didacticiel ont été Zack Jones et Liz Shulok.</span><span class="sxs-lookup"><span data-stu-id="2cfb8-241">Lead reviewers for this tutorial were Zack Jones and Liz Shulok.</span></span> <span data-ttu-id="2cfb8-242">Vous souhaitez consulter mes prochains articles MSDN ?</span><span class="sxs-lookup"><span data-stu-id="2cfb8-242">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="2cfb8-243">Dans ce cas, me supprimer une ligne à [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2cfb8-243">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="2cfb8-244">[Précédent](master-detail-filtering-with-a-dropdownlist-datalist-vb.md)
> [Suivant](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md)</span><span class="sxs-lookup"><span data-stu-id="2cfb8-244">[Previous](master-detail-filtering-with-a-dropdownlist-datalist-vb.md)
[Next](master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md)</span></span>
