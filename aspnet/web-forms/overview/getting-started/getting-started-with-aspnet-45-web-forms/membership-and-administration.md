---
uid: web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/membership-and-administration
title: L’appartenance et l’Administration | Documents Microsoft
author: Erikre
description: Cette série de didacticiels, vous allez apprendre les principes fondamentaux de la création d’une application Web Forms ASP.NET à l’aide de ASP.NET 4.5 et Microsoft Visual Studio Express 2013 pour nous...
ms.author: aspnetcontent
manager: wpickett
ms.date: 09/08/2014
ms.topic: article
ms.assetid: 732a2316-e49f-4f72-becd-0cd72f14457e
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/membership-and-administration
msc.type: authoredcontent
ms.openlocfilehash: 166bc642ea2083f455be0648e424f0b0ae3b082c
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/10/2018
---
<a name="membership-and-administration"></a><span data-ttu-id="202ac-103">L’appartenance et l’Administration</span><span class="sxs-lookup"><span data-stu-id="202ac-103">Membership and Administration</span></span>
====================
<span data-ttu-id="202ac-104">by [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="202ac-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

<span data-ttu-id="202ac-105">[Télécharger Wingtip Toys exemple de projet (c#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) ou [télécharger des livres (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span><span class="sxs-lookup"><span data-stu-id="202ac-105">[Download Wingtip Toys Sample Project (C#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) or [Download E-book (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span></span>

> <span data-ttu-id="202ac-106">Cette série de didacticiels, vous allez apprendre les principes fondamentaux de la création d’une application Web Forms ASP.NET à l’aide de ASP.NET 4.5 et Microsoft Visual Studio Express 2013 pour le Web.</span><span class="sxs-lookup"><span data-stu-id="202ac-106">This tutorial series will teach you the basics of building an ASP.NET Web Forms application using ASP.NET 4.5 and Microsoft Visual Studio Express 2013 for Web.</span></span> <span data-ttu-id="202ac-107">Un Visual Studio 2013 [projet avec le code source c#](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) est disponible pour accompagner cette série de didacticiels.</span><span class="sxs-lookup"><span data-stu-id="202ac-107">A Visual Studio 2013 [project with C# source code](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) is available to accompany this tutorial series.</span></span>


<span data-ttu-id="202ac-108">Ce didacticiel vous montre comment mettre à jour de l’exemple d’application Wingtip Toys pour ajouter un rôle personnalisé et utiliser l’identité de ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="202ac-108">This tutorial shows you how to update the Wingtip Toys sample application to add a custom role and use ASP.NET Identity.</span></span> <span data-ttu-id="202ac-109">Il montre également comment implémenter une page d’administration à partir duquel l’utilisateur avec un rôle personnalisé peut ajouter et supprimer des produits depuis le site Web.</span><span class="sxs-lookup"><span data-stu-id="202ac-109">It also shows you how to implement an administration page from which the user with a custom role can add and remove products from the website.</span></span>

<span data-ttu-id="202ac-110">[ASP.NET Identity](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md) est le système d’appartenance utilisé pour générer l’application web ASP.NET et est disponible dans ASP.NET 4.5.</span><span class="sxs-lookup"><span data-stu-id="202ac-110">[ASP.NET Identity](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md) is the membership system used to build ASP.NET web application and is available in ASP.NET 4.5.</span></span> <span data-ttu-id="202ac-111">Identité ASP.NET est utilisée dans le modèle de projet Web Forms de Visual Studio 2013, ainsi que les modèles de [ASP.NET MVC](../../../../mvc/index.md), [API Web ASP.NET](../../../../web-api/index.md), et [Application à Page unique ASP.NET](../../../../single-page-application/index.md).</span><span class="sxs-lookup"><span data-stu-id="202ac-111">ASP.NET Identity is used in the Visual Studio 2013 Web Forms project template, as well as the templates for [ASP.NET MVC](../../../../mvc/index.md), [ASP.NET Web API](../../../../web-api/index.md), and [ASP.NET Single Page Application](../../../../single-page-application/index.md).</span></span> <span data-ttu-id="202ac-112">Vous pouvez également installer le système d’identité ASP.NET à l’aide de NuGet lorsque vous démarrez avec une application Web vide.</span><span class="sxs-lookup"><span data-stu-id="202ac-112">You can also specifically install the ASP.NET Identity system using NuGet when you start with an empty Web application.</span></span> <span data-ttu-id="202ac-113">Toutefois, dans cette série de didacticiels que vous utilisez le **Web Forms**projecttemplate, qui inclut le système d’identité ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="202ac-113">However, in this tutorial series you use the **Web Forms**projecttemplate, which includes the ASP.NET Identity system.</span></span> <span data-ttu-id="202ac-114">ASP.NET Identity rend facile à intégrer les données de profil d’utilisateur avec les données d’application.</span><span class="sxs-lookup"><span data-stu-id="202ac-114">ASP.NET Identity makes it easy to integrate user-specific profile data with application data.</span></span> <span data-ttu-id="202ac-115">En outre, ASP.NET Identity vous permet de choisir le modèle de persistance pour les profils utilisateur dans votre application.</span><span class="sxs-lookup"><span data-stu-id="202ac-115">Also, ASP.NET Identity allows you to choose the persistence model for user profiles in your application.</span></span> <span data-ttu-id="202ac-116">Vous pouvez stocker les données dans une base de données SQL Server ou une autre banque de données, y compris *NoSQL* stocke les données telles que les Tables de stockage Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="202ac-116">You can store the data in a SQL Server database or another data store, including *NoSQL* data stores such as Windows Azure Storage Tables.</span></span>

<span data-ttu-id="202ac-117">Ce didacticiel s’appuie sur le didacticiel précédent intitulé « Extraction et paiement avec PayPal » dans la série de didacticiels Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="202ac-117">This tutorial builds on the previous tutorial titled "Checkout and Payment with PayPal" in the Wingtip Toys tutorial series.</span></span>

## <a name="what-youll-learn"></a><span data-ttu-id="202ac-118">Ce que vous allez apprendre :</span><span class="sxs-lookup"><span data-stu-id="202ac-118">What you'll learn:</span></span>

- <span data-ttu-id="202ac-119">Comment utiliser du code pour ajouter un rôle personnalisé et un utilisateur à l’application.</span><span class="sxs-lookup"><span data-stu-id="202ac-119">How to use code to add a custom role and a user to the application.</span></span>
- <span data-ttu-id="202ac-120">Comment restreindre l’accès à la page et le dossier d’administration.</span><span class="sxs-lookup"><span data-stu-id="202ac-120">How to restrict access to the administration folder and page.</span></span>
- <span data-ttu-id="202ac-121">Comment fournir une navigation de l’utilisateur qui appartient au rôle personnalisé.</span><span class="sxs-lookup"><span data-stu-id="202ac-121">How to provide navigation for the user that belongs to the custom role.</span></span>
- <span data-ttu-id="202ac-122">Comment utiliser la liaison de modèle pour remplir un [DropDownList](https://msdn.microsoft.com/library/system.web.ui.webcontrols.dropdownlist(v=vs.110).aspx) contrôle avec des catégories de produits.</span><span class="sxs-lookup"><span data-stu-id="202ac-122">How to use model binding to populate a [DropDownList](https://msdn.microsoft.com/library/system.web.ui.webcontrols.dropdownlist(v=vs.110).aspx) control with product categories.</span></span>
- <span data-ttu-id="202ac-123">Comment télécharger un fichier dans l’application web à l’aide du [FileUpload](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload(v=vs.110).aspx) contrôle.</span><span class="sxs-lookup"><span data-stu-id="202ac-123">How to upload a file to the web application using the [FileUpload](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload(v=vs.110).aspx) control.</span></span>
- <span data-ttu-id="202ac-124">Comment utiliser des contrôles de validation pour implémenter la validation d’entrée.</span><span class="sxs-lookup"><span data-stu-id="202ac-124">How to use validation controls to implement input validation.</span></span>
- <span data-ttu-id="202ac-125">Comment ajouter et supprimer des produits à partir de l’application.</span><span class="sxs-lookup"><span data-stu-id="202ac-125">How to add and remove products from the application.</span></span>

## <a name="these-features-are-included-in-the-tutorial"></a><span data-ttu-id="202ac-126">Ces fonctionnalités sont incluses dans le didacticiel :</span><span class="sxs-lookup"><span data-stu-id="202ac-126">These features are included in the tutorial:</span></span>

- <span data-ttu-id="202ac-127">ASP.NET Identity</span><span class="sxs-lookup"><span data-stu-id="202ac-127">ASP.NET Identity</span></span>
- <span data-ttu-id="202ac-128">Configuration et autorisation</span><span class="sxs-lookup"><span data-stu-id="202ac-128">Configuration and Authorization</span></span>
- <span data-ttu-id="202ac-129">Liaison de modèle</span><span class="sxs-lookup"><span data-stu-id="202ac-129">Model Binding</span></span>
- <span data-ttu-id="202ac-130">Validation non obstrusive</span><span class="sxs-lookup"><span data-stu-id="202ac-130">Unobtrusive Validation</span></span>

<span data-ttu-id="202ac-131">ASP.NET Web Forms fournit des capacités d’appartenance.</span><span class="sxs-lookup"><span data-stu-id="202ac-131">ASP.NET Web Forms provides membership capabilities.</span></span> <span data-ttu-id="202ac-132">À l’aide du modèle par défaut, vous disposez des fonctionnalités d’appartenance intégrées que vous pouvez utiliser immédiatement lorsque l’application s’exécute.</span><span class="sxs-lookup"><span data-stu-id="202ac-132">By using the default template, you have built-in membership functionality that you can immediately use when the application runs.</span></span> <span data-ttu-id="202ac-133">Ce didacticiel vous montre comment utiliser ASP.NET Identity pour ajouter un rôle personnalisé et attribuer un utilisateur à ce rôle.</span><span class="sxs-lookup"><span data-stu-id="202ac-133">This tutorial shows you how to use ASP.NET Identity to add a custom role and assign a user to that role.</span></span> <span data-ttu-id="202ac-134">Vous allez apprendre comment restreindre l’accès au dossier d’administration.</span><span class="sxs-lookup"><span data-stu-id="202ac-134">You will learn how to restrict access to the administration folder.</span></span> <span data-ttu-id="202ac-135">Vous allez ajouter une page dans le dossier d’administration qui permet à un utilisateur avec un rôle personnalisé pour ajouter et supprimer des produits et afficher un aperçu d’un produit une fois qu’il a été ajouté.</span><span class="sxs-lookup"><span data-stu-id="202ac-135">You'll add a page to the administration folder that allows a user with a custom role to add and remove products, and to preview a product after it has been added.</span></span>

## <a name="adding-a-custom-role"></a><span data-ttu-id="202ac-136">Ajout d’un rôle personnalisé</span><span class="sxs-lookup"><span data-stu-id="202ac-136">Adding a Custom Role</span></span>

<span data-ttu-id="202ac-137">À l’aide d’identité ASP.NET, vous pouvez ajouter un rôle personnalisé et attribuer un utilisateur à ce rôle à l’aide de code.</span><span class="sxs-lookup"><span data-stu-id="202ac-137">Using ASP.NET Identity, you can add a custom role and assign a user to that role using code.</span></span>

1. <span data-ttu-id="202ac-138">Dans **l’Explorateur de solutions**, avec le bouton droit sur le *logique* dossier et créer une nouvelle classe.</span><span class="sxs-lookup"><span data-stu-id="202ac-138">In **Solution Explorer**, right-click on the *Logic* folder and create a new class.</span></span>
2. <span data-ttu-id="202ac-139">Nommez la nouvelle classe *RoleActions.cs*.</span><span class="sxs-lookup"><span data-stu-id="202ac-139">Name the new class *RoleActions.cs*.</span></span>
3. <span data-ttu-id="202ac-140">Modifiez le code afin qu’il apparaisse comme suit :</span><span class="sxs-lookup"><span data-stu-id="202ac-140">Modify the code so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample1.cs?highlight=8)]
4. <span data-ttu-id="202ac-141">Dans **l’Explorateur de solutions**, ouvrez le *Global.asax.cs* fichier.</span><span class="sxs-lookup"><span data-stu-id="202ac-141">In **Solution Explorer**, open the *Global.asax.cs* file.</span></span>
5. <span data-ttu-id="202ac-142">Modifier la *Global.asax.cs* fichier en ajoutant le code mis en surbrillance en jaune afin qu’il apparaisse comme suit :</span><span class="sxs-lookup"><span data-stu-id="202ac-142">Modify the *Global.asax.cs* file by adding the code highlighted in yellow so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample2.cs?highlight=11,26-28)]
6. <span data-ttu-id="202ac-143">Notez que `AddUserAndRole` est souligné en rouge.</span><span class="sxs-lookup"><span data-stu-id="202ac-143">Notice that `AddUserAndRole` is underlined in red.</span></span> <span data-ttu-id="202ac-144">Double-cliquez sur le code AddUserAndRole.</span><span class="sxs-lookup"><span data-stu-id="202ac-144">Double-click the AddUserAndRole code.</span></span>  
   <span data-ttu-id="202ac-145">La lettre « A » au début de la méthode de mise en surbrillance est soulignée.</span><span class="sxs-lookup"><span data-stu-id="202ac-145">The letter "A" at the beginning of the highlighted method will be underlined.</span></span>
7. <span data-ttu-id="202ac-146">Placez le curseur sur la lettre « A » et cliquez sur l’interface utilisateur qui vous permet de générer un stub de méthode pour le `AddUserAndRole` (méthode).</span><span class="sxs-lookup"><span data-stu-id="202ac-146">Hover over the letter "A" and click the UI that allows you to generate a method stub for the `AddUserAndRole` method.</span></span> 

    ![L’appartenance et Advministration - générer le Stub de méthode](membership-and-administration/_static/image1.png)
8. <span data-ttu-id="202ac-148">Cliquez sur l’option intitulée :</span><span class="sxs-lookup"><span data-stu-id="202ac-148">Click the option titled:</span></span>  
    `Generate method stub for "AddUserAndRole" in "WingtipToys.Logic.RoleActions"`
9. <span data-ttu-id="202ac-149">Ouvrez le *RoleActions.cs* à partir de la *logique* dossier.</span><span class="sxs-lookup"><span data-stu-id="202ac-149">Open the *RoleActions.cs* file from the *Logic* folder.</span></span>  
   <span data-ttu-id="202ac-150">Le `AddUserAndRole` méthode a été ajoutée au fichier de classe.</span><span class="sxs-lookup"><span data-stu-id="202ac-150">The `AddUserAndRole` method has been added to the class file.</span></span>
10. <span data-ttu-id="202ac-151">Modifier la *RoleActions.cs* fichier en supprimant le `NotImplementedeException` et en ajoutant le code mis en surbrillance en jaune, afin qu’il apparaisse comme suit :</span><span class="sxs-lookup"><span data-stu-id="202ac-151">Modify the *RoleActions.cs* file by removing the `NotImplementedeException` and adding the code highlighted in yellow, so that it appears as follows:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample3.cs?highlight=5-7,15-51)]

<span data-ttu-id="202ac-152">Tout d’abord, le code ci-dessus établit un contexte de base de données pour la base de données d’appartenance.</span><span class="sxs-lookup"><span data-stu-id="202ac-152">The above code first establishes a database context for the membership database.</span></span> <span data-ttu-id="202ac-153">La base de données d’appartenance est également stockée comme un *.mdf* de fichiers dans le *application\_données* dossier.</span><span class="sxs-lookup"><span data-stu-id="202ac-153">The membership database is also stored as an *.mdf* file in the *App\_Data* folder.</span></span> <span data-ttu-id="202ac-154">Vous serez en mesure d’afficher cette base de données une fois le premier utilisateur est connecté à cette application web.</span><span class="sxs-lookup"><span data-stu-id="202ac-154">You will be able to view this database once the first user has signed in to this web application.</span></span> 

> [!NOTE] 
> 
> <span data-ttu-id="202ac-155">Si vous souhaitez stocker les données d’appartenance, ainsi que les données de produit, vous pouvez envisager d’utiliser le même **DbContext** que vous avez utilisé pour stocker les données de produit dans le code ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="202ac-155">If you wish to store the membership data along with the product data, you can consider using the same **DbContext** that you used to store the product data in the above code.</span></span>


 <span data-ttu-id="202ac-156">Le *interne* mot clé est un modificateur d’accès pour les types (tels que les classes) et les membres de type (par exemple, les méthodes ou propriétés).</span><span class="sxs-lookup"><span data-stu-id="202ac-156">The *internal* keyword is an access modifier for types (such as classes) and type members (such as methods or properties).</span></span> <span data-ttu-id="202ac-157">Types internes ou les membres sont accessibles uniquement dans les fichiers contenus dans le même assembly *(.dll* fichier).</span><span class="sxs-lookup"><span data-stu-id="202ac-157">Internal types or members are accessible only within files contained in the same assembly *(.dll* file).</span></span> <span data-ttu-id="202ac-158">Lorsque vous générez votre application, un fichier d’assembly *(.dll*) est créé qui contient le code qui est exécuté lorsque vous exécutez votre application.</span><span class="sxs-lookup"><span data-stu-id="202ac-158">When you build your application, an assembly file *(.dll*) is created that contains the code that is executed when you run your application.</span></span> 

<span data-ttu-id="202ac-159">A `RoleStore` objet qui fournit la gestion des rôles, est créé en fonction du contexte de base de données.</span><span class="sxs-lookup"><span data-stu-id="202ac-159">A `RoleStore` object, which provides role management, is created based on the database context.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="202ac-160">Notez que lorsque la `RoleStore` objet est créé qu’il utilise un type générique `IdentityRole` type.</span><span class="sxs-lookup"><span data-stu-id="202ac-160">Notice that when the `RoleStore` object is created it uses a Generic `IdentityRole` type.</span></span> <span data-ttu-id="202ac-161">Cela signifie que la `RoleStore` est uniquement autorisée à contenir `IdentityRole` objets.</span><span class="sxs-lookup"><span data-stu-id="202ac-161">This means that the `RoleStore` is only allowed to contain `IdentityRole` objects.</span></span> <span data-ttu-id="202ac-162">Également par l’utilisation de génériques, les ressources en mémoire sont plus facile à gérer.</span><span class="sxs-lookup"><span data-stu-id="202ac-162">Also by using Generics, resources in memory are handled better.</span></span>


<span data-ttu-id="202ac-163">Ensuite, le `RoleManager` , est créé selon la `RoleStore` objet que vous venez de créer.</span><span class="sxs-lookup"><span data-stu-id="202ac-163">Next, the `RoleManager` object, is created based on the `RoleStore` object that you just created.</span></span> <span data-ttu-id="202ac-164">le `RoleManager` objet expose rôle API associée qui peut être utilisé pour enregistrer automatiquement les modifications apportées à la `RoleStore`.</span><span class="sxs-lookup"><span data-stu-id="202ac-164">the `RoleManager` object exposes role related API which can be used to automatically save changes to the `RoleStore`.</span></span> <span data-ttu-id="202ac-165">Le `RoleManager` est uniquement autorisée à contenir `IdentityRole` objets, car le code utilise le `<IdentityRole>` type générique.</span><span class="sxs-lookup"><span data-stu-id="202ac-165">The `RoleManager` is only allowed to contain `IdentityRole` objects because the code uses the `<IdentityRole>` Generic type.</span></span>

<span data-ttu-id="202ac-166">Vous appelez le `RoleExists` méthode pour déterminer si le rôle « canEdit » est présent dans la base de données d’appartenance.</span><span class="sxs-lookup"><span data-stu-id="202ac-166">You call the `RoleExists` method to determine if the "canEdit" role is present in the membership database.</span></span> <span data-ttu-id="202ac-167">Si elle n’est pas le cas, vous créez le rôle.</span><span class="sxs-lookup"><span data-stu-id="202ac-167">If it is not, you create the role.</span></span>

<span data-ttu-id="202ac-168">Création de la `UserManager` objet semble être plus complexe que le `RoleManager` contrôler, toutefois, il est presque les mêmes.</span><span class="sxs-lookup"><span data-stu-id="202ac-168">Creating the `UserManager` object appears to be more complicated than the `RoleManager` control, however it is nearly the same.</span></span> <span data-ttu-id="202ac-169">Il est simplement codé sur une ligne plutôt que plusieurs.</span><span class="sxs-lookup"><span data-stu-id="202ac-169">It is just coded on one line rather than several.</span></span> <span data-ttu-id="202ac-170">Ici, le paramètre que vous passez est instanciation comme un nouvel objet contenu dans les parenthèses.</span><span class="sxs-lookup"><span data-stu-id="202ac-170">Here, the parameter that you are passing is instantiating as a new object contained in the parenthesis.</span></span>

<span data-ttu-id="202ac-171">Ensuite vous créez l’utilisateur « canEditUser » en créant un nouveau `ApplicationUser` objet.</span><span class="sxs-lookup"><span data-stu-id="202ac-171">Next you create the "canEditUser" user by creating a new `ApplicationUser` object.</span></span> <span data-ttu-id="202ac-172">Ensuite, si vous créez avec succès de l’utilisateur, vous devez ajouter l’utilisateur au nouveau rôle.</span><span class="sxs-lookup"><span data-stu-id="202ac-172">Then, if you successfully create the user, you add the user to the new role.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="202ac-173">La gestion des erreurs seront mise à jour au cours du didacticiel « Gestion d’erreurs ASP.NET » plus loin dans cette série de didacticiels.</span><span class="sxs-lookup"><span data-stu-id="202ac-173">The error handling will be updated during the "ASP.NET Error Handling" tutorial later in this tutorial series.</span></span>


<span data-ttu-id="202ac-174">Lors du prochain démarrage de l’application, l’utilisateur nommé « canEditUser » sera ajouté en tant que rôle nommé « canEdit » de l’application.</span><span class="sxs-lookup"><span data-stu-id="202ac-174">The next time the application starts, the user named "canEditUser" will be added as the role named "canEdit" of the application.</span></span> <span data-ttu-id="202ac-175">Plus loin dans ce didacticiel, vous va se connecter en tant que l’utilisateur « canEditUser » pour afficher les fonctionnalités supplémentaires qui vous serez ajoutés au cours de ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="202ac-175">Later in this tutorial, you will login as the "canEditUser" user to display additional capabilities that you will added during this tutorial.</span></span> <span data-ttu-id="202ac-176">Pour plus d’informations de l’API sur ASP.NET Identity, consultez le [Microsoft.AspNet.Identity Namespace](https://msdn.microsoft.com/library/microsoft.aspnet.identity(v=vs.111).aspx).</span><span class="sxs-lookup"><span data-stu-id="202ac-176">For API details about ASP.NET Identity, see the [Microsoft.AspNet.Identity Namespace](https://msdn.microsoft.com/library/microsoft.aspnet.identity(v=vs.111).aspx).</span></span> <span data-ttu-id="202ac-177">Pour plus d’informations sur l’initialisation du système d’identité ASP.NET, consultez le [AspnetIdentitySample](https://github.com/rustd/AspnetIdentitySample/blob/master/AspnetIdentitySample/App_Start/IdentityConfig.cs).</span><span class="sxs-lookup"><span data-stu-id="202ac-177">For additional details about initializing the ASP.NET Identity system, see the [AspnetIdentitySample](https://github.com/rustd/AspnetIdentitySample/blob/master/AspnetIdentitySample/App_Start/IdentityConfig.cs).</span></span>

### <a name="restricting-access-to-the-administration-page"></a><span data-ttu-id="202ac-178">Restreindre l’accès à la Page d’Administration</span><span class="sxs-lookup"><span data-stu-id="202ac-178">Restricting Access to the Administration Page</span></span>

<span data-ttu-id="202ac-179">L’exemple d’application Wingtip Toys permet aux utilisateurs anonymes et les utilisateurs connectés à afficher et acheter des produits.</span><span class="sxs-lookup"><span data-stu-id="202ac-179">The Wingtip Toys sample application allows both anonymous users and logged-in users to view and purchase products.</span></span> <span data-ttu-id="202ac-180">Toutefois, l’utilisateur connecté qui a le rôle personnalisé « canEdit » peut accéder à une page à accès restreint pour ajouter et supprimer des produits.</span><span class="sxs-lookup"><span data-stu-id="202ac-180">However, the logged-in user that has the custom "canEdit" role can access a restricted page in order to add and remove products.</span></span>

#### <a name="add-an-administration-folder-and-page"></a><span data-ttu-id="202ac-181">Ajouter un dossier d’Administration et de la Page</span><span class="sxs-lookup"><span data-stu-id="202ac-181">Add an Administration Folder and Page</span></span>

<span data-ttu-id="202ac-182">Ensuite, vous allez créer un dossier nommé *Admin* exemple d’application pour l’utilisateur « canEditUser » appartenant au rôle personnalisé de la Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="202ac-182">Next, you will create a folder named *Admin* for the "canEditUser" user belonging to the custom role of the Wingtip Toys sample application.</span></span>

1. <span data-ttu-id="202ac-183">Cliquez sur le nom du projet (**Wingtip Toys**) dans **l’Explorateur de solutions** et sélectionnez **ajouter**  - &gt; **nouveau dossier**.</span><span class="sxs-lookup"><span data-stu-id="202ac-183">Right-click the project name (**Wingtip Toys**) in **Solution Explorer** and select **Add** -&gt; **New Folder**.</span></span>
2. <span data-ttu-id="202ac-184">Nommez le nouveau dossier *Admin*.</span><span class="sxs-lookup"><span data-stu-id="202ac-184">Name the new folder *Admin*.</span></span>
3. <span data-ttu-id="202ac-185">Avec le bouton droit le *Admin* dossier, puis sélectionnez **ajouter**  - &gt; **un nouvel élément**.</span><span class="sxs-lookup"><span data-stu-id="202ac-185">Right-click the *Admin* folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="202ac-186">La boîte de dialogue **Ajouter un nouvel élément** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="202ac-186">The **Add New Item** dialog box is displayed.</span></span>
4. <span data-ttu-id="202ac-187">Sélectionnez le <strong>Visual C#</strong> - &gt; <strong>Web</strong> groupe de modèles sur la gauche.</span><span class="sxs-lookup"><span data-stu-id="202ac-187">Select the <strong>Visual C#</strong>-&gt; <strong>Web</strong> templates group on the left.</span></span> <span data-ttu-id="202ac-188">Dans la liste du milieu, sélectionnez <strong>Web Form avec Page maître</strong>, nommez-le <em>AdminPage.aspx</em><strong>,</strong> , puis sélectionnez <strong>ajouter</strong>.</span><span class="sxs-lookup"><span data-stu-id="202ac-188">From the middle list, select <strong>Web Form with Master Page</strong>,name it <em>AdminPage.aspx</em><strong>,</strong> and then select <strong>Add</strong>.</span></span>
5. <span data-ttu-id="202ac-189">Sélectionnez le *Site.Master* de fichiers en tant que la page maître, puis choisissez **OK**.</span><span class="sxs-lookup"><span data-stu-id="202ac-189">Select the *Site.Master* file as the master page, and then choose **OK**.</span></span>

#### <a name="add-a-webconfig-file"></a><span data-ttu-id="202ac-190">Ajouter un fichier Web.config</span><span class="sxs-lookup"><span data-stu-id="202ac-190">Add a Web.config File</span></span>

<span data-ttu-id="202ac-191">En ajoutant un *Web.config* de fichiers à la *Admin* dossier, vous pouvez restreindre l’accès à la page contenue dans le dossier.</span><span class="sxs-lookup"><span data-stu-id="202ac-191">By adding a *Web.config* file to the *Admin* folder, you can restrict access to the page contained in the folder.</span></span>

1. <span data-ttu-id="202ac-192">Avec le bouton droit le *Admin* et sélectionnez **ajouter**  - &gt; **un nouvel élément**.</span><span class="sxs-lookup"><span data-stu-id="202ac-192">Right-click the *Admin* folder and select **Add** -&gt; **New Item**.</span></span>  
   <span data-ttu-id="202ac-193">La boîte de dialogue **Ajouter un nouvel élément** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="202ac-193">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="202ac-194">Dans la liste des modèles de web Visual c#, sélectionnez <strong>fichier de Configuration Web</strong>à partir de la liste du milieu, acceptez le nom par défaut <em>Web.config</em><strong>,</strong> , puis sélectionnez <strong>Ajouter</strong>.</span><span class="sxs-lookup"><span data-stu-id="202ac-194">From the list of Visual C# web templates, select <strong>Web Configuration File</strong>from the middle list, accept the default name of <em>Web.config</em><strong>,</strong> and then select <strong>Add</strong>.</span></span>
3. <span data-ttu-id="202ac-195">Remplacez le document XML contenu dans le *Web.config* fichier avec les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="202ac-195">Replace the existing XML content in the *Web.config* file with the following:</span></span>  

    [!code-xml[Main](membership-and-administration/samples/sample4.xml)]

<span data-ttu-id="202ac-196">Enregistrer le *Web.config* fichier.</span><span class="sxs-lookup"><span data-stu-id="202ac-196">Save the *Web.config* file.</span></span> <span data-ttu-id="202ac-197">Le *Web.config* fichier Spécifie que seul l’utilisateur appartenant au rôle « canEdit » de l’application peut accéder à la page contenue dans le *Admin* dossier.</span><span class="sxs-lookup"><span data-stu-id="202ac-197">The *Web.config* file specifies that only user belonging to the "canEdit" role of the application can access the page contained in the *Admin* folder.</span></span>

### <a name="including-custom-role-navigation"></a><span data-ttu-id="202ac-198">Y compris la Navigation de rôle personnalisé</span><span class="sxs-lookup"><span data-stu-id="202ac-198">Including Custom Role Navigation</span></span>

<span data-ttu-id="202ac-199">Pour permettre à l’utilisateur du rôle personnalisé « canEdit » accéder à la section administration de l’application, vous devez ajouter un lien vers le *Site.Master* page.</span><span class="sxs-lookup"><span data-stu-id="202ac-199">To enable the user of the custom "canEdit" role to navigate to the administration section of the application, you must add a link to the *Site.Master* page.</span></span> <span data-ttu-id="202ac-200">Seuls les utilisateurs qui appartiennent au rôle « canEdit » seront en mesure de voir les **Admin** lier et accéder à la section administration.</span><span class="sxs-lookup"><span data-stu-id="202ac-200">Only users that belong to the "canEdit" role will be able to see the **Admin** link and access the administration section.</span></span>

1. <span data-ttu-id="202ac-201">Dans l’Explorateur de solutions, recherchez et ouvrez le *Site.Master* page.</span><span class="sxs-lookup"><span data-stu-id="202ac-201">In Solution Explorer, find and open the *Site.Master* page.</span></span>
2. <span data-ttu-id="202ac-202">Pour créer un lien pour l’utilisateur du rôle « canEdit », ajoutez le balisage mis en surbrillance en jaune dans la liste non triée suivante `<ul>` élément afin que la liste s’affiche comme suit :</span><span class="sxs-lookup"><span data-stu-id="202ac-202">To create a link for the user of the "canEdit" role, add the markup highlighted in yellow to the following unordered list `<ul>` element so that the list appears as follows:</span></span>  

    [!code-html[Main](membership-and-administration/samples/sample5.html?highlight=2-3)]
3. <span data-ttu-id="202ac-203">Ouvrez le *Site.Master.cs* fichier.</span><span class="sxs-lookup"><span data-stu-id="202ac-203">Open the *Site.Master.cs* file.</span></span> <span data-ttu-id="202ac-204">Rendre le **Admin** lien visible uniquement à l’utilisateur « canEditUser » en ajoutant le code mis en surbrillance en jaune pour le `Page_Load` gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="202ac-204">Make the **Admin** link visible only to the "canEditUser" user by adding the code highlighted in yellow to the `Page_Load` handler.</span></span> <span data-ttu-id="202ac-205">Le `Page_Load` gestionnaire s’affiche comme suit :</span><span class="sxs-lookup"><span data-stu-id="202ac-205">The `Page_Load` handler will appear as follows:</span></span>   

    [!code-csharp[Main](membership-and-administration/samples/sample6.cs?highlight=3-6)]

<span data-ttu-id="202ac-206">Lors du chargement de la page, le code vérifie si l’utilisateur connecté a le rôle de « canEdit ».</span><span class="sxs-lookup"><span data-stu-id="202ac-206">When the page loads, the code checks whether the logged-in user has the role of "canEdit".</span></span> <span data-ttu-id="202ac-207">Si l’utilisateur appartient au rôle « canEdit », l’élément span qui contient le lien vers le *AdminPage.aspx* page (et, par conséquent, le lien à l’intérieur de l’étendue) sont rendues visibles.</span><span class="sxs-lookup"><span data-stu-id="202ac-207">If the user belongs to the "canEdit" role, the span element containing the link to the *AdminPage.aspx* page (and consequently the link inside the span) is made visible.</span></span>

### <a name="enabling-product-administration"></a><span data-ttu-id="202ac-208">L’activation de produit Administration</span><span class="sxs-lookup"><span data-stu-id="202ac-208">Enabling Product Administration</span></span>

<span data-ttu-id="202ac-209">Jusqu'à présent, vous avez créé le rôle « canEdit » et ajouté un utilisateur « canEditUser », un dossier d’administration et une page d’administration.</span><span class="sxs-lookup"><span data-stu-id="202ac-209">So far, you have created the "canEdit" role and added an "canEditUser" user, an administration folder, and an administration page.</span></span> <span data-ttu-id="202ac-210">Vous avez défini des droits d’accès pour le dossier d’administration et de la page et que vous avez ajouté un lien de navigation de l’utilisateur du rôle « canEdit » à l’application.</span><span class="sxs-lookup"><span data-stu-id="202ac-210">You have set access rights for the administration folder and page, and have added a navigation link for the user of the "canEdit" role to the application.</span></span> <span data-ttu-id="202ac-211">Vous allez ensuite ajouter le balisage à la *AdminPage.aspx* page et le code vers le *AdminPage.aspx.cs* fichier code-behind qui permettre à l’utilisateur avec le rôle « canEdit » ajouter et supprimer des produits.</span><span class="sxs-lookup"><span data-stu-id="202ac-211">Next, you will add markup to the *AdminPage.aspx* page and code to the *AdminPage.aspx.cs* code-behind file that will enable the user with the "canEdit" role to add and remove products.</span></span>

1. <span data-ttu-id="202ac-212">Dans **l’Explorateur de solutions**, ouvrez le *AdminPage.aspx* de fichiers à partir de la *Admin* dossier.</span><span class="sxs-lookup"><span data-stu-id="202ac-212">In **Solution Explorer**, open the *AdminPage.aspx* file from the *Admin* folder.</span></span>
2. <span data-ttu-id="202ac-213">Remplacez la balise existante avec les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="202ac-213">Replace the existing markup with the following:</span></span>  

    [!code-aspx[Main](membership-and-administration/samples/sample7.aspx)]
3. <span data-ttu-id="202ac-214">Ensuite, ouvrez le *AdminPage.aspx.cs* fichier code-behind en double-cliquant sur le *AdminPage.aspx* et en cliquant sur **afficher le Code**.</span><span class="sxs-lookup"><span data-stu-id="202ac-214">Next, open the *AdminPage.aspx.cs* code-behind file by right-clicking the *AdminPage.aspx* and clicking **View Code**.</span></span>
4. <span data-ttu-id="202ac-215">Remplacez le code existant dans le *AdminPage.aspx.cs* fichier code-behind par le code suivant :</span><span class="sxs-lookup"><span data-stu-id="202ac-215">Replace the existing code in the *AdminPage.aspx.cs* code-behind file with the following code:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample8.cs)]

<span data-ttu-id="202ac-216">Dans le code que vous avez entré pour le *AdminPage.aspx.cs* fichier code-behind, une classe appelée `AddProducts` effectue le travail de l’ajout de produits à la base de données.</span><span class="sxs-lookup"><span data-stu-id="202ac-216">In the code that you entered for the *AdminPage.aspx.cs* code-behind file, a class called `AddProducts` does the actual work of adding products to the database.</span></span> <span data-ttu-id="202ac-217">Cette classe n’existe pas encore, vous allez donc créer il maintenant.</span><span class="sxs-lookup"><span data-stu-id="202ac-217">This class doesn't exist yet, so you will create it now.</span></span>

1. <span data-ttu-id="202ac-218">Dans **l’Explorateur de solutions**, avec le bouton droit le *logique* dossier, puis sélectionnez **ajouter**  - &gt; **un nouvel élément**.</span><span class="sxs-lookup"><span data-stu-id="202ac-218">In **Solution Explorer**, right-click the *Logic* folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="202ac-219">La boîte de dialogue **Ajouter un nouvel élément** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="202ac-219">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="202ac-220">Sélectionnez le **Visual C#**  - &gt; **Code** groupe de modèles sur la gauche.</span><span class="sxs-lookup"><span data-stu-id="202ac-220">Select the **Visual C#** -&gt; **Code** templates group on the left.</span></span> <span data-ttu-id="202ac-221">Ensuite, sélectionnez **classe**à partir du milieu de liste et nommez-le *AddProducts.cs*.</span><span class="sxs-lookup"><span data-stu-id="202ac-221">Then, select **Class**from the middle list and name it *AddProducts.cs*.</span></span>   
   <span data-ttu-id="202ac-222">Le nouveau fichier de classe s’affiche.</span><span class="sxs-lookup"><span data-stu-id="202ac-222">The new class file is displayed.</span></span>
3. <span data-ttu-id="202ac-223">Remplacez le code existant par le code ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="202ac-223">Replace the existing code with the following:</span></span>  

    [!code-csharp[Main](membership-and-administration/samples/sample9.cs)]

<span data-ttu-id="202ac-224">Le *AdminPage.aspx* page permet à l’utilisateur appartenant au rôle « canEdit » ajouter et supprimer des produits.</span><span class="sxs-lookup"><span data-stu-id="202ac-224">The *AdminPage.aspx* page allows the user belonging to the "canEdit" role to add and remove products.</span></span> <span data-ttu-id="202ac-225">Lorsqu’un nouveau produit est ajouté, les détails du produit sont validées et ensuite entrées dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="202ac-225">When a new product is added, the details about the product are validated and then entered into the database.</span></span> <span data-ttu-id="202ac-226">Le nouveau produit est immédiatement disponible pour tous les utilisateurs de l’application web.</span><span class="sxs-lookup"><span data-stu-id="202ac-226">The new product is immediately available to all users of the web application.</span></span>

#### <a name="unobtrusive-validation"></a><span data-ttu-id="202ac-227">Validation non obstrusive</span><span class="sxs-lookup"><span data-stu-id="202ac-227">Unobtrusive Validation</span></span>

<span data-ttu-id="202ac-228">Les détails du produit fournies par l’utilisateur sur le *AdminPage.aspx* page sont validés à l’aide de contrôles de validation (`RequiredFieldValidator` et `RegularExpressionValidator`).</span><span class="sxs-lookup"><span data-stu-id="202ac-228">The product details that the user provides on the *AdminPage.aspx* page are validated using validation controls (`RequiredFieldValidator` and `RegularExpressionValidator`).</span></span> <span data-ttu-id="202ac-229">Ces contrôles utilisent automatiquement la validation non obstrusive.</span><span class="sxs-lookup"><span data-stu-id="202ac-229">These controls automatically use unobtrusive validation.</span></span> <span data-ttu-id="202ac-230">Validation non obstrusive permet les contrôles de validation à utiliser JavaScript pour la logique de validation côté client, ce qui signifie que la page ne requiert pas un aller-retour vers le serveur à valider.</span><span class="sxs-lookup"><span data-stu-id="202ac-230">Unobtrusive validation allows the validation controls to use JavaScript for client-side validation logic, which means the page does not require a trip to the server to be validated.</span></span> <span data-ttu-id="202ac-231">Par défaut, la validation discrète est incluse dans le *Web.config* fichier basé sur le paramètre de configuration suivantes :</span><span class="sxs-lookup"><span data-stu-id="202ac-231">By default, unobtrusive validation is included in the *Web.config* file based on the following configuration setting:</span></span>

[!code-xml[Main](membership-and-administration/samples/sample10.xml)]

#### <a name="regular-expressions"></a><span data-ttu-id="202ac-232">Expressions régulières</span><span class="sxs-lookup"><span data-stu-id="202ac-232">Regular Expressions</span></span>

<span data-ttu-id="202ac-233">Le prix du produit sur le *AdminPage.aspx* page est validée à l’aide un **RegularExpressionValidator** contrôle.</span><span class="sxs-lookup"><span data-stu-id="202ac-233">The product price on the *AdminPage.aspx* page is validated using a **RegularExpressionValidator** control.</span></span> <span data-ttu-id="202ac-234">Ce contrôle vérifie si la valeur du contrôle d’entrée associé (la zone de texte « AddProductPrice ») correspond au modèle spécifié par l’expression régulière.</span><span class="sxs-lookup"><span data-stu-id="202ac-234">This control validates whether the value of the associated input control (the "AddProductPrice" TextBox) matches the pattern specified by the regular expression.</span></span> <span data-ttu-id="202ac-235">Une expression régulière est une notation de correspondance qui vous permet de rapidement rechercher des modèles de caractères spécifiques.</span><span class="sxs-lookup"><span data-stu-id="202ac-235">A regular expression is a pattern-matching notation that enables you to quickly find and match specific character patterns.</span></span> <span data-ttu-id="202ac-236">Le **RegularExpressionValidator** contrôle inclut une propriété nommée `ValidationExpression` qui contient l’expression régulière utilisée pour valider une entrée de prix, comme indiqué ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="202ac-236">The **RegularExpressionValidator** control includes a property named `ValidationExpression` that contains the regular expression used to validate price input, as shown below:</span></span>

[!code-aspx[Main](membership-and-administration/samples/sample11.aspx)]

#### <a name="fileupload-control"></a><span data-ttu-id="202ac-237">Contrôle fileUpload</span><span class="sxs-lookup"><span data-stu-id="202ac-237">FileUpload Control</span></span>

<span data-ttu-id="202ac-238">Outre les contrôles d’entrée et de validation, vous avez ajouté le **FileUpload** le contrôle à la *AdminPage.aspx* page.</span><span class="sxs-lookup"><span data-stu-id="202ac-238">In addition to the input and validation controls, you added the **FileUpload** control to the *AdminPage.aspx* page.</span></span> <span data-ttu-id="202ac-239">Ce contrôle permet de télécharger des fichiers.</span><span class="sxs-lookup"><span data-stu-id="202ac-239">This control provides the capability to upload files.</span></span> <span data-ttu-id="202ac-240">Dans ce cas, vous autorisez uniquement les fichiers image à télécharger.</span><span class="sxs-lookup"><span data-stu-id="202ac-240">In this case, you are only allowing image files to be uploaded.</span></span> <span data-ttu-id="202ac-241">Dans le fichier code-behind (*AdminPage.aspx.cs*), lorsque le `AddProductButton` est activé, le code vérifie la `HasFile` propriété de la **FileUpload** contrôle.</span><span class="sxs-lookup"><span data-stu-id="202ac-241">In the code-behind file (*AdminPage.aspx.cs*), when the `AddProductButton` is clicked, the code checks the `HasFile` property of the **FileUpload** control.</span></span> <span data-ttu-id="202ac-242">Si le contrôle dispose d’un fichier et si le type de fichier (basé sur l’extension de fichier) est autorisé, l’image est enregistrée sur le *Images* dossier et le *Images/pouces* dossier de l’application.</span><span class="sxs-lookup"><span data-stu-id="202ac-242">If the control has a file and if the file type (based on file extension) is allowed, the image is saved to the *Images* folder and the *Images/Thumbs* folder of the application.</span></span>

#### <a name="model-binding"></a><span data-ttu-id="202ac-243">Liaison de modèle</span><span class="sxs-lookup"><span data-stu-id="202ac-243">Model Binding</span></span>

<span data-ttu-id="202ac-244">Plus haut dans cette série de didacticiels vous permet de liaison de modèle pour remplir un **ListView** (contrôle), un **FormsView** (contrôle), un **GridView** (contrôle) et un  **DetailView** contrôle.</span><span class="sxs-lookup"><span data-stu-id="202ac-244">Earlier in this tutorial series you used model binding to populate a **ListView** control, a **FormsView** control, a **GridView** control, and a **DetailView** control.</span></span> <span data-ttu-id="202ac-245">Dans ce didacticiel, vous utilisez liaison de modèle pour remplir un **DropDownList** contrôle avec une liste des catégories de produits.</span><span class="sxs-lookup"><span data-stu-id="202ac-245">In this tutorial, you use model binding to populate a **DropDownList** control with a list of product categories.</span></span>

<span data-ttu-id="202ac-246">Le balisage que vous avez ajouté à la *AdminPage.aspx* fichier contient un **DropDownList** contrôle appelé `DropDownAddCategory`:</span><span class="sxs-lookup"><span data-stu-id="202ac-246">The markup that you added to the *AdminPage.aspx* file contains a **DropDownList** control called `DropDownAddCategory`:</span></span>

[!code-aspx[Main](membership-and-administration/samples/sample12.aspx)]

<span data-ttu-id="202ac-247">Liaison de modèle vous permet de remplir ce **DropDownList** en définissant le `ItemType` attribut et le `SelectMethod` attribut.</span><span class="sxs-lookup"><span data-stu-id="202ac-247">You use model binding to populate this **DropDownList** by setting the `ItemType` attribute and the `SelectMethod` attribute.</span></span> <span data-ttu-id="202ac-248">Le `ItemType` attribut indique que vous utilisez le `WingtipToys.Models.Category` lors du remplissage du contrôle de type.</span><span class="sxs-lookup"><span data-stu-id="202ac-248">The `ItemType` attribute specifies that you use the `WingtipToys.Models.Category` type when populating the control.</span></span> <span data-ttu-id="202ac-249">Définie de ce type au début de cette série de didacticiels en créant la `Category` classe (voir ci-dessous).</span><span class="sxs-lookup"><span data-stu-id="202ac-249">You defined this type at the beginning of this tutorial series by creating the `Category` class (shown below).</span></span> <span data-ttu-id="202ac-250">Le `Category` classe se trouve dans le *modèles* dossier à l’intérieur de la *Category.cs* fichier.</span><span class="sxs-lookup"><span data-stu-id="202ac-250">The `Category` class is in the *Models* folder inside the *Category.cs* file.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample13.cs)]

<span data-ttu-id="202ac-251">Le `SelectMethod` attribut de la **DropDownList** contrôle indique que vous utilisez le `GetCategories` (méthode) (voir ci-dessous) qui est inclus dans le fichier code-behind (*AdminPage.aspx.cs*).</span><span class="sxs-lookup"><span data-stu-id="202ac-251">The `SelectMethod` attribute of the **DropDownList** control specifies that you use the `GetCategories` method (shown below) that is included in the code-behind file (*AdminPage.aspx.cs*).</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample14.cs)]

<span data-ttu-id="202ac-252">Cette méthode spécifie qu’un `IQueryable` interface est utilisée pour évaluer une requête sur un `Category` type.</span><span class="sxs-lookup"><span data-stu-id="202ac-252">This method specifies that an `IQueryable` interface is used to evaluate a query against a `Category` type.</span></span> <span data-ttu-id="202ac-253">La valeur retournée est utilisée pour remplir la **DropDownList** dans le balisage de la page (*AdminPage.aspx*).</span><span class="sxs-lookup"><span data-stu-id="202ac-253">The returned value is used to populate the **DropDownList** in the markup of the page (*AdminPage.aspx*).</span></span>

<span data-ttu-id="202ac-254">Le texte affiché pour chaque élément dans la liste est spécifié en définissant le `DataTextField` attribut.</span><span class="sxs-lookup"><span data-stu-id="202ac-254">The text displayed for each item in the list is specified by setting the `DataTextField` attribute.</span></span> <span data-ttu-id="202ac-255">Le `DataTextField` attribut utilise le `CategoryName` de la `Category` classe (illustré ci-dessus) pour afficher chaque catégorie dans le **DropDownList** contrôle.</span><span class="sxs-lookup"><span data-stu-id="202ac-255">The `DataTextField` attribute uses the `CategoryName` of the `Category` class (shown above) to display each category in the **DropDownList** control.</span></span> <span data-ttu-id="202ac-256">La valeur réelle est passée lorsqu’un élément est sélectionné dans le **DropDownList** contrôle est basé sur le `DataValueField` attribut.</span><span class="sxs-lookup"><span data-stu-id="202ac-256">The actual value that is passed when an item is selected in the **DropDownList** control is based on the `DataValueField` attribute.</span></span> <span data-ttu-id="202ac-257">Le `DataValueField` attribut est défini sur le `CategoryID` que la définition de la `Category` classe (illustré ci-dessus).</span><span class="sxs-lookup"><span data-stu-id="202ac-257">The `DataValueField` attribute is set to the `CategoryID` as define in the `Category` class (shown above).</span></span>

### <a name="how-the-application-will-work"></a><span data-ttu-id="202ac-258">Fonctionne de l’Application</span><span class="sxs-lookup"><span data-stu-id="202ac-258">How the Application Will Work</span></span>

<span data-ttu-id="202ac-259">Lorsque l’utilisateur appartenant au rôle « canEdit » accède à la page pour la première fois, le `DropDownAddCategory` **DropDownList** est rempli comme décrit ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="202ac-259">When the user belonging to the "canEdit" role navigates to the page for the first time, the `DropDownAddCategory`**DropDownList** control is populated as described above.</span></span> <span data-ttu-id="202ac-260">Le `DropDownRemoveProduct` **DropDownList** contrôle est également rempli avec les produits à l’aide de la même approche.</span><span class="sxs-lookup"><span data-stu-id="202ac-260">The `DropDownRemoveProduct`**DropDownList** control is also populated with products using the same approach.</span></span> <span data-ttu-id="202ac-261">Sélectionne le type de catégorie de l’utilisateur appartenant au rôle « canEdit » et ajoute les détails du produit (**nom**, **Description**, **prix**, et **le fichier Image**).</span><span class="sxs-lookup"><span data-stu-id="202ac-261">The user belonging to the "canEdit" role selects the category type and adds product details (**Name**, **Description**, **Price**, and **Image File**).</span></span> <span data-ttu-id="202ac-262">Lorsque l’utilisateur appartenant au rôle « canEdit » clique le **ajouter un produit** bouton, le `AddProductButton_Click` Gestionnaire d’événements est déclenché.</span><span class="sxs-lookup"><span data-stu-id="202ac-262">When the user belonging to the "canEdit" role clicks the **Add Product** button, the `AddProductButton_Click` event handler is triggered.</span></span> <span data-ttu-id="202ac-263">Le `AddProductButton_Click` Gestionnaire d’événements se trouve dans le fichier code-behind (*AdminPage.aspx.cs*) vérifie le fichier image pour vous assurer qu’il correspond aux types de fichiers autorisés *(.gif*, *.png*, *.jpeg*, ou *.jpg*).</span><span class="sxs-lookup"><span data-stu-id="202ac-263">The `AddProductButton_Click` event handler located in the code-behind file (*AdminPage.aspx.cs*) checks the image file to make sure it matches the allowed file types *(.gif*, *.png*, *.jpeg*, or *.jpg*).</span></span> <span data-ttu-id="202ac-264">Ensuite, l’image est enregistrée dans un dossier de l’exemple d’application Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="202ac-264">Then, the image file is saved into a folder of the Wingtip Toys sample application.</span></span> <span data-ttu-id="202ac-265">Ensuite, le nouveau produit est ajouté à la base de données.</span><span class="sxs-lookup"><span data-stu-id="202ac-265">Next, the new product is added to the database.</span></span> <span data-ttu-id="202ac-266">Pour accomplir l’ajout d’un nouveau produit, une nouvelle instance de la `AddProducts` classe est créée et nommée produits.</span><span class="sxs-lookup"><span data-stu-id="202ac-266">To accomplish adding a new product, a new instance of the `AddProducts` class is created and named products.</span></span> <span data-ttu-id="202ac-267">Le `AddProducts` classe a une méthode nommée `AddProduct`, et l’objet de produits appelle cette méthode pour ajouter des produits à la base de données.</span><span class="sxs-lookup"><span data-stu-id="202ac-267">The `AddProducts` class has a method named `AddProduct`, and the products object calls this method to add products to the database.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample15.cs)]

<span data-ttu-id="202ac-268">Si le code ajoute correctement le nouveau produit à la base de données, la page est rechargée avec la valeur de chaîne de requête `ProductAction=add`.</span><span class="sxs-lookup"><span data-stu-id="202ac-268">If the code successfully adds the new product to the database, the page is reloaded with the query string value `ProductAction=add`.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample16.cs)]

<span data-ttu-id="202ac-269">Lorsque la page se recharge, la chaîne de requête est incluse dans l’URL.</span><span class="sxs-lookup"><span data-stu-id="202ac-269">When the page reloads, the query string is included in the URL.</span></span> <span data-ttu-id="202ac-270">Rechargez la page, l’utilisateur appartenant au rôle « canEdit » voir immédiatement les mises à jour dans le **DropDownList** contrôle sur le *AdminPage.aspx* page.</span><span class="sxs-lookup"><span data-stu-id="202ac-270">By reloading the page, the user belonging to the "canEdit" role can immediately see the updates in the **DropDownList** controls on the *AdminPage.aspx* page.</span></span> <span data-ttu-id="202ac-271">En outre, en incluant la chaîne de requête avec l’URL, la page peut afficher un message de réussite à l’utilisateur appartenant au rôle « canEdit ».</span><span class="sxs-lookup"><span data-stu-id="202ac-271">Also, by including the query string with the URL, the page can display a success message to the user belonging to the "canEdit" role.</span></span>

<span data-ttu-id="202ac-272">Lorsque le *AdminPage.aspx* page recharge, le `Page_Load` événement est appelé.</span><span class="sxs-lookup"><span data-stu-id="202ac-272">When the *AdminPage.aspx* page reloads, the `Page_Load` event is called.</span></span>

[!code-csharp[Main](membership-and-administration/samples/sample17.cs)]

<span data-ttu-id="202ac-273">Le `Page_Load` Gestionnaire d’événements vérifie la valeur de chaîne de requête et détermine s’il faut afficher un message de réussite.</span><span class="sxs-lookup"><span data-stu-id="202ac-273">The `Page_Load` event handler checks the query string value and determines whether to show a success message.</span></span>

## <a name="running-the-application"></a><span data-ttu-id="202ac-274">Exécution de l'application</span><span class="sxs-lookup"><span data-stu-id="202ac-274">Running the Application</span></span>

<span data-ttu-id="202ac-275">Vous pouvez exécuter l’application maintenant pour voir comment vous pouvez ajouter, supprimer et les éléments de mise à jour dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="202ac-275">You can run the application now to see how you can add, delete, and update items in the shopping cart.</span></span> <span data-ttu-id="202ac-276">Le total de panier d’achat reflète le coût total de tous les éléments dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="202ac-276">The shopping cart total will reflect the total cost of all items in the shopping cart.</span></span>

1. <span data-ttu-id="202ac-277">Dans l’Explorateur de solutions, appuyez sur **F5** pour exécuter l’exemple d’application Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="202ac-277">In Solution Explorer, press **F5** to run the Wingtip Toys sample application.</span></span>  
   <span data-ttu-id="202ac-278">Le navigateur s’ouvre et affiche le *Default.aspx* page.</span><span class="sxs-lookup"><span data-stu-id="202ac-278">The browser opens and shows the *Default.aspx* page.</span></span>
2. <span data-ttu-id="202ac-279">Cliquez sur le **connecter** lien en haut de la page.</span><span class="sxs-lookup"><span data-stu-id="202ac-279">Click the **Log in** link at the top of the page.</span></span> 

    ![L’appartenance et l’Administration - connectez-vous de lien](membership-and-administration/_static/image2.png)

   <span data-ttu-id="202ac-281">Le *Login.aspx* page s’affiche.</span><span class="sxs-lookup"><span data-stu-id="202ac-281">The *Login.aspx* page is displayed.</span></span>
3. <span data-ttu-id="202ac-282">Utilisez le nom d’utilisateur suivant et le mot de passe :</span><span class="sxs-lookup"><span data-stu-id="202ac-282">Use the following user name and password:</span></span>  
   <span data-ttu-id="202ac-283">Nom d’utilisateur : canEditUser@wingtiptoys.com</span><span class="sxs-lookup"><span data-stu-id="202ac-283">User name: canEditUser@wingtiptoys.com</span></span>  
   <span data-ttu-id="202ac-284">Mot de passe : Pa$ $word1</span><span class="sxs-lookup"><span data-stu-id="202ac-284">Password: Pa$$word1</span></span> 

    ![L’appartenance et l’Administration - Page de connexion](membership-and-administration/_static/image3.png)
4. <span data-ttu-id="202ac-286">Cliquez sur le **connecter** bouton vers le bas de la page.</span><span class="sxs-lookup"><span data-stu-id="202ac-286">Click the **Log in** button near the bottom of the page.</span></span>
5. <span data-ttu-id="202ac-287">En haut de la page suivante, sélectionnez le **Admin** lien pour accéder à la *AdminPage.aspx* page.</span><span class="sxs-lookup"><span data-stu-id="202ac-287">At the top of the next page, select the **Admin** link to navigate to the *AdminPage.aspx* page.</span></span> 

    ![L’appartenance et l’Administration - lien d’administration](membership-and-administration/_static/image4.png)
6. <span data-ttu-id="202ac-289">Pour tester la validation des entrées, cliquez sur le **ajouter un produit** bouton sans ajouter les détails du produit.</span><span class="sxs-lookup"><span data-stu-id="202ac-289">To test the input validation, click the **Add Product** button without adding any product details.</span></span> 

    ![L’appartenance et l’Administration - Page d’administration](membership-and-administration/_static/image5.png)

   <span data-ttu-id="202ac-291">Notez que les messages de champ obligatoire sont affichés.</span><span class="sxs-lookup"><span data-stu-id="202ac-291">Notice that the required field messages are displayed.</span></span>
7. <span data-ttu-id="202ac-292">Ajouter les détails d’un nouveau produit, puis cliquez sur le **ajouter un produit** bouton.</span><span class="sxs-lookup"><span data-stu-id="202ac-292">Add the details for a new product, and then click the **Add Product** button.</span></span> 

    ![L’appartenance et l’Administration - ajouter un produit](membership-and-administration/_static/image6.png)
8. <span data-ttu-id="202ac-294">Sélectionnez **produits** à partir du menu de navigation supérieur pour afficher le nouveau produit que vous avez ajouté.</span><span class="sxs-lookup"><span data-stu-id="202ac-294">Select **Products** from the top navigation menu to view the new product you added.</span></span> 

    ![L’appartenance et l’Administration - afficher le nouveau produit](membership-and-administration/_static/image7.png)
9. <span data-ttu-id="202ac-296">Cliquez sur le **Admin** lien pour revenir à la page d’administration.</span><span class="sxs-lookup"><span data-stu-id="202ac-296">Click the **Admin** link to return to the administration page.</span></span>
10. <span data-ttu-id="202ac-297">Dans le **supprimer le produit** section de la page, sélectionnez le nouveau produit que vous avez ajouté à la **DropDownListBox**.</span><span class="sxs-lookup"><span data-stu-id="202ac-297">In the **Remove Product** section of the page, select the new product you added in the **DropDownListBox**.</span></span>
11. <span data-ttu-id="202ac-298">Cliquez sur le **supprimer le produit** bouton pour supprimer le nouveau produit de l’application.</span><span class="sxs-lookup"><span data-stu-id="202ac-298">Click the **Remove Product** button to remove the new product from the application.</span></span> 

    ![L’appartenance et l’Administration - Remove produit](membership-and-administration/_static/image8.png)
12. <span data-ttu-id="202ac-300">Sélectionnez **produits** à partir du menu de navigation supérieure pour confirmer que le produit a été supprimé.</span><span class="sxs-lookup"><span data-stu-id="202ac-300">Select **Products** from the top navigation menu to confirm that the product has been removed.</span></span>
13. <span data-ttu-id="202ac-301">Cliquez sur **session** d’exister en mode d’administration.</span><span class="sxs-lookup"><span data-stu-id="202ac-301">Click **Log off** to exist administration mode.</span></span>   
    <span data-ttu-id="202ac-302">Notez que le volet de navigation supérieure n’affiche plus le **Admin** élément de menu.</span><span class="sxs-lookup"><span data-stu-id="202ac-302">Notice that the top navigation pane no longer shows the **Admin** menu item.</span></span>

## <a name="summary"></a><span data-ttu-id="202ac-303">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="202ac-303">Summary</span></span>

<span data-ttu-id="202ac-304">Dans ce didacticiel, vous ajouté un rôle personnalisé et un utilisateur appartenant au rôle personnalisé, un accès limité à la page et le dossier d’administration et fourni la navigation de l’utilisateur appartenant au rôle personnalisé.</span><span class="sxs-lookup"><span data-stu-id="202ac-304">In this tutorial, you added a custom role and a user belonging to the custom role, restricted access to the administration folder and page, and provided navigation for the user belonging to the custom role.</span></span> <span data-ttu-id="202ac-305">Liaison de modèle vous permet de remplir un **DropDownList** contrôle de données.</span><span class="sxs-lookup"><span data-stu-id="202ac-305">You used model binding to populate a **DropDownList** control with data.</span></span> <span data-ttu-id="202ac-306">Vous implémenté la **FileUpload** contrôle et les contrôles de validation.</span><span class="sxs-lookup"><span data-stu-id="202ac-306">You implemented the **FileUpload** control and validation controls.</span></span> <span data-ttu-id="202ac-307">En outre, vous avez appris comment ajouter et supprimer des produits à partir d’une base de données.</span><span class="sxs-lookup"><span data-stu-id="202ac-307">Also, you have learned how to add and remove products from a database.</span></span> <span data-ttu-id="202ac-308">Dans l’étape suivante du didacticiel, vous allez apprendre à implémenter le routage ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="202ac-308">In the next tutorial, you'll learn how to implement ASP.NET routing.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="202ac-309">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="202ac-309">Additional Resources</span></span>

<span data-ttu-id="202ac-310">[Web.config - authorization, élément](https://msdn.microsoft.com/library/8d82143t(v=vs.100).aspx)</span><span class="sxs-lookup"><span data-stu-id="202ac-310">[Web.config - authorization Element](https://msdn.microsoft.com/library/8d82143t(v=vs.100).aspx)</span></span>  
[<span data-ttu-id="202ac-311">Identité ASP.NET</span><span class="sxs-lookup"><span data-stu-id="202ac-311">ASP.NET Identity</span></span>](../../../../identity/overview/getting-started/introduction-to-aspnet-identity.md)  
[<span data-ttu-id="202ac-312">Déployer une application de formulaires Web ASP.NET sécurisée avec base de données SQL, OAuth et l’appartenance à un Site Web Azure</span><span class="sxs-lookup"><span data-stu-id="202ac-312">Deploy a Secure ASP.NET Web Forms App with Membership, OAuth, and SQL Database to an Azure Web Site</span></span>](https://azure.microsoft.com/documentation/articles/web-sites-dotnet-deploy-aspnet-webforms-app-membership-oauth-sql-database/)  
[<span data-ttu-id="202ac-313">Microsoft Azure - version d’évaluation gratuite</span><span class="sxs-lookup"><span data-stu-id="202ac-313">Microsoft Azure - Free Trial</span></span>](https://azure.microsoft.com/pricing/free-trial/)

> [!div class="step-by-step"]
> <span data-ttu-id="202ac-314">[Précédent](checkout-and-payment-with-paypal.md)
> [Suivant](url-routing.md)</span><span class="sxs-lookup"><span data-stu-id="202ac-314">[Previous](checkout-and-payment-with-paypal.md)
[Next](url-routing.md)</span></span>
