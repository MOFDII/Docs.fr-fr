---
uid: web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/shopping-cart
title: "Panier d’achat | Documents Microsoft"
author: Erikre
description: "Cette série de didacticiels, vous allez apprendre les principes fondamentaux de la création d’une application Web Forms ASP.NET à l’aide de ASP.NET 4.5 et Microsoft Visual Studio Express 2013 pour nous..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 09/08/2014
ms.topic: article
ms.assetid: 6898c601-6c31-432f-8388-e6843f8a17cb
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/shopping-cart
msc.type: authoredcontent
ms.openlocfilehash: 9fe6f28685d6a423b03f9c7abe753283b89344e1
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/24/2018
---
<a name="shopping-cart"></a><span data-ttu-id="3ec90-103">Panier d’achat</span><span class="sxs-lookup"><span data-stu-id="3ec90-103">Shopping Cart</span></span>
====================
<span data-ttu-id="3ec90-104">Par [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="3ec90-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

<span data-ttu-id="3ec90-105">[Télécharger Wingtip Toys exemple de projet (c#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) ou [télécharger des livres (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span><span class="sxs-lookup"><span data-stu-id="3ec90-105">[Download Wingtip Toys Sample Project (C#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) or [Download E-book (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span></span>

> <span data-ttu-id="3ec90-106">Cette série de didacticiels, vous allez apprendre les principes fondamentaux de la création d’une application Web Forms ASP.NET à l’aide de ASP.NET 4.5 et Microsoft Visual Studio Express 2013 pour le Web.</span><span class="sxs-lookup"><span data-stu-id="3ec90-106">This tutorial series will teach you the basics of building an ASP.NET Web Forms application using ASP.NET 4.5 and Microsoft Visual Studio Express 2013 for Web.</span></span> <span data-ttu-id="3ec90-107">Un Visual Studio 2013 [projet avec le code source c#](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) est disponible pour accompagner cette série de didacticiels.</span><span class="sxs-lookup"><span data-stu-id="3ec90-107">A Visual Studio 2013 [project with C# source code](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) is available to accompany this tutorial series.</span></span>


<span data-ttu-id="3ec90-108">Ce didacticiel décrit la logique métier nécessaire pour ajouter un panier d’achat à l’application de Web Forms ASP.NET exemple Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="3ec90-108">This tutorial describes the business logic required to add a shopping cart to the Wingtip Toys sample ASP.NET Web Forms application.</span></span> <span data-ttu-id="3ec90-109">Ce didacticiel s’appuie sur le didacticiel précédent « Affichage des éléments et détails de données » et fait partie de la série de didacticiels Wingtip JOUET magasin.</span><span class="sxs-lookup"><span data-stu-id="3ec90-109">This tutorial builds on the previous tutorial "Display Data Items and Details" and is part of the Wingtip Toy Store tutorial series.</span></span> <span data-ttu-id="3ec90-110">Lorsque vous avez terminé ce didacticiel, les utilisateurs de votre exemple d’application sera en mesure de les ajouter, supprimer et modifier les produits dans leur panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-110">When you've completed this tutorial, the users of your sample app will be able to add, remove, and modify the products in their shopping cart.</span></span>

## <a name="what-youll-learn"></a><span data-ttu-id="3ec90-111">Ce que vous allez apprendre :</span><span class="sxs-lookup"><span data-stu-id="3ec90-111">What you'll learn:</span></span>

1. <span data-ttu-id="3ec90-112">Comment créer un panier d’achat pour l’application web.</span><span class="sxs-lookup"><span data-stu-id="3ec90-112">How to create a shopping cart for the web application.</span></span>
2. <span data-ttu-id="3ec90-113">Comment permettre aux utilisateurs d’ajouter des éléments au panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-113">How to enable users to add items to the shopping cart.</span></span>
3. <span data-ttu-id="3ec90-114">Comment ajouter un [GridView](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview(v=vs.110).aspx#introduction) contrôle pour afficher les détails du panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-114">How to add a [GridView](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview(v=vs.110).aspx#introduction) control to display shopping cart details.</span></span>
4. <span data-ttu-id="3ec90-115">Comment calculer et afficher le total de la commande.</span><span class="sxs-lookup"><span data-stu-id="3ec90-115">How to calculate and display the order total.</span></span>
5. <span data-ttu-id="3ec90-116">Comment supprimer et mettre à jour des éléments dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-116">How to remove and update items in the shopping cart.</span></span>
6. <span data-ttu-id="3ec90-117">Explique comment inclure un compteur de panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-117">How to include a shopping cart counter.</span></span>

## <a name="code-features-in-this-tutorial"></a><span data-ttu-id="3ec90-118">Fonctionnalités de code dans ce didacticiel :</span><span class="sxs-lookup"><span data-stu-id="3ec90-118">Code features in this tutorial:</span></span>

1. <span data-ttu-id="3ec90-119">Entity Framework Code First</span><span class="sxs-lookup"><span data-stu-id="3ec90-119">Entity Framework Code First</span></span>
2. <span data-ttu-id="3ec90-120">Annotations de données</span><span class="sxs-lookup"><span data-stu-id="3ec90-120">Data Annotations</span></span>
3. <span data-ttu-id="3ec90-121">Fortement typée les contrôles de données</span><span class="sxs-lookup"><span data-stu-id="3ec90-121">Strongly typed data controls</span></span>
4. <span data-ttu-id="3ec90-122">Liaison de modèle</span><span class="sxs-lookup"><span data-stu-id="3ec90-122">Model binding</span></span>

## <a name="creating-a-shopping-cart"></a><span data-ttu-id="3ec90-123">Création d’un panier d’achat</span><span class="sxs-lookup"><span data-stu-id="3ec90-123">Creating a Shopping Cart</span></span>

<span data-ttu-id="3ec90-124">Plus haut dans cette série de didacticiels, vous avez ajouté des pages et le code pour afficher les données de produit à partir d’une base de données.</span><span class="sxs-lookup"><span data-stu-id="3ec90-124">Earlier in this tutorial series, you added pages and code to view product data from a database.</span></span> <span data-ttu-id="3ec90-125">Dans ce didacticiel, vous allez créer un panier d’achat pour gérer les produits que les utilisateurs intéressés par l’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-125">In this tutorial, you'll create a shopping cart to manage the products that users are interested in buying.</span></span> <span data-ttu-id="3ec90-126">Les utilisateurs pourront parcourir et ajouter des éléments au panier d’achat même s’ils ne sont pas inscrits ou connectés.</span><span class="sxs-lookup"><span data-stu-id="3ec90-126">Users will be able to browse and add items to the shopping cart even if they are not registered or logged in.</span></span> <span data-ttu-id="3ec90-127">Pour gérer l’accès de panier d’achat, vous allez attribuer aux utilisateurs une unique `ID` à l’aide d’un identificateur global unique (GUID) lorsque l’utilisateur accède à l’analyse de panier pour la première fois.</span><span class="sxs-lookup"><span data-stu-id="3ec90-127">To manage shopping cart access, you will assign users a unique `ID` using a globally unique identifier (GUID) when the user accesses the shopping cart for the first time.</span></span> <span data-ttu-id="3ec90-128">Vous allez enregistrer cet `ID` à l’aide de l’état de Session ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="3ec90-128">You'll store this `ID` using the ASP.NET Session state.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="3ec90-129">L’état de Session ASP.NET est un emplacement pratique pour stocker des informations spécifiques à l’utilisateur expire une fois que l’utilisateur quitte le site.</span><span class="sxs-lookup"><span data-stu-id="3ec90-129">The ASP.NET Session state is a convenient place to store user-specific information which will expire after the user leaves the site.</span></span> <span data-ttu-id="3ec90-130">Lors de l’utilisation incorrecte de l’état de session peut avoir des implications en matière de performances sur les sites de grande taille, clair l’utilisation de la session de l’état fonctionne correctement à des fins de démonstration.</span><span class="sxs-lookup"><span data-stu-id="3ec90-130">While misuse of session state can have performance implications on larger sites, light use of session state works well for demonstration purposes.</span></span> <span data-ttu-id="3ec90-131">L’exemple de projet Wingtip Toys montre comment utiliser l’état de session sans un fournisseur externe, où l’état de session est stockée in-process sur le serveur web qui héberge le site.</span><span class="sxs-lookup"><span data-stu-id="3ec90-131">The Wingtip Toys sample project shows how to use session state without an external provider, where session state is stored in-process on the web server hosting the site.</span></span> <span data-ttu-id="3ec90-132">Pour les sites de grande taille qui fournissent plusieurs instances d’une application ou pour les sites qui exécutent plusieurs instances d’une application sur différents serveurs, envisagez d’utiliser **Service de Cache de Windows Azure**.</span><span class="sxs-lookup"><span data-stu-id="3ec90-132">For larger sites that provide multiple instances of an application or for sites that run multiple instances of an application on different servers, consider using **Windows Azure Cache Service**.</span></span> <span data-ttu-id="3ec90-133">Ce Service de Cache fournit un service de mise en cache distribué qui est le site web externe et résout le problème de l’état de session in-process.</span><span class="sxs-lookup"><span data-stu-id="3ec90-133">This Cache Service provides a distributed caching service that is external to the web site and solves the problem of using in-process session state.</span></span> <span data-ttu-id="3ec90-134">Pour plus d’informations, consultez [l’état de Session ASP.NET avec les Sites Web Windows Azure](https://docs.microsoft.com/azure/redis-cache/cache-aspnet-session-state-provider).</span><span class="sxs-lookup"><span data-stu-id="3ec90-134">For more information see, [How to Use ASP.NET Session State with Windows Azure Web Sites](https://docs.microsoft.com/azure/redis-cache/cache-aspnet-session-state-provider).</span></span>


### <a name="add-cartitem-as-a-model-class"></a><span data-ttu-id="3ec90-135">Ajouter CartItem comme une classe de modèle</span><span class="sxs-lookup"><span data-stu-id="3ec90-135">Add CartItem as a Model Class</span></span>

<span data-ttu-id="3ec90-136">Plus haut dans cette série de didacticiels, vous défini le schéma pour les données de catégorie et de produit en créant le `Category` et `Product` des classes dans le *modèles* dossier.</span><span class="sxs-lookup"><span data-stu-id="3ec90-136">Earlier in this tutorial series, you defined the schema for the category and product data by creating the `Category` and `Product` classes in the *Models* folder.</span></span> <span data-ttu-id="3ec90-137">Maintenant, ajoutez une nouvelle classe pour définir le schéma pour le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-137">Now, add a new class to define the schema for the shopping cart.</span></span> <span data-ttu-id="3ec90-138">Plus loin dans ce didacticiel, vous allez ajouter une classe pour gérer l’accès aux données le `CartItem` table.</span><span class="sxs-lookup"><span data-stu-id="3ec90-138">Later in this tutorial, you will add a class to handle data access to the `CartItem` table.</span></span> <span data-ttu-id="3ec90-139">Cette classe fournit la logique métier pour ajouter, supprimer et mettre à jour des éléments dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-139">This class will provide the business logic to add, remove, and update items in the shopping cart.</span></span>

1. <span data-ttu-id="3ec90-140">Avec le bouton droit le *modèles* et sélectionnez **ajouter**  - &gt; **un nouvel élément**.</span><span class="sxs-lookup"><span data-stu-id="3ec90-140">Right-click the *Models* folder and select **Add** -&gt; **New Item**.</span></span> 

    ![Panier d’achat - nouvel élément](shopping-cart/_static/image1.png)
2. <span data-ttu-id="3ec90-142">La boîte de dialogue **Ajouter un nouvel élément** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="3ec90-142">The **Add New Item** dialog box is displayed.</span></span> <span data-ttu-id="3ec90-143">Sélectionnez **Code**, puis sélectionnez **classe**.</span><span class="sxs-lookup"><span data-stu-id="3ec90-143">Select **Code**, and then select **Class**.</span></span> 

    ![Panier - ajouter la boîte de dialogue Nouvel élément](shopping-cart/_static/image2.png)
3. <span data-ttu-id="3ec90-145">Nommez cette nouvelle classe *CartItem.cs*.</span><span class="sxs-lookup"><span data-stu-id="3ec90-145">Name this new class *CartItem.cs*.</span></span>
4. <span data-ttu-id="3ec90-146">Cliquez sur **Ajouter**.</span><span class="sxs-lookup"><span data-stu-id="3ec90-146">Click **Add**.</span></span>  
 <span data-ttu-id="3ec90-147">Le nouveau fichier de classe s’affiche dans l’éditeur.</span><span class="sxs-lookup"><span data-stu-id="3ec90-147">The new class file is displayed in the editor.</span></span>
5. <span data-ttu-id="3ec90-148">Remplacez le code par défaut par le code suivant :</span><span class="sxs-lookup"><span data-stu-id="3ec90-148">Replace the default code with the following code:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample1.cs)]

<span data-ttu-id="3ec90-149">La `CartItem` classe contient le schéma qui définit chaque produit un utilisateur ajoute dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-149">The `CartItem` class contains the schema that will define each product a user adds to the shopping cart.</span></span> <span data-ttu-id="3ec90-150">Cette classe est semblable à d’autres classes de schéma que vous avez créé plus haut dans cette série de didacticiels.</span><span class="sxs-lookup"><span data-stu-id="3ec90-150">This class is similar to the other schema classes you created earlier in this tutorial series.</span></span> <span data-ttu-id="3ec90-151">Par convention, Entity Framework Code First s’attend que la clé primaire de la `CartItem` table sera `CartItemId` ou `ID`.</span><span class="sxs-lookup"><span data-stu-id="3ec90-151">By convention, Entity Framework Code First expects that the primary key for the `CartItem` table will be either `CartItemId` or `ID`.</span></span> <span data-ttu-id="3ec90-152">Toutefois, le code substitue le comportement par défaut à l’aide de l’annotation de données `[Key]` attribut.</span><span class="sxs-lookup"><span data-stu-id="3ec90-152">However, the code overrides the default behavior by using the data annotation `[Key]` attribute.</span></span> <span data-ttu-id="3ec90-153">Le `Key` attribut de la propriété ItemId Spécifie que le `ItemID` propriété est la clé primaire.</span><span class="sxs-lookup"><span data-stu-id="3ec90-153">The `Key` attribute of the ItemId property specifies that the `ItemID` property is the primary key.</span></span>

<span data-ttu-id="3ec90-154">Le `CartId` propriété spécifie le `ID` de l’utilisateur qui est associé à l’article à acheter.</span><span class="sxs-lookup"><span data-stu-id="3ec90-154">The `CartId` property specifies the `ID` of the user that is associated with the item to purchase.</span></span> <span data-ttu-id="3ec90-155">Vous ajouterez du code pour créer l’utilisateur `ID` lorsque l’utilisateur accède au panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-155">You'll add code to create this user `ID` when the user accesses the shopping cart.</span></span> <span data-ttu-id="3ec90-156">Cela `ID` seront également stockés comme une variable de Session ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="3ec90-156">This `ID` will also be stored as an ASP.NET Session variable.</span></span>

### <a name="update-the-product-context"></a><span data-ttu-id="3ec90-157">Mettre à jour le contexte de produit</span><span class="sxs-lookup"><span data-stu-id="3ec90-157">Update the Product Context</span></span>

<span data-ttu-id="3ec90-158">En plus d’ajouter le `CartItem` (classe), vous devez mettre à jour de la classe de contexte de base de données qui gère les classes d’entité et qui fournit l’accès à la base de données.</span><span class="sxs-lookup"><span data-stu-id="3ec90-158">In addition to adding the `CartItem` class, you will need to update the database context class that manages the entity classes and that provides data access to the database.</span></span> <span data-ttu-id="3ec90-159">Pour ce faire, vous allez ajouter nouvellement créé `CartItem` à la classe de modèle la `ProductContext` classe.</span><span class="sxs-lookup"><span data-stu-id="3ec90-159">To do this, you will add the newly created `CartItem` model class to the `ProductContext` class.</span></span>

1. <span data-ttu-id="3ec90-160">Dans **l’Explorateur de solutions**, recherchez et ouvrez le *ProductContext.cs* de fichiers dans le *modèles* dossier.</span><span class="sxs-lookup"><span data-stu-id="3ec90-160">In **Solution Explorer**, find and open the *ProductContext.cs* file in the *Models* folder.</span></span>
2. <span data-ttu-id="3ec90-161">Ajoutez le code en surbrillance à le *ProductContext.cs* de fichiers comme suit :</span><span class="sxs-lookup"><span data-stu-id="3ec90-161">Add the highlighted code to the *ProductContext.cs* file as follows:</span></span>  

    [!code-csharp[Main](shopping-cart/samples/sample2.cs?highlight=14)]

<span data-ttu-id="3ec90-162">Comme mentionné précédemment dans cette série de didacticiels, le code dans le *ProductContext.cs* fichier ajoute le `System.Data.Entity` espace de noms afin que vous ayez accès à toutes les fonctionnalités principales d’Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="3ec90-162">As mentioned previously in this tutorial series, the code in the *ProductContext.cs* file adds the `System.Data.Entity` namespace so that you have access to all the core functionality of the Entity Framework.</span></span> <span data-ttu-id="3ec90-163">Cette fonctionnalité inclut la possibilité d’interroger, insérer, mettre à jour et supprimer des données à l’aide des objets fortement typés.</span><span class="sxs-lookup"><span data-stu-id="3ec90-163">This functionality includes the capability to query, insert, update, and delete data by working with strongly typed objects.</span></span> <span data-ttu-id="3ec90-164">Le `ProductContext` classe ajoute l’accès à récemment ajouté `CartItem` classe de modèle.</span><span class="sxs-lookup"><span data-stu-id="3ec90-164">The `ProductContext` class adds access to the newly added `CartItem` model class.</span></span>

### <a name="managing-the-shopping-cart-business-logic"></a><span data-ttu-id="3ec90-165">La gestion de la logique métier de panier d’achat</span><span class="sxs-lookup"><span data-stu-id="3ec90-165">Managing the Shopping Cart Business Logic</span></span>

<span data-ttu-id="3ec90-166">Ensuite, vous allez créer le `ShoppingCart` classe dans une nouvelle *logique* dossier.</span><span class="sxs-lookup"><span data-stu-id="3ec90-166">Next, you'll create the `ShoppingCart` class in a new *Logic* folder.</span></span> <span data-ttu-id="3ec90-167">Le `ShoppingCart` classe gère l’accès aux données le `CartItem` table.</span><span class="sxs-lookup"><span data-stu-id="3ec90-167">The `ShoppingCart` class handles data access to the `CartItem` table.</span></span> <span data-ttu-id="3ec90-168">La classe inclut également la logique métier pour ajouter, supprimer et mettre à jour des éléments dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-168">The class will also include the business logic to add, remove, and update items in the shopping cart.</span></span>

<span data-ttu-id="3ec90-169">Contient la logique de panier d’achat que vous allez ajouter les fonctionnalités permettant de gérer les actions suivantes :</span><span class="sxs-lookup"><span data-stu-id="3ec90-169">The shopping cart logic that you will add will contain the functionality to manage the following actions:</span></span>

1. <span data-ttu-id="3ec90-170">Ajout d’éléments dans le panier d’achat</span><span class="sxs-lookup"><span data-stu-id="3ec90-170">Adding items to the shopping cart</span></span>
2. <span data-ttu-id="3ec90-171">Suppression d’éléments de panier d’achat</span><span class="sxs-lookup"><span data-stu-id="3ec90-171">Removing items from the shopping cart</span></span>
3. <span data-ttu-id="3ec90-172">Obtention de l’ID du caddie</span><span class="sxs-lookup"><span data-stu-id="3ec90-172">Getting the shopping cart ID</span></span>
4. <span data-ttu-id="3ec90-173">Récupération des éléments depuis le panier d’achat</span><span class="sxs-lookup"><span data-stu-id="3ec90-173">Retrieving items from the shopping cart</span></span>
5. <span data-ttu-id="3ec90-174">Total de la quantité de tous les éléments du panier d’achat</span><span class="sxs-lookup"><span data-stu-id="3ec90-174">Totaling the amount of all the shopping cart items</span></span>
6. <span data-ttu-id="3ec90-175">Mise à jour les données de panier d’achat</span><span class="sxs-lookup"><span data-stu-id="3ec90-175">Updating the shopping cart data</span></span>

<span data-ttu-id="3ec90-176">Une page de panier d’achat (*ShoppingCart.aspx*) et la classe de panier d’achat est utilisée ensemble pour accéder aux données de panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-176">A shopping cart page (*ShoppingCart.aspx*) and the shopping cart class will be used together to access shopping cart data.</span></span> <span data-ttu-id="3ec90-177">La page de panier d’achat affiche tous les éléments de que l’utilisateur ajoute au panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-177">The shopping cart page will display all the items the user adds to the shopping cart.</span></span> <span data-ttu-id="3ec90-178">Outre l’analyse de panier page et la classe, vous allez créer une page (*AddToCart.aspx*) pour ajouter des produits dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-178">Besides the shopping cart page and class, you'll create a page (*AddToCart.aspx*) to add products to the shopping cart.</span></span> <span data-ttu-id="3ec90-179">Vous allez également ajouter le code pour le *ProductList.aspx* page et le *ProductDetails.aspx* page qui fournit un lien vers le *AddToCart.aspx* page, afin que l’utilisateur peut ajouter produits dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-179">You will also add code to the *ProductList.aspx* page and the *ProductDetails.aspx* page that will provide a link to the *AddToCart.aspx* page, so that the user can add products to the shopping cart.</span></span>

<span data-ttu-id="3ec90-180">Le diagramme suivant illustre le processus de base qui se produit lorsque l’utilisateur ajoute un produit dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-180">The following diagram shows the basic process that occurs when the user adds a product to the shopping cart.</span></span>

![Panier - ajouter au panier d’achat](shopping-cart/_static/image3.png)

<span data-ttu-id="3ec90-182">Lorsque l’utilisateur clique sur le **Add To Cart** lien soit le *ProductList.aspx* page ou le *ProductDetails.aspx* page, l’application permet d’accéder à la *AddToCart.aspx* page, puis automatiquement à la *ShoppingCart.aspx* page.</span><span class="sxs-lookup"><span data-stu-id="3ec90-182">When the user clicks the **Add To Cart** link on either the *ProductList.aspx* page or the *ProductDetails.aspx* page, the application will navigate to the *AddToCart.aspx* page and then automatically to the *ShoppingCart.aspx* page.</span></span> <span data-ttu-id="3ec90-183">Le *AddToCart.aspx* page ajoutera le produit dans le panier d’achat en appelant une méthode dans la classe ShoppingCart.</span><span class="sxs-lookup"><span data-stu-id="3ec90-183">The *AddToCart.aspx* page will add the select product to the shopping cart by calling a method in the ShoppingCart class.</span></span> <span data-ttu-id="3ec90-184">Le *ShoppingCart.aspx* page affiche les produits qui ont été ajoutés dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-184">The *ShoppingCart.aspx* page will display the products that have been added to the shopping cart.</span></span>

#### <a name="creating-the-shopping-cart-class"></a><span data-ttu-id="3ec90-185">Création de la classe de panier d’achat</span><span class="sxs-lookup"><span data-stu-id="3ec90-185">Creating the Shopping Cart Class</span></span>

<span data-ttu-id="3ec90-186">La `ShoppingCart` classe est ajoutée à un dossier distinct dans l’application afin qu’il y aura une distinction claire entre le modèle (dossier de modèles), les pages (dossier racine) et la logique (dossier logique).</span><span class="sxs-lookup"><span data-stu-id="3ec90-186">The `ShoppingCart` class will be added to a separate folder in the application so that there will be a clear distinction between the model (Models folder), the pages (root folder) and the logic (Logic folder).</span></span>

1. <span data-ttu-id="3ec90-187">Dans **l’Explorateur de solutions**, avec le bouton droit le **WingtipToys**de projet et sélectionnez **ajouter**-&gt;**nouveau dossier**.</span><span class="sxs-lookup"><span data-stu-id="3ec90-187">In **Solution Explorer**, right-click the **WingtipToys**project and select **Add**-&gt;**New Folder**.</span></span> <span data-ttu-id="3ec90-188">Nommez le nouveau dossier *logique*.</span><span class="sxs-lookup"><span data-stu-id="3ec90-188">Name the new folder *Logic*.</span></span>
2. <span data-ttu-id="3ec90-189">Avec le bouton droit le *logique* dossier, puis sélectionnez **ajouter**  - &gt; **un nouvel élément**.</span><span class="sxs-lookup"><span data-stu-id="3ec90-189">Right-click the *Logic* folder and then select **Add** -&gt; **New Item**.</span></span>
3. <span data-ttu-id="3ec90-190">Ajouter un nouveau fichier de classe nommé *ShoppingCartActions.cs*.</span><span class="sxs-lookup"><span data-stu-id="3ec90-190">Add a new class file named *ShoppingCartActions.cs*.</span></span>
4. <span data-ttu-id="3ec90-191">Remplacez le code par défaut par le code suivant :</span><span class="sxs-lookup"><span data-stu-id="3ec90-191">Replace the default code with the following code:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample3.cs)]

<span data-ttu-id="3ec90-192">Le `AddToCart` méthode permet à des produits individuels à inclure dans le panier d’achat en fonction du produit `ID`.</span><span class="sxs-lookup"><span data-stu-id="3ec90-192">The `AddToCart` method enables individual products to be included in the shopping cart based on the product `ID`.</span></span> <span data-ttu-id="3ec90-193">Le produit est ajouté au panier d’achat, ou si le panier contient déjà un élément de ce produit, la quantité est incrémentée.</span><span class="sxs-lookup"><span data-stu-id="3ec90-193">The product is added to the cart, or if the cart already contains an item for that product, the quantity is incremented.</span></span>

<span data-ttu-id="3ec90-194">Le `GetCartId` méthode retourne le panier `ID` pour l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3ec90-194">The `GetCartId` method returns the cart `ID` for the user.</span></span> <span data-ttu-id="3ec90-195">Le panier `ID` est utilisé pour suivre les éléments dont dispose un utilisateur dans leur panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-195">The cart `ID` is used to track the items that a user has in their shopping cart.</span></span> <span data-ttu-id="3ec90-196">Si l’utilisateur ne dispose pas d’un panier existant `ID`, un panier d’achat nouvelle `ID` est créée pour eux.</span><span class="sxs-lookup"><span data-stu-id="3ec90-196">If the user does not have an existing cart `ID`, a new cart `ID` is created for them.</span></span> <span data-ttu-id="3ec90-197">Si l’utilisateur est connecté en tant qu’un utilisateur enregistré, le panier `ID` est défini sur son nom d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3ec90-197">If the user is signed in as a registered user, the cart `ID` is set to their user name.</span></span> <span data-ttu-id="3ec90-198">Toutefois, si l’utilisateur n’est pas signé dans le panier `ID` est définie sur une valeur unique (GUID).</span><span class="sxs-lookup"><span data-stu-id="3ec90-198">However, if the user is not signed in, the cart `ID` is set to a unique value (a GUID).</span></span> <span data-ttu-id="3ec90-199">Un GUID garantit que seul panier d’achat est créé pour chaque utilisateur, en fonction de la session.</span><span class="sxs-lookup"><span data-stu-id="3ec90-199">A GUID ensures that only one cart is created for each user, based on session.</span></span>

<span data-ttu-id="3ec90-200">Le `GetCartItems` méthode retourne une liste des articles du panier pour l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3ec90-200">The `GetCartItems` method returns a list of shopping cart items for the user.</span></span> <span data-ttu-id="3ec90-201">Plus loin dans ce didacticiel, vous verrez que la liaison de modèle est utilisée pour afficher les éléments de panier dans le panier d’achat à l’aide du `GetCartItems` (méthode).</span><span class="sxs-lookup"><span data-stu-id="3ec90-201">Later in this tutorial, you will see that model binding is used to display the cart items in the shopping cart using the `GetCartItems` method.</span></span>

### <a name="creating-the-add-to-cart-functionality"></a><span data-ttu-id="3ec90-202">Création de la fonctionnalité Ajouter au panier</span><span class="sxs-lookup"><span data-stu-id="3ec90-202">Creating the Add-To-Cart Functionality</span></span>

<span data-ttu-id="3ec90-203">Comme mentionné précédemment, vous allez créer une page de traitement nommée *AddToCart.aspx* qui servira à ajouter de nouveaux produits dans le panier d’achat de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3ec90-203">As mentioned earlier, you will create a processing page named *AddToCart.aspx* that will be used to add new products to the shopping cart of the user.</span></span> <span data-ttu-id="3ec90-204">Cette page appellera la `AddToCart` méthode dans la `ShoppingCart` classe que vous venez de créer.</span><span class="sxs-lookup"><span data-stu-id="3ec90-204">This page will call the `AddToCart` method in the `ShoppingCart` class that you just created.</span></span> <span data-ttu-id="3ec90-205">Le *AddToCart.aspx* page qui attend un produit `ID` lui est transmise.</span><span class="sxs-lookup"><span data-stu-id="3ec90-205">The *AddToCart.aspx* page will expect that a product `ID` is passed to it.</span></span> <span data-ttu-id="3ec90-206">Ce produit `ID` sera utilisé lors de l’appel du `AddToCart` méthode dans la `ShoppingCart` classe.</span><span class="sxs-lookup"><span data-stu-id="3ec90-206">This product `ID` will be used when calling the `AddToCart` method in the `ShoppingCart` class.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="3ec90-207">Vous allez modifier le code-behind (*AddToCart.aspx.cs*) de cette page, et non la page de l’interface utilisateur (*AddToCart.aspx*).</span><span class="sxs-lookup"><span data-stu-id="3ec90-207">You will be modifying the code-behind (*AddToCart.aspx.cs*) for this page, not the page UI (*AddToCart.aspx*).</span></span>


#### <a name="to-create-the-add-to-cart-functionality"></a><span data-ttu-id="3ec90-208">Pour créer l’ajouter au panier fonctionnalités :</span><span class="sxs-lookup"><span data-stu-id="3ec90-208">To create the Add-To-Cart functionality:</span></span>

1. <span data-ttu-id="3ec90-209">Dans **l’Explorateur de solutions**, avec le bouton droit le **WingtipToys**de projet, cliquez sur **ajouter**  - &gt; **un nouvel élément**.</span><span class="sxs-lookup"><span data-stu-id="3ec90-209">In **Solution Explorer**, right-click the **WingtipToys**project, click **Add** -&gt; **New Item**.</span></span>  
 <span data-ttu-id="3ec90-210">La boîte de dialogue **Ajouter un nouvel élément** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="3ec90-210">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="3ec90-211">Ajouter une nouvelle page standard (formulaire Web) pour l’application nommée *AddToCart.aspx*.</span><span class="sxs-lookup"><span data-stu-id="3ec90-211">Add a standard new page (Web Form) to the application named *AddToCart.aspx*.</span></span> 

    ![Panier - ajouter le formulaire Web](shopping-cart/_static/image4.png)
3. <span data-ttu-id="3ec90-213">Dans **l’Explorateur de solutions**, cliquez sur le *AddToCart.aspx* page, puis cliquez sur **afficher le Code**.</span><span class="sxs-lookup"><span data-stu-id="3ec90-213">In **Solution Explorer**, right-click the *AddToCart.aspx* page and then click **View Code**.</span></span> <span data-ttu-id="3ec90-214">Le *AddToCart.aspx.cs* fichier code-behind est ouvert dans l’éditeur.</span><span class="sxs-lookup"><span data-stu-id="3ec90-214">The *AddToCart.aspx.cs* code-behind file is opened in the editor.</span></span>
4. <span data-ttu-id="3ec90-215">Remplacez le code existant dans le *AddToCart.aspx.cs* code-behind par le code suivant :</span><span class="sxs-lookup"><span data-stu-id="3ec90-215">Replace the existing code in the *AddToCart.aspx.cs* code-behind with the following:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample4.cs)]

<span data-ttu-id="3ec90-216">Lorsque le *AddToCart.aspx* page est chargée, le produit `ID` sont récupérées à partir de la chaîne de requête.</span><span class="sxs-lookup"><span data-stu-id="3ec90-216">When the *AddToCart.aspx* page is loaded, the product `ID` is retrieved from the query string.</span></span> <span data-ttu-id="3ec90-217">Ensuite, une instance de la classe de panier d’achat est créée et utilisée pour appeler le `AddToCart` méthode que vous avez ajouté précédemment dans ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="3ec90-217">Next, an instance of the shopping cart class is created and used to call the `AddToCart` method that you added earlier in this tutorial.</span></span> <span data-ttu-id="3ec90-218">Le `AddToCart` méthode, contenu dans le *ShoppingCartActions.cs* de fichiers, inclut la logique pour ajouter le produit sélectionné dans le panier d’achat ou augmenter la quantité de produit du produit sélectionné.</span><span class="sxs-lookup"><span data-stu-id="3ec90-218">The `AddToCart` method, contained in the *ShoppingCartActions.cs* file, includes the logic to add the selected product to the shopping cart or increment the product quantity of the selected product.</span></span> <span data-ttu-id="3ec90-219">Si le produit n’a pas été ajouté au panier d’achat, le produit est ajouté à la `CartItem` table de la base de données.</span><span class="sxs-lookup"><span data-stu-id="3ec90-219">If the product hasn't been added to the shopping cart, the product is added to the `CartItem` table of the database.</span></span> <span data-ttu-id="3ec90-220">Si le produit a déjà été ajouté dans le panier d’achat et l’utilisateur ajoute un élément supplémentaire du même produit, la quantité du produit est incrémentée de la `CartItem` table.</span><span class="sxs-lookup"><span data-stu-id="3ec90-220">If the product has already been added to the shopping cart and the user adds an additional item of the same product, the product quantity is incremented in the `CartItem` table.</span></span> <span data-ttu-id="3ec90-221">Enfin, la page redirige vers le *ShoppingCart.aspx* page que vous ajouterez dans l’étape suivante, où l’utilisateur voit une liste actualisée des éléments dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-221">Finally, the page redirects back to the *ShoppingCart.aspx* page that you'll add in the next step, where the user sees an updated list of items in the cart.</span></span>

<span data-ttu-id="3ec90-222">Comme mentionné précédemment, un utilisateur `ID` est utilisé pour identifier les produits qui sont associés à un utilisateur spécifique.</span><span class="sxs-lookup"><span data-stu-id="3ec90-222">As previously mentioned, a user `ID` is used to identify the products that are associated with a specific user.</span></span> <span data-ttu-id="3ec90-223">Cela `ID` est ajouté à une ligne dans le `CartItem` chaque fois que l’utilisateur ajoute un produit dans le panier d’achat de la table.</span><span class="sxs-lookup"><span data-stu-id="3ec90-223">This `ID` is added to a row in the `CartItem` table each time the user adds a product to the shopping cart.</span></span>

### <a name="creating-the-shopping-cart-ui"></a><span data-ttu-id="3ec90-224">Création de l’interface utilisateur de panier d’achat</span><span class="sxs-lookup"><span data-stu-id="3ec90-224">Creating the Shopping Cart UI</span></span>

<span data-ttu-id="3ec90-225">Le *ShoppingCart.aspx* page affiche les produits dont l’utilisateur a ajouté à leur panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-225">The *ShoppingCart.aspx* page will display the products that the user has added to their shopping cart.</span></span> <span data-ttu-id="3ec90-226">Elle fournit également la possibilité d’ajouter, supprimer et mettre à jour des éléments dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-226">It will also provide the ability to add, remove and update items in the shopping cart.</span></span>

1. <span data-ttu-id="3ec90-227">Dans **l’Explorateur de solutions**, avec le bouton droit **WingtipToys**, cliquez sur **ajouter**  - &gt; **un nouvel élément**.</span><span class="sxs-lookup"><span data-stu-id="3ec90-227">In **Solution Explorer**, right-click **WingtipToys**, click **Add** -&gt; **New Item**.</span></span>  
 <span data-ttu-id="3ec90-228">La boîte de dialogue **Ajouter un nouvel élément** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="3ec90-228">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="3ec90-229">Ajouter une nouvelle page (formulaire Web) qui inclut une page maître en sélectionnant **Web Form avec Page maître**.</span><span class="sxs-lookup"><span data-stu-id="3ec90-229">Add a new page (Web Form) that includes a master page by selecting **Web Form using Master Page**.</span></span> <span data-ttu-id="3ec90-230">Nommez la nouvelle page *ShoppingCart.aspx*.</span><span class="sxs-lookup"><span data-stu-id="3ec90-230">Name the new page *ShoppingCart.aspx*.</span></span>
3. <span data-ttu-id="3ec90-231">Sélectionnez **Site.Master** pour attacher la page maître à la nouvelle *.aspx* page.</span><span class="sxs-lookup"><span data-stu-id="3ec90-231">Select **Site.Master** to attach the master page to the newly created *.aspx* page.</span></span>
4. <span data-ttu-id="3ec90-232">Dans le *ShoppingCart.aspx* page, remplacez la balise existante par le balisage suivant :</span><span class="sxs-lookup"><span data-stu-id="3ec90-232">In the *ShoppingCart.aspx* page, replace the existing markup with the following markup:</span></span>   

    [!code-aspx[Main](shopping-cart/samples/sample5.aspx)]

<span data-ttu-id="3ec90-233">Le *ShoppingCart.aspx* page inclut un **GridView** contrôle nommé `CartList`.</span><span class="sxs-lookup"><span data-stu-id="3ec90-233">The *ShoppingCart.aspx* page includes a **GridView** control named `CartList`.</span></span> <span data-ttu-id="3ec90-234">Ce contrôle utilise la liaison de modèle pour lier les données de panier d’achat à partir de la base de données pour le **GridView** contrôle.</span><span class="sxs-lookup"><span data-stu-id="3ec90-234">This control uses model binding to bind the shopping cart data from the database to the **GridView** control.</span></span> <span data-ttu-id="3ec90-235">Lorsque vous définissez la `ItemType` propriété de la **GridView** contrôler, l’expression de liaison de données `Item` est disponible dans le balisage du contrôle et le contrôle devienne fortement typé.</span><span class="sxs-lookup"><span data-stu-id="3ec90-235">When you set the `ItemType` property of the **GridView** control, the data-binding expression `Item` is available in the markup of the control and the control becomes strongly typed.</span></span> <span data-ttu-id="3ec90-236">Comme mentionné plus haut dans cette série de didacticiels, vous pouvez sélectionner les détails de la `Item` de l’objet à l’aide d’IntelliSense.</span><span class="sxs-lookup"><span data-stu-id="3ec90-236">As mentioned earlier in this tutorial series, you can select details of the `Item` object using IntelliSense.</span></span> <span data-ttu-id="3ec90-237">Pour configurer un contrôle de données pour utiliser la liaison de modèle pour sélectionner les données, vous définissez le `SelectMethod` propriété du contrôle.</span><span class="sxs-lookup"><span data-stu-id="3ec90-237">To configure a data control to use model binding to select data, you set the `SelectMethod` property of the control.</span></span> <span data-ttu-id="3ec90-238">Dans le balisage ci-dessus, vous définissez la `SelectMethod` d’utiliser la méthode GetShoppingCartItems qui renvoie une liste de `CartItem` objets.</span><span class="sxs-lookup"><span data-stu-id="3ec90-238">In the markup above, you set the `SelectMethod` to use the GetShoppingCartItems method which returns a list of `CartItem` objects.</span></span> <span data-ttu-id="3ec90-239">Le **GridView** contrôle de données appelle la méthode au moment approprié dans le cycle de vie de page et lie automatiquement les données retournées.</span><span class="sxs-lookup"><span data-stu-id="3ec90-239">The **GridView** data control calls the method at the appropriate time in the page life cycle and automatically binds the returned data.</span></span> <span data-ttu-id="3ec90-240">Le `GetShoppingCartItems` méthode doit encore être ajoutée.</span><span class="sxs-lookup"><span data-stu-id="3ec90-240">The `GetShoppingCartItems` method must still be added.</span></span>

#### <a name="retrieving-the-shopping-cart-items"></a><span data-ttu-id="3ec90-241">Récupérer les éléments de panier d’achat</span><span class="sxs-lookup"><span data-stu-id="3ec90-241">Retrieving the Shopping Cart Items</span></span>

<span data-ttu-id="3ec90-242">Ensuite, vous ajoutez le code à la *ShoppingCart.aspx.cs* code-behind pour extraire et remplir l’interface utilisateur de panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-242">Next, you add code to the *ShoppingCart.aspx.cs* code-behind to retrieve and populate the Shopping Cart UI.</span></span>

1. <span data-ttu-id="3ec90-243">Dans **l’Explorateur de solutions**, cliquez sur le *ShoppingCart.aspx* page, puis cliquez sur **afficher le Code**.</span><span class="sxs-lookup"><span data-stu-id="3ec90-243">In **Solution Explorer**, right-click the *ShoppingCart.aspx* page and then click **View Code**.</span></span> <span data-ttu-id="3ec90-244">Le *ShoppingCart.aspx.cs* fichier code-behind est ouvert dans l’éditeur.</span><span class="sxs-lookup"><span data-stu-id="3ec90-244">The *ShoppingCart.aspx.cs* code-behind file is opened in the editor.</span></span>
2. <span data-ttu-id="3ec90-245">Remplacez le code existant par le code ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="3ec90-245">Replace the existing code with the following:</span></span>  

    [!code-csharp[Main](shopping-cart/samples/sample6.cs)]

<span data-ttu-id="3ec90-246">Comme indiqué ci-dessus, le `GridView` de contrôle de données appelle la `GetShoppingCartItems` méthode au moment approprié dans la vie de la page cycle et lie automatiquement les données retournées.</span><span class="sxs-lookup"><span data-stu-id="3ec90-246">As mentioned above, the `GridView` data control calls the `GetShoppingCartItems` method at the appropriate time in the page life cycle and automatically binds the returned data.</span></span> <span data-ttu-id="3ec90-247">Le `GetShoppingCartItems` méthode crée une instance de la `ShoppingCartActions` objet.</span><span class="sxs-lookup"><span data-stu-id="3ec90-247">The `GetShoppingCartItems` method creates an instance of the `ShoppingCartActions` object.</span></span> <span data-ttu-id="3ec90-248">Ensuite, le code utilise cette instance pour retourner les éléments dans le panier d’achat en appelant le `GetCartItems` (méthode).</span><span class="sxs-lookup"><span data-stu-id="3ec90-248">Then, the code uses that instance to return the items in the cart by calling the `GetCartItems` method.</span></span>

### <a name="adding-products-to-the-shopping-cart"></a><span data-ttu-id="3ec90-249">Ajout de produits dans le panier d’achat</span><span class="sxs-lookup"><span data-stu-id="3ec90-249">Adding Products to the Shopping Cart</span></span>

<span data-ttu-id="3ec90-250">Lorsque soit la *ProductList.aspx* ou *ProductDetails.aspx* page s’affiche, l’utilisateur sera en mesure d’ajouter le produit dans le panier d’achat à l’aide d’un lien.</span><span class="sxs-lookup"><span data-stu-id="3ec90-250">When either the *ProductList.aspx* or the *ProductDetails.aspx* page is displayed, the user will be able to add the product to the shopping cart using a link.</span></span> <span data-ttu-id="3ec90-251">Lorsqu’ils cliquent sur le lien, l’application accède à la page de traitement nommée *AddToCart.aspx*.</span><span class="sxs-lookup"><span data-stu-id="3ec90-251">When they click the link, the application navigates to the processing page named *AddToCart.aspx*.</span></span> <span data-ttu-id="3ec90-252">Le *AddToCart.aspx* page appellera la `AddToCart` méthode dans la `ShoppingCart` classe que vous avez ajouté précédemment dans ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="3ec90-252">The *AddToCart.aspx* page will call the `AddToCart` method in the `ShoppingCart` class that you added earlier in this tutorial.</span></span>

<span data-ttu-id="3ec90-253">À présent, vous allez ajouter un **ajouter au panier** lien à la fois à la *ProductList.aspx* page et le *ProductDetails.aspx* page.</span><span class="sxs-lookup"><span data-stu-id="3ec90-253">Now, you'll add an **Add to Cart** link to both the *ProductList.aspx* page and the *ProductDetails.aspx* page.</span></span> <span data-ttu-id="3ec90-254">Ce lien inclut le produit `ID` qui est récupéré à partir de la base de données.</span><span class="sxs-lookup"><span data-stu-id="3ec90-254">This link will include the product `ID` that is retrieved from the database.</span></span>

1. <span data-ttu-id="3ec90-255">Dans **l’Explorateur de solutions**, recherchez et ouvrez la page nommée *ProductList.aspx*.</span><span class="sxs-lookup"><span data-stu-id="3ec90-255">In **Solution Explorer**, find and open the page named *ProductList.aspx*.</span></span>
2. <span data-ttu-id="3ec90-256">Ajoutez le balisage mis en surbrillance en jaune pour le *ProductList.aspx* page afin que l’ensemble de la page s’affiche comme suit :</span><span class="sxs-lookup"><span data-stu-id="3ec90-256">Add the markup highlighted in yellow to the *ProductList.aspx* page so that the entire page appears as follows:</span></span>  

    [!code-aspx[Main](shopping-cart/samples/sample7.aspx?highlight=50-54)]

### <a name="testing-the-shopping-cart"></a><span data-ttu-id="3ec90-257">Test du panier d’achat</span><span class="sxs-lookup"><span data-stu-id="3ec90-257">Testing the Shopping Cart</span></span>

<span data-ttu-id="3ec90-258">Exécutez l’application pour voir comment ajouter des produits dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-258">Run the application to see how you add products to the shopping cart.</span></span>

1. <span data-ttu-id="3ec90-259">Appuyez sur **F5** pour exécuter l’application.</span><span class="sxs-lookup"><span data-stu-id="3ec90-259">Press **F5** to run the application.</span></span>  
 <span data-ttu-id="3ec90-260">Une fois le projet recrée la base de données, le navigateur s’ouvre et affiche le *Default.aspx* page.</span><span class="sxs-lookup"><span data-stu-id="3ec90-260">After the project recreates the database, the browser will open and show the *Default.aspx* page.</span></span>
2. <span data-ttu-id="3ec90-261">Sélectionnez **voitures** à partir du menu de navigation de catégorie.</span><span class="sxs-lookup"><span data-stu-id="3ec90-261">Select **Cars** from the category navigation menu.</span></span>  
 <span data-ttu-id="3ec90-262">Le *ProductList.aspx* page affiche uniquement les produits inclus dans la catégorie « Voitures ».</span><span class="sxs-lookup"><span data-stu-id="3ec90-262">The *ProductList.aspx* page is displayed showing only products included in the "Cars" category.</span></span> 

    ![Panier d’achat - voitures](shopping-cart/_static/image5.png)
3. <span data-ttu-id="3ec90-264">Cliquez sur le **ajouter au panier** lien en regard de la première produit répertorié (la voiture convertible).</span><span class="sxs-lookup"><span data-stu-id="3ec90-264">Click the **Add to Cart** link next to the first product listed (the convertible car).</span></span>   
 <span data-ttu-id="3ec90-265">Le *ShoppingCart.aspx* page s’affiche, indiquant la sélection dans votre panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-265">The *ShoppingCart.aspx* page is displayed, showing the selection in your shopping cart.</span></span> 

    ![Panier d’achat - panier](shopping-cart/_static/image6.png)
4. <span data-ttu-id="3ec90-267">Afficher des produits supplémentaires en sélectionnant **plans** à partir du menu de navigation de catégorie.</span><span class="sxs-lookup"><span data-stu-id="3ec90-267">View additional products by selecting **Planes** from the category navigation menu.</span></span>
5. <span data-ttu-id="3ec90-268">Cliquez sur le **ajouter au panier** lien en regard de la première produit répertorié.</span><span class="sxs-lookup"><span data-stu-id="3ec90-268">Click the **Add to Cart** link next to the first product listed.</span></span>  
 <span data-ttu-id="3ec90-269">Le *ShoppingCart.aspx* page s’affiche avec l’élément supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="3ec90-269">The *ShoppingCart.aspx* page is displayed with the additional item.</span></span>
6. <span data-ttu-id="3ec90-270">Fermez le navigateur.</span><span class="sxs-lookup"><span data-stu-id="3ec90-270">Close the browser.</span></span>

### <a name="calculating-and-displaying-the-order-total"></a><span data-ttu-id="3ec90-271">Calcul et affichage du Total de la commande</span><span class="sxs-lookup"><span data-stu-id="3ec90-271">Calculating and Displaying the Order Total</span></span>

<span data-ttu-id="3ec90-272">En plus de l’ajout de produits dans le panier d’achat, vous allez ajouter un `GetTotal` méthode à la `ShoppingCart` classe et afficher le montant total des commandes dans la page du panier.</span><span class="sxs-lookup"><span data-stu-id="3ec90-272">In addition to adding products to the shopping cart, you will add a `GetTotal` method to the `ShoppingCart` class and display the total order amount in the shopping cart page.</span></span>

1. <span data-ttu-id="3ec90-273">Dans **l’Explorateur de solutions**, ouvrez le *ShoppingCartActions.cs* de fichiers dans le *logique* dossier.</span><span class="sxs-lookup"><span data-stu-id="3ec90-273">In **Solution Explorer**, open the *ShoppingCartActions.cs* file in the *Logic* folder.</span></span>
2. <span data-ttu-id="3ec90-274">Ajoutez le code suivant `GetTotal` méthode mis en surbrillance en jaune à la `ShoppingCart` classe, afin que la classe s’affiche comme suit :</span><span class="sxs-lookup"><span data-stu-id="3ec90-274">Add the following `GetTotal` method highlighted in yellow to the `ShoppingCart` class, so that the class appears as follows:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample8.cs?highlight=85-97)]

<span data-ttu-id="3ec90-275">Tout d’abord, la `GetTotal` méthode obtient l’ID de panier d’achat pour l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3ec90-275">First, the `GetTotal` method gets the ID of the shopping cart for the user.</span></span> <span data-ttu-id="3ec90-276">La méthode obtient ensuite le panier d’achat total en multipliant le prix du produit par la quantité du produit pour chaque produit répertorié dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-276">Then the method gets the cart total by multiplying the product price by the product quantity for each product listed in the cart.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="3ec90-277">Le code ci-dessus utilise le type nullable «`int?`».</span><span class="sxs-lookup"><span data-stu-id="3ec90-277">The above code uses the nullable type "`int?`".</span></span> <span data-ttu-id="3ec90-278">Types Nullable peuvent représenter toutes les valeurs d’un type sous-jacent et également comme une valeur null.</span><span class="sxs-lookup"><span data-stu-id="3ec90-278">Nullable types can represent all the values of an underlying type, and also as a null value.</span></span> <span data-ttu-id="3ec90-279">Pour plus d’informations, consultez [à l’aide des Types Nullable](https://msdn.microsoft.com/library/2cf62fcy(v=vs.110).aspx).</span><span class="sxs-lookup"><span data-stu-id="3ec90-279">For more information see, [Using Nullable Types](https://msdn.microsoft.com/library/2cf62fcy(v=vs.110).aspx).</span></span>


### <a name="modify-the-shopping-cart-display"></a><span data-ttu-id="3ec90-280">Modification de l’affichage du panier d’achat</span><span class="sxs-lookup"><span data-stu-id="3ec90-280">Modify the Shopping Cart Display</span></span>

<span data-ttu-id="3ec90-281">Ensuite, vous allez modifier le code pour le *ShoppingCart.aspx* page pour appeler le `GetTotal` (méthode) et l’affichage total sur le *ShoppingCart.aspx* page lorsque la page se charge.</span><span class="sxs-lookup"><span data-stu-id="3ec90-281">Next you'll modify the code for the *ShoppingCart.aspx* page to call the `GetTotal` method and display that total on the *ShoppingCart.aspx* page when the page loads.</span></span>

1. <span data-ttu-id="3ec90-282">Dans **l’Explorateur de solutions**, avec le bouton droit le *ShoppingCart.aspx* page et sélectionnez **afficher le Code**.</span><span class="sxs-lookup"><span data-stu-id="3ec90-282">In **Solution Explorer**, right-click the *ShoppingCart.aspx* page and select **View Code**.</span></span>
2. <span data-ttu-id="3ec90-283">Dans le *ShoppingCart.aspx.cs* de fichiers, mettez à jour le `Page_Load` gestionnaire en ajoutant le code suivant est mis en surbrillance en jaune :</span><span class="sxs-lookup"><span data-stu-id="3ec90-283">In the *ShoppingCart.aspx.cs* file, update the `Page_Load` handler by adding the following code highlighted in yellow:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample9.cs?highlight=16-31)]

<span data-ttu-id="3ec90-284">Lorsque le *ShoppingCart.aspx* chargement de la page, il charge l’objet panier d’achat et récupère ensuite le total de panier d’achat en appelant le `GetTotal` méthode de la `ShoppingCart` classe.</span><span class="sxs-lookup"><span data-stu-id="3ec90-284">When the *ShoppingCart.aspx* page loads, it loads the shopping cart object and then retrieves the shopping cart total by calling the `GetTotal` method of the `ShoppingCart` class.</span></span> <span data-ttu-id="3ec90-285">Si le panier d’achat est vide, un message s’affiche à cet effet.</span><span class="sxs-lookup"><span data-stu-id="3ec90-285">If the shopping cart is empty, a message to that effect is displayed.</span></span>

### <a name="testing-the-shopping-cart-total"></a><span data-ttu-id="3ec90-286">Le Total de panier d’achat de test</span><span class="sxs-lookup"><span data-stu-id="3ec90-286">Testing the Shopping Cart Total</span></span>

<span data-ttu-id="3ec90-287">Exécutez l’application maintenant pour voir comment pas uniquement ajouter un produit dans le panier d’achat, mais vous pouvez consulter le total de panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-287">Run the application now to see how you can not only add a product to the shopping cart, but you can see the shopping cart total.</span></span>

1. <span data-ttu-id="3ec90-288">Appuyez sur **F5** pour exécuter l’application.</span><span class="sxs-lookup"><span data-stu-id="3ec90-288">Press **F5** to run the application.</span></span>  
 <span data-ttu-id="3ec90-289">Le navigateur s’ouvre et affiche le *Default.aspx* page.</span><span class="sxs-lookup"><span data-stu-id="3ec90-289">The browser will open and show the *Default.aspx* page.</span></span>
2. <span data-ttu-id="3ec90-290">Sélectionnez **voitures** à partir du menu de navigation de catégorie.</span><span class="sxs-lookup"><span data-stu-id="3ec90-290">Select **Cars** from the category navigation menu.</span></span>
3. <span data-ttu-id="3ec90-291">Cliquez sur le **Add To Cart** lien en regard du produit en premier.</span><span class="sxs-lookup"><span data-stu-id="3ec90-291">Click the **Add To Cart** link next to the first product.</span></span>   
 <span data-ttu-id="3ec90-292">Le *ShoppingCart.aspx* page s’affiche avec le total de la commande.</span><span class="sxs-lookup"><span data-stu-id="3ec90-292">The *ShoppingCart.aspx* page is displayed with the order total.</span></span> 

    ![Panier d’achat - Total de panier](shopping-cart/_static/image7.png)
4. <span data-ttu-id="3ec90-294">Ajouter d’autres produits (par exemple, un plan) dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-294">Add some other products (for example, a plane) to the cart.</span></span>
5. <span data-ttu-id="3ec90-295">Le *ShoppingCart.aspx* page s’affiche avec un total de mises à jour pour tous les produits que vous avez ajouté.</span><span class="sxs-lookup"><span data-stu-id="3ec90-295">The *ShoppingCart.aspx* page is displayed with an updated total for all the products you've added.</span></span> 

    ![Panier d’achat - plusieurs produits](shopping-cart/_static/image8.png)
6. <span data-ttu-id="3ec90-297">Arrêter l’application en cours d’exécution en fermant la fenêtre du navigateur.</span><span class="sxs-lookup"><span data-stu-id="3ec90-297">Stop the running app by closing the browser window.</span></span>

### <a name="adding-update-and-checkout-buttons-to-the-shopping-cart"></a><span data-ttu-id="3ec90-298">Ajout de mise à jour et les boutons d’extraction dans le panier d’achat</span><span class="sxs-lookup"><span data-stu-id="3ec90-298">Adding Update and Checkout Buttons to the Shopping Cart</span></span>

<span data-ttu-id="3ec90-299">Pour permettre aux utilisateurs de modifier le panier d’achat, vous allez ajouter un **mise à jour** bouton et un **extraction** bouton à la page de panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-299">To allow the users to modify the shopping cart, you'll add an **Update** button and a **Checkout** button to the shopping cart page.</span></span> <span data-ttu-id="3ec90-300">Le **extraction** bouton n’est pas utilisé jusqu'à ce que plus loin dans cette série de didacticiels.</span><span class="sxs-lookup"><span data-stu-id="3ec90-300">The **Checkout** button is not used until later in this tutorial series.</span></span>

1. <span data-ttu-id="3ec90-301">Dans **l’Explorateur de solutions**, ouvrez le *ShoppingCart.aspx* page à la racine du projet d’application web.</span><span class="sxs-lookup"><span data-stu-id="3ec90-301">In **Solution Explorer**, open the *ShoppingCart.aspx* page in the root of the web application project.</span></span>
2. <span data-ttu-id="3ec90-302">Pour ajouter le **mise à jour** bouton et le **extraction** bouton à la *ShoppingCart.aspx* , ajoutez le balisage mis en surbrillance en jaune au balisage, comme indiqué dans les code suivant :</span><span class="sxs-lookup"><span data-stu-id="3ec90-302">To add the **Update** button and the **Checkout** button to the *ShoppingCart.aspx* page, add the markup highlighted in yellow to the existing markup, as shown in the following code:</span></span>   

    [!code-aspx[Main](shopping-cart/samples/sample10.aspx?highlight=36-45)]

<span data-ttu-id="3ec90-303">Lorsque l’utilisateur clique sur le **mise à jour** bouton, le `UpdateBtn_Click` Gestionnaire d’événements est appelé.</span><span class="sxs-lookup"><span data-stu-id="3ec90-303">When the user clicks the **Update** button, the `UpdateBtn_Click` event handler will be called.</span></span> <span data-ttu-id="3ec90-304">Ce gestionnaire d’événements appelle le code que vous ajouterez à l’étape suivante.</span><span class="sxs-lookup"><span data-stu-id="3ec90-304">This event handler will call the code that you'll add in the next step.</span></span>

<span data-ttu-id="3ec90-305">Ensuite, vous pouvez mettre à jour le code contenu dans le *ShoppingCart.aspx.cs* fichier en boucle les éléments du panier et appelez le `RemoveItem` et `UpdateItem` méthodes.</span><span class="sxs-lookup"><span data-stu-id="3ec90-305">Next, you can update the code contained in the *ShoppingCart.aspx.cs* file to loop through the cart items and call the `RemoveItem` and `UpdateItem` methods.</span></span>

1. <span data-ttu-id="3ec90-306">Dans **l’Explorateur de solutions**, ouvrez le *ShoppingCart.aspx.cs* dans le fichier racine du projet d’application web.</span><span class="sxs-lookup"><span data-stu-id="3ec90-306">In **Solution Explorer**, open the *ShoppingCart.aspx.cs* file in the root of the web application project.</span></span>
2. <span data-ttu-id="3ec90-307">Ajoutez les sections suivantes de code mis en surbrillance en jaune pour le *ShoppingCart.aspx.cs* fichier :</span><span class="sxs-lookup"><span data-stu-id="3ec90-307">Add the following code sections highlighted in yellow to the *ShoppingCart.aspx.cs* file:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample11.cs?highlight=9-11,33,44-89)]

<span data-ttu-id="3ec90-308">Lorsque l’utilisateur clique sur le **mise à jour** bouton sur le *ShoppingCart.aspx* page, la méthode UpdateCartItems est appelée.</span><span class="sxs-lookup"><span data-stu-id="3ec90-308">When the user clicks the **Update** button on the *ShoppingCart.aspx* page, the UpdateCartItems method is called.</span></span> <span data-ttu-id="3ec90-309">La méthode UpdateCartItems Obtient les valeurs mises à jour pour chaque élément dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-309">The UpdateCartItems method gets the updated values for each item in the shopping cart.</span></span> <span data-ttu-id="3ec90-310">Ensuite, la méthode UpdateCartItems appelle le `UpdateShoppingCartDatabase` (méthode) (ajouté et expliqué dans l’étape suivante) pour ajouter ou supprimer des éléments dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-310">Then, the UpdateCartItems method calls the `UpdateShoppingCartDatabase` method (added and explained in the next step) to either add or remove items from the shopping cart.</span></span> <span data-ttu-id="3ec90-311">Une fois que la base de données a été mis à jour pour refléter les mises à jour le panier d’achat, la **GridView** contrôle est mis à jour sur la page du panier en appelant le `DataBind` méthode pour le **GridView**.</span><span class="sxs-lookup"><span data-stu-id="3ec90-311">Once the database has been updated to reflect the updates to the shopping cart, the **GridView** control is updated on the shopping cart page by calling the `DataBind` method for the **GridView**.</span></span> <span data-ttu-id="3ec90-312">En outre, le montant total des commandes sur la page de panier d’achat est mis à jour pour refléter la liste de mises à jour des éléments.</span><span class="sxs-lookup"><span data-stu-id="3ec90-312">Also, the total order amount on the shopping cart page is updated to reflect the updated list of items.</span></span>

### <a name="updating-and-removing-shopping-cart-items"></a><span data-ttu-id="3ec90-313">Mise à jour et suppression d’éléments de panier d’achat</span><span class="sxs-lookup"><span data-stu-id="3ec90-313">Updating and Removing Shopping Cart Items</span></span>

<span data-ttu-id="3ec90-314">Sur le *ShoppingCart.aspx* page, vous pouvez voir les contrôles ont été ajoutés pour la quantité d’un élément de mise à jour et suppression d’un élément.</span><span class="sxs-lookup"><span data-stu-id="3ec90-314">On the *ShoppingCart.aspx* page, you can see controls have been added for updating the quantity of an item and removing an item.</span></span> <span data-ttu-id="3ec90-315">Maintenant, ajoutez le code qui permettront à ces contrôles de travail.</span><span class="sxs-lookup"><span data-stu-id="3ec90-315">Now, add the code that will make these controls work.</span></span>

1. <span data-ttu-id="3ec90-316">Dans **l’Explorateur de solutions**, ouvrez le *ShoppingCartActions.cs* de fichiers dans le *logique* dossier.</span><span class="sxs-lookup"><span data-stu-id="3ec90-316">In **Solution Explorer**, open the *ShoppingCartActions.cs* file in the *Logic* folder.</span></span>
2. <span data-ttu-id="3ec90-317">Ajoutez le code suivant est mis en surbrillance en jaune pour le *ShoppingCartActions.cs* fichier de classe :</span><span class="sxs-lookup"><span data-stu-id="3ec90-317">Add the following code highlighted in yellow to the *ShoppingCartActions.cs* class file:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample12.cs?highlight=99-213)]

<span data-ttu-id="3ec90-318">Le `UpdateShoppingCartDatabase` méthode, appelée à partir de la `UpdateCartItems` méthode sur le *ShoppingCart.aspx.cs* page, contient la logique pour mettre à jour ou supprimer des éléments dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-318">The `UpdateShoppingCartDatabase` method, called from the `UpdateCartItems` method on the *ShoppingCart.aspx.cs* page, contains the logic to either update or remove items from the shopping cart.</span></span> <span data-ttu-id="3ec90-319">Le `UpdateShoppingCartDatabase` méthode effectue une itération dans toutes les lignes dans la liste de panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-319">The `UpdateShoppingCartDatabase` method iterates through all the rows within the shopping cart list.</span></span> <span data-ttu-id="3ec90-320">Si un élément de panier d’achat a été marqué pour être supprimé, ou si la quantité est inférieure à 1, le `RemoveItem` méthode est appelée.</span><span class="sxs-lookup"><span data-stu-id="3ec90-320">If a shopping cart item has been marked to be removed, or the quantity is less than one, the `RemoveItem` method is called.</span></span> <span data-ttu-id="3ec90-321">Dans le cas contraire, l’élément de panier d’achat est activée pour les mises à jour le `UpdateItem` méthode est appelée.</span><span class="sxs-lookup"><span data-stu-id="3ec90-321">Otherwise, the shopping cart item is checked for updates when the `UpdateItem` method is called.</span></span> <span data-ttu-id="3ec90-322">Une fois que l’élément de panier d’achat a été supprimé ou mis à jour, les modifications de la base de données sont enregistrées.</span><span class="sxs-lookup"><span data-stu-id="3ec90-322">After the shopping cart item has been removed or updated, the database changes are saved.</span></span>

<span data-ttu-id="3ec90-323">Le `ShoppingCartUpdates` structure est utilisée pour contenir tous les éléments du panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-323">The `ShoppingCartUpdates` structure is used to hold all the shopping cart items.</span></span> <span data-ttu-id="3ec90-324">Le `UpdateShoppingCartDatabase` utilise le `ShoppingCartUpdates` structure afin de déterminer si les éléments doivent être mis à jour ou supprimé.</span><span class="sxs-lookup"><span data-stu-id="3ec90-324">The `UpdateShoppingCartDatabase` method uses the `ShoppingCartUpdates` structure to determine if any of the items need to be updated or removed.</span></span>

<span data-ttu-id="3ec90-325">Dans l’étape suivante du didacticiel, vous allez utiliser le `EmptyCart` méthode pour effacer les achats panier après l’achat des produits.</span><span class="sxs-lookup"><span data-stu-id="3ec90-325">In the next tutorial, you will use the `EmptyCart` method to clear the shopping cart after purchasing products.</span></span> <span data-ttu-id="3ec90-326">Mais pour l’instant, vous allez utiliser le `GetCount` méthode que vous venez d’ajouter à la *ShoppingCartActions.cs* fichier pour déterminer le nombre d’éléments dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-326">But for now, you will use the `GetCount` method that you just added to the *ShoppingCartActions.cs* file to determine how many items are in the shopping cart.</span></span>

### <a name="adding-a-shopping-cart-counter"></a><span data-ttu-id="3ec90-327">Ajout d’un compteur de panier d’achat</span><span class="sxs-lookup"><span data-stu-id="3ec90-327">Adding a Shopping Cart Counter</span></span>

<span data-ttu-id="3ec90-328">Pour autoriser l’utilisateur d’afficher le nombre total d’éléments dans le panier d’achat, vous allez ajouter un compteur à le *Site.Master* page.</span><span class="sxs-lookup"><span data-stu-id="3ec90-328">To allow the user to view the total number of items in the shopping cart, you will add a counter to the *Site.Master* page.</span></span> <span data-ttu-id="3ec90-329">Ce compteur représente également un lien vers le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-329">This counter will also act as a link to the shopping cart.</span></span>

1. <span data-ttu-id="3ec90-330">Dans **l’Explorateur de solutions**, ouvrez le *Site.Master* page.</span><span class="sxs-lookup"><span data-stu-id="3ec90-330">In **Solution Explorer**, open the *Site.Master* page.</span></span>
2. <span data-ttu-id="3ec90-331">Modifiez le balisage en ajoutant la liaison de compteur de panier d’achat comme indiqué en jaune dans la section navigation afin qu’elle apparaisse comme suit :</span><span class="sxs-lookup"><span data-stu-id="3ec90-331">Modify the markup by adding the shopping cart counter link as shown in yellow to the navigation section so it appears as follows:</span></span>  

    [!code-html[Main](shopping-cart/samples/sample13.html?highlight=6)]
3. <span data-ttu-id="3ec90-332">Ensuite, mettez à jour le code-behind de la *Site.Master.cs* fichier en ajoutant le code mis en surbrillance en jaune comme suit :</span><span class="sxs-lookup"><span data-stu-id="3ec90-332">Next, update the code-behind of the *Site.Master.cs* file by adding the code highlighted in yellow as follows:</span></span>  

    [!code-csharp[Main](shopping-cart/samples/sample14.cs?highlight=11,77-84)]

<span data-ttu-id="3ec90-333">Avant de la page est rendue au format HTML, le `Page_PreRender` événement est déclenché.</span><span class="sxs-lookup"><span data-stu-id="3ec90-333">Before the page is rendered as HTML, the `Page_PreRender` event is raised.</span></span> <span data-ttu-id="3ec90-334">Dans le `Page_PreRender` gestionnaire, le nombre total de panier d’achat est déterminé en appelant le `GetCount` (méthode).</span><span class="sxs-lookup"><span data-stu-id="3ec90-334">In the `Page_PreRender` handler, the total count of the shopping cart is determined by calling the `GetCount` method.</span></span> <span data-ttu-id="3ec90-335">La valeur retournée est ajoutée à la `cartCount` étendue incluse dans le balisage de la *Site.Master* page.</span><span class="sxs-lookup"><span data-stu-id="3ec90-335">The returned value is added to the `cartCount` span included in the markup of the *Site.Master* page.</span></span> <span data-ttu-id="3ec90-336">Le `<span>` balises active les éléments internes doivent être rendus correctement.</span><span class="sxs-lookup"><span data-stu-id="3ec90-336">The `<span>` tags enables the inner elements to be properly rendered.</span></span> <span data-ttu-id="3ec90-337">Lorsque n’importe quelle page du site s’affiche, le total de panier d’achat s’affichera.</span><span class="sxs-lookup"><span data-stu-id="3ec90-337">When any page of the site is displayed, the shopping cart total will be displayed.</span></span> <span data-ttu-id="3ec90-338">L’utilisateur peut cliquer également sur le total de panier d’achat pour afficher le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-338">The user can also click the shopping cart total to display the shopping cart.</span></span>

## <a name="testing-the-completed-shopping-cart"></a><span data-ttu-id="3ec90-339">Test du panier d’achat terminé</span><span class="sxs-lookup"><span data-stu-id="3ec90-339">Testing the Completed Shopping Cart</span></span>

<span data-ttu-id="3ec90-340">Vous pouvez exécuter l’application maintenant pour voir comment vous pouvez ajouter, supprimer et les éléments de mise à jour dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-340">You can run the application now to see how you can add, delete, and update items in the shopping cart.</span></span> <span data-ttu-id="3ec90-341">Le total de panier d’achat reflète le coût total de tous les éléments dans le panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-341">The shopping cart total will reflect the total cost of all items in the shopping cart.</span></span>

1. <span data-ttu-id="3ec90-342">Appuyez sur **F5** pour exécuter l’application.</span><span class="sxs-lookup"><span data-stu-id="3ec90-342">Press **F5** to run the application.</span></span>  
 <span data-ttu-id="3ec90-343">Le navigateur s’ouvre et affiche le *Default.aspx* page.</span><span class="sxs-lookup"><span data-stu-id="3ec90-343">The browser opens and shows the *Default.aspx* page.</span></span>
2. <span data-ttu-id="3ec90-344">Sélectionnez **voitures** à partir du menu de navigation de catégorie.</span><span class="sxs-lookup"><span data-stu-id="3ec90-344">Select **Cars** from the category navigation menu.</span></span>
3. <span data-ttu-id="3ec90-345">Cliquez sur le **Add To Cart** lien en regard du produit en premier.</span><span class="sxs-lookup"><span data-stu-id="3ec90-345">Click the **Add To Cart** link next to the first product.</span></span>   
 <span data-ttu-id="3ec90-346">Le *ShoppingCart.aspx* page s’affiche avec le total de la commande.</span><span class="sxs-lookup"><span data-stu-id="3ec90-346">The *ShoppingCart.aspx* page is displayed with the order total.</span></span>
4. <span data-ttu-id="3ec90-347">Sélectionnez **plans** à partir du menu de navigation de catégorie.</span><span class="sxs-lookup"><span data-stu-id="3ec90-347">Select **Planes** from the category navigation menu.</span></span>
5. <span data-ttu-id="3ec90-348">Cliquez sur le **Add To Cart** lien en regard du produit en premier.</span><span class="sxs-lookup"><span data-stu-id="3ec90-348">Click the **Add To Cart** link next to the first product.</span></span>
6. <span data-ttu-id="3ec90-349">Définissez la quantité du premier élément dans le panier d’achat à 3, puis sélectionnez le **supprimer un élément** case à cocher du deuxième élément.<a id="a"></a></span><span class="sxs-lookup"><span data-stu-id="3ec90-349">Set the quantity of the first item in the shopping cart to 3 and select the **Remove Item** check box of the second item.<a id="a"></a></span></span>
7. <span data-ttu-id="3ec90-350">Cliquez sur le **mettre à jour** pour mettre à jour de la page du panier et afficher le total de la nouvelle commande.</span><span class="sxs-lookup"><span data-stu-id="3ec90-350">Click the **Update** button to update the shopping cart page and display the new order total.</span></span> 

    ![Panier d’achat - mise à jour le panier](shopping-cart/_static/image9.png)

## <a name="summary"></a><span data-ttu-id="3ec90-352">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="3ec90-352">Summary</span></span>

<span data-ttu-id="3ec90-353">Dans ce didacticiel, vous avez créé un panier d’achat pour l’exemple d’application Wingtip Toys Web Forms.</span><span class="sxs-lookup"><span data-stu-id="3ec90-353">In this tutorial, you have created a shopping cart for the Wingtip Toys Web Forms sample application.</span></span> <span data-ttu-id="3ec90-354">Au cours de ce didacticiel, vous utilisez Entity Framework Code First, les annotations de données, les contrôles de données fortement typées et liaison de modèle.</span><span class="sxs-lookup"><span data-stu-id="3ec90-354">During this tutorial you have used Entity Framework Code First, data annotations, strongly typed data controls, and model binding.</span></span>

<span data-ttu-id="3ec90-355">Le panier d’achat prend en charge l’ajout, la suppression et la mise à jour des éléments de l’utilisateur a sélectionné à l’achat.</span><span class="sxs-lookup"><span data-stu-id="3ec90-355">The shopping cart supports adding, deleting, and updating items that the user has selected for purchase.</span></span> <span data-ttu-id="3ec90-356">En plus d’implémenter les fonctionnalités de panier d’achat, vous avez appris comment afficher des éléments de panier d’achat dans une **GridView** contrôler et calculer le total de la commande.</span><span class="sxs-lookup"><span data-stu-id="3ec90-356">In addition to implementing the shopping cart functionality, you have learned how to display shopping cart items in a **GridView** control and calculate the order total.</span></span>

## <a name="addition-information"></a><span data-ttu-id="3ec90-357">Plus d’informations</span><span class="sxs-lookup"><span data-stu-id="3ec90-357">Addition Information</span></span>

[<span data-ttu-id="3ec90-358">Vue d’ensemble de l’état de Session ASP.NET</span><span class="sxs-lookup"><span data-stu-id="3ec90-358">ASP.NET Session State Overview</span></span>](https://msdn.microsoft.com/library/ms178581.aspx)

>[!div class="step-by-step"]
<span data-ttu-id="3ec90-359">[Précédent](display_data_items_and_details.md)
[Suivant](checkout-and-payment-with-paypal.md)</span><span class="sxs-lookup"><span data-stu-id="3ec90-359">[Previous](display_data_items_and_details.md)
[Next](checkout-and-payment-with-paypal.md)</span></span>
