---
uid: identity/overview/extensibility/implementing-a-custom-mysql-aspnet-identity-storage-provider
title: Implémentation d’un fournisseur de stockage d’identité ASP.NET MySQL personnalisé | Documents Microsoft
author: raquelsa
description: ASP.NET Identity est un système extensible qui vous permet de créer votre propre fournisseur de stockage et connectez-le à votre application sans utiliser de nouveau l’Affich...
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/22/2015
ms.topic: article
ms.assetid: 248f5fe7-39ba-40ea-ab1e-71a69b0bd649
ms.technology: ''
ms.prod: .net-framework
msc.legacyurl: /identity/overview/extensibility/implementing-a-custom-mysql-aspnet-identity-storage-provider
msc.type: authoredcontent
ms.openlocfilehash: d843b31e011fe520aad6cfdab0beca2d12477f12
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/06/2018
ms.locfileid: "30872736"
---
<a name="implementing-a-custom-mysql-aspnet-identity-storage-provider"></a><span data-ttu-id="1a89d-103">Implémentation d’un fournisseur de stockage d’identité ASP.NET MySQL personnalisé</span><span class="sxs-lookup"><span data-stu-id="1a89d-103">Implementing a Custom MySQL ASP.NET Identity Storage Provider</span></span>
====================
<span data-ttu-id="1a89d-104">par [Raquel Soares De Almeida](https://github.com/raquelsa), [Suhas Joshi](https://github.com/suhasj), [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="1a89d-104">by [Raquel Soares De Almeida](https://github.com/raquelsa), [Suhas Joshi](https://github.com/suhasj), [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="1a89d-105">ASP.NET Identity est un système extensible qui vous permet de créer votre propre fournisseur de stockage et connectez-le à votre application sans utiliser de nouveau l’application.</span><span class="sxs-lookup"><span data-stu-id="1a89d-105">ASP.NET Identity is an extensible system which enables you to create your own storage provider and plug it into your application without re-working the application.</span></span> <span data-ttu-id="1a89d-106">Cette rubrique décrit comment créer un fournisseur de stockage de MySQL pour ASP.NET Identity.</span><span class="sxs-lookup"><span data-stu-id="1a89d-106">This topic describes how to create a MySQL storage provider for ASP.NET Identity.</span></span> <span data-ttu-id="1a89d-107">Pour une vue d’ensemble de la création de fournisseurs de stockage personnalisé, consultez [vue d’ensemble du stockage fournisseurs personnalisés pour ASP.NET Identity](overview-of-custom-storage-providers-for-aspnet-identity.md).</span><span class="sxs-lookup"><span data-stu-id="1a89d-107">For an overview of creating custom storage providers, see [Overview of Custom Storage Providers for ASP.NET Identity](overview-of-custom-storage-providers-for-aspnet-identity.md).</span></span>
> 
> <span data-ttu-id="1a89d-108">Pour effectuer ce didacticiel, vous devez disposer de Visual Studio 2013 Update 2.</span><span class="sxs-lookup"><span data-stu-id="1a89d-108">To complete this tutorial, you must have Visual Studio 2013 with Update 2.</span></span>
> 
> <span data-ttu-id="1a89d-109">Ce didacticiel va :</span><span class="sxs-lookup"><span data-stu-id="1a89d-109">This tutorial will:</span></span>
> 
> - <span data-ttu-id="1a89d-110">Montrent comment créer une instance de la base de données MySQL sur Azure.</span><span class="sxs-lookup"><span data-stu-id="1a89d-110">Show how to create a MySQL database instance on Azure.</span></span>
> - <span data-ttu-id="1a89d-111">Montrent comment utiliser un outil client de MySQL (banc d’essai MySQL) pour créer des tables et de gérer votre base de données distante sur Azure.</span><span class="sxs-lookup"><span data-stu-id="1a89d-111">Show how to use a MySQL client tool (MySQL Workbench) to create tables and manage your remote database on Azure.</span></span>
> - <span data-ttu-id="1a89d-112">Montrent comment remplacer la valeur par défaut de mise en œuvre du stockage ASP.NET Identity avec notre implémentation personnalisée sur un projet d’application MVC.</span><span class="sxs-lookup"><span data-stu-id="1a89d-112">Show how to replace the default ASP.NET Identity storage implementation with our custom implementation on a MVC application project.</span></span>
> 
> <span data-ttu-id="1a89d-113">Ce didacticiel a été écrit à l’origine par Raquel Soares De Almeida et Rick Anderson ( [ @RickAndMSFT ](https://twitter.com/#!/RickAndMSFT) ).</span><span class="sxs-lookup"><span data-stu-id="1a89d-113">This tutorial was originally written by Raquel Soares De Almeida and Rick Anderson ( [@RickAndMSFT](https://twitter.com/#!/RickAndMSFT) ).</span></span> <span data-ttu-id="1a89d-114">L’exemple de projet a été mis à jour pour l’identité 2.0 Suhas Joshi.</span><span class="sxs-lookup"><span data-stu-id="1a89d-114">The sample project was updated for Identity 2.0 by Suhas Joshi.</span></span> <span data-ttu-id="1a89d-115">La rubrique a été mis à jour pour l’identité 2.0 par Tom FitzMacken.</span><span class="sxs-lookup"><span data-stu-id="1a89d-115">The topic was updated for Identity 2.0 by Tom FitzMacken.</span></span>


## <a name="download-completed-project"></a><span data-ttu-id="1a89d-116">Projet de téléchargement terminé</span><span class="sxs-lookup"><span data-stu-id="1a89d-116">Download completed project</span></span>

<span data-ttu-id="1a89d-117">À la fin de ce didacticiel, vous disposez un projet d’application MVC avec ASP.NET Identity, utilisez une base de données MySQL hébergé sur Azure.</span><span class="sxs-lookup"><span data-stu-id="1a89d-117">At the end of this tutorial, you will have an MVC application project with ASP.NET Identity working with a MySQL database hosted on Azure.</span></span>

<span data-ttu-id="1a89d-118">Vous pouvez télécharger le fournisseur de stockage MySQL terminé à [AspNet.Identity.MySQL (CodePlex)](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/).</span><span class="sxs-lookup"><span data-stu-id="1a89d-118">You can download the completed MySQL storage provider at [AspNet.Identity.MySQL (CodePlex)](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/).</span></span>

## <a name="the-steps-you-will-perform"></a><span data-ttu-id="1a89d-119">Les étapes que vous allez effectuer</span><span class="sxs-lookup"><span data-stu-id="1a89d-119">The steps you will perform</span></span>

<span data-ttu-id="1a89d-120">Dans ce didacticiel, vous allez :</span><span class="sxs-lookup"><span data-stu-id="1a89d-120">In this tutorial you will:</span></span>

1. <span data-ttu-id="1a89d-121">Créer une base de données MySQL sur Azure</span><span class="sxs-lookup"><span data-stu-id="1a89d-121">Create a MySQL database on Azure</span></span>
2. <span data-ttu-id="1a89d-122">Créer des tables de l’identité de ASP.NET dans MySQL</span><span class="sxs-lookup"><span data-stu-id="1a89d-122">Create the ASP.NET Identity tables in MySQL</span></span>
3. <span data-ttu-id="1a89d-123">Créer une application MVC et le configurer pour utiliser le fournisseur MySQL</span><span class="sxs-lookup"><span data-stu-id="1a89d-123">Create an MVC application and configure it to use the MySQL provider</span></span>
4. <span data-ttu-id="1a89d-124">Exécuter l'application</span><span class="sxs-lookup"><span data-stu-id="1a89d-124">Run the app</span></span>

<span data-ttu-id="1a89d-125">Cette rubrique ne couvre pas l’architecture d’identité ASP.NET et les décisions à prendre lors de l’implémentation d’un fournisseur de stockage du client.</span><span class="sxs-lookup"><span data-stu-id="1a89d-125">This topic does not cover the architecture of ASP.NET Identity and the decisions you must make when implementing a customer storage provider.</span></span> <span data-ttu-id="1a89d-126">Pour obtenir cette information, consultez [vue d’ensemble de fournisseurs de stockage personnalisé pour ASP.NET Identity](overview-of-custom-storage-providers-for-aspnet-identity.md).</span><span class="sxs-lookup"><span data-stu-id="1a89d-126">For that information, see [Overview of Custom Storage Providers for ASP.NET Identity](overview-of-custom-storage-providers-for-aspnet-identity.md).</span></span>

## <a name="review-mysql-storage-provider-classes"></a><span data-ttu-id="1a89d-127">Passez en revue les classes de fournisseur de stockage de MySQL</span><span class="sxs-lookup"><span data-stu-id="1a89d-127">Review MySQL storage provider classes</span></span>

<span data-ttu-id="1a89d-128">Avant de passer à la procédure pour créer le fournisseur de stockage MySQL, examinons les classes qui constituent le fournisseur de stockage.</span><span class="sxs-lookup"><span data-stu-id="1a89d-128">Before jumping into the steps to create the MySQL storage provider, let's look at the classes that make up the storage provider.</span></span> <span data-ttu-id="1a89d-129">Vous devez les classes qui gèrent les opérations de base de données et des classes qui sont appelées à partir de l’application à gérer des utilisateurs et des rôles.</span><span class="sxs-lookup"><span data-stu-id="1a89d-129">You will need classes that manage the database operations and classes that are called from the application to manage users and roles.</span></span>

### <a name="storage-classes"></a><span data-ttu-id="1a89d-130">Classes de stockage</span><span class="sxs-lookup"><span data-stu-id="1a89d-130">Storage classes</span></span>

- <span data-ttu-id="1a89d-131">[IdentityUser](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/IdentityUser.cs) -contient les propriétés de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="1a89d-131">[IdentityUser](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/IdentityUser.cs) - contains properties for the user.</span></span>
- <span data-ttu-id="1a89d-132">[UserStore](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserStore.cs) -contient des opérations d’ajout, mise à jour ou la récupération des utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="1a89d-132">[UserStore](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserStore.cs) - contains operations for adding, updating or retrieving users.</span></span>
- <span data-ttu-id="1a89d-133">[IdentityRole](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/IdentityRole.cs) -contient des propriétés pour les rôles.</span><span class="sxs-lookup"><span data-stu-id="1a89d-133">[IdentityRole](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/IdentityRole.cs) - contains properties for roles.</span></span>
- <span data-ttu-id="1a89d-134">[RoleStore](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/RoleStore.cs) -contient des opérations d’ajout, suppression, mise à jour et la récupération des rôles.</span><span class="sxs-lookup"><span data-stu-id="1a89d-134">[RoleStore](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/RoleStore.cs) - contains operations for adding, deleting, updating and retrieving roles.</span></span>

### <a name="data-access-layer-classes"></a><span data-ttu-id="1a89d-135">Classes de couche d’accès aux données</span><span class="sxs-lookup"><span data-stu-id="1a89d-135">Data access layer classes</span></span>

<span data-ttu-id="1a89d-136">Pour cet exemple, les classes de couche d’accès aux données contiennent des instructions SQL pour travailler avec les tables ; Toutefois, dans votre code, vous souhaiterez utilisent le mappage relationnel objet (ORM) comme Entity Framework ou NHibernate.</span><span class="sxs-lookup"><span data-stu-id="1a89d-136">For this example, the data access layer classes contain SQL statements for working with the tables; however, in your code you might want to use object-relational mapping (ORM) such as Entity Framework or NHibernate.</span></span> <span data-ttu-id="1a89d-137">En particulier, votre application peut rencontrer des performances médiocres sans un ORM qui inclut le chargement différé et la mise en cache de l’objet.</span><span class="sxs-lookup"><span data-stu-id="1a89d-137">In particular, your application may experience poor performance without an ORM that includes lazy loading and object caching.</span></span> <span data-ttu-id="1a89d-138">Pour plus d’informations, consultez [ASP.NET Identity 2.0 sans Entity Framework ?](https://aspnetidentity.codeplex.com/discussions/561828)</span><span class="sxs-lookup"><span data-stu-id="1a89d-138">For more information, see [ASP.NET Identity 2.0 without Entity Framework?](https://aspnetidentity.codeplex.com/discussions/561828)</span></span>

- <span data-ttu-id="1a89d-139">[MySQLDatabase](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/MySQLDatabase.cs) -contient la connexion de base de données MySQL et des méthodes pour effectuer des opérations de base de données.</span><span class="sxs-lookup"><span data-stu-id="1a89d-139">[MySQLDatabase](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/MySQLDatabase.cs) - contains the MySQL database connection and methods for performing database operations.</span></span> <span data-ttu-id="1a89d-140">UserStore et RoleStore sont instanciés avec une instance de cette classe.</span><span class="sxs-lookup"><span data-stu-id="1a89d-140">UserStore and RoleStore are both instantiated with an instance of this class.</span></span>
- <span data-ttu-id="1a89d-141">[RoleTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/RoleTable.cs) -contient des opérations de base de données pour la table qui stocke les rôles.</span><span class="sxs-lookup"><span data-stu-id="1a89d-141">[RoleTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/RoleTable.cs) - contains database operations for the table that stores roles.</span></span>
- <span data-ttu-id="1a89d-142">[UserClaimsTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserClaimsTable.cs) -contient des opérations de base de données pour la table qui stocke des revendications d’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="1a89d-142">[UserClaimsTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserClaimsTable.cs) - contains database operations for the table that stores user claims.</span></span>
- <span data-ttu-id="1a89d-143">[UserLoginsTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserLoginsTable.cs) -contient des opérations de base de données pour la table qui stocke les informations de connexion utilisateur.</span><span class="sxs-lookup"><span data-stu-id="1a89d-143">[UserLoginsTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserLoginsTable.cs) - contains database operations for the table that stores user login information.</span></span>
- <span data-ttu-id="1a89d-144">[UserRoleTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserRoleTable.cs) -contient des opérations de base de données pour la table qui stocke les utilisateurs qui sont affectés à des rôles.</span><span class="sxs-lookup"><span data-stu-id="1a89d-144">[UserRoleTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserRoleTable.cs) - contains database operations for the table that stores which users are assigned to which roles.</span></span>
- <span data-ttu-id="1a89d-145">[UserTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserTable.cs) -contient des opérations de base de données pour la table qui stocke les utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="1a89d-145">[UserTable](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/UserTable.cs) - contains database operations for the table that stores users.</span></span>

## <a name="create-a-mysql-database-instance-on-azure"></a><span data-ttu-id="1a89d-146">Créer une instance de la base de données MySQL sur Azure</span><span class="sxs-lookup"><span data-stu-id="1a89d-146">Create a MySQL database instance on Azure</span></span>

1. <span data-ttu-id="1a89d-147">Se connecter à la [portail Azure](https://manage.windowsazure.com/).</span><span class="sxs-lookup"><span data-stu-id="1a89d-147">Log in to the [Azure Portal](https://manage.windowsazure.com/).</span></span>
2. <span data-ttu-id="1a89d-148">Cliquez sur **+ nouveau** au bas de la page, puis sélectionnez **magasin**.</span><span class="sxs-lookup"><span data-stu-id="1a89d-148">Click **+NEW** at the bottom of the page, and then select **STORE**.</span></span>  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image1.png)
3. <span data-ttu-id="1a89d-149">Dans le **choisir et des modules complémentaires** Assistant, sélectionnez **base de données MySQL de ClearDB** , puis cliquez sur la flèche suivant en bas à droite de la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="1a89d-149">In the **Choose and Add-on** wizard, select **ClearDB MySQL Database** and click on the next arrow at the bottom right of the dialog.</span></span>  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image2.png)
4. <span data-ttu-id="1a89d-150">Conservez la valeur par défaut **libre** planifier et de modifier le **nom** à **IdentityMySQLDatabase**.</span><span class="sxs-lookup"><span data-stu-id="1a89d-150">Keep the default **Free** plan and change the **Name** to **IdentityMySQLDatabase**.</span></span> <span data-ttu-id="1a89d-151">Sélectionnez la région le plus proche, puis sur la flèche suivant.</span><span class="sxs-lookup"><span data-stu-id="1a89d-151">Select the region nearest you and then click the next arrow.</span></span>  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image3.png)
5. <span data-ttu-id="1a89d-152">Cliquez sur la coche pour terminer la création de la base de données.</span><span class="sxs-lookup"><span data-stu-id="1a89d-152">Click the checkmark to complete the database creation.</span></span>  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image4.png)
6. <span data-ttu-id="1a89d-153">Une fois que votre base de données a été créé, vous pouvez le gérer à partir de la **modules complémentaires** onglet dans le portail de gestion.</span><span class="sxs-lookup"><span data-stu-id="1a89d-153">After your database has been created, you can manage it from the **ADD-ONS** tab in the management portal.</span></span>   
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image5.png)
7. <span data-ttu-id="1a89d-154">Vous pouvez obtenir les informations de connexion de base de données en cliquant sur **informations de connexion** au bas de la page.</span><span class="sxs-lookup"><span data-stu-id="1a89d-154">You can get the database connection information by clicking on **CONNECTION INFO** at the bottom of the page.</span></span>  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image6.png)
8. <span data-ttu-id="1a89d-155">Copier la chaîne de connexion en cliquant sur le bouton Copier et l’enregistrer afin de pouvoir utiliser plus tard dans votre application MVC.</span><span class="sxs-lookup"><span data-stu-id="1a89d-155">Copy the connection string by clicking on the copy button and save it so you can use later in your MVC application.</span></span>   
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image7.png)

## <a name="create-the-aspnet-identity-tables-in-a-mysql-database"></a><span data-ttu-id="1a89d-156">Créer des tables de l’identité de ASP.NET dans une base de données MySQL</span><span class="sxs-lookup"><span data-stu-id="1a89d-156">Create the ASP.NET Identity tables in a MySQL database</span></span>

### <a name="install-mysql-workbench-tool-to-connect-and-manage-mysql-database"></a><span data-ttu-id="1a89d-157">Installer l’outil MySQL banc d’essai pour vous connecter et gérer la base de données MySQL</span><span class="sxs-lookup"><span data-stu-id="1a89d-157">Install MySQL Workbench tool to connect and manage MySQL database</span></span>

1. <span data-ttu-id="1a89d-158">Installer le **banc d’essai MySQL** outil à partir de la [page Téléchargements de MySQL](http://dev.mysql.com/downloads/windows/installer/)</span><span class="sxs-lookup"><span data-stu-id="1a89d-158">Install the **MySQL Workbench** tool from the [MySQL downloads page](http://dev.mysql.com/downloads/windows/installer/)</span></span>
2. <span data-ttu-id="1a89d-159">Lancez l’application et ajouter un clic sur le **MySQLConnections +** pour ajouter une nouvelle connexion.</span><span class="sxs-lookup"><span data-stu-id="1a89d-159">Launch the app and add click on the **MySQLConnections +** button to add a new connection.</span></span> <span data-ttu-id="1a89d-160">Utiliser les données de chaîne de connexion que vous avez copié à partir de la base de données MySQL de Azure que vous avez créé précédemment dans ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="1a89d-160">Use the connection string data you copied from the Azure MySQL database you created earlier in this tutorial.</span></span>
3. <span data-ttu-id="1a89d-161">Après avoir établi la connexion, ouvrez une nouvelle **requête** onglet ; collez les commandes à partir de [MySQLIdentity.sql](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/MySQLIdentity.sql) dans la requête et de l’exécuter pour créer les tables de base de données.</span><span class="sxs-lookup"><span data-stu-id="1a89d-161">After establishing the connection, open a new **Query** tab; paste the commands from [MySQLIdentity.sql](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/MySQLIdentity.sql) into the query and execute it in order to create the database tables.</span></span>
4. <span data-ttu-id="1a89d-162">Vous avez maintenant toutes les tables nécessaires ASP.NET Identity créés sur une base de données MySQL hébergé sur Azure, comme indiqué ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="1a89d-162">You now have all the ASP.NET Identity necessary tables created on a MySQL database hosted on Azure as shown below.</span></span>  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image1.jpg)

## <a name="create-an-mvc-application-project-from-template-and-configure-it-to-use-mysql-provider"></a><span data-ttu-id="1a89d-163">Créer un projet d’application MVC à partir du modèle et le configurer pour utiliser le fournisseur MySQL</span><span class="sxs-lookup"><span data-stu-id="1a89d-163">Create an MVC application project from template and configure it to use MySQL provider</span></span>

<span data-ttu-id="1a89d-164">Si nécessaire, installez [Visual Studio Express 2013 pour le Web](https://go.microsoft.com/fwlink/?LinkId=299058) ou [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566) Update 2.</span><span class="sxs-lookup"><span data-stu-id="1a89d-164">If needed, install either [Visual Studio Express 2013 for Web](https://go.microsoft.com/fwlink/?LinkId=299058) or [Visual Studio 2013](https://go.microsoft.com/fwlink/?LinkId=306566) with Update 2.</span></span>

### <a name="download-the-aspnetidentitymysql-project-from-codeplex"></a><span data-ttu-id="1a89d-165">Télécharger le projet ASP.NET.Identity.MySQL sur CodePlex</span><span class="sxs-lookup"><span data-stu-id="1a89d-165">Download the ASP.NET.Identity.MySQL project from CodePlex</span></span>

1. <span data-ttu-id="1a89d-166">Accédez à l’URL de référentiel [AspNet.Identity.MySQL (CodePlex)](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/).</span><span class="sxs-lookup"><span data-stu-id="1a89d-166">Browse to the repository URL at [AspNet.Identity.MySQL (CodePlex)](https://aspnet.codeplex.com/SourceControl/latest#Samples/Identity/AspNet.Identity.MySQL/).</span></span>
2. <span data-ttu-id="1a89d-167">Télécharger le code source.</span><span class="sxs-lookup"><span data-stu-id="1a89d-167">Download the source code.</span></span>
3. <span data-ttu-id="1a89d-168">Extraire le fichier .zip dans un dossier local.</span><span class="sxs-lookup"><span data-stu-id="1a89d-168">Extract the .zip file into a local folder.</span></span>
4. <span data-ttu-id="1a89d-169">Ouvrez la solution AspNet.Identity.MySQL et générez-le.</span><span class="sxs-lookup"><span data-stu-id="1a89d-169">Open the AspNet.Identity.MySQL solution and build it.</span></span>

### <a name="create-a-new-mvc-application-project-from-template"></a><span data-ttu-id="1a89d-170">Créer un nouveau projet d’application MVC à partir du modèle</span><span class="sxs-lookup"><span data-stu-id="1a89d-170">Create a new MVC application project from template</span></span>

1. <span data-ttu-id="1a89d-171">Bouton droit sur le **AspNet.Identity.MySQL** solution et **ajouter**, **nouveau projet**</span><span class="sxs-lookup"><span data-stu-id="1a89d-171">Right click the **AspNet.Identity.MySQL** solution and **Add**, **New Project**</span></span>
2. <span data-ttu-id="1a89d-172">Dans le **ajouter un nouveau projet** select de la boîte de dialogue **Visual C#** sur la gauche, puis **Web** , puis sélectionnez **Application Web ASP.NET**.</span><span class="sxs-lookup"><span data-stu-id="1a89d-172">In the **Add New Project** Dialog select **Visual C#** on the left, then **Web** and then select **ASP.NET Web Application**.</span></span> <span data-ttu-id="1a89d-173">Nommez votre projet **IdentityMySQLDemo**; puis cliquez sur OK.</span><span class="sxs-lookup"><span data-stu-id="1a89d-173">Name your project **IdentityMySQLDemo**; and then click OK.</span></span>  
  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image2.jpg)
3. <span data-ttu-id="1a89d-174">Dans le **nouveau projet ASP.NET** boîte de dialogue, sélectionnez le modèle MVC avec les options par défaut (qui inclut **comptes d’utilisateur individuels** comme méthode d’authentification) et cliquez sur **OK** .![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image3.jpg)</span><span class="sxs-lookup"><span data-stu-id="1a89d-174">In the **New ASP.NET Project** dialog, select the MVC template with the default options (that includes **Individual User Accounts** as authentication method) and click **OK**.![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image3.jpg)</span></span>
4. <span data-ttu-id="1a89d-175">Dans l’Explorateur de solutions, cliquez sur votre projet IdentityMySQLDemo et sélectionnez **gérer les Packages NuGet**.</span><span class="sxs-lookup"><span data-stu-id="1a89d-175">In Solution Explorer, right-click your IdentityMySQLDemo project and select **Manage NuGet Packages**.</span></span> <span data-ttu-id="1a89d-176">Dans la fenêtre de zone de texte Rechercher, tapez **Identity.EntityFramework**.</span><span class="sxs-lookup"><span data-stu-id="1a89d-176">In the search text box dialog, type **Identity.EntityFramework**.</span></span> <span data-ttu-id="1a89d-177">Sélectionnez ce package dans la liste des résultats, cliquez sur **désinstallation**.</span><span class="sxs-lookup"><span data-stu-id="1a89d-177">Select this package in the list of results and click **Uninstall**.</span></span> <span data-ttu-id="1a89d-178">Vous devrez désinstaller le package de dépendance EntityFramework.</span><span class="sxs-lookup"><span data-stu-id="1a89d-178">You will be prompted to uninstall the dependency package EntityFramework.</span></span> <span data-ttu-id="1a89d-179">Cliquez sur Oui que nous ne sera plus ce package sur cette application.</span><span class="sxs-lookup"><span data-stu-id="1a89d-179">Click on Yes as we will no longer this package on this application.</span></span>
5. <span data-ttu-id="1a89d-180">Cliquez avec le bouton droit sur le projet IdentityMySQLDemo, sélectionnez **ajouter**, **référence, les solutions, projets ;** sélectionnez le projet AspNet.Identity.MySQL et cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="1a89d-180">Right click the IdentityMySQLDemo project, select **Add**, **Reference, Solution, Projects;** select the AspNet.Identity.MySQL project and click **OK**.</span></span>
6. <span data-ttu-id="1a89d-181">Dans le projet IdentityMySQLDemo, remplacez toutes les références à</span><span class="sxs-lookup"><span data-stu-id="1a89d-181">In the IdentityMySQLDemo project, replace all references to</span></span>  
    `using Microsoft.AspNet.Identity.EntityFramework;`  
   <span data-ttu-id="1a89d-182">par</span><span class="sxs-lookup"><span data-stu-id="1a89d-182">with</span></span>  
     `using AspNet.Identity.MySQL;`
7. <span data-ttu-id="1a89d-183">Dans IdentityModels.cs, définissez **ApplicationDbContext** dériver **MySqlDatabase** et inclure un constructeur qui prend un seul paramètre portant le nom de connexion.</span><span class="sxs-lookup"><span data-stu-id="1a89d-183">In IdentityModels.cs, set **ApplicationDbContext** to derive from **MySqlDatabase** and include a contructor that take a single parameter with the connection name.</span></span>  

    [!code-csharp[Main](implementing-a-custom-mysql-aspnet-identity-storage-provider/samples/sample1.cs)]
8. <span data-ttu-id="1a89d-184">Ouvrez le fichier IdentityConfig.cs.</span><span class="sxs-lookup"><span data-stu-id="1a89d-184">Open the IdentityConfig.cs file.</span></span> <span data-ttu-id="1a89d-185">Dans le **ApplicationUserManager.Create** (méthode), de remplacer l’instanciation UserManager avec le code suivant :</span><span class="sxs-lookup"><span data-stu-id="1a89d-185">In the **ApplicationUserManager.Create** method, replace instantiating UserManager with the following code:</span></span>  

    [!code-csharp[Main](implementing-a-custom-mysql-aspnet-identity-storage-provider/samples/sample2.cs)]
9. <span data-ttu-id="1a89d-186">Ouvrez le fichier web.config et remplacez la chaîne de connexion par défaut de cette entrée en remplaçant les valeurs en surbrillance avec la chaîne de connexion de la base de données MySQL que vous avez créé dans les étapes précédentes :</span><span class="sxs-lookup"><span data-stu-id="1a89d-186">Open the web.config file and replace the DefaultConnection string with this entry replacing the highlighted values with the connection string of the MySQL database you created on previous steps:</span></span>  

    [!code-xml[Main](implementing-a-custom-mysql-aspnet-identity-storage-provider/samples/sample3.xml?highlight=2)]

## <a name="run-the-app-and-connect-to-the-mysql-db"></a><span data-ttu-id="1a89d-187">Exécutez l’application et de se connecter à la base de données MySQL</span><span class="sxs-lookup"><span data-stu-id="1a89d-187">Run the app and connect to the MySQL DB</span></span>

1. <span data-ttu-id="1a89d-188">Bouton droit sur le **IdentityMySQLDemo** de projet et sélectionnez **définir comme projet de démarrage**</span><span class="sxs-lookup"><span data-stu-id="1a89d-188">Right click the **IdentityMySQLDemo** project and select **Set as Startup Project**</span></span>
2. <span data-ttu-id="1a89d-189">Appuyez sur **Ctrl + F5** pour générer et exécuter l’application.</span><span class="sxs-lookup"><span data-stu-id="1a89d-189">Press **Ctrl + F5** to build and run the app.</span></span>
3. <span data-ttu-id="1a89d-190">Cliquez sur **inscrire** onglet en haut de la page.</span><span class="sxs-lookup"><span data-stu-id="1a89d-190">Click on **Register** tab on the top of the page.</span></span>
4. <span data-ttu-id="1a89d-191">Entrez un nom d’utilisateur et un mot de passe, puis cliquez sur **inscrire**.</span><span class="sxs-lookup"><span data-stu-id="1a89d-191">Enter a new user name and password and then click on **Register**.</span></span>  
  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image8.png)
5. <span data-ttu-id="1a89d-192">Le nouvel utilisateur est maintenant inscrit et connecté.</span><span class="sxs-lookup"><span data-stu-id="1a89d-192">The new user is now registered and logged in.</span></span>  
  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image9.png)
6. <span data-ttu-id="1a89d-193">Revenez à l’outil de banc d’essai MySQL et inspecter les **IdentityMySQLDatabase** contenu de la table.</span><span class="sxs-lookup"><span data-stu-id="1a89d-193">Go back to the MySQL Workbench tool and inspect the **IdentityMySQLDatabase** table's contents.</span></span> <span data-ttu-id="1a89d-194">Inspectez la table d’utilisateurs pour les entrées que vous inscrivez des nouveaux utilisateurs.</span><span class="sxs-lookup"><span data-stu-id="1a89d-194">Inspect the users table for the entries as you register new users.</span></span>  
  
    ![](implementing-a-custom-mysql-aspnet-identity-storage-provider/_static/image10.png)

## <a name="next-steps"></a><span data-ttu-id="1a89d-195">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="1a89d-195">Next Steps</span></span>

<span data-ttu-id="1a89d-196">Pour plus d’informations sur l’activation d’autres méthodes d’authentification sur cette application, consultez [création d’une application ASP.NET MVC 5 avec Facebook et Google OAuth2 et OpenID Sign-on](../../../mvc/overview/security/create-an-aspnet-mvc-5-app-with-facebook-and-google-oauth2-and-openid-sign-on.md).</span><span class="sxs-lookup"><span data-stu-id="1a89d-196">For more information on how to enable other authentication methods on this app, refer to [Create an ASP.NET MVC 5 App with Facebook and Google OAuth2 and OpenID Sign-on](../../../mvc/overview/security/create-an-aspnet-mvc-5-app-with-facebook-and-google-oauth2-and-openid-sign-on.md).</span></span>

<span data-ttu-id="1a89d-197">Pour savoir comment intégrer votre base de données avec OAuth et définir des rôles pour limiter l’accès des utilisateurs à votre application, consultez [déployer une application Secure ASP.NET MVC 5 avec l’appartenance, OAuth et base de données SQL Azure](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data).</span><span class="sxs-lookup"><span data-stu-id="1a89d-197">To learn how to integrate your DB with OAuth and to set up roles to limit users access to your app, see [Deploy a Secure ASP.NET MVC 5 app with Membership, OAuth, and SQL Database to Azure](https://docs.microsoft.com/aspnet/core/security/authorization/secure-data).</span></span>
