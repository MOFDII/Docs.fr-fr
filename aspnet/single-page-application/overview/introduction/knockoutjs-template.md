---
uid: single-page-application/overview/introduction/knockoutjs-template
title: "Application à Page unique : Modèle KnockoutJS | Documents Microsoft"
author: MikeWasson
description: "Modèle de Knockout"
ms.author: aspnetcontent
manager: wpickett
ms.date: 01/30/2013
ms.topic: article
ms.assetid: f9c07af0-4b20-4b08-af8f-47fc3df169a2
ms.technology: 
ms.prod: .net-framework
msc.legacyurl: /single-page-application/overview/introduction/knockoutjs-template
msc.type: authoredcontent
ms.openlocfilehash: e6c0c45bed098a8a1160ff11e4f77244bf55ffd3
ms.sourcegitcommit: 060879fcf3f73d2366b5c811986f8695fff65db8
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/24/2018
---
<a name="single-page-application-knockoutjs-template"></a><span data-ttu-id="8c373-103">Application à Page unique : Modèle de KnockoutJS</span><span class="sxs-lookup"><span data-stu-id="8c373-103">Single Page Application: KnockoutJS template</span></span>
====================
<span data-ttu-id="8c373-104">par [Mike Wasson](https://github.com/MikeWasson)</span><span class="sxs-lookup"><span data-stu-id="8c373-104">by [Mike Wasson](https://github.com/MikeWasson)</span></span>

> <span data-ttu-id="8c373-105">Le modèle MVC Knockout fait partie d’ASP.NET et Web Tools 2012.2</span><span class="sxs-lookup"><span data-stu-id="8c373-105">The Knockout MVC Template is part of ASP.NET and Web Tools 2012.2</span></span>
> 
> [<span data-ttu-id="8c373-106">Télécharger ASP.NET et Web Tools 2012.2</span><span class="sxs-lookup"><span data-stu-id="8c373-106">Download ASP.NET and Web Tools 2012.2</span></span>](https://go.microsoft.com/fwlink/?LinkId=282650)


<span data-ttu-id="8c373-107">La mise à jour ASP.NET et Web Tools 2012.2 inclut un modèle d’Application de Page unique (SPA) pour ASP.NET MVC 4.</span><span class="sxs-lookup"><span data-stu-id="8c373-107">The ASP.NET and Web Tools 2012.2 update includes a Single-Page Application (SPA) template for ASP.NET MVC 4.</span></span> <span data-ttu-id="8c373-108">Ce modèle est conçu pour vous aider à démarrer rapidement à créer les applications web côté client interactives.</span><span class="sxs-lookup"><span data-stu-id="8c373-108">This template is designed to get you started quickly building interactive client-side web apps.</span></span>

<span data-ttu-id="8c373-109">« Application à page unique » (SPA) est le terme général pour une application web qui charge une page HTML unique, puis met à jour la page dynamiquement, au lieu de charger les nouvelles pages.</span><span class="sxs-lookup"><span data-stu-id="8c373-109">"Single-page application" (SPA) is the general term for a web application that loads a single HTML page and then updates the page dynamically, instead of loading new pages.</span></span> <span data-ttu-id="8c373-110">Après le chargement de page initial, SPA communique avec le serveur via les requêtes AJAX.</span><span class="sxs-lookup"><span data-stu-id="8c373-110">After the initial page load, the SPA talks with the server through AJAX requests.</span></span>

![](knockoutjs-template/_static/image1.png)

<span data-ttu-id="8c373-111">AJAX n’est pas nouveau, mais aujourd'hui des infrastructures JavaScript qui le rendent plus facile créer et gérer une grande application SPA sophistiquée.</span><span class="sxs-lookup"><span data-stu-id="8c373-111">AJAX is nothing new, but today there are JavaScript frameworks that make it easier to build and maintain a large sophisticated SPA application.</span></span> <span data-ttu-id="8c373-112">En outre, HTML 5 et CSS3 sont qu’il soit plus facile de créer des interfaces utilisateur riches.</span><span class="sxs-lookup"><span data-stu-id="8c373-112">Also, HTML 5 and CSS3 are making it easier to create rich UIs.</span></span>

<span data-ttu-id="8c373-113">Pour vous aider à démarrer, le modèle SPA crée un exemple d’application « Liste des tâches ».</span><span class="sxs-lookup"><span data-stu-id="8c373-113">To get you started, the SPA template creates a sample "To-do list" application.</span></span> <span data-ttu-id="8c373-114">Dans ce didacticiel, nous allons prendre une visite guidée du modèle.</span><span class="sxs-lookup"><span data-stu-id="8c373-114">In this tutorial, we'll take a guided tour of the template.</span></span> <span data-ttu-id="8c373-115">Tout d’abord, nous allons examiner l’application de liste des tâches, puis examiner les éléments de la technologie qui fonctionne.</span><span class="sxs-lookup"><span data-stu-id="8c373-115">First we'll look at the To-do list application itself, then examine the technology pieces that make it work.</span></span>

## <a name="create-a-new-spa-template-project"></a><span data-ttu-id="8c373-116">Créez un projet de modèle SPA</span><span class="sxs-lookup"><span data-stu-id="8c373-116">Create a New SPA Template Project</span></span>

<span data-ttu-id="8c373-117">Configuration requise :</span><span class="sxs-lookup"><span data-stu-id="8c373-117">Requirements:</span></span>

- <span data-ttu-id="8c373-118">Visual Studio 2012 ou Visual Studio Express 2012 pour le Web</span><span class="sxs-lookup"><span data-stu-id="8c373-118">Visual Studio 2012 or Visual Studio Express 2012 for Web</span></span>
- <span data-ttu-id="8c373-119">Mettre à jour des outils de Web ASP.NET 2012.2.</span><span class="sxs-lookup"><span data-stu-id="8c373-119">ASP.NET Web Tools 2012.2 update.</span></span> <span data-ttu-id="8c373-120">Vous pouvez installer la mise à jour [ici](https://www.microsoft.com/web/handlers/webpi.ashx?command=getinstallerredirect&appid=ASPDOTNETandWebTools2012_2).</span><span class="sxs-lookup"><span data-stu-id="8c373-120">You can install the update [here](https://www.microsoft.com/web/handlers/webpi.ashx?command=getinstallerredirect&appid=ASPDOTNETandWebTools2012_2).</span></span>

<span data-ttu-id="8c373-121">Démarrez Visual Studio et sélectionnez **nouveau projet** à partir de la page de démarrage.</span><span class="sxs-lookup"><span data-stu-id="8c373-121">Start Visual Studio and select **New Project** from the Start page.</span></span> <span data-ttu-id="8c373-122">Ou, à partir de la **fichier** menu, sélectionnez **nouveau** , puis **projet**.</span><span class="sxs-lookup"><span data-stu-id="8c373-122">Or, from the **File** menu, select **New** and then **Project**.</span></span>

<span data-ttu-id="8c373-123">Dans le **modèles** volet, sélectionnez **modèles installés** et développez le **Visual C#** nœud.</span><span class="sxs-lookup"><span data-stu-id="8c373-123">In the **Templates** pane, select **Installed Templates** and expand the **Visual C#** node.</span></span> <span data-ttu-id="8c373-124">Sous **Visual C#**, sélectionnez **Web**.</span><span class="sxs-lookup"><span data-stu-id="8c373-124">Under **Visual C#**, select **Web**.</span></span> <span data-ttu-id="8c373-125">Dans la liste des modèles de projet, sélectionnez **ASP.NET MVC 4 Web Application**.</span><span class="sxs-lookup"><span data-stu-id="8c373-125">In the list of project templates, select **ASP.NET MVC 4 Web Application**.</span></span> <span data-ttu-id="8c373-126">Nommez le projet et cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="8c373-126">Name the project and click **OK**.</span></span>

![](knockoutjs-template/_static/image2.png)

<span data-ttu-id="8c373-127">Dans le **nouveau projet** Assistant, sélectionnez **Application à Page unique**.</span><span class="sxs-lookup"><span data-stu-id="8c373-127">In the **New Project** wizard, select **Single Page Application**.</span></span>

![](knockoutjs-template/_static/image3.png)

<span data-ttu-id="8c373-128">Appuyez sur F5 pour générer et exécuter l'application.</span><span class="sxs-lookup"><span data-stu-id="8c373-128">Press F5 to build and run the application.</span></span> <span data-ttu-id="8c373-129">Lorsque l’application s’exécute tout d’abord, il affiche un écran de connexion.</span><span class="sxs-lookup"><span data-stu-id="8c373-129">When the application first runs, it displays a login screen.</span></span>

![](knockoutjs-template/_static/image4.png)

<span data-ttu-id="8c373-130">Cliquez sur le &quot;inscrire&quot; lier et créer un nouvel utilisateur.</span><span class="sxs-lookup"><span data-stu-id="8c373-130">Click the &quot;Sign up&quot; link and create a new user.</span></span>

![](knockoutjs-template/_static/image5.png)

<span data-ttu-id="8c373-131">Une fois connecté, l’application crée une liste de tâches par défaut avec deux éléments.</span><span class="sxs-lookup"><span data-stu-id="8c373-131">After you log in, the application creates a default Todo list with two items.</span></span> <span data-ttu-id="8c373-132">Vous pouvez cliquer sur « Ajouter une liste de tâches » pour ajouter une nouvelle liste.</span><span class="sxs-lookup"><span data-stu-id="8c373-132">You can click "Add Todo list" to add a new list.</span></span>

![](knockoutjs-template/_static/image6.png)

<span data-ttu-id="8c373-133">Renommer la liste, ajouter des éléments à la liste et les cocher.</span><span class="sxs-lookup"><span data-stu-id="8c373-133">Rename the list, add items to the list, and check them off.</span></span> <span data-ttu-id="8c373-134">Vous pouvez également supprimer des éléments ou supprimer une liste entière.</span><span class="sxs-lookup"><span data-stu-id="8c373-134">You can also delete items or delete an entire list.</span></span> <span data-ttu-id="8c373-135">Les modifications sont automatiquement conservées dans une base de données sur le serveur (LocalDB réellement à ce stade, étant donné que vous exécutez l’application localement).</span><span class="sxs-lookup"><span data-stu-id="8c373-135">The changes are automatically persisted to a database on the server (actually LocalDB at this point, because you are running the application locally).</span></span>

![](knockoutjs-template/_static/image7.png)

## <a name="architecture-of-the-spa-template"></a><span data-ttu-id="8c373-136">Architecture du modèle SPA</span><span class="sxs-lookup"><span data-stu-id="8c373-136">Architecture of the SPA Template</span></span>

<span data-ttu-id="8c373-137">Ce diagramme illustre les blocs de construction principaux de l’application.</span><span class="sxs-lookup"><span data-stu-id="8c373-137">This diagram shows the main building blocks for the application.</span></span>

![](knockoutjs-template/_static/image8.png)

<span data-ttu-id="8c373-138">Côté serveur, ASP.NET MVC sert le code HTML et gère également l’authentification basée sur des formulaires.</span><span class="sxs-lookup"><span data-stu-id="8c373-138">On the server side, ASP.NET MVC serves the HTML and also handles forms-based authentication.</span></span>

<span data-ttu-id="8c373-139">API Web ASP.NET gère toutes les demandes qui se rapportent à la ToDoLists et ToDoItems, y compris la mise en route, de création, de mise à jour et de suppression.</span><span class="sxs-lookup"><span data-stu-id="8c373-139">ASP.NET Web API handles all requests that relate to the ToDoLists and ToDoItems, including getting, creating, updating and deleting.</span></span> <span data-ttu-id="8c373-140">Le client échange des données avec l’API Web au format JSON.</span><span class="sxs-lookup"><span data-stu-id="8c373-140">The client exchanges data with Web API in JSON format.</span></span>

<span data-ttu-id="8c373-141">Entity Framework (EF) est la couche de O/RM.</span><span class="sxs-lookup"><span data-stu-id="8c373-141">Entity Framework (EF) is the O/RM layer.</span></span> <span data-ttu-id="8c373-142">Il sert d’intermédiaire entre le monde et orienté objet d’ASP.NET et la base de données sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="8c373-142">It mediates between the object-oriented world of ASP.NET and the underlying database.</span></span> <span data-ttu-id="8c373-143">La base de données utilise la base de données locale, mais vous pouvez le modifier dans le fichier Web.config.</span><span class="sxs-lookup"><span data-stu-id="8c373-143">The database uses LocalDB but you can change this in the Web.config file.</span></span> <span data-ttu-id="8c373-144">En général, vous utilisez LocalDB pour le développement local et déployer une base de données SQL sur le serveur, à l’aide de la migration de code-first EF.</span><span class="sxs-lookup"><span data-stu-id="8c373-144">Typically you would use LocalDB for local development and then deploy to a SQL database on the server, using EF code-first migration.</span></span>

<span data-ttu-id="8c373-145">Du côté client, la bibliothèque Knockout.js gère les mises à jour de la page à partir de requêtes AJAX.</span><span class="sxs-lookup"><span data-stu-id="8c373-145">On the client side, the Knockout.js library handles page updates from AJAX requests.</span></span> <span data-ttu-id="8c373-146">Knockout utilise la liaison de données pour synchroniser la page avec les dernières données.</span><span class="sxs-lookup"><span data-stu-id="8c373-146">Knockout uses data binding to synchronize the page with the latest data.</span></span> <span data-ttu-id="8c373-147">De cette façon, il est inutile d’écrire du code qui vous guide à travers les données JSON et met à jour le modèle DOM.</span><span class="sxs-lookup"><span data-stu-id="8c373-147">That way, you don't have to write any of the code that walks through the JSON data and updates the DOM.</span></span> <span data-ttu-id="8c373-148">Au lieu de cela, vous placez des attributs déclaratifs dans le code HTML qui indiquent Knockout comment présenter les données.</span><span class="sxs-lookup"><span data-stu-id="8c373-148">Instead, you put declarative attributes in the HTML that tell Knockout how to present the data.</span></span>

<span data-ttu-id="8c373-149">Un grand avantage de cette architecture est qu’il sépare la couche de présentation de la logique d’application.</span><span class="sxs-lookup"><span data-stu-id="8c373-149">A big advantage of this architecture is that it separates the presentation layer from the application logic.</span></span> <span data-ttu-id="8c373-150">Vous pouvez créer la partie de l’API Web sans connaître quoi que ce soit sur l’apparence de votre page web.</span><span class="sxs-lookup"><span data-stu-id="8c373-150">You can create the Web API portion without knowing anything about how your web page will look.</span></span> <span data-ttu-id="8c373-151">Du côté client, vous créez un modèle de « vue » pour représenter ces données, et le modèle d’affichage utilise Knockout pour lier le code HTML.</span><span class="sxs-lookup"><span data-stu-id="8c373-151">On the client side, you create a "view model" to represent that data, and the view model uses Knockout to bind to the HTML.</span></span> <span data-ttu-id="8c373-152">Qui vous permet de facilement modifier le code HTML sans modifier le modèle d’affichage.</span><span class="sxs-lookup"><span data-stu-id="8c373-152">That lets you easily change the HTML without changing the view model.</span></span> <span data-ttu-id="8c373-153">(Nous allons examiner Knockout un peu plus loin.)</span><span class="sxs-lookup"><span data-stu-id="8c373-153">(We'll look at Knockout a bit later.)</span></span>

## <a name="models"></a><span data-ttu-id="8c373-154">Modèles</span><span class="sxs-lookup"><span data-stu-id="8c373-154">Models</span></span>

<span data-ttu-id="8c373-155">Dans le projet Visual Studio, le dossier de modèles contient les modèles qui sont utilisés sur le côté serveur.</span><span class="sxs-lookup"><span data-stu-id="8c373-155">In the Visual Studio project, the Models folder contains the models that are used on the server side.</span></span> <span data-ttu-id="8c373-156">(Il existe également des modèles sur le côté client ; nous le verrons celles.)</span><span class="sxs-lookup"><span data-stu-id="8c373-156">(There are also models on the client side; we'll get to those.)</span></span>

![](knockoutjs-template/_static/image9.png)

<span data-ttu-id="8c373-157">**TodoItem, liste des tâches**</span><span class="sxs-lookup"><span data-stu-id="8c373-157">**TodoItem, TodoList**</span></span>

<span data-ttu-id="8c373-158">Il s’agit de modèles de base de données pour Entity Framework Code First.</span><span class="sxs-lookup"><span data-stu-id="8c373-158">These are the database models for Entity Framework Code First.</span></span> <span data-ttu-id="8c373-159">Notez que ces modèles ont des propriétés qui pointent vers les uns par rapport aux autres.</span><span class="sxs-lookup"><span data-stu-id="8c373-159">Notice that these models have properties that point to each other.</span></span> <span data-ttu-id="8c373-160">`ToDoList`contient une collection de ToDoItems et chaque `ToDoItem` a une référence à son parent ToDoList.</span><span class="sxs-lookup"><span data-stu-id="8c373-160">`ToDoList` contains a collection of ToDoItems, and each `ToDoItem` has a reference back to its parent ToDoList.</span></span> <span data-ttu-id="8c373-161">Ces propriétés sont appelées propriétés de navigation, et elles représentent la relation un-à-plusieurs, une liste de tâches et ses éléments de tâches.</span><span class="sxs-lookup"><span data-stu-id="8c373-161">These properties are called navigation properties, and they represent the one-to-many relation a to-do list and its to-do items.</span></span>

<span data-ttu-id="8c373-162">Le `ToDoItem` également classe le **[ForeignKey]** attribut pour spécifier que `ToDoListId` est une clé étrangère dans la `ToDoList` table.</span><span class="sxs-lookup"><span data-stu-id="8c373-162">The `ToDoItem` class also uses the **[ForeignKey]** attribute to specify that `ToDoListId` is a foreign key into the `ToDoList` table.</span></span> <span data-ttu-id="8c373-163">Cela indique à EF pour ajouter une contrainte foreign key à la base de données.</span><span class="sxs-lookup"><span data-stu-id="8c373-163">This tells EF to add a foreign-key constraint to the database.</span></span>

[!code-csharp[Main](knockoutjs-template/samples/sample1.cs)]

<span data-ttu-id="8c373-164">**TodoItemDto, TodoListDto**</span><span class="sxs-lookup"><span data-stu-id="8c373-164">**TodoItemDto, TodoListDto**</span></span>

<span data-ttu-id="8c373-165">Ces classes définissent les données qui seront envoyées au client.</span><span class="sxs-lookup"><span data-stu-id="8c373-165">These classes define the data that will be sent to the client.</span></span> <span data-ttu-id="8c373-166">« DTO » signifie « objet de transfert de données. »</span><span class="sxs-lookup"><span data-stu-id="8c373-166">"DTO" stands for "data transfer object."</span></span> <span data-ttu-id="8c373-167">Le DTO définit comment les entités seront sérialisées en JSON.</span><span class="sxs-lookup"><span data-stu-id="8c373-167">The DTO defines how the entities will be serialized into JSON.</span></span> <span data-ttu-id="8c373-168">En règle générale, il existe plusieurs raisons d’utiliser DTO :</span><span class="sxs-lookup"><span data-stu-id="8c373-168">In general, there are several reasons to use DTOs:</span></span>

- <span data-ttu-id="8c373-169">Pour contrôler les propriétés qui sont sérialisées.</span><span class="sxs-lookup"><span data-stu-id="8c373-169">To control which properties are serialized.</span></span> <span data-ttu-id="8c373-170">Le DTO peut contenir un sous-ensemble des propriétés du modèle de domaine.</span><span class="sxs-lookup"><span data-stu-id="8c373-170">The DTO can contain a subset of the properties from the domain model.</span></span> <span data-ttu-id="8c373-171">Vous pouvez procéder ainsi pour des raisons de sécurité (masquer les données sensibles) ou simplement pour réduire la quantité de données que vous envoyez.</span><span class="sxs-lookup"><span data-stu-id="8c373-171">You might do this for security reasons (to hide sensitive data) or simply to reduce the amount of data that you send.</span></span>
- <span data-ttu-id="8c373-172">Pour modifier la forme des données : par exemple, pour lisser une structure de données plus complexe.</span><span class="sxs-lookup"><span data-stu-id="8c373-172">To change the shape of the data – e.g. to flatten a more complex data structure.</span></span>
- <span data-ttu-id="8c373-173">Pour conserver toute logique métier en dehors du DTO (séparation des problèmes).</span><span class="sxs-lookup"><span data-stu-id="8c373-173">To keep any business logic out of the DTO (separation of concerns).</span></span>
- <span data-ttu-id="8c373-174">Si vos modèles de domaine ne peut pas être sérialisées pour une raison quelconque.</span><span class="sxs-lookup"><span data-stu-id="8c373-174">If your domain models cannot be serialized for some reason.</span></span> <span data-ttu-id="8c373-175">Par exemple, les références circulaires peuvent provoquer des problèmes lorsque vous sérialisez un objet sont moyens de gérer ce problème dans l’API Web (consultez [la gestion des références d’objet circulaires](../../../web-api/overview/formats-and-model-binding/json-and-xml-serialization.md#handling_circular_object_references)) ; mais à l’aide d’un DTO simplement permet d’éviter le problème complètement.</span><span class="sxs-lookup"><span data-stu-id="8c373-175">For example, circular references can cause problems when you serialize an object There are ways to handle this problem in Web API (see [Handling Circular Object References](../../../web-api/overview/formats-and-model-binding/json-and-xml-serialization.md#handling_circular_object_references)); but using a DTO simply avoids the problem altogether.</span></span>

<span data-ttu-id="8c373-176">Dans le modèle SPA, les DTO contient les mêmes données que les modèles de domaine.</span><span class="sxs-lookup"><span data-stu-id="8c373-176">In the SPA template, the DTOs contains the same data as the domain models.</span></span> <span data-ttu-id="8c373-177">Toutefois, ils sont toujours utiles, car ils évitent les références circulaires dans les propriétés de navigation, et ils présentent le modèle DTO général.</span><span class="sxs-lookup"><span data-stu-id="8c373-177">However, they are still useful because they avoid circular references from the navigation properties, and they demonstrate the general DTO pattern.</span></span>

<span data-ttu-id="8c373-178">**AccountModels.cs**</span><span class="sxs-lookup"><span data-stu-id="8c373-178">**AccountModels.cs**</span></span>

<span data-ttu-id="8c373-179">Ce fichier contient des modèles de l’appartenance au site.</span><span class="sxs-lookup"><span data-stu-id="8c373-179">This file contains models for site membership.</span></span> <span data-ttu-id="8c373-180">La `UserProfile` classe définit le schéma pour les profils utilisateur dans la base de données d’appartenance.</span><span class="sxs-lookup"><span data-stu-id="8c373-180">The `UserProfile` class defines the schema for user profiles in the membership DB.</span></span> <span data-ttu-id="8c373-181">(Dans ce cas, que les seules informations sont l’ID d’utilisateur et le nom d’utilisateur.) Les autres classes de modèle dans ce fichier sont utilisés pour créer des formulaires d’inscription et de connexion de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="8c373-181">(In this case, the only information is the user ID and the user name.) The other model classes in this file are used to create the user registration and login forms.</span></span>

## <a name="entity-framework"></a><span data-ttu-id="8c373-182">Entity Framework</span><span class="sxs-lookup"><span data-stu-id="8c373-182">Entity Framework</span></span>

<span data-ttu-id="8c373-183">Le modèle SPA utilise EF Code First.</span><span class="sxs-lookup"><span data-stu-id="8c373-183">The SPA template uses EF Code First.</span></span> <span data-ttu-id="8c373-184">Dans le développement Code First, vous commencez par définir les modèles dans le code et EF utilise ensuite le modèle pour créer la base de données.</span><span class="sxs-lookup"><span data-stu-id="8c373-184">In Code First development, you define the models first in code, and then EF uses the model to create the database.</span></span> <span data-ttu-id="8c373-185">Vous pouvez également utiliser EF avec une base de données existante ([Database First](https://msdn.microsoft.com/data/jj206878.aspx)).</span><span class="sxs-lookup"><span data-stu-id="8c373-185">You can also use EF with an existing database ([Database First](https://msdn.microsoft.com/data/jj206878.aspx)).</span></span>

<span data-ttu-id="8c373-186">Le `TodoItemContext` dérive de la classe dans le dossier de modèles **DbContext**.</span><span class="sxs-lookup"><span data-stu-id="8c373-186">The `TodoItemContext` class in the Models folder derives from **DbContext**.</span></span> <span data-ttu-id="8c373-187">Cette classe fournit le type « glue » entre les modèles et EF.</span><span class="sxs-lookup"><span data-stu-id="8c373-187">This class provides the "glue" between the models and EF.</span></span> <span data-ttu-id="8c373-188">Le `TodoItemContext` contient un `ToDoItem` collection et un `TodoList` collection.</span><span class="sxs-lookup"><span data-stu-id="8c373-188">The `TodoItemContext` holds a `ToDoItem` collection and a `TodoList` collection.</span></span> <span data-ttu-id="8c373-189">Pour interroger la base de données, vous écrivez simplement une requête LINQ sur ces collections.</span><span class="sxs-lookup"><span data-stu-id="8c373-189">To query the database, you simply write a LINQ query against these collections.</span></span> <span data-ttu-id="8c373-190">Par exemple, voici comment vous pouvez sélectionner toutes les listes de tâches pour l’utilisateur « Alice » :</span><span class="sxs-lookup"><span data-stu-id="8c373-190">For example, here is how you can select all of the to-do lists for user "Alice":</span></span>

[!code-csharp[Main](knockoutjs-template/samples/sample2.cs)]

<span data-ttu-id="8c373-191">Vous pouvez également ajouter de nouveaux éléments à la collection, éléments, de mettre à jour ou supprimer des éléments de la collection et conserver les modifications apportées à la base de données.</span><span class="sxs-lookup"><span data-stu-id="8c373-191">You can also add new items to the collection, update items, or delete items from the collection, and persist the changes to the database.</span></span>

## <a name="aspnet-web-api-controllers"></a><span data-ttu-id="8c373-192">Contrôleurs de l’API Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="8c373-192">ASP.NET Web API Controllers</span></span>

<span data-ttu-id="8c373-193">Dans ASP.NET Web API, les contrôleurs sont des objets qui gèrent les demandes HTTP.</span><span class="sxs-lookup"><span data-stu-id="8c373-193">In ASP.NET Web API, controllers are objects that handle HTTP requests.</span></span> <span data-ttu-id="8c373-194">Comme indiqué, le modèle SPA utilise une API Web pour activer les opérations CRUD sur `ToDoList` et `ToDoItem` instances.</span><span class="sxs-lookup"><span data-stu-id="8c373-194">As mentioned, the SPA template uses Web API to enable CRUD operations on `ToDoList` and `ToDoItem` instances.</span></span> <span data-ttu-id="8c373-195">Les contrôleurs sont situés dans le dossier contrôleurs, de la solution.</span><span class="sxs-lookup"><span data-stu-id="8c373-195">The controllers are located in the Controllers folder of the solution.</span></span>

![](knockoutjs-template/_static/image10.png)

- <span data-ttu-id="8c373-196">`TodoController`: Gère les requêtes HTTP pour les éléments d’action</span><span class="sxs-lookup"><span data-stu-id="8c373-196">`TodoController`: Handles HTTP requests for to-do items</span></span>
- <span data-ttu-id="8c373-197">`TodoListController`: Gère les requêtes HTTP pour les listes de tâches.</span><span class="sxs-lookup"><span data-stu-id="8c373-197">`TodoListController`: Handles HTTP requests for to-do lists.</span></span>

<span data-ttu-id="8c373-198">Ces noms sont importantes, car le chemin d’accès de l’URI pour le nom du contrôleur correspond à l’API Web.</span><span class="sxs-lookup"><span data-stu-id="8c373-198">These names are significant, because Web API matches the URI path to the controller name.</span></span> <span data-ttu-id="8c373-199">(Pour savoir comment API Web achemine les demandes HTTP aux contrôleurs, consultez [le routage ASP.NET Web API](../../../web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api.md).)</span><span class="sxs-lookup"><span data-stu-id="8c373-199">(To learn how Web API routes HTTP requests to controllers, see [Routing in ASP.NET Web API](../../../web-api/overview/web-api-routing-and-actions/routing-in-aspnet-web-api.md).)</span></span>

<span data-ttu-id="8c373-200">Examinons la `ToDoListController` classe.</span><span class="sxs-lookup"><span data-stu-id="8c373-200">Let's look at the `ToDoListController` class.</span></span> <span data-ttu-id="8c373-201">Il contient un membre de données unique :</span><span class="sxs-lookup"><span data-stu-id="8c373-201">It contains a single data member:</span></span>

[!code-csharp[Main](knockoutjs-template/samples/sample3.cs)]

<span data-ttu-id="8c373-202">Le `TodoItemContext` est utilisé pour communiquer avec EF, comme décrit précédemment.</span><span class="sxs-lookup"><span data-stu-id="8c373-202">The `TodoItemContext` is used to communicate with EF, as described earlier.</span></span> <span data-ttu-id="8c373-203">Les méthodes sur le contrôleur d’implémentent les opérations CRUD.</span><span class="sxs-lookup"><span data-stu-id="8c373-203">The methods on the controller implement the CRUD operations.</span></span> <span data-ttu-id="8c373-204">API Web mappe les requêtes HTTP du client aux méthodes de contrôleur, comme suit :</span><span class="sxs-lookup"><span data-stu-id="8c373-204">Web API maps HTTP requests from the client to controller methods, as follows:</span></span>

| <span data-ttu-id="8c373-205">Requête HTTP</span><span class="sxs-lookup"><span data-stu-id="8c373-205">HTTP Request</span></span> | <span data-ttu-id="8c373-206">Méthode de contrôleur</span><span class="sxs-lookup"><span data-stu-id="8c373-206">Controller Method</span></span> | <span data-ttu-id="8c373-207">Description</span><span class="sxs-lookup"><span data-stu-id="8c373-207">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="8c373-208">GET /api/todo</span><span class="sxs-lookup"><span data-stu-id="8c373-208">GET /api/todo</span></span> | `GetTodoLists` | <span data-ttu-id="8c373-209">Obtient une collection de listes de tâches.</span><span class="sxs-lookup"><span data-stu-id="8c373-209">Gets a collection of to-do lists.</span></span> |
| <span data-ttu-id="8c373-210">GET /api/todo/*id*</span><span class="sxs-lookup"><span data-stu-id="8c373-210">GET /api/todo/*id*</span></span> | `GetTodoList` | <span data-ttu-id="8c373-211">Obtient une liste de tâches par ID</span><span class="sxs-lookup"><span data-stu-id="8c373-211">Gets a to-do list by ID</span></span> |
| <span data-ttu-id="8c373-212">PUT /api/todo/*id*</span><span class="sxs-lookup"><span data-stu-id="8c373-212">PUT /api/todo/*id*</span></span> | `PutTodoList` | <span data-ttu-id="8c373-213">Met à jour une liste de tâches.</span><span class="sxs-lookup"><span data-stu-id="8c373-213">Updates a to-do list.</span></span> |
| <span data-ttu-id="8c373-214">POST /api/todo</span><span class="sxs-lookup"><span data-stu-id="8c373-214">POST /api/todo</span></span> | `PostTodoList` | <span data-ttu-id="8c373-215">Crée une liste de tâches.</span><span class="sxs-lookup"><span data-stu-id="8c373-215">Creates a new to-do list.</span></span> |
| <span data-ttu-id="8c373-216">DELETE /api/todo/*id*</span><span class="sxs-lookup"><span data-stu-id="8c373-216">DELETE /api/todo/*id*</span></span> | `DeleteTodoList` | <span data-ttu-id="8c373-217">Supprime une liste de tâches.</span><span class="sxs-lookup"><span data-stu-id="8c373-217">Deletes a TODO list.</span></span> |

<span data-ttu-id="8c373-218">Notez que les URI pour certaines opérations contiennent des espaces réservés pour la valeur d’ID.</span><span class="sxs-lookup"><span data-stu-id="8c373-218">Notice that the URIs for some operations contain placeholders for the ID value.</span></span> <span data-ttu-id="8c373-219">Par exemple, pour supprimer une liste à avec un ID de 42, l’URI est `/api/todo/42`.</span><span class="sxs-lookup"><span data-stu-id="8c373-219">For example, to delete a to-list with an ID of 42, the URI is `/api/todo/42`.</span></span>

<span data-ttu-id="8c373-220">Pour en savoir plus sur l’utilisation des API Web pour les opérations, consultez [création d’une API Web qui prend en charge les opérations CRUD](../../../web-api/overview/older-versions/creating-a-web-api-that-supports-crud-operations.md).</span><span class="sxs-lookup"><span data-stu-id="8c373-220">To learn more about using Web API for CRUD operations, see [Creating a Web API that Supports CRUD Operations](../../../web-api/overview/older-versions/creating-a-web-api-that-supports-crud-operations.md).</span></span> <span data-ttu-id="8c373-221">Le code pour ce contrôleur est assez simple.</span><span class="sxs-lookup"><span data-stu-id="8c373-221">The code for this controller is fairly straightforward.</span></span> <span data-ttu-id="8c373-222">Voici quelques points intéressants :</span><span class="sxs-lookup"><span data-stu-id="8c373-222">Here are some interesting points:</span></span>

- <span data-ttu-id="8c373-223">Le `GetTodoLists` méthode utilise une requête LINQ pour filtrer les résultats par l’ID de l’utilisateur connecté.</span><span class="sxs-lookup"><span data-stu-id="8c373-223">The `GetTodoLists` method uses a LINQ query to filter the results by the ID of the logged-in user.</span></span> <span data-ttu-id="8c373-224">De cette façon, un utilisateur ne voit que les données qui appartiennent à lui.</span><span class="sxs-lookup"><span data-stu-id="8c373-224">That way, a user only sees the data that belongs to him or her.</span></span> <span data-ttu-id="8c373-225">Notez également qu’une instruction Select est utilisée pour convertir le `ToDoList` dans des instances `TodoListDto` instances.</span><span class="sxs-lookup"><span data-stu-id="8c373-225">Also, notice that a Select statement is used to convert the `ToDoList` instances into `TodoListDto` instances.</span></span>
- <span data-ttu-id="8c373-226">Les méthodes PUT et POST vérifient l’état du modèle avant de modifier la base de données.</span><span class="sxs-lookup"><span data-stu-id="8c373-226">The PUT and POST methods check the model state before modifying the database.</span></span> <span data-ttu-id="8c373-227">Si **ModelState.IsValid** a la valeur false, ces méthodes retournent HTTP 400 demande incorrecte.</span><span class="sxs-lookup"><span data-stu-id="8c373-227">If **ModelState.IsValid** is false, these methods return HTTP 400, Bad Request.</span></span> <span data-ttu-id="8c373-228">En savoir plus sur la validation de modèle dans l’API Web à [Validation du modèle](../../../web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api.md).</span><span class="sxs-lookup"><span data-stu-id="8c373-228">Read more about model validation in Web API at [Model Validation](../../../web-api/overview/formats-and-model-binding/model-validation-in-aspnet-web-api.md).</span></span>
- <span data-ttu-id="8c373-229">La classe de contrôleur est également décorée avec le **[Authorize]** attribut.</span><span class="sxs-lookup"><span data-stu-id="8c373-229">The controller class is also decorated with the **[Authorize]** attribute.</span></span> <span data-ttu-id="8c373-230">Cet attribut vérifie si la requête HTTP est authentifiée.</span><span class="sxs-lookup"><span data-stu-id="8c373-230">This attribute checks whether the HTTP request is authenticated.</span></span> <span data-ttu-id="8c373-231">Si la demande n’est pas authentifiée, le client reçoit HTTP 401, non autorisé.</span><span class="sxs-lookup"><span data-stu-id="8c373-231">If the request is not authenticated, the client receives HTTP 401, Unauthorized.</span></span> <span data-ttu-id="8c373-232">En savoir plus sur l’authentification au niveau [authentification et autorisation dans ASP.NET Web API](../../../web-api/overview/security/authentication-and-authorization-in-aspnet-web-api.md).</span><span class="sxs-lookup"><span data-stu-id="8c373-232">Read more about authentication at [Authentication and Authorization in ASP.NET Web API](../../../web-api/overview/security/authentication-and-authorization-in-aspnet-web-api.md).</span></span>

<span data-ttu-id="8c373-233">Le `TodoController` classe est très similaire à `TodoListController`.</span><span class="sxs-lookup"><span data-stu-id="8c373-233">The `TodoController` class is very similar to `TodoListController`.</span></span> <span data-ttu-id="8c373-234">La plus grande différence est qu’il ne définit pas les méthodes GET, car le client obtiendra les éléments d’action, ainsi que de chaque liste de tâches.</span><span class="sxs-lookup"><span data-stu-id="8c373-234">The biggest difference is that it does not define any GET methods, because the client will get the to-do items along with each to-do list.</span></span>

## <a name="mvc-controllers-and-views"></a><span data-ttu-id="8c373-235">Vues et contrôleurs MVC</span><span class="sxs-lookup"><span data-stu-id="8c373-235">MVC Controllers and Views</span></span>

<span data-ttu-id="8c373-236">Les contrôleurs MVC se trouvent également dans le dossier contrôleurs, de la solution.</span><span class="sxs-lookup"><span data-stu-id="8c373-236">The MVC controllers are also located in the Controllers folder of the solution.</span></span> <span data-ttu-id="8c373-237">`HomeController`effectue le rendu HTML principal pour l’application.</span><span class="sxs-lookup"><span data-stu-id="8c373-237">`HomeController` renders the main HTML for the application.</span></span> <span data-ttu-id="8c373-238">La vue pour le contrôleur Home est définie dans Views/Home/Index.cshtml.</span><span class="sxs-lookup"><span data-stu-id="8c373-238">The view for the Home controller is defined in Views/Home/Index.cshtml.</span></span> <span data-ttu-id="8c373-239">La vue accueil restitue un contenu différent selon que l’utilisateur est connecté :</span><span class="sxs-lookup"><span data-stu-id="8c373-239">The Home view renders different content depending on whether the user is logged in:</span></span>

[!code-cshtml[Main](knockoutjs-template/samples/sample4.cshtml)]

<span data-ttu-id="8c373-240">Lorsque les utilisateurs sont connectés, ils voient l’interface utilisateur principale.</span><span class="sxs-lookup"><span data-stu-id="8c373-240">When users are logged in, they see the main UI.</span></span> <span data-ttu-id="8c373-241">Dans le cas contraire, ils voient le panneau de login.</span><span class="sxs-lookup"><span data-stu-id="8c373-241">Otherwise, they see the login panel.</span></span> <span data-ttu-id="8c373-242">Notez que cet conditionnel rendu se produit côté serveur.</span><span class="sxs-lookup"><span data-stu-id="8c373-242">Note that this conditional rendering happens on the server side.</span></span> <span data-ttu-id="8c373-243">N’essaient jamais de masquer le contenu sensible sur le côté client & #8212anything que vous envoyez dans une réponse HTTP est visible à une personne qui surveille les messages HTTP bruts.</span><span class="sxs-lookup"><span data-stu-id="8c373-243">Never try to hide sensitive content on the client side&#8212anything that you send in an HTTP response is visible to someone who is watching the raw HTTP messages.</span></span>

## <a name="client-side-javascript-and-knockoutjs"></a><span data-ttu-id="8c373-244">Knockout.js et JavaScript côté client</span><span class="sxs-lookup"><span data-stu-id="8c373-244">Client-Side JavaScript and Knockout.js</span></span>

<span data-ttu-id="8c373-245">Maintenant nous allons activer à partir du serveur de l’application pour le client.</span><span class="sxs-lookup"><span data-stu-id="8c373-245">Now let's turn from the server side of the application to the client.</span></span> <span data-ttu-id="8c373-246">Le modèle SPA utilise une combinaison de jQuery et Knockout.js pour créer une interface utilisateur interactive lisse.</span><span class="sxs-lookup"><span data-stu-id="8c373-246">The SPA template uses a combination of jQuery and Knockout.js to create a smooth, interactive UI.</span></span> <span data-ttu-id="8c373-247">Knockout.js est une bibliothèque JavaScript qui permet de facilement lier HTML à des données.</span><span class="sxs-lookup"><span data-stu-id="8c373-247">Knockout.js is a JavaScript library that makes it easy to bind HTML to data.</span></span> <span data-ttu-id="8c373-248">Knockout.js utilise un modèle appelé « Model-View-ViewModel. »</span><span class="sxs-lookup"><span data-stu-id="8c373-248">Knockout.js uses a pattern called "Model-View-ViewModel."</span></span>

- <span data-ttu-id="8c373-249">Le modèle est les données de domaine (listes de tâches et éléments de tâche).</span><span class="sxs-lookup"><span data-stu-id="8c373-249">The model is the domain data (ToDo lists and ToDo items).</span></span>
- <span data-ttu-id="8c373-250">La vue est le document HTML.</span><span class="sxs-lookup"><span data-stu-id="8c373-250">The view is the HTML document.</span></span>
- <span data-ttu-id="8c373-251">Le modèle d’affichage est un objet JavaScript qui contient les données de modèle.</span><span class="sxs-lookup"><span data-stu-id="8c373-251">The view-model is a JavaScript object that holds the model data.</span></span> <span data-ttu-id="8c373-252">Le modèle d’affichage est une abstraction de code de l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="8c373-252">The view-model is a code abstraction of the UI.</span></span> <span data-ttu-id="8c373-253">Il n’a aucune connaissance de la représentation sous forme de code HTML.</span><span class="sxs-lookup"><span data-stu-id="8c373-253">It has no knowledge of the HTML representation.</span></span> <span data-ttu-id="8c373-254">Au lieu de cela, il représente les fonctionnalités abstraites de la vue, telles que « il s’agit d’une liste des éléments de tâche ».</span><span class="sxs-lookup"><span data-stu-id="8c373-254">Instead, it represents abstract features of the view, such as "a list of ToDo items".</span></span>

<span data-ttu-id="8c373-255">La vue est lié aux données pour le modèle d’affichage.</span><span class="sxs-lookup"><span data-stu-id="8c373-255">The view is data-bound to the view-model.</span></span> <span data-ttu-id="8c373-256">Mises à jour le modèle d’affichage sont automatiquement reflétées dans la vue.</span><span class="sxs-lookup"><span data-stu-id="8c373-256">Updates to the view-model are automatically reflected in the view.</span></span> <span data-ttu-id="8c373-257">Liaisons fonctionnent l’autre direction.</span><span class="sxs-lookup"><span data-stu-id="8c373-257">Bindings work the other direction as well.</span></span> <span data-ttu-id="8c373-258">Événements dans le DOM (tels que les clics) sont liés aux données à des fonctions sur le modèle d’affichage, qui déclenchent des appels AJAX.</span><span class="sxs-lookup"><span data-stu-id="8c373-258">Events in the DOM (such as clicks) are data-bound to functions on the view model, which trigger AJAX calls.</span></span>

<span data-ttu-id="8c373-259">Le modèle SPA organise le JavaScript côté client en trois couches :</span><span class="sxs-lookup"><span data-stu-id="8c373-259">The SPA template organizes the client-side JavaScript into three layers:</span></span>

- <span data-ttu-id="8c373-260">TODO.DataContext.js : envoie les requêtes AJAX.</span><span class="sxs-lookup"><span data-stu-id="8c373-260">todo.datacontext.js: Sends AJAX requests.</span></span>
- <span data-ttu-id="8c373-261">TODO.Model.js : définit les modèles.</span><span class="sxs-lookup"><span data-stu-id="8c373-261">todo.model.js: Defines the models.</span></span>
- <span data-ttu-id="8c373-262">TODO.ViewModel.js : définit le modèle d’affichage.</span><span class="sxs-lookup"><span data-stu-id="8c373-262">todo.viewmodel.js: Defines the view model.</span></span>

![](knockoutjs-template/_static/image11.png)

<span data-ttu-id="8c373-263">Ces fichiers de script sont situés dans le dossier Scripts/application de la solution.</span><span class="sxs-lookup"><span data-stu-id="8c373-263">These script files are located in the Scripts/app folder of the solution.</span></span>

![](knockoutjs-template/_static/image12.png)

<span data-ttu-id="8c373-264">**TODO.DataContext** gère tous les appels AJAX pour les contrôleurs de l’API Web.</span><span class="sxs-lookup"><span data-stu-id="8c373-264">**todo.datacontext** handles all AJAX calls to the Web API controllers.</span></span> <span data-ttu-id="8c373-265">(Les appels AJAX pour la connexion sont définis ailleurs, dans ajaxlogin.js.)</span><span class="sxs-lookup"><span data-stu-id="8c373-265">(The AJAX calls for logging in are defined elsewhere, in ajaxlogin.js.)</span></span>

<span data-ttu-id="8c373-266">**TODO.Model.js** définit les modèles côté client (navigateur) pour les listes de tâches.</span><span class="sxs-lookup"><span data-stu-id="8c373-266">**todo.model.js** defines the client-side (browser) models for the to-do lists.</span></span> <span data-ttu-id="8c373-267">Il existe deux classes de modèle : todoItem et liste des tâches.</span><span class="sxs-lookup"><span data-stu-id="8c373-267">There are two model classes: todoItem and todoList.</span></span>

<span data-ttu-id="8c373-268">La plupart des propriétés dans les classes de modèle sont de type « ko.observable ».</span><span class="sxs-lookup"><span data-stu-id="8c373-268">Many of the properties in the model classes are of type "ko.observable".</span></span> <span data-ttu-id="8c373-269">Observables sont comment Knockout intervient.</span><span class="sxs-lookup"><span data-stu-id="8c373-269">Observables are how Knockout does its magic.</span></span> <span data-ttu-id="8c373-270">À partir de la [documentation de Knockout](http://knockoutjs.com/documentation/introduction.html): observable est un « objet JavaScript qui peut notifier les abonnés à propos des modifications. »</span><span class="sxs-lookup"><span data-stu-id="8c373-270">From the [Knockout documentation](http://knockoutjs.com/documentation/introduction.html): An observable is a "JavaScript object that can notify subscribers about changes."</span></span> <span data-ttu-id="8c373-271">Lorsque la valeur d’observable change, Knockout met à jour des éléments HTML qui sont liés à ces objets observable.</span><span class="sxs-lookup"><span data-stu-id="8c373-271">When the value of an observable changes, Knockout updates any HTML elements that are bound to those observables.</span></span> <span data-ttu-id="8c373-272">Par exemple, todoItem a observables pour les propriétés title et quotidiennea lieu :</span><span class="sxs-lookup"><span data-stu-id="8c373-272">For example, todoItem has observables for the title and isDone properties:</span></span>

[!code-javascript[Main](knockoutjs-template/samples/sample5.js)]

<span data-ttu-id="8c373-273">Vous pouvez également vous abonner à observable dans le code.</span><span class="sxs-lookup"><span data-stu-id="8c373-273">You can also subscribe to an observable in code.</span></span> <span data-ttu-id="8c373-274">Par exemple, la classe todoItem s’abonne aux modifications dans les propriétés « quotidiennea lieu » et « title » :</span><span class="sxs-lookup"><span data-stu-id="8c373-274">For example, the todoItem class subscribes to changes in the "isDone" and "title" properties:</span></span>

[!code-javascript[Main](knockoutjs-template/samples/sample6.js)]

<span data-ttu-id="8c373-275">**Modèle d’affichage**</span><span class="sxs-lookup"><span data-stu-id="8c373-275">**View Model**</span></span>

<span data-ttu-id="8c373-276">Le modèle d’affichage est défini dans todo.viewmodel.js.</span><span class="sxs-lookup"><span data-stu-id="8c373-276">The view model is defined in todo.viewmodel.js.</span></span> <span data-ttu-id="8c373-277">Le modèle d’affichage est le point central, où l’application lie les éléments de la page HTML pour les données du domaine.</span><span class="sxs-lookup"><span data-stu-id="8c373-277">The view model is the central point where the application binds the HTML page elements to the domain data.</span></span> <span data-ttu-id="8c373-278">Dans le modèle SPA, le modèle d’affichage contient un tableau observable de todoLists.</span><span class="sxs-lookup"><span data-stu-id="8c373-278">In the SPA template, the view model contains an observable array of todoLists.</span></span> <span data-ttu-id="8c373-279">Le code suivant dans le modèle d’affichage indique Knockout pour appliquer les liaisons :</span><span class="sxs-lookup"><span data-stu-id="8c373-279">The following code in the view model tells Knockout to apply the bindings:</span></span>

[!code-javascript[Main](knockoutjs-template/samples/sample7.js)]

## <a name="html-and-data-binding"></a><span data-ttu-id="8c373-280">HTML et la liaison de données</span><span class="sxs-lookup"><span data-stu-id="8c373-280">HTML and Data Binding</span></span>

<span data-ttu-id="8c373-281">Le principal HTML de la page est défini dans Views/Home/Index.cshtml.</span><span class="sxs-lookup"><span data-stu-id="8c373-281">The main HTML for the page is defined in Views/Home/Index.cshtml.</span></span> <span data-ttu-id="8c373-282">Étant donné que nous utilisons la liaison de données, le code HTML est uniquement un modèle pour ce qui en fait est restitué.</span><span class="sxs-lookup"><span data-stu-id="8c373-282">Because we are using data-binding, the HTML is only a template for what actually gets rendered.</span></span> <span data-ttu-id="8c373-283">Knockout utilise *déclarative* liaisons.</span><span class="sxs-lookup"><span data-stu-id="8c373-283">Knockout uses *declarative* bindings.</span></span> <span data-ttu-id="8c373-284">Vous liez des éléments de page aux données en ajoutant un attribut de « lier » à l’élément.</span><span class="sxs-lookup"><span data-stu-id="8c373-284">You bind page elements to data by adding a "data-bind" attribute to the element.</span></span> <span data-ttu-id="8c373-285">Voici un exemple très simple, tirée de la documentation de Knockout :</span><span class="sxs-lookup"><span data-stu-id="8c373-285">Here is a very simple example, taken from the Knockout documentation:</span></span>

[!code-html[Main](knockoutjs-template/samples/sample8.html)]

<span data-ttu-id="8c373-286">Dans cet exemple, Knockout met à jour le contenu de la  **&lt;span&gt;**  élément avec la valeur de `myItems.count()`.</span><span class="sxs-lookup"><span data-stu-id="8c373-286">In this example, Knockout updates the contents of the **&lt;span&gt;** element with the value of `myItems.count()`.</span></span> <span data-ttu-id="8c373-287">Lorsque cette valeur change, Knockout met à jour le document.</span><span class="sxs-lookup"><span data-stu-id="8c373-287">Whenever this value changes, Knockout updates the document.</span></span>

<span data-ttu-id="8c373-288">Knockout fournit plusieurs types de liaison différents.</span><span class="sxs-lookup"><span data-stu-id="8c373-288">Knockout provides a number of different binding types.</span></span> <span data-ttu-id="8c373-289">Voici quelques-unes des liaisons utilisées dans le modèle SPA :</span><span class="sxs-lookup"><span data-stu-id="8c373-289">Here are some of the bindings used in the SPA template:</span></span>

- <span data-ttu-id="8c373-290">**foreach**: vous permet d’itérer dans une boucle et appliquer la même balise à chaque élément dans la liste.</span><span class="sxs-lookup"><span data-stu-id="8c373-290">**foreach**: Lets you iterate through a loop and apply the same markup to each item in the list.</span></span> <span data-ttu-id="8c373-291">Cela permet de restituer les listes de tâches et les éléments de tâches.</span><span class="sxs-lookup"><span data-stu-id="8c373-291">This is used to render the to-do lists and to-do items.</span></span> <span data-ttu-id="8c373-292">Dans le **foreach**, les liaisons sont appliquées aux éléments de la liste.</span><span class="sxs-lookup"><span data-stu-id="8c373-292">Within the **foreach**, the bindings are applied to the elements of the list.</span></span>
- <span data-ttu-id="8c373-293">**visible**: utilisé pour afficher ou masquer.</span><span class="sxs-lookup"><span data-stu-id="8c373-293">**visible**: Used to toggle visibility.</span></span> <span data-ttu-id="8c373-294">Masquer le balisage lorsqu’une collection est vide, ou afficher le message d’erreur.</span><span class="sxs-lookup"><span data-stu-id="8c373-294">Hide markup when a collection is empty, or make the error message visible.</span></span>
- <span data-ttu-id="8c373-295">**valeur**: utilisé pour remplir les valeurs de formulaire.</span><span class="sxs-lookup"><span data-stu-id="8c373-295">**value**: Used to populate form values.</span></span>
- <span data-ttu-id="8c373-296">**Cliquez sur**: lie un événement click à une fonction sur le modèle d’affichage.</span><span class="sxs-lookup"><span data-stu-id="8c373-296">**click**: Binds a click event to a function on the view model.</span></span>

## <a name="anti-csrf-protection"></a><span data-ttu-id="8c373-297">Protection de l’anti-CSRF</span><span class="sxs-lookup"><span data-stu-id="8c373-297">Anti-CSRF Protection</span></span>

<span data-ttu-id="8c373-298">Falsification de requête intersites (CSRF) est une attaque où un site malveillant envoie une demande à un site vulnérable où l’utilisateur est actuellement connecté.</span><span class="sxs-lookup"><span data-stu-id="8c373-298">Cross-Site Request Forgery (CSRF) is an attack where a malicious site sends a request to a vulnerable site where the user is currently logged in.</span></span> <span data-ttu-id="8c373-299">Pour aider à empêcher les attaques par CSRF, ASP.NET MVC utilise *les jetons anti-contrefaçon*, également appelé demande de jetons de vérification.</span><span class="sxs-lookup"><span data-stu-id="8c373-299">To help prevent CSRF attacks, ASP.NET MVC uses *anti-forgery tokens*, also called request verification tokens.</span></span> <span data-ttu-id="8c373-300">L’idée est que le serveur place un jeton généré de manière aléatoire dans une page web.</span><span class="sxs-lookup"><span data-stu-id="8c373-300">The idea is that the server puts a randomly generated token into a web page.</span></span> <span data-ttu-id="8c373-301">Lorsque le client envoie des données au serveur, il doit inclure cette valeur dans le message de demande.</span><span class="sxs-lookup"><span data-stu-id="8c373-301">When the client submits data to the server, it must include this value in the request message.</span></span>

<span data-ttu-id="8c373-302">Les jetons anti-contrefaçon fonctionnent, car la page malveillante ne peut pas lire les jetons de l’utilisateur, en raison des stratégies de la même origine.</span><span class="sxs-lookup"><span data-stu-id="8c373-302">Anti-forgery tokens work because the malicious page cannot read the user's tokens, due to same-origin policies.</span></span> <span data-ttu-id="8c373-303">(Même origine stratégies empêchent documents hébergés sur deux sites différents d’accéder au contenu de l’autre.)</span><span class="sxs-lookup"><span data-stu-id="8c373-303">(Same-origin policies prevent documents hosted on two different sites from accessing each other's content.)</span></span>

<span data-ttu-id="8c373-304">ASP.NET MVC fournit la prise en charge intégrée pour les jetons anti-contrefaçon, via le [AntiForgery](https://msdn.microsoft.com/library/system.web.helpers.antiforgery.aspx) classe et le [[ValidateAntiForgeryToken]](https://msdn.microsoft.com/library/system.web.mvc.validateantiforgerytokenattribute.aspx) attribut.</span><span class="sxs-lookup"><span data-stu-id="8c373-304">ASP.NET MVC provides built-in support for anti-forgery tokens, through the [AntiForgery](https://msdn.microsoft.com/library/system.web.helpers.antiforgery.aspx) class and the [[ValidateAntiForgeryToken]](https://msdn.microsoft.com/library/system.web.mvc.validateantiforgerytokenattribute.aspx) attribute.</span></span> <span data-ttu-id="8c373-305">Actuellement, cette fonctionnalité n’est pas intégrée dans l’API Web.</span><span class="sxs-lookup"><span data-stu-id="8c373-305">Currently, this functionality is not built into Web API.</span></span> <span data-ttu-id="8c373-306">Toutefois, le modèle SPA inclut une implémentation personnalisée pour l’API Web.</span><span class="sxs-lookup"><span data-stu-id="8c373-306">However, the SPA template includes a custom implementation for Web API.</span></span> <span data-ttu-id="8c373-307">Ce code est défini dans le `ValidateHttpAntiForgeryTokenAttribute` (classe), qui se trouve dans le dossier de filtres de la solution.</span><span class="sxs-lookup"><span data-stu-id="8c373-307">This code is defined in the `ValidateHttpAntiForgeryTokenAttribute` class, which is located in the Filters folder of the solution.</span></span> <span data-ttu-id="8c373-308">Pour en savoir plus sur anti-CSRF dans l’API Web, consultez [empêcher Cross-Site demande Forgery (CSRF) attaques](../../../web-api/overview/security/preventing-cross-site-request-forgery-csrf-attacks.md).</span><span class="sxs-lookup"><span data-stu-id="8c373-308">To learn more about anti-CSRF in Web API, see [Preventing Cross-Site Request Forgery (CSRF) Attacks](../../../web-api/overview/security/preventing-cross-site-request-forgery-csrf-attacks.md).</span></span>

## <a name="conclusion"></a><span data-ttu-id="8c373-309">Conclusion</span><span class="sxs-lookup"><span data-stu-id="8c373-309">Conclusion</span></span>

<span data-ttu-id="8c373-310">Le modèle SPA est conçu pour vous aider à commencer à écrire rapidement des applications web modernes, interactif.</span><span class="sxs-lookup"><span data-stu-id="8c373-310">The SPA template is designed to get you started quickly writing modern, interactive web applications.</span></span> <span data-ttu-id="8c373-311">Il utilise la bibliothèque Knockout.js pour séparer la présentation (la balise HTML) à partir de la logique de données et des applications.</span><span class="sxs-lookup"><span data-stu-id="8c373-311">It uses the Knockout.js library to separate presentation (HTML markup) from the data and application logic.</span></span> <span data-ttu-id="8c373-312">Mais Knockout n’est pas la bibliothèque JavaScript uniquement, que vous pouvez utiliser pour créer un SPA.</span><span class="sxs-lookup"><span data-stu-id="8c373-312">But Knockout is not the only JavaScript library you can use to create a SPA.</span></span> <span data-ttu-id="8c373-313">Si vous souhaitez Explorer d’autres options, examinez les [créés par la Communauté des modèles SPA](../templates/index.md).</span><span class="sxs-lookup"><span data-stu-id="8c373-313">If you want to explore some other options, take a look at the [community-created SPA templates](../templates/index.md).</span></span>
