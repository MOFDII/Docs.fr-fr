---
uid: mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-5
title: 'Partie 5 : Modification de formulaires et création de modèles | Documents Microsoft'
author: jongalloway
description: Cette série de didacticiels détaille toutes les mesures prises pour générer l’exemple d’application de magasin de musique ASP.NET MVC. Partie 5 couvre la modification de formulaires et de création de modèles.
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/21/2011
ms.topic: article
ms.assetid: 6b09413a-6d6a-425a-87c9-629f91b91b28
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-5
msc.type: authoredcontent
ms.openlocfilehash: d584e614b5a4124044cd9decd2272192ca164643
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/06/2018
---
<a name="part-5-edit-forms-and-templating"></a><span data-ttu-id="da3a6-104">Partie 5 : Modification de formulaires et création de modèles</span><span class="sxs-lookup"><span data-stu-id="da3a6-104">Part 5: Edit Forms and Templating</span></span>
====================
<span data-ttu-id="da3a6-105">par [Jon Galloway](https://github.com/jongalloway)</span><span class="sxs-lookup"><span data-stu-id="da3a6-105">by [Jon Galloway](https://github.com/jongalloway)</span></span>

> <span data-ttu-id="da3a6-106">Le magasin de musique MVC est une application du didacticiel qui présente et explique étape par étape comment utiliser ASP.NET MVC et Visual Studio pour le développement web.</span><span class="sxs-lookup"><span data-stu-id="da3a6-106">The MVC Music Store is a tutorial application that introduces and explains step-by-step how to use ASP.NET MVC and Visual Studio for web development.</span></span>  
>   
> <span data-ttu-id="da3a6-107">Le magasin de musique MVC est une implémentation de magasin exemple léger qui vend des albums de musique en ligne et implémente l’administration de site de base, authentification de l’utilisateur et les fonctionnalités de panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="da3a6-107">The MVC Music Store is a lightweight sample store implementation which sells music albums online, and implements basic site administration, user sign-in, and shopping cart functionality.</span></span>
> 
> <span data-ttu-id="da3a6-108">Cette série de didacticiels détaille toutes les mesures prises pour générer l’exemple d’application de magasin de musique ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="da3a6-108">This tutorial series details all of the steps taken to build the ASP.NET MVC Music Store sample application.</span></span> <span data-ttu-id="da3a6-109">Partie 5 couvre la modification de formulaires et de création de modèles.</span><span class="sxs-lookup"><span data-stu-id="da3a6-109">Part 5 covers Edit Forms and Templating.</span></span>


<span data-ttu-id="da3a6-110">Dans le chapitre passé, nous avons le chargement de données à partir de notre base de données et afficher.</span><span class="sxs-lookup"><span data-stu-id="da3a6-110">In the past chapter, we were loading data from our database and displaying it.</span></span> <span data-ttu-id="da3a6-111">Dans ce chapitre, nous allons également activer la modification des données.</span><span class="sxs-lookup"><span data-stu-id="da3a6-111">In this chapter, we'll also enable editing the data.</span></span>

## <a name="creating-the-storemanagercontroller"></a><span data-ttu-id="da3a6-112">Création de la StoreManagerController</span><span class="sxs-lookup"><span data-stu-id="da3a6-112">Creating the StoreManagerController</span></span>

<span data-ttu-id="da3a6-113">Nous allons commencer par créer un nouveau contrôleur appelé **StoreManagerController**.</span><span class="sxs-lookup"><span data-stu-id="da3a6-113">We'll begin by creating a new controller called **StoreManagerController**.</span></span> <span data-ttu-id="da3a6-114">Pour ce contrôleur, nous allons parti des fonctionnalités de génération de modèles automatique est disponibles dans ASP.NET MVC 3 Tools Update.</span><span class="sxs-lookup"><span data-stu-id="da3a6-114">For this controller, we will be taking advantage of the Scaffolding features available in the ASP.NET MVC 3 Tools Update.</span></span> <span data-ttu-id="da3a6-115">Définissez les options de la boîte de dialogue Ajouter un contrôleur, comme indiqué ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="da3a6-115">Set the options for the Add Controller dialog as shown below.</span></span>

![](mvc-music-store-part-5/_static/image1.png)

<span data-ttu-id="da3a6-116">Lorsque vous cliquez sur le bouton Ajouter, vous verrez que le mécanisme de génération de modèles automatique ASP.NET MVC 3 effectue une quantité importante de travail pour vous :</span><span class="sxs-lookup"><span data-stu-id="da3a6-116">When you click the Add button, you'll see that the ASP.NET MVC 3 scaffolding mechanism does a good amount of work for you:</span></span>

- <span data-ttu-id="da3a6-117">Il crée la nouvelle StoreManagerController avec une variable locale de l’Entity Framework</span><span class="sxs-lookup"><span data-stu-id="da3a6-117">It creates the new StoreManagerController with a local Entity Framework variable</span></span>
- <span data-ttu-id="da3a6-118">Il ajoute un dossier StoreManager vers le dossier du projet vues</span><span class="sxs-lookup"><span data-stu-id="da3a6-118">It adds a StoreManager folder to the project's Views folder</span></span>
- <span data-ttu-id="da3a6-119">Il ajoute une vue Create.cshtml, Delete.cshtml, Details.cshtml, Edit.cshtml et Index.cshtml, fortement typée de la classe Album</span><span class="sxs-lookup"><span data-stu-id="da3a6-119">It adds Create.cshtml, Delete.cshtml, Details.cshtml, Edit.cshtml, and Index.cshtml view, strongly typed to the Album class</span></span>

![](mvc-music-store-part-5/_static/image2.png)

<span data-ttu-id="da3a6-120">La nouvelle classe de contrôleur StoreManager inclut CRUD (créer, lire, mettre à jour, supprimer) des actions de contrôleur qui savent comment travailler avec l’Album classe de modèle et utiliser notre contexte Entity Framework pour l’accès de la base de données.</span><span class="sxs-lookup"><span data-stu-id="da3a6-120">The new StoreManager controller class includes CRUD (create, read, update, delete) controller actions which know how to work with the Album model class and use our Entity Framework context for database access.</span></span>

## <a name="modifying-a-scaffolded-view"></a><span data-ttu-id="da3a6-121">Modification d’une vue de modèle généré automatiquement</span><span class="sxs-lookup"><span data-stu-id="da3a6-121">Modifying a Scaffolded View</span></span>

<span data-ttu-id="da3a6-122">Il est important de se rappeler que, même si ce code a été généré pour nous, il est le code ASP.NET MVC standard, comme nous avons écrit tout au long de ce didacticiel.</span><span class="sxs-lookup"><span data-stu-id="da3a6-122">It's important to remember that, while this code was generated for us, it's standard ASP.NET MVC code, just like we've been writing throughout this tutorial.</span></span> <span data-ttu-id="da3a6-123">Il est destiné à vous permettre d’économiser le temps serait nécessaire sur l’écriture de code réutilisable du contrôleur et la création des vues fortement typées manuellement, mais ce n’est pas le type de code généré est peut-être affiché précédé effrayants avertissements dans les commentaires sur la façon dont vous ne doit pas modifier le code.</span><span class="sxs-lookup"><span data-stu-id="da3a6-123">It's intended to save you the time you'd spend on writing boilerplate controller code and creating the strongly typed views manually, but this isn't the kind of generated code you may have seen prefaced with dire warnings in comments about how you mustn't change the code.</span></span> <span data-ttu-id="da3a6-124">C’est votre code, et vous êtes attendu pour le modifier.</span><span class="sxs-lookup"><span data-stu-id="da3a6-124">This is your code, and you're expected to change it.</span></span>

<span data-ttu-id="da3a6-125">Par conséquent, nous allons commencer par une modification rapide à la vue StoreManager Index (/ Views/StoreManager/Index.cshtml).</span><span class="sxs-lookup"><span data-stu-id="da3a6-125">So, let's start with a quick edit to the StoreManager Index view (/Views/StoreManager/Index.cshtml).</span></span> <span data-ttu-id="da3a6-126">Cet affichage d’une table qui répertorie les Albums dans notre magasin avec Modifier / détails / supprimer les liens et inclut les propriétés publiques de l’Album.</span><span class="sxs-lookup"><span data-stu-id="da3a6-126">This view will display a table which lists the Albums in our store with Edit / Details / Delete links, and includes the Album's public properties.</span></span> <span data-ttu-id="da3a6-127">Nous allons la supprimer le champ AlbumArtUrl, car il n’est pas très utile dans cet affichage.</span><span class="sxs-lookup"><span data-stu-id="da3a6-127">We'll remove the AlbumArtUrl field, as it's not very useful in this display.</span></span> <span data-ttu-id="da3a6-128">Dans &lt;table&gt; section du code de la vue, supprimer le &lt;th&gt; et &lt;td&gt; éléments autour des références à des AlbumArtUrl, comme indiqué par les lignes en surbrillance ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="da3a6-128">In &lt;table&gt; section of the view code, remove the &lt;th&gt; and &lt;td&gt; elements surrounding AlbumArtUrl references, as indicated by the highlighted lines below:</span></span>

[!code-cshtml[Main](mvc-music-store-part-5/samples/sample1.cshtml)]

<span data-ttu-id="da3a6-129">Le code de la vue modifiée s’affiche comme suit :</span><span class="sxs-lookup"><span data-stu-id="da3a6-129">The modified view code will appear as follows:</span></span>

[!code-cshtml[Main](mvc-music-store-part-5/samples/sample2.cshtml)]

## <a name="a-first-look-at-the-store-manager"></a><span data-ttu-id="da3a6-130">Examine d’abord le directeur du magasin</span><span class="sxs-lookup"><span data-stu-id="da3a6-130">A first look at the Store Manager</span></span>

<span data-ttu-id="da3a6-131">Maintenant, exécutez l’application et accédez à/StoreManager /.</span><span class="sxs-lookup"><span data-stu-id="da3a6-131">Now run the application and browse to /StoreManager/.</span></span> <span data-ttu-id="da3a6-132">Cela permet d’afficher l’Index de gestionnaire de stockage que nous avons modifié uniquement, qui contient la liste des albums dans le magasin avec des liens vers plus d’informations, modifier et supprimer.</span><span class="sxs-lookup"><span data-stu-id="da3a6-132">This displays the Store Manager Index we just modified, showing a list of the albums in the store with links to Edit, Details, and Delete.</span></span>

![](mvc-music-store-part-5/_static/image3.png)

<span data-ttu-id="da3a6-133">En cliquant sur le lien Modifier d’affiche un écran de modification des champs de pour l’Album, y compris les menus déroulants pour Genre et artiste.</span><span class="sxs-lookup"><span data-stu-id="da3a6-133">Clicking the Edit link displays an edit form with fields for the Album, including dropdowns for Genre and Artist.</span></span>

![](mvc-music-store-part-5/_static/image4.png)

<span data-ttu-id="da3a6-134">Cliquez sur le lien « Retour à la liste » en bas, puis cliquez sur le lien Détails pour un Album.</span><span class="sxs-lookup"><span data-stu-id="da3a6-134">Click the "Back to List" link at the bottom, then click on the Details link for an Album.</span></span> <span data-ttu-id="da3a6-135">Cela affiche les informations détaillées concernant un Album individuel.</span><span class="sxs-lookup"><span data-stu-id="da3a6-135">This displays the detail information for an individual Album.</span></span>

![](mvc-music-store-part-5/_static/image5.png)

<span data-ttu-id="da3a6-136">Là encore, cliquez sur retour à la liste, puis cliquez sur un lien de suppression.</span><span class="sxs-lookup"><span data-stu-id="da3a6-136">Again, click the Back to List link, then click on a Delete link.</span></span> <span data-ttu-id="da3a6-137">Cela affiche une boîte de dialogue confirmation, présentant les détails de l’album et vous demande si nous sommes que vous souhaitez supprimer.</span><span class="sxs-lookup"><span data-stu-id="da3a6-137">This displays a confirmation dialog, showing the album details and asking if we're sure we want to delete it.</span></span>

![](mvc-music-store-part-5/_static/image6.png)

<span data-ttu-id="da3a6-138">En cliquant sur le bouton Supprimer en bas pour supprimer l’album et vous revenez à la page d’Index, ce qui indique l’album supprimé.</span><span class="sxs-lookup"><span data-stu-id="da3a6-138">Clicking the Delete button at the bottom will delete the album and return you to the Index page, which shows the album deleted.</span></span>

<span data-ttu-id="da3a6-139">Nous n’avons pas terminé avec le directeur du magasin, mais nous avons contrôleur et afficher le code pour les opérations CRUD démarrer à partir de travail.</span><span class="sxs-lookup"><span data-stu-id="da3a6-139">We're not done with the Store Manager, but we have working controller and view code for the CRUD operations to start from.</span></span>

## <a name="looking-at-the-store-manager-controller-code"></a><span data-ttu-id="da3a6-140">Le code de contrôleur du gestionnaire magasin</span><span class="sxs-lookup"><span data-stu-id="da3a6-140">Looking at the Store Manager Controller code</span></span>

<span data-ttu-id="da3a6-141">Le contrôleur du Gestionnaire de magasin contient une quantité importante de code.</span><span class="sxs-lookup"><span data-stu-id="da3a6-141">The Store Manager Controller contains a good amount of code.</span></span> <span data-ttu-id="da3a6-142">Examinons cela de haut en bas.</span><span class="sxs-lookup"><span data-stu-id="da3a6-142">Let's go through this from top to bottom.</span></span> <span data-ttu-id="da3a6-143">Le contrôleur inclut certains espaces de noms standard pour un contrôleur MVC, ainsi que d’une référence à notre espace de noms de modèles.</span><span class="sxs-lookup"><span data-stu-id="da3a6-143">The controller includes some standard namespaces for an MVC controller, as well as a reference to our Models namespace.</span></span> <span data-ttu-id="da3a6-144">Le contrôleur a une instance privée de MusicStoreEntities, utilisé par chacune des actions de contrôleur pour accéder aux données.</span><span class="sxs-lookup"><span data-stu-id="da3a6-144">The controller has a private instance of MusicStoreEntities, used by each of the controller actions for data access.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample3.cs)]

### <a name="store-manager-index-and-details-actions"></a><span data-ttu-id="da3a6-145">Stocker l’Index du gestionnaire et les détails des actions</span><span class="sxs-lookup"><span data-stu-id="da3a6-145">Store Manager Index and Details actions</span></span>

<span data-ttu-id="da3a6-146">La vue index récupère une liste d’Albums, y compris chaque album référencé Genre et artiste, comme nous l’avons vu précédemment lors de l’utilisation de la méthode Store Parcourir.</span><span class="sxs-lookup"><span data-stu-id="da3a6-146">The index view retrieves a list of Albums, including each album's referenced Genre and Artist information, as we previously saw when working on the Store Browse method.</span></span> <span data-ttu-id="da3a6-147">La vue Index suit les références à des objets liés afin qu’il peut affiche chaque album nom du Genre et nom d’un artiste, donc le contrôleur est en cours efficace et interrogation de ces informations dans la demande d’origine.</span><span class="sxs-lookup"><span data-stu-id="da3a6-147">The Index view is following the references to the linked objects so that it can display each album's Genre name and Artist name, so the controller is being efficient and querying for this information in the original request.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample4.cs)]

<span data-ttu-id="da3a6-148">Action de contrôleur du contrôleur StoreManager détails fonctionne exactement comme l’action détails du contrôleur magasin nous avais précédemment écrite - il recherche de l’Album par ID à l’aide de la méthode Find(), puis le renvoie à la vue.</span><span class="sxs-lookup"><span data-stu-id="da3a6-148">The StoreManager Controller's Details controller action works exactly the same as the Store Controller Details action we wrote previously - it queries for the Album by ID using the Find() method, then returns it to the view.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample5.cs)]

### <a name="the-create-action-methods"></a><span data-ttu-id="da3a6-149">La création de méthodes d’Action</span><span class="sxs-lookup"><span data-stu-id="da3a6-149">The Create Action Methods</span></span>

<span data-ttu-id="da3a6-150">Les méthodes d’action de création sont un peu différentes de celles que nous avons vu jusqu’ici, car ils gèrent l’entrée du formulaire.</span><span class="sxs-lookup"><span data-stu-id="da3a6-150">The Create action methods are a little different from ones we've seen so far, because they handle form input.</span></span> <span data-ttu-id="da3a6-151">Lorsqu’un utilisateur visite tout d’abord /StoreManager/Create/ils seront affichera un formulaire vide.</span><span class="sxs-lookup"><span data-stu-id="da3a6-151">When a user first visits /StoreManager/Create/ they will be shown an empty form.</span></span> <span data-ttu-id="da3a6-152">Cette page HTML contient un &lt;formulaire&gt; élément qui contient la liste déroulante et zone de texte d’entrée des éléments dans lequel ils peuvent entrer les détails de l’album.</span><span class="sxs-lookup"><span data-stu-id="da3a6-152">This HTML page will contain a &lt;form&gt; element that contains dropdown and textbox input elements where they can enter the album's details.</span></span>

<span data-ttu-id="da3a6-153">Une fois que l’utilisateur remplit les valeurs de formulaire Album, il peuvent appuyer sur le bouton « Enregistrer » pour soumettre ces modifications dans notre application à enregistrer dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="da3a6-153">After the user fills in the Album form values, they can press the "Save" button to submit these changes back to our application to save within the database.</span></span> <span data-ttu-id="da3a6-154">Lorsque l’utilisateur appuie sur le bouton « Enregistrer » le &lt;formulaire&gt; effectuera une requête HTTP POST vers l’URL de /StoreManager/créer et envoyer la &lt;formulaire&gt; valeurs dans le cadre de la requête HTTP-POST.</span><span class="sxs-lookup"><span data-stu-id="da3a6-154">When the user presses the "save" button the &lt;form&gt; will perform an HTTP-POST back to the /StoreManager/Create/ URL and submit the &lt;form&gt; values as part of the HTTP-POST.</span></span>

<span data-ttu-id="da3a6-155">ASP.NET MVC permet de diviser facilement de la logique de ces deux scénarios d’appel URL en nous permettant d’implémenter les deux méthodes d’action « Créer » distincts au sein de notre classe StoreManagerController : une pour gérer l’initiale HTTP-GET, accédez à la /StoreManager/Create / URL et l’autre pour gérer le HTTP-POST des modifications soumises.</span><span class="sxs-lookup"><span data-stu-id="da3a6-155">ASP.NET MVC allows us to easily split up the logic of these two URL invocation scenarios by enabling us to implement two separate "Create" action methods within our StoreManagerController class – one to handle the initial HTTP-GET browse to the /StoreManager/Create/ URL, and the other to handle the HTTP-POST of the submitted changes.</span></span>

### <a name="passing-information-to-a-view-using-viewbag"></a><span data-ttu-id="da3a6-156">Passage des informations à une vue à l’aide de ViewBag</span><span class="sxs-lookup"><span data-stu-id="da3a6-156">Passing information to a View using ViewBag</span></span>

<span data-ttu-id="da3a6-157">Nous avez utilisé l’élément ViewBag précédemment dans ce didacticiel, mais que vous n’avez pas évoquer il.</span><span class="sxs-lookup"><span data-stu-id="da3a6-157">We've used the ViewBag earlier in this tutorial, but haven't talked much about it.</span></span> <span data-ttu-id="da3a6-158">ViewBag permet de passer des informations à la vue sans utiliser un objet de modèle fortement typé.</span><span class="sxs-lookup"><span data-stu-id="da3a6-158">The ViewBag allows us to pass information to the view without using a strongly typed model object.</span></span> <span data-ttu-id="da3a6-159">Dans ce cas, notre action du contrôleur HTTP-GET modifier doit passer à la fois une liste de Genres et artistes au formulaire pour remplir les menus déroulants et la plus simple pour ce faire consiste à les retourner en tant qu’éléments de l’élément ViewBag.</span><span class="sxs-lookup"><span data-stu-id="da3a6-159">In this case, our Edit HTTP-GET controller action needs to pass both a list of Genres and Artists to the form to populate the dropdowns, and the simplest way to do that is to return them as ViewBag items.</span></span>

<span data-ttu-id="da3a6-160">L’élément ViewBag est un objet dynamique, ce qui signifie que vous pouvez taper ViewBag.Foo ou ViewBag.YourNameHere sans écrire de code pour définir ces propriétés.</span><span class="sxs-lookup"><span data-stu-id="da3a6-160">The ViewBag is a dynamic object, meaning that you can type ViewBag.Foo or ViewBag.YourNameHere without writing code to define those properties.</span></span> <span data-ttu-id="da3a6-161">Dans ce cas, le code du contrôleur utilise ViewBag.GenreId et ViewBag.ArtistId afin que les valeurs de liste déroulante envoyées avec le formulaire seront GenreId et ArtistId, qui sont les propriétés de l’Album que leur définition.</span><span class="sxs-lookup"><span data-stu-id="da3a6-161">In this case, the controller code uses ViewBag.GenreId and ViewBag.ArtistId so that the dropdown values submitted with the form will be GenreId and ArtistId, which are the Album properties they will be setting.</span></span>

<span data-ttu-id="da3a6-162">Ces valeurs de liste déroulante sont renvoyées au formulaire à l’aide de l’objet SelectList, qui est généré seulement à cet effet.</span><span class="sxs-lookup"><span data-stu-id="da3a6-162">These dropdown values are returned to the form using the SelectList object, which is built just for that purpose.</span></span> <span data-ttu-id="da3a6-163">Cette opération est effectuée à l’aide de code similaire à celui-ci :</span><span class="sxs-lookup"><span data-stu-id="da3a6-163">This is done using code like this:</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample6.cs)]

<span data-ttu-id="da3a6-164">Comme vous pouvez le voir à partir du code de méthode d’action, les trois paramètres sont utilisés pour créer cet objet :</span><span class="sxs-lookup"><span data-stu-id="da3a6-164">As you can see from the action method code, three parameters are being used to create this object:</span></span>

- <span data-ttu-id="da3a6-165">La liste des éléments de qu'affichage de la liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="da3a6-165">The list of items the dropdown will be displaying.</span></span> <span data-ttu-id="da3a6-166">Notez que cela n’est pas simplement une chaîne que nous transmettons une liste de Genres.</span><span class="sxs-lookup"><span data-stu-id="da3a6-166">Note that this isn't just a string - we're passing a list of Genres.</span></span>
- <span data-ttu-id="da3a6-167">Le paramètre suivant passé à le SelectList est la valeur sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="da3a6-167">The next parameter being passed to the SelectList is the Selected Value.</span></span> <span data-ttu-id="da3a6-168">Cette façon dont le SelectList sait comment présélectionner un élément dans la liste.</span><span class="sxs-lookup"><span data-stu-id="da3a6-168">This how the SelectList knows how to pre-select an item in the list.</span></span> <span data-ttu-id="da3a6-169">Ce sera plus facile à comprendre si vous regardez le formulaire d’édition, qui est assez similaire.</span><span class="sxs-lookup"><span data-stu-id="da3a6-169">This will be easier to understand when we look at the Edit form, which is pretty similar.</span></span>
- <span data-ttu-id="da3a6-170">Le dernier paramètre est la propriété à afficher.</span><span class="sxs-lookup"><span data-stu-id="da3a6-170">The final parameter is the property to be displayed.</span></span> <span data-ttu-id="da3a6-171">Dans ce cas, cela indique que la propriété Genre.Name est ce qui sera affiché à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="da3a6-171">In this case, this is indicating that the Genre.Name property is what will be shown to the user.</span></span>

<span data-ttu-id="da3a6-172">Dans cette optique, puis, l’action HTTP-GET créer est assez simple - deux SelectLists sont ajoutés à l’élément ViewBag, et aucun objet de modèle n’est passé au formulaire (dans la mesure où il n’a pas encore été créé).</span><span class="sxs-lookup"><span data-stu-id="da3a6-172">With that in mind, then, the HTTP-GET Create action is pretty simple - two SelectLists are added to the ViewBag, and no model object is passed to the form (since it hasn't been created yet).</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample7.cs)]

### <a name="html-helpers-to-display-the-drop-downs-in-the-create-view"></a><span data-ttu-id="da3a6-173">Programmes d’assistance HTML pour afficher les détails de la supprimer dans la vue à créer</span><span class="sxs-lookup"><span data-stu-id="da3a6-173">HTML Helpers to display the Drop Downs in the Create View</span></span>

<span data-ttu-id="da3a6-174">Étant donné que nous avons vu comment la liste déroulante de valeurs sont passées à la vue, jetons un œil rapide à la vue pour voir comment les valeurs sont affichées.</span><span class="sxs-lookup"><span data-stu-id="da3a6-174">Since we've talked about how the drop down values are passed to the view, let's take a quick look at the view to see how those values are displayed.</span></span> <span data-ttu-id="da3a6-175">Dans le code de la vue (/ Views/StoreManager/Create.cshtml), vous verrez que l’appel suivant est effectué pour afficher la liste déroulante de Genre vers le bas.</span><span class="sxs-lookup"><span data-stu-id="da3a6-175">In the view code (/Views/StoreManager/Create.cshtml), you'll see the following call is made to display the Genre drop down.</span></span>

[!code-cshtml[Main](mvc-music-store-part-5/samples/sample8.cshtml)]

<span data-ttu-id="da3a6-176">Il s’agit d’une application d’assistance HTML - une méthode utilitaire qui effectue une tâche courante de la vue.</span><span class="sxs-lookup"><span data-stu-id="da3a6-176">This is known as an HTML Helper - a utility method which performs a common view task.</span></span> <span data-ttu-id="da3a6-177">Programmes d’assistance HTML sont très utiles dans le maintien de notre code de vue concises et lisibles.</span><span class="sxs-lookup"><span data-stu-id="da3a6-177">HTML Helpers are very useful in keeping our view code concise and readable.</span></span> <span data-ttu-id="da3a6-178">L’application d’assistance Html.DropDownList est fournie par ASP.NET MVC, mais comme nous le verrons plus tard, il est possible de créer nos programmes d’assistance pour afficher le code que nous allons réutiliser dans notre application.</span><span class="sxs-lookup"><span data-stu-id="da3a6-178">The Html.DropDownList helper is provided by ASP.NET MVC, but as we'll see later it's possible to create our own helpers for view code we'll reuse in our application.</span></span>

<span data-ttu-id="da3a6-179">L’appel de Html.DropDownList doit simplement être invité à deux choses - cas pour obtenir la liste pour afficher et quelle valeur (le cas échéant) doit être sélectionnée au préalable.</span><span class="sxs-lookup"><span data-stu-id="da3a6-179">The Html.DropDownList call just needs to be told two things - where to get the list to display, and what value (if any) should be pre-selected.</span></span> <span data-ttu-id="da3a6-180">Le premier paramètre, GenreId, indique le DropDownList pour rechercher une valeur nommée GenreId dans le modèle ou un élément ViewBag.</span><span class="sxs-lookup"><span data-stu-id="da3a6-180">The first parameter, GenreId, tells the DropDownList to look for a value named GenreId in either the model or ViewBag.</span></span> <span data-ttu-id="da3a6-181">Le deuxième paramètre est utilisé pour indiquer la valeur à afficher comme initialement sélectionnée dans la liste déroulante.</span><span class="sxs-lookup"><span data-stu-id="da3a6-181">The second parameter is used to indicate the value to show as initially selected in the drop down list.</span></span> <span data-ttu-id="da3a6-182">Étant donné que ce formulaire est un formulaire de création, il n’existe aucune valeur pour être présélectionnées et String.Empty est passé.</span><span class="sxs-lookup"><span data-stu-id="da3a6-182">Since this form is a Create form, there's no value to be preselected and String.Empty is passed.</span></span>

### <a name="handling-the-posted-form-values"></a><span data-ttu-id="da3a6-183">La gestion des valeurs de la validation de formulaire</span><span class="sxs-lookup"><span data-stu-id="da3a6-183">Handling the Posted Form values</span></span>

<span data-ttu-id="da3a6-184">Que nous avons abordée avant, il existe deux méthodes d’action associés à chaque formulaire.</span><span class="sxs-lookup"><span data-stu-id="da3a6-184">As we discussed before, there are two action methods associated with each form.</span></span> <span data-ttu-id="da3a6-185">Le premier traite la demande HTTP-GET et affiche le formulaire.</span><span class="sxs-lookup"><span data-stu-id="da3a6-185">The first handles the HTTP-GET request and displays the form.</span></span> <span data-ttu-id="da3a6-186">La seconde gère la demande HTTP-POST, qui contient les valeurs de formulaire envoyé.</span><span class="sxs-lookup"><span data-stu-id="da3a6-186">The second handles the HTTP-POST request, which contains the submitted form values.</span></span> <span data-ttu-id="da3a6-187">Remarquez qu’un attribut [HttpPost], ce qui indique à ASP.NET MVC qu’il doit répondre uniquement aux demandes HTTP-POST action du contrôleur.</span><span class="sxs-lookup"><span data-stu-id="da3a6-187">Notice that controller action has an [HttpPost] attribute, which tells ASP.NET MVC that it should only respond to HTTP-POST requests.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample9.cs)]

<span data-ttu-id="da3a6-188">Cette action a quatre responsabilités :</span><span class="sxs-lookup"><span data-stu-id="da3a6-188">This action has four responsibilities:</span></span>

- 1. <span data-ttu-id="da3a6-189">Lire les valeurs de formulaire</span><span class="sxs-lookup"><span data-stu-id="da3a6-189">Read the form values</span></span>
- 2. <span data-ttu-id="da3a6-190">Vérifiez si les valeurs de formulaire passer les règles de validation</span><span class="sxs-lookup"><span data-stu-id="da3a6-190">Check if the form values pass any validation rules</span></span>
- 3. <span data-ttu-id="da3a6-191">Si l’envoi du formulaire est valide, enregistrer les données et afficher la liste de mises à jour</span><span class="sxs-lookup"><span data-stu-id="da3a6-191">If the form submission is valid, save the data and display the updated list</span></span>
- 4. <span data-ttu-id="da3a6-192">Si l’envoi du formulaire n’est pas valide, réafficher le formulaire avec des erreurs de validation</span><span class="sxs-lookup"><span data-stu-id="da3a6-192">If the form submission is not valid, redisplay the form with validation errors</span></span>

#### <a name="reading-form-values-with-model-binding"></a><span data-ttu-id="da3a6-193">La lecture des valeurs de formulaire avec liaison de modèle</span><span class="sxs-lookup"><span data-stu-id="da3a6-193">Reading Form Values with Model Binding</span></span>

<span data-ttu-id="da3a6-194">L’action du contrôleur est le traitement d’envoi d’un formulaire qui inclut des valeurs pour GenreId et ArtistId (à partir de la zone de liste déroulante) et les valeurs de la zone de texte pour le titre, le prix et AlbumArtUrl.</span><span class="sxs-lookup"><span data-stu-id="da3a6-194">The controller action is processing a form submission that includes values for GenreId and ArtistId (from the drop down list) and textbox values for Title, Price, and AlbumArtUrl.</span></span> <span data-ttu-id="da3a6-195">Bien qu’il soit possible d’accéder directement aux valeurs de formulaire, une meilleure approche consiste à utiliser les fonctionnalités de liaison de modèle intégrées à ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="da3a6-195">While it's possible to directly access form values, a better approach is to use the Model Binding capabilities built into ASP.NET MVC.</span></span> <span data-ttu-id="da3a6-196">Lorsqu’une action de contrôleur prend un type de modèle en tant que paramètre, ASP.NET MVC va tenter de remplir un objet de ce type à l’aide des entrées de formulaire (ainsi que les valeurs d’itinéraire et de la chaîne de requête).</span><span class="sxs-lookup"><span data-stu-id="da3a6-196">When a controller action takes a model type as a parameter, ASP.NET MVC will attempt to populate an object of that type using form inputs (as well as route and querystring values).</span></span> <span data-ttu-id="da3a6-197">Pour ce faire, il recherche des valeurs dont les noms correspondent aux propriétés de l’objet de modèle, par exemple, lorsque vous définissez la valeur de GenreId du nouvel objet Album, il recherche une entrée avec le nom GenreId.</span><span class="sxs-lookup"><span data-stu-id="da3a6-197">It does this by looking for values whose names match properties of the model object, e.g. when setting the new Album object's GenreId value, it looks for an input with the name GenreId.</span></span> <span data-ttu-id="da3a6-198">Lorsque vous créez des vues à l’aide des méthodes standard dans ASP.NET MVC, les formulaires seront toujours rendues à l’aide des noms de propriété en tant que noms de champ d’entrée, cela les noms de champ seront simplement correspondre à.</span><span class="sxs-lookup"><span data-stu-id="da3a6-198">When you create views using the standard methods in ASP.NET MVC, the forms will always be rendered using property names as input field names, so this the field names will just match up.</span></span>

#### <a name="validating-the-model"></a><span data-ttu-id="da3a6-199">Validation du modèle</span><span class="sxs-lookup"><span data-stu-id="da3a6-199">Validating the Model</span></span>

<span data-ttu-id="da3a6-200">Le modèle est validé par un simple appel à ModelState.IsValid.</span><span class="sxs-lookup"><span data-stu-id="da3a6-200">The model is validated with a simple call to ModelState.IsValid.</span></span> <span data-ttu-id="da3a6-201">Nous n’avons pas ajouté les règles de validation à la classe Album encore, nous allons faire ayant un bit - donc maintenant cette vérification pas grand-chose à faire.</span><span class="sxs-lookup"><span data-stu-id="da3a6-201">We haven't added any validation rules to our Album class yet - we'll do that in a bit - so right now this check doesn't have much to do.</span></span> <span data-ttu-id="da3a6-202">L’essentiel est que cette vérification ModelStat.IsValid s’adapte aux règles de validation que nous plaçons sur notre modèle, afin de futures modifications aux règles de validation ne nécessitent pas les mises à jour le code d’action de contrôleur.</span><span class="sxs-lookup"><span data-stu-id="da3a6-202">What's important is that this ModelStat.IsValid check will adapt to the validation rules we put on our model, so future changes to validation rules won't require any updates to the controller action code.</span></span>

#### <a name="saving-the-submitted-values"></a><span data-ttu-id="da3a6-203">Enregistrer les valeurs envoyés</span><span class="sxs-lookup"><span data-stu-id="da3a6-203">Saving the submitted values</span></span>

<span data-ttu-id="da3a6-204">Si l’envoi du formulaire de validation réussit, il est temps d’enregistrer les valeurs de la base de données.</span><span class="sxs-lookup"><span data-stu-id="da3a6-204">If the form submission passes validation, it's time to save the values to the database.</span></span> <span data-ttu-id="da3a6-205">Avec Entity Framework, qui requiert simplement ajouter le modèle à la collection d’Albums et appeler SaveChanges.</span><span class="sxs-lookup"><span data-stu-id="da3a6-205">With Entity Framework, that just requires adding the model to the Albums collection and calling SaveChanges.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample10.cs)]

<span data-ttu-id="da3a6-206">Entity Framework génère les commandes SQL appropriées pour conserver la valeur.</span><span class="sxs-lookup"><span data-stu-id="da3a6-206">Entity Framework generates the appropriate SQL commands to persist the value.</span></span> <span data-ttu-id="da3a6-207">Après avoir enregistré les données, nous rediriger à la liste des Albums, nous pouvons voir notre mise à jour.</span><span class="sxs-lookup"><span data-stu-id="da3a6-207">After saving the data, we redirect back to the list of Albums so we can see our update.</span></span> <span data-ttu-id="da3a6-208">Pour cela, vous devez retourner RedirectToAction avec le nom de l’action de contrôleur nous à afficher.</span><span class="sxs-lookup"><span data-stu-id="da3a6-208">This is done by returning RedirectToAction with the name of the controller action we want displayed.</span></span> <span data-ttu-id="da3a6-209">Dans ce cas, qui est la méthode d’Index.</span><span class="sxs-lookup"><span data-stu-id="da3a6-209">In this case, that's the Index method.</span></span>

#### <a name="displaying-invalid-form-submissions-with-validation-errors"></a><span data-ttu-id="da3a6-210">Affichage des envois de formulaire non valide avec des erreurs de Validation</span><span class="sxs-lookup"><span data-stu-id="da3a6-210">Displaying invalid form submissions with Validation Errors</span></span>

<span data-ttu-id="da3a6-211">Dans le cas d’entrée de formulaire non valide, les valeurs de liste déroulante sont ajoutés à l’élément ViewBag (comme dans le cas de HTTP-GET) et les valeurs du modèle lié sont transmises à la vue pour l’affichage.</span><span class="sxs-lookup"><span data-stu-id="da3a6-211">In the case of invalid form input, the dropdown values are added to the ViewBag (as in the HTTP-GET case) and the bound model values are passed back to the view for display.</span></span> <span data-ttu-id="da3a6-212">Erreurs de validation sont automatiquement affichés à l’aide de la @Html.ValidationMessageFor programme d’assistance HTML.</span><span class="sxs-lookup"><span data-stu-id="da3a6-212">Validation errors are automatically displayed using the @Html.ValidationMessageFor HTML Helper.</span></span>

#### <a name="testing-the-create-form"></a><span data-ttu-id="da3a6-213">Le formulaire de création de test</span><span class="sxs-lookup"><span data-stu-id="da3a6-213">Testing the Create Form</span></span>

<span data-ttu-id="da3a6-214">Pour tester cela, exécutez l’application et les parcourir à /StoreManager/Create / - cette opération affiche le formulaire vierge qui a été retourné par la méthode StoreController créer HTTP-GET.</span><span class="sxs-lookup"><span data-stu-id="da3a6-214">To test this out, run the application and browse to /StoreManager/Create/ - this will show you the blank form which was returned by the StoreController Create HTTP-GET method.</span></span>

<span data-ttu-id="da3a6-215">Remplir certaines valeurs, puis cliquez sur le bouton Créer pour envoyer le formulaire.</span><span class="sxs-lookup"><span data-stu-id="da3a6-215">Fill in some values and click the Create button to submit the form.</span></span>

![](mvc-music-store-part-5/_static/image7.png)

![](mvc-music-store-part-5/_static/image8.png)

### <a name="handling-edits"></a><span data-ttu-id="da3a6-216">La gestion des modifications</span><span class="sxs-lookup"><span data-stu-id="da3a6-216">Handling Edits</span></span>

<span data-ttu-id="da3a6-217">La paire d’action de modification (HTTP-GET et HTTP-POST) est très semblable aux méthodes d’action créer que nous.</span><span class="sxs-lookup"><span data-stu-id="da3a6-217">The Edit action pair (HTTP-GET and HTTP-POST) are very similar to the Create action methods we just looked at.</span></span> <span data-ttu-id="da3a6-218">Étant donné que le scénario de modification implique de travailler avec un album existant, la méthode charge de l’Album en fonction du paramètre « id », HTTP-GET à modifier transmises via l’itinéraire.</span><span class="sxs-lookup"><span data-stu-id="da3a6-218">Since the edit scenario involves working with an existing album, the Edit HTTP-GET method loads the Album based on the "id" parameter, passed in via the route.</span></span> <span data-ttu-id="da3a6-219">Ce code pour récupérer un album par AlbumId est le même que nous avons présenté précédemment dans l’action de contrôleur de détails.</span><span class="sxs-lookup"><span data-stu-id="da3a6-219">This code for retrieving an album by AlbumId is the same as we've previously looked at in the Details controller action.</span></span> <span data-ttu-id="da3a6-220">Comme avec la création / HTTP-GET (méthode), la liste déroulante de valeurs sont retournées via l’élément ViewBag.</span><span class="sxs-lookup"><span data-stu-id="da3a6-220">As with the Create / HTTP-GET method, the drop down values are returned via the ViewBag.</span></span> <span data-ttu-id="da3a6-221">Cela nous permet à retourner un Album comme notre modèle d’objet à la vue (qui est fortement typée à la classe Album) lors de la transmission des données supplémentaires (par exemple, une liste de Genres) via l’élément ViewBag.</span><span class="sxs-lookup"><span data-stu-id="da3a6-221">This allows us to return an Album as our model object to the view (which is strongly typed to the Album class) while passing additional data (e.g. a list of Genres) via the ViewBag.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample11.cs)]

<span data-ttu-id="da3a6-222">L’action HTTP-POST modifier est très similaire à l’action de création de HTTP-POST.</span><span class="sxs-lookup"><span data-stu-id="da3a6-222">The Edit HTTP-POST action is very similar to the Create HTTP-POST action.</span></span> <span data-ttu-id="da3a6-223">La seule différence est que, au lieu d’ajouter un nouvel album à la base de données. Collection d’albums, nous avons observé l’instance actuelle de l’Album à l’aide de la base de données. Entry(album) et en définissant son état Modified.</span><span class="sxs-lookup"><span data-stu-id="da3a6-223">The only difference is that instead of adding a new album to the db.Albums collection, we're finding the current instance of the Album using db.Entry(album) and setting its state to Modified.</span></span> <span data-ttu-id="da3a6-224">Cela indique à Entity Framework que nous sommes en train de modifier un album existant au lieu de créer un nouveau.</span><span class="sxs-lookup"><span data-stu-id="da3a6-224">This tells Entity Framework that we are modifying an existing album as opposed to creating a new one.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample12.cs)]

<span data-ttu-id="da3a6-225">Nous pouvons tester par l’application en cours d’exécution et accédant à/StoreManger /, puis en cliquant sur le lien Modifier pour un album.</span><span class="sxs-lookup"><span data-stu-id="da3a6-225">We can test this out by running the application and browsing to /StoreManger/, then clicking the Edit link for an album.</span></span>

![](mvc-music-store-part-5/_static/image9.png)

<span data-ttu-id="da3a6-226">Cela affiche le formulaire d’édition indiqué par la méthode HTTP-GET modifier.</span><span class="sxs-lookup"><span data-stu-id="da3a6-226">This displays the Edit form shown by the Edit HTTP-GET method.</span></span> <span data-ttu-id="da3a6-227">Remplir certaines valeurs, puis cliquez sur le bouton Enregistrer.</span><span class="sxs-lookup"><span data-stu-id="da3a6-227">Fill in some values and click the Save button.</span></span>

![](mvc-music-store-part-5/_static/image10.png)

<span data-ttu-id="da3a6-228">Publie le formulaire, enregistre les valeurs, il nous ramène à la liste des albums, indiquant que les valeurs ont été mis à jour.</span><span class="sxs-lookup"><span data-stu-id="da3a6-228">This posts the form, saves the values, and returns us to the Album list, showing that the values were updated.</span></span>

![](mvc-music-store-part-5/_static/image11.png)

### <a name="handling-deletion"></a><span data-ttu-id="da3a6-229">Suppression de la gestion</span><span class="sxs-lookup"><span data-stu-id="da3a6-229">Handling Deletion</span></span>

<span data-ttu-id="da3a6-230">Suppression suit le même modèle que modifier et créer, à l’aide d’action d’un contrôleur pour afficher l’écran de confirmation et une autre action de contrôleur pour gérer l’envoi du formulaire.</span><span class="sxs-lookup"><span data-stu-id="da3a6-230">Deletion follows the same pattern as Edit and Create, using one controller action to display the confirmation form, and another controller action to handle the form submission.</span></span>

<span data-ttu-id="da3a6-231">L’action du contrôleur HTTP-GET Delete est identique à notre action de contrôleur Store Manager détails précédente.</span><span class="sxs-lookup"><span data-stu-id="da3a6-231">The HTTP-GET Delete controller action is exactly the same as our previous Store Manager Details controller action.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample13.cs)]

<span data-ttu-id="da3a6-232">Pour un type Album, en utilisant le modèle de contenu de la vue Delete, nous affichons un formulaire qui est fortement typé.</span><span class="sxs-lookup"><span data-stu-id="da3a6-232">We display a form that's strongly typed to an Album type, using the Delete view content template.</span></span>

![](mvc-music-store-part-5/_static/image12.png)

<span data-ttu-id="da3a6-233">Le modèle de suppression affiche tous les champs pour le modèle, mais nous pouvons simplifier mal que vers le bas.</span><span class="sxs-lookup"><span data-stu-id="da3a6-233">The Delete template shows all the fields for the model, but we can simplify that down quite a bit.</span></span> <span data-ttu-id="da3a6-234">Modifiez l’affichage du code dans /Views/StoreManager/Delete.cshtml comme suit.</span><span class="sxs-lookup"><span data-stu-id="da3a6-234">Change the view code in /Views/StoreManager/Delete.cshtml to the following.</span></span>

[!code-cshtml[Main](mvc-music-store-part-5/samples/sample14.cshtml)]

<span data-ttu-id="da3a6-235">Cela affiche une confirmation de suppression simplifiée.</span><span class="sxs-lookup"><span data-stu-id="da3a6-235">This displays a simplified Delete confirmation.</span></span>

![](mvc-music-store-part-5/_static/image13.png)

<span data-ttu-id="da3a6-236">En cliquant sur le bouton Supprimer entraîne le formulaire à être publié sur le serveur qui exécute l’action DeleteConfirmed.</span><span class="sxs-lookup"><span data-stu-id="da3a6-236">Clicking the Delete button causes the form to be posted back to the server, which executes the DeleteConfirmed action.</span></span>

[!code-csharp[Main](mvc-music-store-part-5/samples/sample15.cs)]

<span data-ttu-id="da3a6-237">Notre Action du contrôleur HTTP-POST supprimer effectue les actions suivantes :</span><span class="sxs-lookup"><span data-stu-id="da3a6-237">Our HTTP-POST Delete Controller Action takes the following actions:</span></span>

- 1. <span data-ttu-id="da3a6-238">Charge l’Album par ID</span><span class="sxs-lookup"><span data-stu-id="da3a6-238">Loads the Album by ID</span></span>
- 2. <span data-ttu-id="da3a6-239">Il supprime l’album et enregistrer les modifications</span><span class="sxs-lookup"><span data-stu-id="da3a6-239">Deletes it the album and save changes</span></span>
- 3. <span data-ttu-id="da3a6-240">Effectue une redirection vers l’Index, indiquant que l’Album a été supprimé de la liste</span><span class="sxs-lookup"><span data-stu-id="da3a6-240">Redirects to the Index, showing that the Album was removed from the list</span></span>

<span data-ttu-id="da3a6-241">Pour tester cela, exécutez l’application et accédez à /StoreManager.</span><span class="sxs-lookup"><span data-stu-id="da3a6-241">To test this, run the application and browse to /StoreManager.</span></span> <span data-ttu-id="da3a6-242">Sélectionnez un album à partir de la liste et cliquez sur le lien Supprimer.</span><span class="sxs-lookup"><span data-stu-id="da3a6-242">Select an album from the list and click the Delete link.</span></span>

![](mvc-music-store-part-5/_static/image14.png)

<span data-ttu-id="da3a6-243">Cela affiche notre écran de confirmation de suppression.</span><span class="sxs-lookup"><span data-stu-id="da3a6-243">This displays our Delete confirmation screen.</span></span>

![](mvc-music-store-part-5/_static/image15.png)

<span data-ttu-id="da3a6-244">En cliquant sur le bouton Supprimer supprime l’album et nous ramène à la page d’Index de gestionnaire de magasin, ce qui indique que l’album a été supprimé.</span><span class="sxs-lookup"><span data-stu-id="da3a6-244">Clicking the Delete button removes the album and returns us to the Store Manager Index page, which shows that the album has been deleted.</span></span>

![](mvc-music-store-part-5/_static/image16.png)

### <a name="using-a-custom-html-helper-to-truncate-text"></a><span data-ttu-id="da3a6-245">À l’aide d’un programme d’assistance HTML personnalisé pour le texte tronqué</span><span class="sxs-lookup"><span data-stu-id="da3a6-245">Using a custom HTML Helper to truncate text</span></span>

<span data-ttu-id="da3a6-246">Nous avons un problème potentiel avec notre page d’Index de gestionnaire de magasin.</span><span class="sxs-lookup"><span data-stu-id="da3a6-246">We've got one potential issue with our Store Manager Index page.</span></span> <span data-ttu-id="da3a6-247">Notre propriétés du titre de l’Album et le nom de l’auteur peuvent tous deux être suffisamment longue qu’ils pourrait lever off notre table mise en forme.</span><span class="sxs-lookup"><span data-stu-id="da3a6-247">Our Album Title and Artist Name properties can both be long enough that they could throw off our table formatting.</span></span> <span data-ttu-id="da3a6-248">Nous allons créer un programme d’assistance HTML personnalisé pour nous permettent de facilement tronquer ces autres propriétés et dans nos vues.</span><span class="sxs-lookup"><span data-stu-id="da3a6-248">We'll create a custom HTML Helper to allow us to easily truncate these and other properties in our Views.</span></span>

![](mvc-music-store-part-5/_static/image17.png)

<span data-ttu-id="da3a6-249">De Razor @helper syntaxe devenue assez facile à créer vos propres fonctions d’assistance pour une utilisation dans les vues.</span><span class="sxs-lookup"><span data-stu-id="da3a6-249">Razor's @helper syntax has made it pretty easy to create your own helper functions for use in your views.</span></span> <span data-ttu-id="da3a6-250">Ouvrez l’affichage /Views/StoreManager/Index.cshtml et ajoutez le code suivant directement après le @model ligne.</span><span class="sxs-lookup"><span data-stu-id="da3a6-250">Open the /Views/StoreManager/Index.cshtml view and add the following code directly after the @model line.</span></span>

[!code-cshtml[Main](mvc-music-store-part-5/samples/sample16.cshtml)]

<span data-ttu-id="da3a6-251">Cette méthode d’assistance prend une chaîne et une longueur maximale à autoriser.</span><span class="sxs-lookup"><span data-stu-id="da3a6-251">This helper method takes a string and a maximum length to allow.</span></span> <span data-ttu-id="da3a6-252">Si le texte fourni est inférieur à la longueur spécifiée, le programme d’assistance renvoie en tant que-est.</span><span class="sxs-lookup"><span data-stu-id="da3a6-252">If the text supplied is shorter than the length specified, the helper outputs it as-is.</span></span> <span data-ttu-id="da3a6-253">S’il est plus long, il tronque le texte et restitue «... » pour le reste.</span><span class="sxs-lookup"><span data-stu-id="da3a6-253">If it is longer, then it truncates the text and renders "…" for the remainder.</span></span>

<span data-ttu-id="da3a6-254">Maintenant, nous pouvons utiliser notre programme d’assistance de troncation pour vous assurer que le titre de l’Album et le nom de l’auteur des propriétés sont moins de 25 caractères.</span><span class="sxs-lookup"><span data-stu-id="da3a6-254">Now we can use our Truncate helper to ensure that both the Album Title and Artist Name properties are less than 25 characters.</span></span> <span data-ttu-id="da3a6-255">Le code de la vue complète à l’aide de notre nouveau programme d’assistance Truncate apparaît ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="da3a6-255">The complete view code using our new Truncate helper appears below.</span></span>

[!code-cshtml[Main](mvc-music-store-part-5/samples/sample17.cshtml)]

<span data-ttu-id="da3a6-256">Maintenant lorsque nous parcourir l’URL /StoreManager/, les albums et les titres sont conservées sous notre longueurs maximales.</span><span class="sxs-lookup"><span data-stu-id="da3a6-256">Now when we browse the /StoreManager/ URL, the albums and titles are kept below our maximum lengths.</span></span>

![](mvc-music-store-part-5/_static/image18.png)

<span data-ttu-id="da3a6-257">Remarque : Cela indique un cas simple de la création et à l’aide d’un programme d’assistance dans une vue.</span><span class="sxs-lookup"><span data-stu-id="da3a6-257">Note: This shows the simple case of creating and using a helper in one view.</span></span> <span data-ttu-id="da3a6-258">Pour en savoir plus sur la création de programmes d’assistance que vous pouvez utiliser tout au long de votre site, consultez mon blog : [http://bit.ly/mvc3-helper-options](http://bit.ly/mvc3-helper-options)</span><span class="sxs-lookup"><span data-stu-id="da3a6-258">To learn more about creating helpers that you can use throughout your site, see my blog post: [http://bit.ly/mvc3-helper-options](http://bit.ly/mvc3-helper-options)</span></span>


> [!div class="step-by-step"]
> <span data-ttu-id="da3a6-259">[Précédent](mvc-music-store-part-4.md)
> [Suivant](mvc-music-store-part-6.md)</span><span class="sxs-lookup"><span data-stu-id="da3a6-259">[Previous](mvc-music-store-part-4.md)
[Next](mvc-music-store-part-6.md)</span></span>
