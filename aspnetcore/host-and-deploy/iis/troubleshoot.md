---
title: "Résoudre les problèmes de base ASP.NET sur IIS"
author: guardrex
description: "Découvrez comment diagnostiquer les problèmes avec les déploiements d’applications ASP.NET Core IIS."
manager: wpickett
ms.author: riande
ms.custom: mvc
ms.date: 03/13/2017
ms.prod: asp.net-core
ms.technology: aspnet
ms.topic: article
uid: host-and-deploy/iis/troubleshoot
ms.openlocfilehash: c68070a9cba5667504d1ad4927b02b73f83e6573
ms.sourcegitcommit: a510f38930abc84c4b302029d019a34dfe76823b
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/30/2018
---
# <a name="troubleshoot-aspnet-core-on-iis"></a><span data-ttu-id="dce99-103">Résoudre les problèmes de base ASP.NET sur IIS</span><span class="sxs-lookup"><span data-stu-id="dce99-103">Troubleshoot ASP.NET Core on IIS</span></span>

<span data-ttu-id="dce99-104">Par [Luke Latham](https://github.com/guardrex)</span><span class="sxs-lookup"><span data-stu-id="dce99-104">By [Luke Latham](https://github.com/guardrex)</span></span>

<span data-ttu-id="dce99-105">Pour diagnostiquer les problèmes liés aux déploiements d’IIS :</span><span class="sxs-lookup"><span data-stu-id="dce99-105">To diagnose issues with IIS deployments:</span></span>

* <span data-ttu-id="dce99-106">Analysez la sortie du navigateur.</span><span class="sxs-lookup"><span data-stu-id="dce99-106">Study browser output.</span></span>
* <span data-ttu-id="dce99-107">Examinez le journal des **applications** du système avec **l’Observateur d’événements**.</span><span class="sxs-lookup"><span data-stu-id="dce99-107">Examine the system's **Application** log through **Event Viewer**.</span></span>
* <span data-ttu-id="dce99-108">Activez la journalisation `stdout`.</span><span class="sxs-lookup"><span data-stu-id="dce99-108">Enable `stdout` logging.</span></span> <span data-ttu-id="dce99-109">Le journal du **Module ASP.NET Core** se trouve dans le chemin fourni dans l’attribut *stdoutLogFile* de l’élément `<aspNetCore>` dans *web.config*. Tous les dossiers sur le chemin fourni dans la valeur d’attribut doivent exister dans le déploiement.</span><span class="sxs-lookup"><span data-stu-id="dce99-109">The **ASP.NET Core Module** log is found on the path provided in the *stdoutLogFile* attribute of the `<aspNetCore>` element in *web.config*. Any folders on the path provided in the attribute value must exist in the deployment.</span></span> <span data-ttu-id="dce99-110">Définissez *stdoutLogEnabled* à `true`.</span><span class="sxs-lookup"><span data-stu-id="dce99-110">Set *stdoutLogEnabled* to `true`.</span></span> <span data-ttu-id="dce99-111">Applications qui utilisent le le `Microsoft.NET.Sdk.Web` Kit de développement logiciel pour créer le *web.config* de fichiers par défaut le *stdoutLogEnabled* à `false`fournir manuellement le *web.config* de fichiers ou de modifier le fichier afin d’activer `stdout` journalisation.</span><span class="sxs-lookup"><span data-stu-id="dce99-111">Apps that use the the `Microsoft.NET.Sdk.Web` SDK to create the *web.config* file default the *stdoutLogEnabled* setting to `false`, so manually provide the *web.config* file or modify the file in order to enable `stdout` logging.</span></span>

<span data-ttu-id="dce99-112">Utilisez les informations de ces trois sources avec le [les erreurs courantes référencent rubrique](xref:host-and-deploy/azure-iis-errors-reference) pour déterminer le problème.</span><span class="sxs-lookup"><span data-stu-id="dce99-112">Use information from those three sources with the [common errors reference topic](xref:host-and-deploy/azure-iis-errors-reference) to determine the problem.</span></span> <span data-ttu-id="dce99-113">Suivez les conseils de dépannage permettant de résoudre le problème.</span><span class="sxs-lookup"><span data-stu-id="dce99-113">Follow the troubleshooting advice provided to resolve the issue.</span></span>

<span data-ttu-id="dce99-114">Plusieurs erreurs courantes n’apparaissent pas dans le navigateur, le journal des applications et le journal du Module ASP.NET Core tant que les valeurs *startupTimeLimit* (par défaut : 120 secondes) et *startupRetryCount* (par défaut : 2) du module ne sont pas dépassées.</span><span class="sxs-lookup"><span data-stu-id="dce99-114">Several of the common errors don't appear in the browser, Application Log, and ASP.NET Core Module Log until the module *startupTimeLimit* (default: 120 seconds) and *startupRetryCount* (default: 2) have passed.</span></span> <span data-ttu-id="dce99-115">Vous devez donc patienter six minutes avant d’en déduire que le module n’a pas réussi à démarrer un processus pour l’application.</span><span class="sxs-lookup"><span data-stu-id="dce99-115">Therefore, wait a full six minutes before deducing that the module has failed to start a process for the app.</span></span>

<span data-ttu-id="dce99-116">Un moyen rapide de déterminer si l’application fonctionne correctement consiste à exécuter l’application directement sur Kestrel.</span><span class="sxs-lookup"><span data-stu-id="dce99-116">One quick way to determine if the app is working properly is to run the app directly on Kestrel.</span></span> <span data-ttu-id="dce99-117">Si l’application a été publiée en tant qu’un [dépendant du framework déploiement](/dotnet/core/deploying/#framework-dependent-deployments-fdd), exécutez `dotnet <assembly_name>.dll` dans le dossier de déploiement, qui est le chemin d’accès physique de IIS à l’application.</span><span class="sxs-lookup"><span data-stu-id="dce99-117">If the app was published as a [framework-dependent deployment](/dotnet/core/deploying/#framework-dependent-deployments-fdd), execute `dotnet <assembly_name>.dll` in the deployment folder, which is the IIS physical path to the app.</span></span> <span data-ttu-id="dce99-118">Si l’application a été publiée en tant qu’un [déploiement autonome](/dotnet/core/deploying/#self-contained-deployments-scd), exécutez le fichier exécutable directement à partir d’une invite de commandes, de l’application `<assembly_name>.exe`, dans le dossier de déploiement.</span><span class="sxs-lookup"><span data-stu-id="dce99-118">If the app was published as a [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd), run the app's executable directly from a command prompt, `<assembly_name>.exe`, in the deployment folder.</span></span> <span data-ttu-id="dce99-119">Si Kestrel est à l’écoute sur le port par défaut 5000, l’application doit être disponible à l’adresse `http://localhost:5000/`.</span><span class="sxs-lookup"><span data-stu-id="dce99-119">If Kestrel is listening on default port 5000, the app should be available at `http://localhost:5000/`.</span></span> <span data-ttu-id="dce99-120">Si l’application répond généralement à l’adresse de point de terminaison Kestrel, le problème est probablement lié à la configuration de proxy inverse et moins probable au sein de l’application.</span><span class="sxs-lookup"><span data-stu-id="dce99-120">If the app responds normally at the Kestrel endpoint address, the problem is more likely related to the reverse proxy configuration and less likely within the app.</span></span>

<span data-ttu-id="dce99-121">Pour déterminer si le proxy inverse fonctionne correctement consiste à effectuer une demande de fichier statique simple pour une feuille de style, un script ou une image à partir de fichiers statiques de l’application dans *wwwroot* à l’aide de [fichier statique intergiciel (middleware)](xref:fundamentals/static-files).</span><span class="sxs-lookup"><span data-stu-id="dce99-121">One way to determine if the reverse proxy is working properly is to perform a simple static file request for a stylesheet, script, or image from the app's static files in *wwwroot* using [Static File Middleware](xref:fundamentals/static-files).</span></span> <span data-ttu-id="dce99-122">Si l’application peut traiter des fichiers statiques, mais les autres points de terminaison et les vues MVC échouent, le problème est moins probable liés à la configuration de proxy inverse et plus probable que l’application (par exemple, le routage MVC ou 500 Erreur interne au serveur).</span><span class="sxs-lookup"><span data-stu-id="dce99-122">If the app can serve static files but MVC Views and other endpoints are failing, the problem is less likely related to the reverse proxy configuration and more likely within the app (for example, MVC routing or 500 Internal Server Error).</span></span>

<span data-ttu-id="dce99-123">Lorsque Kestrel démarre normalement derrière IIS, mais l’application ne s’exécute pas sur le système après avoir correctement exécuté localement, une variable d’environnement peut être ajoutée temporairement à *web.config* pour définir le `ASPNETCORE_ENVIRONMENT` à `Development`.</span><span class="sxs-lookup"><span data-stu-id="dce99-123">When Kestrel starts normally behind IIS but the app won't run on the system after successfully running locally, an environment variable can be temporarily added to *web.config* to set the `ASPNETCORE_ENVIRONMENT` to `Development`.</span></span> <span data-ttu-id="dce99-124">Tant que l’environnement n’est pas substitué dans le démarrage de l’application, la définition de la variable d’environnement permet la [page d’exception developer](xref:fundamentals/error-handling) apparaissent lorsque l’application est exécutée.</span><span class="sxs-lookup"><span data-stu-id="dce99-124">As long as the environment isn't overridden in app startup, setting the environment variable allows the [developer exception page](xref:fundamentals/error-handling) to appear when the app is run.</span></span> <span data-ttu-id="dce99-125">Définition de la variable d’environnement `ASPNETCORE_ENVIRONMENT` de cette façon est recommandé uniquement pour les serveurs intermédiaires et les tests qui ne sont pas exposés à Internet.</span><span class="sxs-lookup"><span data-stu-id="dce99-125">Setting the environment variable for `ASPNETCORE_ENVIRONMENT` in this way is only recommended for staging/testing servers that aren't exposed to the Internet.</span></span> <span data-ttu-id="dce99-126">Veillez à supprimer la variable d’environnement à partir de la *web.config* lors de la fin du fichier.</span><span class="sxs-lookup"><span data-stu-id="dce99-126">Be sure to remove the environment variable from the *web.config* file when finished.</span></span> <span data-ttu-id="dce99-127">Pour plus d’informations sur la définition des variables d’environnement via *web.config*, consultez [élément enfant d’environmentVariables d’aspNetCore](xref:host-and-deploy/aspnet-core-module#setting-environment-variables).</span><span class="sxs-lookup"><span data-stu-id="dce99-127">For information on setting environment variables via *web.config*, see [environmentVariables child element of aspNetCore](xref:host-and-deploy/aspnet-core-module#setting-environment-variables).</span></span>

<span data-ttu-id="dce99-128">Dans la plupart des cas, l’activation de la journalisation de l’application aide à résoudre les problèmes liés à l’application ou au proxy inverse.</span><span class="sxs-lookup"><span data-stu-id="dce99-128">In most cases, enabling application logging assists in troubleshooting problems with the app or the reverse proxy.</span></span> <span data-ttu-id="dce99-129">Pour plus d’informations, consultez [Journalisation](xref:fundamentals/logging/index).</span><span class="sxs-lookup"><span data-stu-id="dce99-129">See [Logging](xref:fundamentals/logging/index) for more information.</span></span>

<span data-ttu-id="dce99-130">Le dernier conseil de dépannage relative aux applications qui ne parviennent pas à exécuter après la mise à niveau le Kit de développement logiciel .NET Core sur les versions de machine ou un package de développement au sein de l’application.</span><span class="sxs-lookup"><span data-stu-id="dce99-130">The last troubleshooting tip pertains to apps that fail to run after upgrading either the .NET Core SDK on the development machine or package versions within the app.</span></span> <span data-ttu-id="dce99-131">Dans certains cas, les packages incohérents peuvent bloquer une application quand vous effectuez des mises à niveau majeures.</span><span class="sxs-lookup"><span data-stu-id="dce99-131">In some cases, incoherent packages may break an app when performing major upgrades.</span></span> <span data-ttu-id="dce99-132">La plupart de ces problèmes peut être résolue en :</span><span class="sxs-lookup"><span data-stu-id="dce99-132">Most of these issues can be fixed by:</span></span>

* <span data-ttu-id="dce99-133">Suppression de la `bin` et `obj` dossiers dans le projet.</span><span class="sxs-lookup"><span data-stu-id="dce99-133">Deleting the `bin` and `obj` folders in the project.</span></span>
* <span data-ttu-id="dce99-134">Met en cache le package de compensation à `%UserProfile%\.nuget\packages\` et `%LocalAppData%\Nuget\v3-cache`.</span><span class="sxs-lookup"><span data-stu-id="dce99-134">Clearing package caches at `%UserProfile%\.nuget\packages\` and `%LocalAppData%\Nuget\v3-cache`.</span></span>
* <span data-ttu-id="dce99-135">La restauration et régénérer le projet.</span><span class="sxs-lookup"><span data-stu-id="dce99-135">Restoring and rebuilding the project.</span></span>
* <span data-ttu-id="dce99-136">Confirmez que le déploiement préalable sur le serveur a été supprimé complètement avant de redéployer l’application.</span><span class="sxs-lookup"><span data-stu-id="dce99-136">Confirming that the prior deployment on the server has been completely deleted prior to re-deploying the app.</span></span>

> [!TIP]
> <span data-ttu-id="dce99-137">Un moyen pratique pour effacer les caches de package consiste à exécuter `dotnet nuget locals all --clear` à partir d’une invite de commandes.</span><span class="sxs-lookup"><span data-stu-id="dce99-137">A convenient way to clear package caches is to execute `dotnet nuget locals all --clear` from a command prompt.</span></span>
> 
> <span data-ttu-id="dce99-138">Effacer les caches de package peut également être accompli en utilisant le [nuget.exe](https://www.nuget.org/downloads) outil et l’exécution de la commande `nuget locals all -clear`.</span><span class="sxs-lookup"><span data-stu-id="dce99-138">Clearing package caches can also be accomplished by using the [nuget.exe](https://www.nuget.org/downloads) tool and executing the command `nuget locals all -clear`.</span></span> <span data-ttu-id="dce99-139">*NuGet.exe* n’est pas une installation fournie avec Windows 10 et doivent être obtenues séparément à partir du site Web NuGet.</span><span class="sxs-lookup"><span data-stu-id="dce99-139">*nuget.exe* isn't a bundled install with Windows 10 and must be obtained separately from the NuGet website.</span></span>
<!--
> [!TIP]
> A convenient way to clear package caches is to:
>
> * Obtain the *NuGet.exe* tool from [NuGet.org](https://www.nuget.org/).
> * Add the path to *NuGet.exe* to the system PATH.
> * Execute `nuget locals all -clear` from a command prompt.
>
> Alternatively, execute `dotnet nuget locals all --clear` from a command prompt without obtaining *NuGet.exe*. -->

## <a name="additional-resources"></a><span data-ttu-id="dce99-140">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="dce99-140">Additional resources</span></span>

* [<span data-ttu-id="dce99-141">Informations de référence sur les erreurs courantes pour Azure App Service et IIS avec ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="dce99-141">Common errors reference for Azure App Service and IIS with ASP.NET Core</span></span>](xref:host-and-deploy/azure-iis-errors-reference)
* [<span data-ttu-id="dce99-142">Informations de référence sur la configuration du Module ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="dce99-142">ASP.NET Core Module configuration reference</span></span>](xref:host-and-deploy/aspnet-core-module)
