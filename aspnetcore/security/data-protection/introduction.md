---
title: Protection des données ASP.NET Core
author: rick-anderson
description: En savoir plus sur le concept de protection des données et les principes de conception de l’API de Protection de données ASP.NET Core.
manager: wpickett
ms.author: riande
ms.date: 10/14/2016
ms.prod: asp.net-core
ms.technology: aspnet
ms.topic: article
uid: security/data-protection/introduction
ms.openlocfilehash: 56876f43ed48b577f4d870825fd9230f526baec3
ms.sourcegitcommit: 9a35906446af7ffd4ccfc18daec38874b5abbef7
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/18/2018
ms.locfileid: "35725950"
---
# <a name="aspnet-core-data-protection"></a><span data-ttu-id="8c74f-103">Protection des données ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="8c74f-103">ASP.NET Core Data Protection</span></span>

<span data-ttu-id="8c74f-104">Les applications Web doivent souvent stocker les données sensibles pour la sécurité.</span><span class="sxs-lookup"><span data-stu-id="8c74f-104">Web applications often need to store security-sensitive data.</span></span> <span data-ttu-id="8c74f-105">Windows fournit DPAPI pour les applications de bureau, mais il ne convient pas pour les applications web.</span><span class="sxs-lookup"><span data-stu-id="8c74f-105">Windows provides DPAPI for desktop applications but this is unsuitable for web applications.</span></span> <span data-ttu-id="8c74f-106">La pile de protection de données ASP.NET Core fournissent une API de chiffrement simple et facile à utiliser, un développeur peut utiliser pour protéger les données, y compris la rotation et gestion de clés.</span><span class="sxs-lookup"><span data-stu-id="8c74f-106">The ASP.NET Core data protection stack provide a simple, easy to use cryptographic API a developer can use to protect data, including key management and rotation.</span></span>

<span data-ttu-id="8c74f-107">La pile de protection de données ASP.NET Core est conçue pour servir de remplacement à long terme pour le &lt;machineKey&gt; élément dans ASP.NET 1.x - 4.x.</span><span class="sxs-lookup"><span data-stu-id="8c74f-107">The ASP.NET Core data protection stack is designed to serve as the long-term replacement for the &lt;machineKey&gt; element in ASP.NET 1.x - 4.x.</span></span> <span data-ttu-id="8c74f-108">Il a été conçu pour traiter une bonne partie des lacunes de la pile de services de chiffrement ancien tout en fournissant une solution à l’emploi pour la majorité des cas d’utilisation des applications modernes sont susceptibles de rencontrer.</span><span class="sxs-lookup"><span data-stu-id="8c74f-108">It was designed to address many of the shortcomings of the old cryptographic stack while providing an out-of-the-box solution for the majority of use cases modern applications are likely to encounter.</span></span>

## <a name="problem-statement"></a><span data-ttu-id="8c74f-109">Énoncé du problème</span><span class="sxs-lookup"><span data-stu-id="8c74f-109">Problem statement</span></span>

<span data-ttu-id="8c74f-110">L’instruction problème global peut être établie succinctement dans une phrase unique : j’ai besoin de conserver les informations approuvées pour une récupération ultérieure, mais vous ne faites pas confiance le mécanisme de persistance.</span><span class="sxs-lookup"><span data-stu-id="8c74f-110">The overall problem statement can be succinctly stated in a single sentence: I need to persist trusted information for later retrieval, but I don't trust the persistence mechanism.</span></span> <span data-ttu-id="8c74f-111">Cela peut être écrite en termes de web, comme « Ai-je besoin pour effectuer un aller-retour état approuvé via un client non fiable ».</span><span class="sxs-lookup"><span data-stu-id="8c74f-111">In web terms, this might be written as "I need to round-trip trusted state via an untrusted client."</span></span>

<span data-ttu-id="8c74f-112">L’exemple canonique de ce est un cookie d’authentification ou au porteur jeton.</span><span class="sxs-lookup"><span data-stu-id="8c74f-112">The canonical example of this is an authentication cookie or bearer token.</span></span> <span data-ttu-id="8c74f-113">Le serveur génère un « Je suis Groot et disposer des autorisations de xyz » du jeton et qu’il transmet au client.</span><span class="sxs-lookup"><span data-stu-id="8c74f-113">The server generates an "I am Groot and have xyz permissions" token and hands it to the client.</span></span> <span data-ttu-id="8c74f-114">Ultérieurement, le client présentera ce jeton sur le serveur, mais le serveur doit quelconque d’assurance que le client n’est pas falsifié le jeton.</span><span class="sxs-lookup"><span data-stu-id="8c74f-114">At some future date the client will present that token back to the server, but the server needs some kind of assurance that the client hasn't forged the token.</span></span> <span data-ttu-id="8c74f-115">Par conséquent, la première exigence : authenticité (aussi appelé)</span><span class="sxs-lookup"><span data-stu-id="8c74f-115">Thus the first requirement: authenticity (a.k.a.</span></span> <span data-ttu-id="8c74f-116">l’intégrité, vérification de falsification).</span><span class="sxs-lookup"><span data-stu-id="8c74f-116">integrity, tamper-proofing).</span></span>

<span data-ttu-id="8c74f-117">Étant donné que l’état persistant est approuvé par le serveur, nous estimons que cet état peut contenir des informations spécifiques à l’environnement d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="8c74f-117">Since the persisted state is trusted by the server, we anticipate that this state might contain information that's specific to the operating environment.</span></span> <span data-ttu-id="8c74f-118">Cela peut être sous la forme d’un chemin d’accès de fichier, une autorisation, un handle ou une autre référence indirecte, ou certains autres éléments de données de serveur spécifiques.</span><span class="sxs-lookup"><span data-stu-id="8c74f-118">This could be in the form of a file path, a permission, a handle or other indirect reference, or some other piece of server-specific data.</span></span> <span data-ttu-id="8c74f-119">Ces informations ne doivent généralement pas être divulguées à un client non fiable.</span><span class="sxs-lookup"><span data-stu-id="8c74f-119">Such information should generally not be disclosed to an untrusted client.</span></span> <span data-ttu-id="8c74f-120">Par conséquent, la deuxième spécification : la confidentialité.</span><span class="sxs-lookup"><span data-stu-id="8c74f-120">Thus the second requirement: confidentiality.</span></span>

<span data-ttu-id="8c74f-121">Enfin, étant donné que les applications modernes sont basées sur des composants que nous avons vu est que les composants individuels voulez tirer parti de ce système sans tenir compte des autres composants dans le système.</span><span class="sxs-lookup"><span data-stu-id="8c74f-121">Finally, since modern applications are componentized, what we've seen is that individual components will want to take advantage of this system without regard to other components in the system.</span></span> <span data-ttu-id="8c74f-122">Par exemple, si un composant d’émission de jeton de support à l’aide de cette pile, elle doit fonctionner sans interférence à partir d’un mécanisme d’anti-CSRF qui peut également être à l’aide de la même pile.</span><span class="sxs-lookup"><span data-stu-id="8c74f-122">For instance, if a bearer token component is using this stack, it should operate without interference from an anti-CSRF mechanism that might also be using the same stack.</span></span> <span data-ttu-id="8c74f-123">Par conséquent, la spécification finale : isolation.</span><span class="sxs-lookup"><span data-stu-id="8c74f-123">Thus the final requirement: isolation.</span></span>

<span data-ttu-id="8c74f-124">Nous pouvons fournir des contraintes supplémentaires afin de limiter la portée de la configuration requise.</span><span class="sxs-lookup"><span data-stu-id="8c74f-124">We can provide further constraints in order to narrow the scope of our requirements.</span></span> <span data-ttu-id="8c74f-125">Nous partons du principe que tous les services d’exploitation dans le système de cryptage par sont également approuvés et que les données n’a pas besoin d’être généré ou consommés en dehors des services sous notre contrôle direct.</span><span class="sxs-lookup"><span data-stu-id="8c74f-125">We assume that all services operating within the cryptosystem are equally trusted and that the data doesn't need to be generated or consumed outside of the services under our direct control.</span></span> <span data-ttu-id="8c74f-126">En outre, nous avons besoin que les opérations sont aussi rapides que possible, car chaque demande au service web peut accéder via le système de cryptage par une ou plusieurs fois.</span><span class="sxs-lookup"><span data-stu-id="8c74f-126">Furthermore, we require that operations are as fast as possible since each request to the web service might go through the cryptosystem one or more times.</span></span> <span data-ttu-id="8c74f-127">Cela rend le chiffrement symétrique idéale pour notre scénario, et nous pouvons discount cryptographie asymétrique tant que tels, une fois qu’il est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="8c74f-127">This makes symmetric cryptography ideal for our scenario, and we can discount asymmetric cryptography until such a time that it's needed.</span></span>

## <a name="design-philosophy"></a><span data-ttu-id="8c74f-128">Philosophie de conception</span><span class="sxs-lookup"><span data-stu-id="8c74f-128">Design philosophy</span></span>

<span data-ttu-id="8c74f-129">Nous avons commencé en identifiant les problèmes liés à la pile existante.</span><span class="sxs-lookup"><span data-stu-id="8c74f-129">We started by identifying problems with the existing stack.</span></span> <span data-ttu-id="8c74f-130">Une fois que nous avons eu qui, nous le paysage des solutions existantes de mener une enquête et conclu qu’aucune solution existante ne devait tout à fait les fonctionnalités que nous avons recherché.</span><span class="sxs-lookup"><span data-stu-id="8c74f-130">Once we had that, we surveyed the landscape of existing solutions and concluded that no existing solution quite had the capabilities we sought.</span></span> <span data-ttu-id="8c74f-131">Ensuite, nous avons conçu une solution basée sur plusieurs principes.</span><span class="sxs-lookup"><span data-stu-id="8c74f-131">We then engineered a solution based on several guiding principles.</span></span>

* <span data-ttu-id="8c74f-132">Le système doit offrir la simplicité de configuration.</span><span class="sxs-lookup"><span data-stu-id="8c74f-132">The system should offer simplicity of configuration.</span></span> <span data-ttu-id="8c74f-133">Dans l’idéal, le système est sans aucune configuration et les développeurs peut appuyer sur le sol en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="8c74f-133">Ideally the system would be zero-configuration and developers could hit the ground running.</span></span> <span data-ttu-id="8c74f-134">Les situations où les développeurs doivent configurer un aspect spécifique (par exemple, le référentiel de clé), doit être envisagé faire en sorte que ces configurations spécifiques simple.</span><span class="sxs-lookup"><span data-stu-id="8c74f-134">In situations where developers need to configure a specific aspect (such as the key repository), consideration should be given to making those specific configurations simple.</span></span>

* <span data-ttu-id="8c74f-135">Offre une API pour les consommateurs simple.</span><span class="sxs-lookup"><span data-stu-id="8c74f-135">Offer a simple consumer-facing API.</span></span> <span data-ttu-id="8c74f-136">Les API doivent être facile d’utiliser correctement et difficile à utiliser correctement.</span><span class="sxs-lookup"><span data-stu-id="8c74f-136">The APIs should be easy to use correctly and difficult to use incorrectly.</span></span>

* <span data-ttu-id="8c74f-137">Les développeurs ne doivent pas Découvrez les principes de la gestion de clés.</span><span class="sxs-lookup"><span data-stu-id="8c74f-137">Developers shouldn't learn key management principles.</span></span> <span data-ttu-id="8c74f-138">Le système doit gérer la sélection d’un algorithme et la durée de vie de clé sur le compte de développeur.</span><span class="sxs-lookup"><span data-stu-id="8c74f-138">The system should handle algorithm selection and key lifetime on the developer's behalf.</span></span> <span data-ttu-id="8c74f-139">Dans l’idéal, le développeur ne doit jamais avoir accès au matériel de clé brut.</span><span class="sxs-lookup"><span data-stu-id="8c74f-139">Ideally the developer should never even have access to the raw key material.</span></span>

* <span data-ttu-id="8c74f-140">Les clés doivent être protégées au repos lorsque cela est possible.</span><span class="sxs-lookup"><span data-stu-id="8c74f-140">Keys should be protected at rest when possible.</span></span> <span data-ttu-id="8c74f-141">Le système doit déterminer un mécanisme de protection par défaut approprié et l’applique automatiquement.</span><span class="sxs-lookup"><span data-stu-id="8c74f-141">The system should figure out an appropriate default protection mechanism and apply it automatically.</span></span>

<span data-ttu-id="8c74f-142">Avec ces principes à l’esprit que nous avons développées simple, [facile à utiliser](xref:security/data-protection/using-data-protection) pile de protection de données.</span><span class="sxs-lookup"><span data-stu-id="8c74f-142">With these principles in mind we developed a simple, [easy to use](xref:security/data-protection/using-data-protection) data protection stack.</span></span>

<span data-ttu-id="8c74f-143">L’API de protection des données ASP.NET Core ne sont pas destinées principalement pour la persistance indéfini de charges utiles confidentielles.</span><span class="sxs-lookup"><span data-stu-id="8c74f-143">The ASP.NET Core data protection APIs are not primarily intended for indefinite persistence of confidential payloads.</span></span> <span data-ttu-id="8c74f-144">Autres technologies telles que [DPAPI CNG de Windows](https://msdn.microsoft.com/library/windows/desktop/hh706794%28v=vs.85%29.aspx) et [Azure Rights Management](https://docs.microsoft.com/rights-management/) les plus adaptés au scénario de stockage illimité, et ils ont des fonctionnalités de gestion de clé forte en conséquence.</span><span class="sxs-lookup"><span data-stu-id="8c74f-144">Other technologies like [Windows CNG DPAPI](https://msdn.microsoft.com/library/windows/desktop/hh706794%28v=vs.85%29.aspx) and [Azure Rights Management](https://docs.microsoft.com/rights-management/) are more suited to the scenario of indefinite storage, and they have correspondingly strong key management capabilities.</span></span> <span data-ttu-id="8c74f-145">Ceci dit, rien interdire à un développeur à l’aide de l’API de protection des données ASP.NET Core pour la protection à long terme des données confidentielles.</span><span class="sxs-lookup"><span data-stu-id="8c74f-145">That said, there's nothing prohibiting a developer from using the ASP.NET Core data protection APIs for long-term protection of confidential data.</span></span>

## <a name="audience"></a><span data-ttu-id="8c74f-146">Public</span><span class="sxs-lookup"><span data-stu-id="8c74f-146">Audience</span></span>

<span data-ttu-id="8c74f-147">Le système de protection des données est divisé en cinq packages principales.</span><span class="sxs-lookup"><span data-stu-id="8c74f-147">The data protection system is divided into five main packages.</span></span> <span data-ttu-id="8c74f-148">Divers aspects de ces API ciblent les trois principaux types de publics ;</span><span class="sxs-lookup"><span data-stu-id="8c74f-148">Various aspects of these APIs target three main audiences;</span></span>

1. <span data-ttu-id="8c74f-149">Le [vue d’ensemble des API de consommateur](xref:security/data-protection/consumer-apis/overview) cibler des développeurs d’applications et d’infrastructure.</span><span class="sxs-lookup"><span data-stu-id="8c74f-149">The [Consumer APIs Overview](xref:security/data-protection/consumer-apis/overview) target application and framework developers.</span></span>

   <span data-ttu-id="8c74f-150">« Je ne souhaite en savoir plus sur le fonctionnement de la pile ou sur la façon dont il est configuré.</span><span class="sxs-lookup"><span data-stu-id="8c74f-150">"I don't want to learn about how the stack operates or about how it's configured.</span></span> <span data-ttu-id="8c74f-151">Je veux simplement effectuer une opération aussi simple d’une manière que possible avec une probabilité élevée de l’aide des API avec succès. »</span><span class="sxs-lookup"><span data-stu-id="8c74f-151">I simply want to perform some operation in as simple a manner as possible with high probability of using the APIs successfully."</span></span>

2. <span data-ttu-id="8c74f-152">Le [API de configuration](xref:security/data-protection/configuration/overview) ciblent les développeurs d’applications et les administrateurs système.</span><span class="sxs-lookup"><span data-stu-id="8c74f-152">The [configuration APIs](xref:security/data-protection/configuration/overview) target application developers and system administrators.</span></span>

   <span data-ttu-id="8c74f-153">« Ai-je besoin d’indiquer le système de protection des données que mon environnement requiert des paramètres ou des chemins d’accès par défaut ».</span><span class="sxs-lookup"><span data-stu-id="8c74f-153">"I need to tell the data protection system that my environment requires non-default paths or settings."</span></span>

3. <span data-ttu-id="8c74f-154">Les développeurs de la cible d’API d’extensibilité chargé d’implémenter la stratégie personnalisée.</span><span class="sxs-lookup"><span data-stu-id="8c74f-154">The extensibility APIs target developers in charge of implementing custom policy.</span></span> <span data-ttu-id="8c74f-155">L’utilisation de ces API est limitée à rares situations et rencontrée, les développeurs prenant en charge de sécurité.</span><span class="sxs-lookup"><span data-stu-id="8c74f-155">Usage of these APIs would be limited to rare situations and experienced, security aware developers.</span></span>

   <span data-ttu-id="8c74f-156">« J’ai besoin de remplacer un composant entier au sein du système, car j’ai contraintes liées au comportement véritablement uniques.</span><span class="sxs-lookup"><span data-stu-id="8c74f-156">"I need to replace an entire component within the system because I have truly unique behavioral requirements.</span></span> <span data-ttu-id="8c74f-157">Je souhaite en savoir uncommonly utilisé des parties de la surface de l’API pour pouvoir créer un plug-in qui répond à mes besoins. »</span><span class="sxs-lookup"><span data-stu-id="8c74f-157">I am willing to learn uncommonly-used parts of the API surface in order to build a plugin that fulfills my requirements."</span></span>

## <a name="package-layout"></a><span data-ttu-id="8c74f-158">Disposition du package</span><span class="sxs-lookup"><span data-stu-id="8c74f-158">Package Layout</span></span>

<span data-ttu-id="8c74f-159">La pile de protection de données se compose de cinq packages.</span><span class="sxs-lookup"><span data-stu-id="8c74f-159">The data protection stack consists of five packages.</span></span>

* <span data-ttu-id="8c74f-160">Microsoft.AspNetCore.DataProtection.Abstractions contient les interfaces de base IDataProtectionProvider et IDataProtector.</span><span class="sxs-lookup"><span data-stu-id="8c74f-160">Microsoft.AspNetCore.DataProtection.Abstractions contains the basic IDataProtectionProvider and IDataProtector interfaces.</span></span> <span data-ttu-id="8c74f-161">Il contient également des méthodes d’extension utiles qui peuvent faciliter l’utilisation de ces types (par exemple, les surcharges de IDataProtector.Protect).</span><span class="sxs-lookup"><span data-stu-id="8c74f-161">It also contains useful extension methods that can assist working with these types (e.g., overloads of IDataProtector.Protect).</span></span> <span data-ttu-id="8c74f-162">Consultez la section d’interfaces de consommateur pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="8c74f-162">See the consumer interfaces section for more information.</span></span> <span data-ttu-id="8c74f-163">Si quelqu'un d’autre est responsable de l’instanciation du système de protection des données et que vous consommez simplement les API, vous souhaiterez référence Microsoft.AspNetCore.DataProtection.Abstractions.</span><span class="sxs-lookup"><span data-stu-id="8c74f-163">If somebody else is responsible for instantiating the data protection system and you are simply consuming the APIs, you'll want to reference Microsoft.AspNetCore.DataProtection.Abstractions.</span></span>

* <span data-ttu-id="8c74f-164">Microsoft.AspNetCore.DataProtection contient l’implémentation de base du système de protection de données, y compris les opérations de chiffrement de base de la gestion de clés, de la configuration et de l’extensibilité.</span><span class="sxs-lookup"><span data-stu-id="8c74f-164">Microsoft.AspNetCore.DataProtection contains the core implementation of the data protection system, including the core cryptographic operations, key management, configuration, and extensibility.</span></span> <span data-ttu-id="8c74f-165">Si vous êtes responsable de l’instanciation du système de protection des données (par exemple, ajouter à une IServiceCollection) ou de la modification ou l’extension de son comportement, vous souhaiterez référence Microsoft.AspNetCore.DataProtection.</span><span class="sxs-lookup"><span data-stu-id="8c74f-165">If you're responsible for instantiating the data protection system (e.g., adding it to an IServiceCollection) or modifying or extending its behavior, you'll want to reference Microsoft.AspNetCore.DataProtection.</span></span>

* <span data-ttu-id="8c74f-166">Microsoft.AspNetCore.DataProtection.Extensions contient des API supplémentaires qui permet aux développeurs s’avérer utile, mais qui n’appartiennent pas dans le package de base.</span><span class="sxs-lookup"><span data-stu-id="8c74f-166">Microsoft.AspNetCore.DataProtection.Extensions contains additional APIs which developers might find useful but which don't belong in the core package.</span></span> <span data-ttu-id="8c74f-167">Par exemple, ce package contient une API simple « instancier le système pointant vers un répertoire de stockage de clés spécifique sans configuration d’injection de dépendance » (plus d’informations).</span><span class="sxs-lookup"><span data-stu-id="8c74f-167">For instance, this package contains a simple "instantiate the system pointing at a specific key storage directory with no dependency injection setup" API (more info).</span></span> <span data-ttu-id="8c74f-168">Il contient également des méthodes d’extension pour limiter la durée de vie de charges utiles protégés (plus d’informations).</span><span class="sxs-lookup"><span data-stu-id="8c74f-168">It also contains extension methods for limiting the lifetime of protected payloads (more info).</span></span>

* <span data-ttu-id="8c74f-169">Microsoft.AspNetCore.DataProtection.SystemWeb peut être installé dans une application 4.x ASP.NET pour rediriger ses &lt;machineKey&gt; operations au lieu d’utiliser la nouvelle pile de protection des données.</span><span class="sxs-lookup"><span data-stu-id="8c74f-169">Microsoft.AspNetCore.DataProtection.SystemWeb can be installed into an existing ASP.NET 4.x application to redirect its &lt;machineKey&gt; operations to instead use the new data protection stack.</span></span> <span data-ttu-id="8c74f-170">Consultez [compatibilité](xref:security/data-protection/compatibility/replacing-machinekey#compatibility-replacing-machinekey) pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="8c74f-170">See [compatibility](xref:security/data-protection/compatibility/replacing-machinekey#compatibility-replacing-machinekey) for more information.</span></span>

* <span data-ttu-id="8c74f-171">Microsoft.AspNetCore.Cryptography.KeyDerivation fournit une implémentation du mot de passe PBKDF2 hachage routine et peut être utilisé par les systèmes qui doivent gérer les mots de passe utilisateur en toute sécurité.</span><span class="sxs-lookup"><span data-stu-id="8c74f-171">Microsoft.AspNetCore.Cryptography.KeyDerivation provides an implementation of the PBKDF2 password hashing routine and can be used by systems which need to handle user passwords securely.</span></span> <span data-ttu-id="8c74f-172">Consultez [de hachage des mots de passe](xref:security/data-protection/consumer-apis/password-hashing) pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="8c74f-172">See [Hash passwords](xref:security/data-protection/consumer-apis/password-hashing) for more information.</span></span>
