# <a name="add-validation-to-an-aspnet-core-mvc-app"></a><span data-ttu-id="3a0d7-101">Ajouter une validation à une application ASP.NET Core MVC</span><span class="sxs-lookup"><span data-stu-id="3a0d7-101">Add validation to an ASP.NET Core MVC app</span></span>

<span data-ttu-id="3a0d7-102">Par [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="3a0d7-102">By [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

<span data-ttu-id="3a0d7-103">Dans cette section, vous allez ajouter la logique de validation au modèle `Movie`, et vous allez vérifier que les règles de validation sont appliquées chaque fois qu’un utilisateur crée ou modifie un film.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-103">In this section you'll add validation logic to the `Movie` model, and you'll ensure that the validation rules are enforced any time a user creates or edits a movie.</span></span>

## <a name="keeping-things-dry"></a><span data-ttu-id="3a0d7-104">Ne vous répétez pas</span><span class="sxs-lookup"><span data-stu-id="3a0d7-104">Keeping things DRY</span></span>

<span data-ttu-id="3a0d7-105">L’un des principes de conception de MVC est « Ne vous répétez pas » (désigné par l’acronyme [DRY](https://wikipedia.org/wiki/Don%27t_repeat_yourself), Don’t Repeat Yourself).</span><span class="sxs-lookup"><span data-stu-id="3a0d7-105">One of the design tenets of MVC is [DRY](https://wikipedia.org/wiki/Don%27t_repeat_yourself) ("Don't Repeat Yourself").</span></span> <span data-ttu-id="3a0d7-106">ASP.NET Core MVC vous encourage à spécifier les fonctionnalités ou les comportements une seule fois, puis à utiliser la réflexion partout dans une application.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-106">ASP.NET Core MVC encourages you to specify functionality or behavior only once, and then have it be reflected everywhere in an app.</span></span> <span data-ttu-id="3a0d7-107">Cela réduit la quantité de code à écrire, et rend le code que vous écrivez moins susceptible aux erreurs et plus facile à tester et à gérer.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-107">This reduces the amount of code you need to write and makes the code you do write less error prone, easier to test, and easier to maintain.</span></span>

<span data-ttu-id="3a0d7-108">La prise en charge de la validation fournie par MVC et Entity Framework Core Code First est un bon exemple du principe DRY en action.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-108">The validation support provided by MVC and Entity Framework Core Code First is a good example of the DRY principle in action.</span></span> <span data-ttu-id="3a0d7-109">Vous pouvez spécifier de façon déclarative des règles de validation à un seul emplacement (dans la classe de modèle), et les règles sont appliquées partout dans l’application.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-109">You can declaratively specify validation rules in one place (in the model class) and the rules are enforced everywhere in the app.</span></span>

## <a name="adding-validation-rules-to-the-movie-model"></a><span data-ttu-id="3a0d7-110">Ajout de règles de validation au modèle de film</span><span class="sxs-lookup"><span data-stu-id="3a0d7-110">Adding validation rules to the movie model</span></span>

<span data-ttu-id="3a0d7-111">Ouvrez le fichier *Movie.cs*.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-111">Open the *Movie.cs* file.</span></span> <span data-ttu-id="3a0d7-112">DataAnnotations fournit un ensemble intégré d’attributs de validation que vous appliquez de manière déclarative à n’importe quelle classe ou propriété.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-112">DataAnnotations provides a built-in set of validation attributes that you apply declaratively to any class or property.</span></span> <span data-ttu-id="3a0d7-113">(Il contient également des attributs de mise en forme comme `DataType` qui aident à effectuer la mise en forme et ne fournissent aucune validation.)</span><span class="sxs-lookup"><span data-stu-id="3a0d7-113">(It also contains formatting attributes like `DataType` that help with formatting and don't provide any validation.)</span></span>

<span data-ttu-id="3a0d7-114">Mettez à jour la classe `Movie` pour tirer parti des attributs de validation intégrés `Required`, `StringLength`, `RegularExpression` et `Range`.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-114">Update the `Movie` class to take advantage of the built-in `Required`, `StringLength`, `RegularExpression`, and `Range` validation attributes.</span></span>

::: moniker range=">= aspnetcore-2.1"
[!code-csharp[](~/tutorials/first-mvc-app/start-mvc//sample/MvcMovie21/Models/MovieDateRatingDA.cs?name=snippet1)]
::: moniker-end
::: moniker range="<= aspnetcore-2.0"
[!code-csharp[](~/tutorials/first-mvc-app/start-mvc//sample/MvcMovie/Models/MovieDateRatingDA.cs?name=snippet1)]
::: moniker-end

<span data-ttu-id="3a0d7-115">Les attributs de validation spécifient le comportement que vous souhaitez appliquer sur les propriétés du modèle sur lesquels ils sont appliqués.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-115">The validation attributes specify behavior that you want to enforce on the model properties they're applied to.</span></span> <span data-ttu-id="3a0d7-116">Les attributs `Required` et `MinimumLength` indiquent qu’une propriété doit avoir une valeur, mais rien n’empêche un utilisateur d’entrer un espace blanc pour satisfaire cette validation.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-116">The `Required` and `MinimumLength` attributes indicates that a property must have a value; but nothing prevents a user from entering white space to satisfy this validation.</span></span> <span data-ttu-id="3a0d7-117">L’attribut `RegularExpression` sert à limiter les caractères pouvant être entrés.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-117">The `RegularExpression` attribute is used to limit what characters can be input.</span></span> <span data-ttu-id="3a0d7-118">Dans le code ci-dessus, `Genre` et `Rating` doivent utiliser uniquement des lettres (la première lettre en majuscule, les espaces blancs, les chiffres et les caractères spéciaux ne sont pas autorisés).</span><span class="sxs-lookup"><span data-stu-id="3a0d7-118">In the code above, `Genre` and `Rating` must use only letters (First letter uppercase, white space, numbers and special characters are not allowed).</span></span> <span data-ttu-id="3a0d7-119">L’attribut `Range` contraint une valeur à une plage spécifiée.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-119">The `Range` attribute constrains a value to within a specified range.</span></span> <span data-ttu-id="3a0d7-120">L’attribut `StringLength` vous permet de définir la longueur maximale d’une propriété de chaîne, et éventuellement sa longueur minimale.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-120">The `StringLength` attribute lets you set the maximum length of a string property, and optionally its minimum length.</span></span> <span data-ttu-id="3a0d7-121">Les types valeur (tels que `decimal`, `int`, `float` et `DateTime`) sont obligatoires par nature et n’ont pas besoin de l’attribut `[Required]`.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-121">Value types (such as `decimal`, `int`, `float`, `DateTime`) are inherently required and don't need the `[Required]` attribute.</span></span>

<span data-ttu-id="3a0d7-122">L’application automatique des règles de validation par ASP.NET Core permet d’accroître la fiabilité de votre application.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-122">Having validation rules automatically enforced by ASP.NET Core helps make your app more robust.</span></span> <span data-ttu-id="3a0d7-123">Cela garantit également que vous n’oublierez pas de valider un élément et que vous n’autoriserez pas par inadvertance l’insertion de données incorrectes dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-123">It also ensures that you can't forget to validate something and inadvertently let bad data into the database.</span></span>

## <a name="validation-error-ui-in-mvc"></a><span data-ttu-id="3a0d7-124">Interface utilisateur d’erreur de validation dans MVC</span><span class="sxs-lookup"><span data-stu-id="3a0d7-124">Validation Error UI in MVC</span></span>

<span data-ttu-id="3a0d7-125">Exécutez l’application et accédez au contrôleur Movies.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-125">Run the app and navigate to the Movies controller.</span></span>

<span data-ttu-id="3a0d7-126">Appuyez sur le lien **Create New** pour ajouter un nouveau film.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-126">Tap the **Create New** link to add a new movie.</span></span> <span data-ttu-id="3a0d7-127">Remplissez le formulaire avec des valeurs non valides.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-127">Fill out the form with some invalid values.</span></span> <span data-ttu-id="3a0d7-128">Dès que la validation côté client jQuery détecte l’erreur, elle affiche un message d’erreur.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-128">As soon as jQuery client side validation detects the error, it displays an error message.</span></span>

![Formulaire d’affichage de film avec plusieurs erreurs de validation côté client jQuery](~/tutorials/first-mvc-app/validation/_static/val.png)

> [!NOTE]
> <span data-ttu-id="3a0d7-130">Vous ne pourrez peut-être pas entrer de virgules décimales dans le champ `Price`.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-130">You may not be able to enter decimal commas in the `Price` field.</span></span> <span data-ttu-id="3a0d7-131">Pour prendre en charge la [validation jQuery](https://jqueryvalidation.org/) pour les paramètres régionaux autres que l’anglais qui utilisent une virgule (« , ») comme décimale et des formats de date autres que l’anglais des États-Unis, vous devez effectuer des étapes pour localiser votre application.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-131">To support [jQuery validation](https://jqueryvalidation.org/) for non-English locales that use a comma (",") for a decimal point, and non US-English date formats, you must take steps to globalize your app.</span></span> <span data-ttu-id="3a0d7-132">Consultez la page [GitHub problème 4076](https://github.com/aspnet/Docs/issues/4076#issuecomment-326590420) pour savoir comment ajouter une virgule décimale.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-132">This [GitHub issue 4076](https://github.com/aspnet/Docs/issues/4076#issuecomment-326590420) for instructions on adding decimal comma.</span></span> 

<span data-ttu-id="3a0d7-133">Notez que le formulaire a affiché automatiquement un message d’erreur de validation approprié dans chaque champ contenant une valeur non valide.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-133">Notice how the form has automatically rendered an appropriate validation error message in each field containing an invalid value.</span></span> <span data-ttu-id="3a0d7-134">Les erreurs sont appliquées à la fois côté client (à l’aide de JavaScript et jQuery) et côté serveur (au cas où un utilisateur aurait désactivé JavaScript).</span><span class="sxs-lookup"><span data-stu-id="3a0d7-134">The errors are enforced both client-side (using JavaScript and jQuery) and server-side (in case a user has JavaScript disabled).</span></span>

<span data-ttu-id="3a0d7-135">L’un des principaux avantages est que vous n’avez pas eu à changer une seule ligne de code dans la classe `MoviesController` ou dans la vue *Create.cshtml* pour activer cette interface utilisateur de validation.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-135">A significant benefit is that you didn't need to change a single line of code in the `MoviesController` class or in the *Create.cshtml* view in order to enable this validation UI.</span></span> <span data-ttu-id="3a0d7-136">Le contrôleur et les vues créées précédemment dans ce didacticiel ont détecté les règles de validation que vous avez spécifiées à l’aide des attributs de validation sur les propriétés de la classe de modèle `Movie`.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-136">The controller and views you created earlier in this tutorial automatically picked up the validation rules that you specified by using validation attributes on the properties of the `Movie` model class.</span></span> <span data-ttu-id="3a0d7-137">Testez la validation à l’aide de la méthode d’action `Edit`. La même validation est appliquée.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-137">Test validation using the `Edit` action method, and the same validation is applied.</span></span>

<span data-ttu-id="3a0d7-138">Les données de formulaire ne sont pas envoyées au serveur tant qu’il y a des erreurs de validation côté client.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-138">The form data isn't sent to the server until there are no client side validation errors.</span></span> <span data-ttu-id="3a0d7-139">Vous pouvez vérifier cela en plaçant un point d’arrêt dans la méthode `HTTP Post`, en utilisant l’[outil Fiddler](http://www.telerik.com/fiddler) ou à l’aide des [Outils de développement F12](https://developer.microsoft.com/microsoft-edge/platform/documentation/f12-devtools-guide/).</span><span class="sxs-lookup"><span data-stu-id="3a0d7-139">You can verify this by putting a break point in the `HTTP Post` method, by using the [Fiddler tool](http://www.telerik.com/fiddler) , or the [F12 Developer tools](https://developer.microsoft.com/microsoft-edge/platform/documentation/f12-devtools-guide/).</span></span>

## <a name="how-validation-works"></a><span data-ttu-id="3a0d7-140">Fonctionnement de la validation</span><span class="sxs-lookup"><span data-stu-id="3a0d7-140">How validation works</span></span>

<span data-ttu-id="3a0d7-141">Vous vous demandez peut-être comment l’interface utilisateur de validation a été générée sans aucune mise à jour du code dans le contrôleur ou dans les vues.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-141">You might wonder how the validation UI was generated without any updates to the code in the controller or views.</span></span> <span data-ttu-id="3a0d7-142">Le code suivant montre les deux méthodes `Create`.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-142">The following code shows the two `Create` methods.</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc//sample/MvcMovie/Controllers/MoviesController.cs?name=snippetCreate)]

<span data-ttu-id="3a0d7-143">La première méthode d’action (HTTP GET) `Create` affiche le formulaire de création initial.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-143">The first (HTTP GET) `Create` action method displays the initial Create form.</span></span> <span data-ttu-id="3a0d7-144">La deuxième version (`[HttpPost]`) gère la publication de formulaire.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-144">The second (`[HttpPost]`) version handles the form post.</span></span> <span data-ttu-id="3a0d7-145">La seconde méthode `Create` (la version `[HttpPost]`) appelle `ModelState.IsValid` pour vérifier si le film a des erreurs de validation.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-145">The second `Create` method (The `[HttpPost]` version) calls `ModelState.IsValid` to check whether the movie has any validation errors.</span></span> <span data-ttu-id="3a0d7-146">L’appel de cette méthode évalue tous les attributs de validation qui ont été appliqués à l’objet.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-146">Calling this method evaluates any validation attributes that have been applied to the object.</span></span> <span data-ttu-id="3a0d7-147">Si l’objet comporte des erreurs de validation, la méthode `Create` réaffiche le formulaire.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-147">If the object has validation errors, the `Create` method re-displays the form.</span></span> <span data-ttu-id="3a0d7-148">S’il n’y a pas d’erreur, la méthode enregistre le nouveau film dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-148">If there are no errors, the method saves the new movie in the database.</span></span> <span data-ttu-id="3a0d7-149">Dans notre exemple de film, le formulaire n’est pas publié sur le serveur quand des erreurs de validation sont détectées côté client ; la seconde méthode `Create` n’est jamais appelée quand il y a des erreurs de validation côté client.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-149">In our movie example, the form isn't posted to the server when there are validation errors detected on the client side; the second `Create` method is never called when there are client side validation errors.</span></span> <span data-ttu-id="3a0d7-150">Si vous désactivez JavaScript dans votre navigateur, la validation client est désactivée et vous pouvez tester la méthode `Create` HTTP POST `ModelState.IsValid` pour détecter les erreurs de validation.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-150">If you disable JavaScript in your browser, client validation is disabled and you can test the HTTP POST `Create` method `ModelState.IsValid` detecting any validation errors.</span></span>

<span data-ttu-id="3a0d7-151">Vous pouvez définir un point d’arrêt dans la méthode `[HttpPost] Create` et vérifier que la méthode n’est jamais appelée. La validation côté client n’enverra pas les données du formulaire quand des erreurs de validation seront détectées.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-151">You can set a break point in the `[HttpPost] Create` method and verify the method is never called, client side validation won't submit the form data when validation errors are detected.</span></span> <span data-ttu-id="3a0d7-152">Si vous désactivez JavaScript dans votre navigateur et que vous envoyez ensuite le formulaire avec des erreurs, le point d’arrêt sera atteint.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-152">If you disable JavaScript in your browser, then submit the form with errors, the break point will be hit.</span></span> <span data-ttu-id="3a0d7-153">Vous bénéficiez toujours d’une validation complète sans JavaScript.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-153">You still get full validation without JavaScript.</span></span> 

<span data-ttu-id="3a0d7-154">L’illustration suivante montre comment désactiver JavaScript dans le navigateur FireFox.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-154">The following image shows how to disable JavaScript in the FireFox browser.</span></span>

![Firefox : dans Options, sous l’onglet Contenu, décochez la case Activer Javascript.](~/tutorials/first-mvc-app/validation/_static/ff.png)

<span data-ttu-id="3a0d7-156">L’illustration suivante montre comment désactiver JavaScript dans le navigateur Chrome.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-156">The following image shows how to disable JavaScript in the Chrome browser.</span></span>

![Google Chrome : dans Paramètres de contenu, dans la section Javascript, sélectionnez Interdire à tous les sites d’exécuter JavaScript.](~/tutorials/first-mvc-app/validation/_static/chrome.png)

<span data-ttu-id="3a0d7-158">Après la désactivation de JavaScript, publiez les données non valides et parcourez le débogueur.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-158">After you disable JavaScript, post invalid data and step through the debugger.</span></span>

![Pendant le débogage d’une publication de données non valides, Intellisense sur ModelState.IsValid indique que la valeur est false.](~/tutorials/first-mvc-app/validation/_static/ms.png)

<span data-ttu-id="3a0d7-160">Voici la partie du modèle de vue *Create.cshtml* pour lequel vous avez généré automatiquement des modèles précédemment dans le didacticiel.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-160">Below is portion of the *Create.cshtml* view template that you scaffolded earlier in the tutorial.</span></span> <span data-ttu-id="3a0d7-161">Il est utilisé par les méthodes d’action ci-dessus à la fois pour afficher le formulaire initial et pour le réafficher en cas d’erreur.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-161">It's used by the action methods shown above both to display the initial form and to redisplay it in the event of an error.</span></span>

[!code-HTML[](~/tutorials/first-mvc-app/start-mvc//sample/MvcMovie/Views/Movies/CreateRatingBrevity.cshtml)]

<span data-ttu-id="3a0d7-162">Le [Tag Helper Input](xref:mvc/views/working-with-forms) utilise les attributs [DataAnnotations](/aspnet/mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-6) et produit les attributs HTML nécessaires à la validation jQuery côté client.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-162">The [Input Tag Helper](xref:mvc/views/working-with-forms) uses the [DataAnnotations](/aspnet/mvc/overview/older-versions/mvc-music-store/mvc-music-store-part-6) attributes and produces HTML attributes needed for jQuery Validation on the client side.</span></span> <span data-ttu-id="3a0d7-163">Le [Tag Helper Validation](xref:mvc/views/working-with-forms#the-validation-tag-helpers) affiche les erreurs de validation.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-163">The [Validation Tag Helper](xref:mvc/views/working-with-forms#the-validation-tag-helpers) displays validation errors.</span></span> <span data-ttu-id="3a0d7-164">Pour plus d’informations, consultez [Validation](xref:mvc/models/validation).</span><span class="sxs-lookup"><span data-stu-id="3a0d7-164">See [Validation](xref:mvc/models/validation) for more information.</span></span>

<span data-ttu-id="3a0d7-165">Le grand avantage de cette approche est que ni le contrôleur ni le modèle de vue `Create` ne savent rien des règles de validation appliquées ou des messages d’erreur affichés.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-165">What's really nice about this approach is that neither the controller nor the `Create` view template knows anything about the actual validation rules being enforced or about the specific error messages displayed.</span></span> <span data-ttu-id="3a0d7-166">Les règles de validation et les chaînes d’erreur sont spécifiées uniquement dans la classe `Movie`.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-166">The validation rules and the error strings are specified only in the `Movie` class.</span></span> <span data-ttu-id="3a0d7-167">Ces mêmes règles de validation sont automatiquement appliquées à la vue `Edit` et à tous les autres modèles de vues que vous pouvez créer et qui modifient votre modèle.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-167">These same validation rules are automatically applied to the `Edit` view and any other views templates you might create that edit your model.</span></span>

<span data-ttu-id="3a0d7-168">Quand vous devez changer la logique de validation, vous pouvez le faire à un seul endroit en ajoutant des attributs de validation au modèle (dans cet exemple, la classe `Movie`).</span><span class="sxs-lookup"><span data-stu-id="3a0d7-168">When you need to change validation logic, you can do so in exactly one place by adding validation attributes to the model (in this example, the `Movie` class).</span></span> <span data-ttu-id="3a0d7-169">Vous n’aurez pas à vous soucier des différentes parties de l’application qui pourraient être incohérentes avec la façon dont les règles sont appliquées. Toute la logique de validation sera définie à un seul emplacement et utilisée partout.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-169">You won't have to worry about different parts of the application being inconsistent with how the rules are enforced — all validation logic will be defined in one place and used everywhere.</span></span> <span data-ttu-id="3a0d7-170">Le code est ainsi très propre, facile à mettre à jour et évolutif.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-170">This keeps the code very clean, and makes it easy to maintain and evolve.</span></span> <span data-ttu-id="3a0d7-171">Et cela signifie que vous respecterez entièrement le principe DRY.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-171">And it means that you'll be fully honoring the DRY principle.</span></span>

## <a name="using-datatype-attributes"></a><span data-ttu-id="3a0d7-172">Utilisation d’attributs DataType</span><span class="sxs-lookup"><span data-stu-id="3a0d7-172">Using DataType Attributes</span></span>

<span data-ttu-id="3a0d7-173">Ouvrez le fichier *Movie.cs* et examinez la classe `Movie`.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-173">Open the *Movie.cs* file and examine the `Movie` class.</span></span> <span data-ttu-id="3a0d7-174">L’espace de noms `System.ComponentModel.DataAnnotations` fournit des attributs de mise en forme en plus de l’ensemble intégré d’attributs de validation.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-174">The `System.ComponentModel.DataAnnotations` namespace provides formatting attributes in addition to the built-in set of validation attributes.</span></span> <span data-ttu-id="3a0d7-175">Nous avons déjà appliqué une valeur d’énumération `DataType` aux champs de date de sortie et de prix.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-175">We've already applied a `DataType` enumeration value to the release date and to the price fields.</span></span> <span data-ttu-id="3a0d7-176">Le code suivant illustre les propriétés `ReleaseDate` et `Price` avec l’attribut `DataType` approprié.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-176">The following code shows the `ReleaseDate` and `Price` properties with the appropriate `DataType` attribute.</span></span>

[!code-csharp[](~/tutorials/first-mvc-app/start-mvc//sample/MvcMovie/Models/MovieDateRatingDA.cs?highlight=2,6&name=snippet2)]

<span data-ttu-id="3a0d7-177">Les attributs `DataType` fournissent uniquement des indices permettant au moteur de vue de mettre en forme les données (et fournissent des éléments/attributs tels que `<a>` pour les URL et `<a href="mailto:EmailAddress.com">` pour l’e-mail).</span><span class="sxs-lookup"><span data-stu-id="3a0d7-177">The `DataType` attributes only provide hints for the view engine to format the data (and supplies elements/attributes such as `<a>` for URL's and `<a href="mailto:EmailAddress.com">` for email.</span></span> <span data-ttu-id="3a0d7-178">Vous pouvez utiliser l’attribut `RegularExpression` pour valider le format des données.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-178">You can use the `RegularExpression` attribute to validate the format of the data.</span></span> <span data-ttu-id="3a0d7-179">L’attribut `DataType` sert à spécifier un type de données qui est plus spécifique que le type intrinsèque de la base de données ; il ne s’agit pas d’un attribut de validation.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-179">The `DataType` attribute is used to specify a data type that's more specific than the database intrinsic type, they're not validation attributes.</span></span> <span data-ttu-id="3a0d7-180">Dans le cas présent, nous voulons uniquement effectuer le suivi de la date, et non de l’heure.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-180">In this case we only want to keep track of the date, not the time.</span></span> <span data-ttu-id="3a0d7-181">L’énumération `DataType` fournit de nombreux types de données, telles que Date, Time, PhoneNumber, Currency ou EmailAddress.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-181">The `DataType` Enumeration provides for many data types, such as Date, Time, PhoneNumber, Currency, EmailAddress and more.</span></span> <span data-ttu-id="3a0d7-182">L’attribut `DataType` peut également permettre à l’application de fournir automatiquement des fonctionnalités propres au type.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-182">The `DataType` attribute can also enable the application to automatically provide type-specific features.</span></span> <span data-ttu-id="3a0d7-183">Par exemple, vous pouvez créer un lien `mailto:` pour `DataType.EmailAddress`, et vous pouvez fournir un sélecteur de date pour `DataType.Date` dans les navigateurs qui prennent en charge HTML5.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-183">For example, a `mailto:` link can be created for `DataType.EmailAddress`, and a date selector can be provided for `DataType.Date` in browsers that support HTML5.</span></span> <span data-ttu-id="3a0d7-184">Les attributs `DataType` émettent des attributs HTML 5 `data-` compréhensibles par les navigateurs HTML 5.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-184">The `DataType` attributes emit HTML 5 `data-` (pronounced data dash) attributes that HTML 5 browsers can understand.</span></span> <span data-ttu-id="3a0d7-185">Les attributs `DataType` ne fournissent **aucune** validation.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-185">The `DataType` attributes do **not** provide any validation.</span></span>

<span data-ttu-id="3a0d7-186">`DataType.Date` ne spécifie pas le format de la date qui s’affiche.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-186">`DataType.Date` doesn't specify the format of the date that's displayed.</span></span> <span data-ttu-id="3a0d7-187">Par défaut, le champ de données est affiché conformément aux formats par défaut basés sur le `CultureInfo` du serveur.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-187">By default, the data field is displayed according to the default formats based on the server's `CultureInfo`.</span></span>

<span data-ttu-id="3a0d7-188">L’attribut `DisplayFormat` est utilisé pour spécifier explicitement le format de date :</span><span class="sxs-lookup"><span data-stu-id="3a0d7-188">The `DisplayFormat` attribute is used to explicitly specify the date format:</span></span>

```csharp
[DisplayFormat(DataFormatString = "{0:yyyy-MM-dd}", ApplyFormatInEditMode = true)]
public DateTime ReleaseDate { get; set; }
```

<span data-ttu-id="3a0d7-189">Le paramètre `ApplyFormatInEditMode` indique que la mise en forme doit également être appliquée quand la valeur est affichée dans une zone de texte à des fins de modification.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-189">The `ApplyFormatInEditMode` setting specifies that the formatting should also be applied when the value is displayed in a text box for editing.</span></span> <span data-ttu-id="3a0d7-190">(Ceci peut ne pas être souhaitable pour certains champs ; par exemple, pour les valeurs monétaires, vous ne souhaiterez sans doute pas que le symbole monétaire figure dans la zone de texte.)</span><span class="sxs-lookup"><span data-stu-id="3a0d7-190">(You might not want that for some fields — for example, for currency values, you probably don't want the currency symbol in the text box for editing.)</span></span>

<span data-ttu-id="3a0d7-191">Vous pouvez utiliser l’attribut `DisplayFormat` par lui-même, mais il est généralement préférable d’utiliser l’attribut `DataType`.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-191">You can use the `DisplayFormat` attribute by itself, but it's generally a good idea to use the `DataType` attribute.</span></span> <span data-ttu-id="3a0d7-192">L’attribut `DataType` donne la sémantique des données, plutôt que de décrire comment effectuer le rendu sur un écran, et il offre les avantages suivants dont vous ne bénéficiez pas avec DisplayFormat :</span><span class="sxs-lookup"><span data-stu-id="3a0d7-192">The `DataType` attribute conveys the semantics of the data as opposed to how to render it on a screen, and provides the following benefits that you don't get with DisplayFormat:</span></span>

* <span data-ttu-id="3a0d7-193">Le navigateur peut activer des fonctionnalités HTML5 (par exemple pour afficher un contrôle de calendrier, le symbole monétaire correspondant aux paramètres régionaux, des liens de messagerie, etc.).</span><span class="sxs-lookup"><span data-stu-id="3a0d7-193">The browser can enable HTML5 features (for example to show a calendar control, the locale-appropriate currency symbol, email links, etc.)</span></span>

* <span data-ttu-id="3a0d7-194">Par défaut, le navigateur affiche les données à l’aide du format correspondant à vos paramètres régionaux.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-194">By default, the browser will render data using the correct format based on your locale.</span></span>

* <span data-ttu-id="3a0d7-195">L’attribut `DataType` peut permettre à MVC de choisir le modèle de champ correct pour afficher les données (`DisplayFormat`, utilisé par lui-même, utilise le modèle de chaîne).</span><span class="sxs-lookup"><span data-stu-id="3a0d7-195">The `DataType` attribute can enable MVC to choose the right field template to render the data (the `DisplayFormat` if used by itself uses the string template).</span></span>

> [!NOTE]
> <span data-ttu-id="3a0d7-196">La validation jQuery ne fonctionne pas avec l’attribut `Range` et `DateTime`.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-196">jQuery validation doesn't work with the `Range` attribute and `DateTime`.</span></span> <span data-ttu-id="3a0d7-197">Par exemple, le code suivant affiche toujours une erreur de validation côté client, même quand la date se trouve dans la plage spécifiée :</span><span class="sxs-lookup"><span data-stu-id="3a0d7-197">For example, the following code will always display a client side validation error, even when the date is in the specified range:</span></span>

```csharp
[Range(typeof(DateTime), "1/1/1966", "1/1/2020")]
   ```

<span data-ttu-id="3a0d7-198">Vous devez désactiver la validation de date jQuery pour utiliser l’attribut `Range` avec `DateTime`.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-198">You will need to disable jQuery date validation to use the `Range` attribute with `DateTime`.</span></span> <span data-ttu-id="3a0d7-199">Il n’est généralement pas recommandé de compiler des dates dures dans vos modèles. Par conséquent, l’utilisation de l’attribut `Range` et de `DateTime` est déconseillée.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-199">It's generally not a good practice to compile hard dates in your models, so using the `Range` attribute and `DateTime` is discouraged.</span></span>

<span data-ttu-id="3a0d7-200">Le code suivant illustre la combinaison d’attributs sur une seule ligne :</span><span class="sxs-lookup"><span data-stu-id="3a0d7-200">The following code shows combining attributes on one line:</span></span>

::: moniker range=">= aspnetcore-2.1"
[!code-csharp[](~/tutorials/first-mvc-app/start-mvc//sample/MvcMovie21/Models/MovieDateRatingDAmult.cs?name=snippet1)]

::: moniker-end
::: moniker range="<= aspnetcore-2.0"
[!code-csharp[](~/tutorials/first-mvc-app/start-mvc//sample/MvcMovie/Models/MovieDateRatingDAmult.cs?name=snippet1)]

::: moniker-end

<span data-ttu-id="3a0d7-201">Dans la partie suivante de la série, nous allons examiner l’application et apporter des améliorations aux méthodes `Details` et `Delete` générées automatiquement.</span><span class="sxs-lookup"><span data-stu-id="3a0d7-201">In the next part of the series, we'll review the application and make some improvements to the automatically generated `Details` and `Delete` methods.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="3a0d7-202">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="3a0d7-202">Additional resources</span></span>

* [<span data-ttu-id="3a0d7-203">Utilisation des formulaires</span><span class="sxs-lookup"><span data-stu-id="3a0d7-203">Working with Forms</span></span>](xref:mvc/views/working-with-forms)
* [<span data-ttu-id="3a0d7-204">Globalisation et localisation</span><span class="sxs-lookup"><span data-stu-id="3a0d7-204">Globalization and localization</span></span>](xref:fundamentals/localization)
* [<span data-ttu-id="3a0d7-205">Introduction aux Tag Helpers</span><span class="sxs-lookup"><span data-stu-id="3a0d7-205">Introduction to Tag Helpers</span></span>](xref:mvc/views/tag-helpers/intro)
* [<span data-ttu-id="3a0d7-206">Créer des Tag Helpers</span><span class="sxs-lookup"><span data-stu-id="3a0d7-206">Author Tag Helpers</span></span>](xref:mvc/views/tag-helpers/authoring)
