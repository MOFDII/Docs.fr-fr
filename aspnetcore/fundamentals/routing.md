---
title: Routage dans ASP.NET Core
author: ardalis
description: Découvrez comment la fonctionnalité de routage ASP.NET Core est chargée du mappage d’une requête entrante à un gestionnaire de routage.
ms.author: riande
ms.custom: mvc
ms.date: 10/01/2018
uid: fundamentals/routing
ms.openlocfilehash: a014782ba503bc8bd0fdefb4cb4f382aa8fde4cd
ms.sourcegitcommit: c43a6f1fe72d7c2db4b5815fd532f2b45d964e07
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/30/2018
ms.locfileid: "50244968"
---
# <a name="routing-in-aspnet-core"></a><span data-ttu-id="ce372-103">Routage dans ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="ce372-103">Routing in ASP.NET Core</span></span>

<span data-ttu-id="ce372-104">Par [Ryan Nowak](https://github.com/rynowak), [Steve Smith](https://ardalis.com/) et [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="ce372-104">By [Ryan Nowak](https://github.com/rynowak), [Steve Smith](https://ardalis.com/), and [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

<span data-ttu-id="ce372-105">La fonctionnalité de routage est chargée du mappage d’une requête entrante à un gestionnaire de routage.</span><span class="sxs-lookup"><span data-stu-id="ce372-105">Routing functionality is responsible for mapping an incoming request to a route handler.</span></span> <span data-ttu-id="ce372-106">Les routes sont définies dans l’application et configurées au démarrage de l’application.</span><span class="sxs-lookup"><span data-stu-id="ce372-106">Routes are defined in the app and configured when the app starts.</span></span> <span data-ttu-id="ce372-107">Une route peut éventuellement extraire des valeurs de l’URL contenue dans la requête, et ces valeurs peuvent ensuite être utilisées pour le traitement de la requête.</span><span class="sxs-lookup"><span data-stu-id="ce372-107">A route can optionally extract values from the URL contained in the request, and these values can then be used for request processing.</span></span> <span data-ttu-id="ce372-108">À l’aide des informations de route fournies par l’application, la fonctionnalité de routage peut également générer des URL qui mappent à des gestionnaires de routage.</span><span class="sxs-lookup"><span data-stu-id="ce372-108">Using route information from the app, the routing functionality is also able to generate URLs that map to route handlers.</span></span> <span data-ttu-id="ce372-109">Par conséquent, le routage peut trouver un gestionnaire de routage en se basant sur une URL, ou il peut trouver l’URL correspondant à un gestionnaire de routage donné en se basant sur les informations relatives à celui-ci.</span><span class="sxs-lookup"><span data-stu-id="ce372-109">Therefore, routing can find a route handler based on a URL, or find the URL corresponding to a given route handler based on route handler information.</span></span>

<span data-ttu-id="ce372-110">La plupart des applications doivent choisir un schéma de routage de base et descriptif pour que les URL soient lisibles et explicites.</span><span class="sxs-lookup"><span data-stu-id="ce372-110">Most apps should choose a basic and descriptive routing scheme so that URLs are readable and meaningful.</span></span> <span data-ttu-id="ce372-111">La route conventionnelle par défaut `{controller=Home}/{action=Index}/{id?}` :</span><span class="sxs-lookup"><span data-stu-id="ce372-111">The default conventional route `{controller=Home}/{action=Index}/{id?}`:</span></span>

* <span data-ttu-id="ce372-112">Prend en charge un schéma de routage de base et descriptif.</span><span class="sxs-lookup"><span data-stu-id="ce372-112">Supports a basic and descriptive routing scheme:</span></span>
* <span data-ttu-id="ce372-113">Est un bon point de départ pour les applications web conçues pour être utilisées par des navigateurs.</span><span class="sxs-lookup"><span data-stu-id="ce372-113">Is a good starting point for web apps intended for use by browsers.</span></span>

<span data-ttu-id="ce372-114">Il est courant d’ajouter des routes laconiques supplémentaires aux zones à trafic élevé de l’application dans des situations particulières (blog ou commerce électronique par exemple) à l’aide du [routage d’attributs](xref:mvc/controllers/routing#attribute-routing) ou de routes conventionnelles dédiées.</span><span class="sxs-lookup"><span data-stu-id="ce372-114">It's common to add additional terse routes to high traffic areas of the app in specialized situations (for example, blog, ecommerce) using [attribute routing](xref:mvc/controllers/routing#attribute-routing) or dedicated conventional routes.</span></span>

<span data-ttu-id="ce372-115">Les API web doivent utiliser le routage d’attributs pour modéliser les fonctionnalités de l’application sous la forme d’un ensemble de ressources dans lequel les opérations sont représentées par des verbes HTTP.</span><span class="sxs-lookup"><span data-stu-id="ce372-115">Web APIs should use attribute routing to model the app's functionality as a set of resources where operations are represented by HTTP verbs.</span></span> <span data-ttu-id="ce372-116">Cela signifie que plusieurs opérations (comme GET et POST) sur la même ressource logique utilisent la même URL.</span><span class="sxs-lookup"><span data-stu-id="ce372-116">This means that many operations (for example, GET, POST) on the same logical resource will use the same URL.</span></span> <span data-ttu-id="ce372-117">Le routage d’attributs fournit le niveau de contrôle nécessaire pour concevoir avec soin l’espace d’URL d’une API.</span><span class="sxs-lookup"><span data-stu-id="ce372-117">Attribute routing provides a level of control that is needed to carefully design an API's URL-space.</span></span>

<span data-ttu-id="ce372-118">La prise en charge de la génération d’URL de MVC permet de développer l’application sans coder en dur les URL pour relier l’application.</span><span class="sxs-lookup"><span data-stu-id="ce372-118">MVC's URL generation support allows the app to be developed without hard coding the URLs to link the app together.</span></span> <span data-ttu-id="ce372-119">Vous pouvez ainsi commencer par une configuration de routage de base, puis modifier les routes une fois la forme de l’application déterminée.</span><span class="sxs-lookup"><span data-stu-id="ce372-119">This allows for starting with a basic routing configuration, and modifying the routes after the app's shape is determined.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ce372-120">Ce document traite du routage ASP.NET Core de bas niveau.</span><span class="sxs-lookup"><span data-stu-id="ce372-120">This document covers low-level ASP.NET Core routing.</span></span> <span data-ttu-id="ce372-121">Pour plus d’informations sur le routage ASP.NET Core MVC, consultez <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="ce372-121">For information on ASP.NET Core MVC routing, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="ce372-122">[Affichez ou téléchargez l’exemple de code](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([procédure de téléchargement](xref:index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="ce372-122">[View or download sample code](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/routing/samples) ([how to download](xref:index#how-to-download-a-sample))</span></span>

## <a name="routing-basics"></a><span data-ttu-id="ce372-123">Concepts de base du routage</span><span class="sxs-lookup"><span data-stu-id="ce372-123">Routing basics</span></span>

<span data-ttu-id="ce372-124">Le routage utilise des *routes* (implémentations de <xref:Microsoft.AspNetCore.Routing.IRouter>) pour :</span><span class="sxs-lookup"><span data-stu-id="ce372-124">Routing uses *routes* (implementations of <xref:Microsoft.AspNetCore.Routing.IRouter>) to:</span></span>

* <span data-ttu-id="ce372-125">Mapper les requêtes entrantes à des *gestionnaires de routage*.</span><span class="sxs-lookup"><span data-stu-id="ce372-125">Map incoming requests to *route handlers*.</span></span>
* <span data-ttu-id="ce372-126">Générer des URL utilisées dans les réponses.</span><span class="sxs-lookup"><span data-stu-id="ce372-126">Generate URLs used in responses.</span></span>

<span data-ttu-id="ce372-127">En général, une application possède une collection de routes unique.</span><span class="sxs-lookup"><span data-stu-id="ce372-127">Generally, an app has a single collection of routes.</span></span> <span data-ttu-id="ce372-128">Quand une requête arrive, la collection de routes est traitée dans l’ordre.</span><span class="sxs-lookup"><span data-stu-id="ce372-128">When a request arrives, the route collection is processed in order.</span></span> <span data-ttu-id="ce372-129">La requête entrante recherche une route qui correspond à son URL en appelant la méthode <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> sur chaque route disponible dans la collection de routes.</span><span class="sxs-lookup"><span data-stu-id="ce372-129">The incoming request looks for a route that matches the request URL by calling the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each available route in the route collection.</span></span> <span data-ttu-id="ce372-130">En revanche, une réponse peut utiliser le routage pour générer des URL (par exemple, pour la redirection ou les liens) en fonction des informations de route et éviter ainsi d’avoir à coder en dur des URL, ce qui facilite la maintenance.</span><span class="sxs-lookup"><span data-stu-id="ce372-130">By contrast, a response can use routing to generate URLs (for example, for redirection or links) based on route information and thus avoid having to hard-code URLs, which helps maintainability.</span></span>

<span data-ttu-id="ce372-131">Le routage est connecté au pipeline de [l’intergiciel (middleware)](xref:fundamentals/middleware/index) par la classe <xref:Microsoft.AspNetCore.Builder.RouterMiddleware>.</span><span class="sxs-lookup"><span data-stu-id="ce372-131">Routing is connected to the [middleware](xref:fundamentals/middleware/index) pipeline by the <xref:Microsoft.AspNetCore.Builder.RouterMiddleware> class.</span></span> <span data-ttu-id="ce372-132">[ASP.NET Core MVC](xref:mvc/overview) ajoute le routage au pipeline de l’intergiciel dans le cadre de sa configuration.</span><span class="sxs-lookup"><span data-stu-id="ce372-132">[ASP.NET Core MVC](xref:mvc/overview) adds routing to the middleware pipeline as part of its configuration.</span></span> <span data-ttu-id="ce372-133">Pour en savoir plus sur l’utilisation du routage comme composant autonome, consultez la section [Utilisation du middleware de routage](#use-routing-middleware).</span><span class="sxs-lookup"><span data-stu-id="ce372-133">To learn about using routing as a standalone component, see [Use Routing Middleware](#use-routing-middleware) section.</span></span>

### <a name="url-matching"></a><span data-ttu-id="ce372-134">Correspondance d’URL</span><span class="sxs-lookup"><span data-stu-id="ce372-134">URL matching</span></span>

<span data-ttu-id="ce372-135">La correspondance d’URL est le processus par lequel le routage distribue une requête entrante à un *gestionnaire*.</span><span class="sxs-lookup"><span data-stu-id="ce372-135">URL matching is the process by which routing dispatches an incoming request to a *handler*.</span></span> <span data-ttu-id="ce372-136">Ce processus est basé sur des données présentes dans le chemin de l’URL, mais il peut être étendu pour prendre en compte toutes les données de la requête.</span><span class="sxs-lookup"><span data-stu-id="ce372-136">This process is based on data in the URL path but can be extended to consider any data in the request.</span></span> <span data-ttu-id="ce372-137">La possibilité de distribuer des requêtes à des gestionnaires distincts est essentielle pour adapter la taille et la complexité d’une application.</span><span class="sxs-lookup"><span data-stu-id="ce372-137">The ability to dispatch requests to separate handlers is key to scaling the size and complexity of an app.</span></span>

<span data-ttu-id="ce372-138">Les requêtes entrantes entrent dans `RouterMiddleware`, qui appelle la méthode <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> sur chaque route dans l’ordre.</span><span class="sxs-lookup"><span data-stu-id="ce372-138">Incoming requests enter the `RouterMiddleware`, which calls the <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> method on each route in sequence.</span></span> <span data-ttu-id="ce372-139">L’instance <xref:Microsoft.AspNetCore.Routing.IRouter> détermine s’il faut *gérer* la requête en affectant à [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) un <xref:Microsoft.AspNetCore.Http.RequestDelegate> non null.</span><span class="sxs-lookup"><span data-stu-id="ce372-139">The <xref:Microsoft.AspNetCore.Routing.IRouter> instance chooses whether to *handle* the request by setting the [RouteContext.Handler](xref:Microsoft.AspNetCore.Routing.RouteContext.Handler*) to a non-null <xref:Microsoft.AspNetCore.Http.RequestDelegate>.</span></span> <span data-ttu-id="ce372-140">Si une route définit un gestionnaire pour la requête, le traitement de la route s’arrête et le gestionnaire est appelé pour traiter la requête.</span><span class="sxs-lookup"><span data-stu-id="ce372-140">If a route sets a handler for the request, route processing stops, and the handler is invoked to process the request.</span></span> <span data-ttu-id="ce372-141">Si toutes les routes sont tentées et qu’aucun gestionnaire n’est trouvé pour la requête, le middleware appelle *next* : le middleware suivant dans le pipeline de requête est alors appelé.</span><span class="sxs-lookup"><span data-stu-id="ce372-141">If all routes are tried and no handler is found for the request, the middleware calls *next*, and the next middleware in the request pipeline is invoked.</span></span>

<span data-ttu-id="ce372-142">L’entrée principale de `RouteAsync` est le [RouteContext.HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*) associé à la requête actuelle.</span><span class="sxs-lookup"><span data-stu-id="ce372-142">The primary input to `RouteAsync` is the [RouteContext.HttpContext](xref:Microsoft.AspNetCore.Routing.RouteContext.HttpContext*) associated with the current request.</span></span> <span data-ttu-id="ce372-143">Le `RouteContext.Handler` et [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) sont des sorties définies après la correspondance d’une route.</span><span class="sxs-lookup"><span data-stu-id="ce372-143">The `RouteContext.Handler` and [RouteContext.RouteData](xref:Microsoft.AspNetCore.Routing.RouteContext.RouteData*) are outputs set after a route matches.</span></span>

<span data-ttu-id="ce372-144">Une correspondance pendant `RouteAsync` définit également les propriétés de `RouteContext.RouteData` avec les valeurs appropriées en fonction du traitement de requête effectué jusqu’à présent.</span><span class="sxs-lookup"><span data-stu-id="ce372-144">A match during `RouteAsync` also sets the properties of the `RouteContext.RouteData` to appropriate values based on the request processing performed thus far.</span></span> <span data-ttu-id="ce372-145">Si une route correspond à une requête, `RouteContext.RouteData` contient des informations d’état importantes concernant le *résultat*.</span><span class="sxs-lookup"><span data-stu-id="ce372-145">If a route matches a request, the `RouteContext.RouteData` contains important state information about the *result*.</span></span>

<span data-ttu-id="ce372-146">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) est un dictionnaire de *valeurs de route* produites à partir de la route.</span><span class="sxs-lookup"><span data-stu-id="ce372-146">[RouteData.Values](xref:Microsoft.AspNetCore.Routing.RouteData.Values*) is a dictionary of *route values* produced from the route.</span></span> <span data-ttu-id="ce372-147">Ces valeurs sont généralement déterminées en décomposant l’URL en jetons. Elles peuvent être utilisées pour accepter l’entrée d’utilisateur ou pour prendre d’autres décisions relatives à la distribution à l’intérieur de l’application.</span><span class="sxs-lookup"><span data-stu-id="ce372-147">These values are usually determined by tokenizing the URL and can be used to accept user input or to make further dispatching decisions inside the app.</span></span>

<span data-ttu-id="ce372-148">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) est un conteneur de propriétés des données supplémentaires associées à la route mise en correspondance.</span><span class="sxs-lookup"><span data-stu-id="ce372-148">[RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*) is a property bag of additional data related to the matched route.</span></span> <span data-ttu-id="ce372-149">Les `DataTokens` sont fournis pour prendre en charge l’association de données d’état à chaque route afin que l’application puisse prendre des décisions ultérieurement en fonction de la route avec laquelle la correspondance a été établie.</span><span class="sxs-lookup"><span data-stu-id="ce372-149">`DataTokens` are provided to support associating state data with each route so that the app can make decisions later based on which route matched.</span></span> <span data-ttu-id="ce372-150">Ces valeurs sont définies par le développeur et n’affectent **pas** le comportement du routage de quelque manière que ce soit.</span><span class="sxs-lookup"><span data-stu-id="ce372-150">These values are developer-defined and do **not** affect the behavior of routing in any way.</span></span> <span data-ttu-id="ce372-151">De plus, les valeurs remisées (stash) dans `RouteData.DataTokens` peuvent être de n’importe quel type, contrairement aux `RouteData.Values`, qui doivent être facilement convertibles en chaînes et à partir de chaînes.</span><span class="sxs-lookup"><span data-stu-id="ce372-151">Additionally, values stashed in `RouteData.DataTokens` can be of any type, in contrast to `RouteData.Values`, which must be easily convertible to and from strings.</span></span>

<span data-ttu-id="ce372-152">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers*) est une liste des routes qui ont participé à la mise en correspondance correcte de la requête.</span><span class="sxs-lookup"><span data-stu-id="ce372-152">[RouteData.Routers](xref:Microsoft.AspNetCore.Routing.RouteData.Routers*) is a list of the routes that took part in successfully matching the request.</span></span> <span data-ttu-id="ce372-153">Les routes peuvent être imbriquées les unes dans les autres.</span><span class="sxs-lookup"><span data-stu-id="ce372-153">Routes can be nested inside of one another.</span></span> <span data-ttu-id="ce372-154">La propriété `Routers` reflète le chemin à travers l’arborescence logique des routes qui ont généré une correspondance.</span><span class="sxs-lookup"><span data-stu-id="ce372-154">The `Routers` property reflects the path through the logical tree of routes that resulted in a match.</span></span> <span data-ttu-id="ce372-155">En général le premier élément de `Routers` est la collection de routes et il doit être utilisé pour la génération d’URL.</span><span class="sxs-lookup"><span data-stu-id="ce372-155">Generally, the first item in `Routers` is the route collection and should be used for URL generation.</span></span> <span data-ttu-id="ce372-156">Le dernier élément de `Routers` est le gestionnaire de routage avec lequel la correspondance a été établie.</span><span class="sxs-lookup"><span data-stu-id="ce372-156">The last item in `Routers` is the route handler that matched.</span></span>

### <a name="url-generation"></a><span data-ttu-id="ce372-157">Génération d’URL</span><span class="sxs-lookup"><span data-stu-id="ce372-157">URL generation</span></span>

<span data-ttu-id="ce372-158">La génération d’URL est le processus par lequel le routage peut créer un chemin d’URL basé sur un ensemble de valeurs de route.</span><span class="sxs-lookup"><span data-stu-id="ce372-158">URL generation is the process by which routing can create a URL path based on a set of route values.</span></span> <span data-ttu-id="ce372-159">Cela permet une séparation logique entre vos gestionnaires et les URL qui y accèdent.</span><span class="sxs-lookup"><span data-stu-id="ce372-159">This allows for a logical separation between your handlers and the URLs that access them.</span></span>

<span data-ttu-id="ce372-160">La génération d’URL suit un processus itératif similaire, mais elle commence par un appel du code utilisateur ou de framework à la méthode <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> de la collection de routes.</span><span class="sxs-lookup"><span data-stu-id="ce372-160">URL generation follows a similar iterative process, but it starts with user or framework code calling into the <xref:Microsoft.AspNetCore.Routing.IRouter.GetVirtualPath*> method of the route collection.</span></span> <span data-ttu-id="ce372-161">La méthode `GetVirtualPath` de chaque *route* est alors appelée en séquence jusqu’à ce qu’un <xref:Microsoft.AspNetCore.Routing.VirtualPathData> non null soit retourné.</span><span class="sxs-lookup"><span data-stu-id="ce372-161">Each *route* then has its `GetVirtualPath` method called in sequence until a non-null <xref:Microsoft.AspNetCore.Routing.VirtualPathData> is returned.</span></span>

<span data-ttu-id="ce372-162">Les entrées principales dans `GetVirtualPath` sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="ce372-162">The primary inputs to `GetVirtualPath` are:</span></span>

* [<span data-ttu-id="ce372-163">VirtualPathContext.HttpContext</span><span class="sxs-lookup"><span data-stu-id="ce372-163">VirtualPathContext.HttpContext</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.HttpContext*)
* [<span data-ttu-id="ce372-164">VirtualPathContext.Values</span><span class="sxs-lookup"><span data-stu-id="ce372-164">VirtualPathContext.Values</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*)
* [<span data-ttu-id="ce372-165">VirtualPathContext.AmbientValues</span><span class="sxs-lookup"><span data-stu-id="ce372-165">VirtualPathContext.AmbientValues</span></span>](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*)

<span data-ttu-id="ce372-166">Les routes utilisent principalement les valeurs de routage fournies par `Values` et `AmbientValues` pour décider où il est possible de générer une URL et quelles sont les valeurs à inclure.</span><span class="sxs-lookup"><span data-stu-id="ce372-166">Routes primarily use the route values provided by the `Values` and `AmbientValues` to decide whether it's possible to generate a URL and what values to include.</span></span> <span data-ttu-id="ce372-167">Les `AmbientValues` sont l’ensemble des valeurs de route produites à partir de la mise en correspondance de la requête actuelle avec le système de routage.</span><span class="sxs-lookup"><span data-stu-id="ce372-167">The `AmbientValues` are the set of route values that were produced from matching the current request with the routing system.</span></span> <span data-ttu-id="ce372-168">En revanche, les `Values` sont les valeurs de route qui spécifient la façon de générer l’URL souhaitée pour l’opération actuelle.</span><span class="sxs-lookup"><span data-stu-id="ce372-168">In contrast, `Values` are the route values that specify how to generate the desired URL for the current operation.</span></span> <span data-ttu-id="ce372-169">`HttpContext` est fourni au cas où une route aurait besoin d’obtenir des services ou des données supplémentaires associés au contexte actuel.</span><span class="sxs-lookup"><span data-stu-id="ce372-169">The `HttpContext` is provided in case a route needs to obtain services or additional data associated with the current context.</span></span>

> [!TIP]
> <span data-ttu-id="ce372-170">Considérez [VirtualPathContext.Values](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) comme un ensemble de substitutions pour [VirtualPathContext.AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*).</span><span class="sxs-lookup"><span data-stu-id="ce372-170">Think of [VirtualPathContext.Values](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.Values*) as being a set of overrides for the [VirtualPathContext.AmbientValues](xref:Microsoft.AspNetCore.Routing.VirtualPathContext.AmbientValues*).</span></span> <span data-ttu-id="ce372-171">La génération d’URL tente de réutiliser des valeurs de route de la requête actuelle afin de faciliter la génération d’URL pour des liens utilisant la même route ou les mêmes valeurs de route.</span><span class="sxs-lookup"><span data-stu-id="ce372-171">URL generation attempts to reuse route values from the current request to make it easy to generate URLs for links using the same route or route values.</span></span>

<span data-ttu-id="ce372-172">La sortie de `GetVirtualPath` est un `VirtualPathData`.</span><span class="sxs-lookup"><span data-stu-id="ce372-172">The output of `GetVirtualPath` is a `VirtualPathData`.</span></span> <span data-ttu-id="ce372-173">`VirtualPathData` est l’équivalent de `RouteData`.</span><span class="sxs-lookup"><span data-stu-id="ce372-173">`VirtualPathData` is a parallel of `RouteData`.</span></span> <span data-ttu-id="ce372-174">`VirtualPathData` contient le `VirtualPath` de l’URL de sortie et des propriétés supplémentaires qui doivent être définies par la route.</span><span class="sxs-lookup"><span data-stu-id="ce372-174">`VirtualPathData` contains the `VirtualPath` for the output URL and some additional properties that should be set by the route.</span></span>

<span data-ttu-id="ce372-175">La propriété [VirtualPathData.VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*) contient le *chemin virtuel* produit par la route.</span><span class="sxs-lookup"><span data-stu-id="ce372-175">The [VirtualPathData.VirtualPath](xref:Microsoft.AspNetCore.Routing.VirtualPathData.VirtualPath*) property contains the *virtual path* produced by the route.</span></span> <span data-ttu-id="ce372-176">Selon vos besoins, vous devrez peut-être traiter plus avant le chemin.</span><span class="sxs-lookup"><span data-stu-id="ce372-176">Depending on your needs, you may need to process the path further.</span></span> <span data-ttu-id="ce372-177">Si vous souhaitez afficher l’URL générée au format HTML, ajoutez un préfixe au chemin de base de l’application.</span><span class="sxs-lookup"><span data-stu-id="ce372-177">If you want to render the generated URL in HTML, prepend the base path of the app.</span></span>

<span data-ttu-id="ce372-178">[VirtualPathData.Router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) est une référence à la route qui a généré avec succès l’URL.</span><span class="sxs-lookup"><span data-stu-id="ce372-178">The [VirtualPathData.Router](xref:Microsoft.AspNetCore.Routing.VirtualPathData.Router*) is a reference to the route that successfully generated the URL.</span></span>

<span data-ttu-id="ce372-179">La propriété [VirtualPathData.DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*) est un dictionnaire de données supplémentaires relatives à la route qui a généré l’URL.</span><span class="sxs-lookup"><span data-stu-id="ce372-179">The [VirtualPathData.DataTokens](xref:Microsoft.AspNetCore.Routing.VirtualPathData.DataTokens*) properties is a dictionary of additional data related to the route that generated the URL.</span></span> <span data-ttu-id="ce372-180">Il s’agit de l’équivalent de [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span><span class="sxs-lookup"><span data-stu-id="ce372-180">This is the parallel of [RouteData.DataTokens](xref:Microsoft.AspNetCore.Routing.RouteData.DataTokens*).</span></span>

### <a name="creating-routes"></a><span data-ttu-id="ce372-181">Création de routes</span><span class="sxs-lookup"><span data-stu-id="ce372-181">Creating routes</span></span>

<span data-ttu-id="ce372-182">Le routage fournit la classe <xref:Microsoft.AspNetCore.Routing.Route> comme implémentation standard d’<xref:Microsoft.AspNetCore.Routing.IRouter>.</span><span class="sxs-lookup"><span data-stu-id="ce372-182">Routing provides the <xref:Microsoft.AspNetCore.Routing.Route> class as the standard implementation of <xref:Microsoft.AspNetCore.Routing.IRouter>.</span></span> <span data-ttu-id="ce372-183">`Route` utilise la syntaxe de *modèle de routage* pour définir les modèles qui correspondent au chemin d’URL quand <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> est appelé.</span><span class="sxs-lookup"><span data-stu-id="ce372-183">`Route` uses the *route template* syntax to define patterns that match against the URL path when <xref:Microsoft.AspNetCore.Routing.IRouter.RouteAsync*> is called.</span></span> <span data-ttu-id="ce372-184">`Route` utilise le même modèle de routage pour générer une URL quand `GetVirtualPath` est appelé.</span><span class="sxs-lookup"><span data-stu-id="ce372-184">`Route` uses the same route template to generate a URL when `GetVirtualPath` is called.</span></span>

<span data-ttu-id="ce372-185">La plupart des applications créent des routes en appelant <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> ou l’une des méthodes d’extension similaires définies sur <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="ce372-185">Most apps create routes by calling <xref:Microsoft.AspNetCore.Builder.MapRouteRouteBuilderExtensions.MapRoute*> or one of the similar extension methods defined on <xref:Microsoft.AspNetCore.Routing.IRouteBuilder>.</span></span> <span data-ttu-id="ce372-186">Toutes ces méthodes créent une instance de <xref:Microsoft.AspNetCore.Routing.Route> et l’ajoutent à la collection de routes.</span><span class="sxs-lookup"><span data-stu-id="ce372-186">All of these methods create an instance of <xref:Microsoft.AspNetCore.Routing.Route> and add it to the route collection.</span></span>

<span data-ttu-id="ce372-187">`MapRoute` ne prend pas de paramètre de gestionnaire de routage.</span><span class="sxs-lookup"><span data-stu-id="ce372-187">`MapRoute` doesn't take a route handler parameter.</span></span> <span data-ttu-id="ce372-188">`MapRoute` ajoute uniquement des routes gérées par <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="ce372-188">`MapRoute` only adds routes that are handled by the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span> <span data-ttu-id="ce372-189">Étant donné que le gestionnaire par défaut est un `IRouter`, il peut décider de ne pas traiter la requête.</span><span class="sxs-lookup"><span data-stu-id="ce372-189">Since the default handler is an `IRouter`, it may decide not to handle the request.</span></span> <span data-ttu-id="ce372-190">Par exemple, ASP.NET Core MVC est généralement configuré comme gestionnaire par défaut qui gère uniquement les requêtes correspondant à un contrôleur et une action disponibles.</span><span class="sxs-lookup"><span data-stu-id="ce372-190">For example, ASP.NET Core MVC is typically configured as a default handler that only handles requests that match an available controller and action.</span></span> <span data-ttu-id="ce372-191">Pour en savoir plus sur le routage vers MVC, consultez <xref:mvc/controllers/routing>.</span><span class="sxs-lookup"><span data-stu-id="ce372-191">To learn more about routing to MVC, see <xref:mvc/controllers/routing>.</span></span>

<span data-ttu-id="ce372-192">L’exemple de code suivant est un exemple d’appel à `MapRoute` utilisé par une définition de route ASP.NET Core MVC classique :</span><span class="sxs-lookup"><span data-stu-id="ce372-192">The following code example is an example of a `MapRoute` call used by a typical ASP.NET Core MVC route definition:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="ce372-193">Ce modèle établit une correspondance avec un chemin d’URL comme `/Products/Details/17`, et extrait les valeurs de route `{ controller = Products, action = Details, id = 17 }`.</span><span class="sxs-lookup"><span data-stu-id="ce372-193">This template matches a URL path like `/Products/Details/17` and extracts the route values `{ controller = Products, action = Details, id = 17 }`.</span></span> <span data-ttu-id="ce372-194">Les valeurs de route sont déterminées par le fractionnement du chemin d’URL en segments et la mise en correspondance de chaque segment avec le nom des *paramètres de routage* dans le modèle de routage.</span><span class="sxs-lookup"><span data-stu-id="ce372-194">The route values are determined by splitting the URL path into segments and matching each segment with the *route parameter* name in the route template.</span></span> <span data-ttu-id="ce372-195">Les paramètres de routage sont nommés.</span><span class="sxs-lookup"><span data-stu-id="ce372-195">Route parameters are named.</span></span> <span data-ttu-id="ce372-196">Ils sont définis en plaçant le nom du paramètre entre accolades `{ ... }`.</span><span class="sxs-lookup"><span data-stu-id="ce372-196">They're defined by enclosing the parameter name in braces `{ ... }`.</span></span>

<span data-ttu-id="ce372-197">Le modèle précédent peut également mettre en correspondance le chemin d’URL `/` et produirait les valeurs `{ controller = Home, action = Index }`.</span><span class="sxs-lookup"><span data-stu-id="ce372-197">The preceding template could also match the URL path `/` and would produce the values `{ controller = Home, action = Index }`.</span></span> <span data-ttu-id="ce372-198">Cela s’explique par le fait que les paramètres de routage `{controller}` et `{action}` ont des valeurs par défaut et que le paramètre de routage `id` est facultatif.</span><span class="sxs-lookup"><span data-stu-id="ce372-198">This occurs because the `{controller}` and `{action}` route parameters have default values and the `id` route parameter is optional.</span></span> <span data-ttu-id="ce372-199">Un signe égal `=` suivi d’une valeur après le nom du paramètre de routage définit une valeur par défaut pour le paramètre.</span><span class="sxs-lookup"><span data-stu-id="ce372-199">An equals `=` sign followed by a value after the route parameter name defines a default value for the parameter.</span></span> <span data-ttu-id="ce372-200">Un point d’interrogation `?` après le nom du paramètre de routage définit le paramètre comme facultatif.</span><span class="sxs-lookup"><span data-stu-id="ce372-200">A question mark `?` after the route parameter name defines the parameter as optional.</span></span> <span data-ttu-id="ce372-201">Les paramètres de routage ayant une valeur par défaut produisent *toujours* une valeur de routage quand la route correspond.</span><span class="sxs-lookup"><span data-stu-id="ce372-201">Route parameters with a default value *always* produce a route value when the route matches.</span></span> <span data-ttu-id="ce372-202">Les paramètres facultatifs ne produisent pas de valeur de routage si aucun segment de chemin d’URL ne correspondait.</span><span class="sxs-lookup"><span data-stu-id="ce372-202">Optional parameters don't produce a route value if there was no corresponding URL path segment.</span></span>

<span data-ttu-id="ce372-203">Pour obtenir une description complète des fonctionnalités et de la syntaxe des modèles de routage, consultez [Informations de référence sur les modèles de routage](#route-template-reference).</span><span class="sxs-lookup"><span data-stu-id="ce372-203">See [route-template-reference](#route-template-reference) for a thorough description of route template features and syntax.</span></span>

<span data-ttu-id="ce372-204">Cet exemple inclut une *contrainte de routage* :</span><span class="sxs-lookup"><span data-stu-id="ce372-204">This example includes a *route constraint*:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id:int}");
```

<span data-ttu-id="ce372-205">Ce modèle établit une correspondance avec un chemin d’URL comme `/Products/Details/17`, mais pas `/Products/Details/Apples`.</span><span class="sxs-lookup"><span data-stu-id="ce372-205">This template matches a URL path like `/Products/Details/17` but not `/Products/Details/Apples`.</span></span> <span data-ttu-id="ce372-206">La définition de paramètre de routage `{id:int}` définit une [contrainte de routage](#route-constraint-reference) pour le paramètre de routage `id`.</span><span class="sxs-lookup"><span data-stu-id="ce372-206">The route parameter definition `{id:int}` defines a [route constraint](#route-constraint-reference) for the `id` route parameter.</span></span> <span data-ttu-id="ce372-207">Les contraintes de routage implémentent <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> et inspectent les valeurs de route pour les vérifier.</span><span class="sxs-lookup"><span data-stu-id="ce372-207">Route constraints implement <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> and inspect route values to verify them.</span></span> <span data-ttu-id="ce372-208">Dans cet exemple, la valeur de route `id` doit être convertible en entier.</span><span class="sxs-lookup"><span data-stu-id="ce372-208">In this example, the route value `id` must be convertible to an integer.</span></span> <span data-ttu-id="ce372-209">Pour obtenir une explication plus détaillée des contraintes de routage fournies par le framework, consultez [Informations de référence sur les contraintes de routage](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="ce372-209">See [route-constraint-reference](#route-constraint-reference) for a more detailed explanation of route constraints that are provided by the framework.</span></span>

<span data-ttu-id="ce372-210">Des surcharges supplémentaires de `MapRoute` acceptent des values pour `constraints`, `dataTokens` et `defaults`.</span><span class="sxs-lookup"><span data-stu-id="ce372-210">Additional overloads of `MapRoute` accept values for `constraints`, `dataTokens`, and `defaults`.</span></span> <span data-ttu-id="ce372-211">Ces paramètres supplémentaires de `MapRoute` sont définis comme type `object`.</span><span class="sxs-lookup"><span data-stu-id="ce372-211">These additional parameters of `MapRoute` are defined as type `object`.</span></span> <span data-ttu-id="ce372-212">L’utilisation classique de ces paramètres consiste à passer un objet typé anonymement, où les noms des propriétés du type anonyme correspondent aux noms de paramètre de routage.</span><span class="sxs-lookup"><span data-stu-id="ce372-212">The typical usage of these parameters is to pass an anonymously typed object, where the property names of the anonymous type match route parameter names.</span></span>

<span data-ttu-id="ce372-213">Les deux exemples suivants créent des routes équivalentes :</span><span class="sxs-lookup"><span data-stu-id="ce372-213">The following two examples create equivalent routes:</span></span>

```csharp
routes.MapRoute(
    name: "default_route",
    template: "{controller}/{action}/{id?}",
    defaults: new { controller = "Home", action = "Index" });

routes.MapRoute(
    name: "default_route",
    template: "{controller=Home}/{action=Index}/{id?}");
```

> [!TIP]
> <span data-ttu-id="ce372-214">La syntaxe inline pour la définition des contraintes et des valeurs par défaut peut être pratique pour les routes simples.</span><span class="sxs-lookup"><span data-stu-id="ce372-214">The inline syntax for defining constraints and defaults can be convenient for simple routes.</span></span> <span data-ttu-id="ce372-215">Toutefois, certaines fonctionnalités comme les jetons de données ne sont pas prises en charge par la syntaxe inline.</span><span class="sxs-lookup"><span data-stu-id="ce372-215">However, there are features, such as data tokens, that aren't supported by inline syntax.</span></span>

<span data-ttu-id="ce372-216">L’exemple suivant illustre quelques autres scénarios :</span><span class="sxs-lookup"><span data-stu-id="ce372-216">The following example demonstrates a few more scenarios:</span></span>

```csharp
routes.MapRoute(
    name: "blog",
    template: "Blog/{*article}",
    defaults: new { controller = "Blog", action = "ReadArticle" });
```

<span data-ttu-id="ce372-217">Ce modèle établit une correspondance avec un chemin d’URL comme `/Blog/All-About-Routing/Introduction`, et extrait les valeurs `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span><span class="sxs-lookup"><span data-stu-id="ce372-217">This template matches a URL path like `/Blog/All-About-Routing/Introduction` and extracts the values `{ controller = Blog, action = ReadArticle, article = All-About-Routing/Introduction }`.</span></span> <span data-ttu-id="ce372-218">Les valeurs de route par défaut pour `controller` et `action` sont produites par la route, même s’il n’existe aucun paramètre de routage correspondant dans le modèle.</span><span class="sxs-lookup"><span data-stu-id="ce372-218">The default route values for `controller` and `action` are produced by the route even though there are no corresponding route parameters in the template.</span></span> <span data-ttu-id="ce372-219">Il est possible de spécifier des valeurs par défaut dans le modèle de route.</span><span class="sxs-lookup"><span data-stu-id="ce372-219">Default values can be specified in the route template.</span></span> <span data-ttu-id="ce372-220">Le paramètre de routage `article` est défini comme un *fourre-tout*  par la présence d’un astérisque `*` avant le nom de paramètre de routage.</span><span class="sxs-lookup"><span data-stu-id="ce372-220">The `article` route parameter is defined as a *catch-all* by the appearance of an asterisk `*` before the route parameter name.</span></span> <span data-ttu-id="ce372-221">Les paramètres de routage fourre-tout capturent le reste du chemin d’URL et peuvent également établir une correspondance avec la chaîne vide.</span><span class="sxs-lookup"><span data-stu-id="ce372-221">Catch-all route parameters capture the remainder of the URL path and can also match the empty string.</span></span>

<span data-ttu-id="ce372-222">Cet exemple ajoute des contraintes de routage et des jetons de données :</span><span class="sxs-lookup"><span data-stu-id="ce372-222">This example adds route constraints and data tokens:</span></span>

```csharp
routes.MapRoute(
    name: "us_english_products",
    template: "en-US/Products/{id}",
    defaults: new { controller = "Products", action = "Details" },
    constraints: new { id = new IntRouteConstraint() },
    dataTokens: new { locale = "en-US" });
```

<span data-ttu-id="ce372-223">Ce modèle établit une correspondance avec un chemin d’URL comme `/en-US/Products/5`, et extrait les valeurs `{ controller = Products, action = Details, id = 5 }` et les jetons de données `{ locale = en-US }`.</span><span class="sxs-lookup"><span data-stu-id="ce372-223">This template matches a URL path like `/en-US/Products/5` and extracts the values `{ controller = Products, action = Details, id = 5 }` and the data tokens `{ locale = en-US }`.</span></span>

![Jetons Windows de variables locales](routing/_static/tokens.png)

### <a name="url-generation"></a><span data-ttu-id="ce372-225">Génération d’URL</span><span class="sxs-lookup"><span data-stu-id="ce372-225">URL generation</span></span>

<span data-ttu-id="ce372-226">La classe `Route` peut également effectuer une génération d’URL en combinant un ensemble de valeurs de route et son modèle de routage.</span><span class="sxs-lookup"><span data-stu-id="ce372-226">The `Route` class can also perform URL generation by combining a set of route values with its route template.</span></span> <span data-ttu-id="ce372-227">Il s’agit logiquement du processus inverse de la mise en correspondance du chemin d’URL.</span><span class="sxs-lookup"><span data-stu-id="ce372-227">This is logically the reverse process of matching the URL path.</span></span>

> [!TIP]
> <span data-ttu-id="ce372-228">Pour mieux comprendre la génération d’URL, imaginez l’URL que vous voulez générer, puis pensez à la façon dont un modèle de routage établirait une correspondance avec cette URL.</span><span class="sxs-lookup"><span data-stu-id="ce372-228">To better understand URL generation, imagine what URL you want to generate and then think about how a route template would match that URL.</span></span> <span data-ttu-id="ce372-229">Quelles valeurs seraient produites ?</span><span class="sxs-lookup"><span data-stu-id="ce372-229">What values would be produced?</span></span> <span data-ttu-id="ce372-230">Cela équivaut approximativement à la façon dont la génération d’URL fonctionne dans la classe `Route`.</span><span class="sxs-lookup"><span data-stu-id="ce372-230">This is the rough equivalent of how URL generation works in the `Route` class.</span></span>

<span data-ttu-id="ce372-231">Cet exemple utilise une route de style ASP.NET Core MVC de base :</span><span class="sxs-lookup"><span data-stu-id="ce372-231">This example uses a basic ASP.NET Core MVC style route:</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
```

<span data-ttu-id="ce372-232">Avec les valeurs de route `{ controller = Products, action = List }`, cette route génère l’URL `/Products/List`.</span><span class="sxs-lookup"><span data-stu-id="ce372-232">With the route values `{ controller = Products, action = List }`, this route generates the URL `/Products/List`.</span></span> <span data-ttu-id="ce372-233">Les valeurs de route remplacent les paramètres de routage correspondant pour former le chemin d’URL.</span><span class="sxs-lookup"><span data-stu-id="ce372-233">The route values are substituted for the corresponding route parameters to form the URL path.</span></span> <span data-ttu-id="ce372-234">Étant donné qu’`id` est un paramètre de routage facultatif, ce n’est pas un problème qu’il n’ait pas de valeur.</span><span class="sxs-lookup"><span data-stu-id="ce372-234">Since `id` is an optional route parameter, it's no problem that it doesn't have a value.</span></span>

<span data-ttu-id="ce372-235">Avec les valeurs de route `{ controller = Home, action = Index }`, cette route génère l’URL `/`.</span><span class="sxs-lookup"><span data-stu-id="ce372-235">With the route values `{ controller = Home, action = Index }`, this route generates the URL `/`.</span></span> <span data-ttu-id="ce372-236">Les valeurs de route fournies sont mises en correspondance avec les valeurs par défaut afin que les segments correspondant à ces valeurs peuissent être omis sans risque.</span><span class="sxs-lookup"><span data-stu-id="ce372-236">The route values that were provided match the default values so that the segments corresponding to those values can be safely omitted.</span></span> <span data-ttu-id="ce372-237">Les deux URL générées effectuent un aller-retour avec cette définition de route, et produisent les mêmes valeurs de route que celles utilisées pour générer l’URL.</span><span class="sxs-lookup"><span data-stu-id="ce372-237">Both URLs generated round-trip with this route definition and produce the same route values that were used to generate the URL.</span></span>

> [!TIP]
> <span data-ttu-id="ce372-238">Pour générer des URL, une application utilisant ASP.NET Core MVC doit utiliser <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> au lieu d’effectuer un appel directement dans le routage.</span><span class="sxs-lookup"><span data-stu-id="ce372-238">An app using ASP.NET Core MVC should use <xref:Microsoft.AspNetCore.Mvc.Routing.UrlHelper> to generate URLs instead of calling into routing directly.</span></span>

<span data-ttu-id="ce372-239">Pour plus d’informations sur la génération d’URL, consultez [Informations de référence sur la génération d’URL](#url-generation-reference).</span><span class="sxs-lookup"><span data-stu-id="ce372-239">For more information about URL generation, see [url-generation-reference](#url-generation-reference).</span></span>

## <a name="use-routing-middleware"></a><span data-ttu-id="ce372-240">Utilisation du middleware de routage</span><span class="sxs-lookup"><span data-stu-id="ce372-240">Use Routing Middleware</span></span>

::: moniker range=">= aspnetcore-2.1"

<span data-ttu-id="ce372-241">Référencez le [métapackage Microsoft.AspNetCore.App](xref:fundamentals/metapackage-app) dans le fichier projet de l’application.</span><span class="sxs-lookup"><span data-stu-id="ce372-241">Reference the [Microsoft.AspNetCore.App metapackage](xref:fundamentals/metapackage-app) in the app's project file.</span></span>

::: moniker-end

::: moniker range="= aspnetcore-2.0"

<span data-ttu-id="ce372-242">Référencez le [métapackage Microsoft.AspNetCore.All](xref:fundamentals/metapackage) dans le fichier projet de l’application.</span><span class="sxs-lookup"><span data-stu-id="ce372-242">Reference the [Microsoft.AspNetCore.All metapackage](xref:fundamentals/metapackage) in the app's project file.</span></span>

::: moniker-end

::: moniker range="< aspnetcore-2.0"

<span data-ttu-id="ce372-243">Référencez [Microsoft.AspNetCore.Routing](https://www.nuget.org/packages/Microsoft.AspNetCore.Routing/) dans le fichier projet de l’application.</span><span class="sxs-lookup"><span data-stu-id="ce372-243">Reference the [Microsoft.AspNetCore.Routing](https://www.nuget.org/packages/Microsoft.AspNetCore.Routing/) in the app's project file.</span></span>

::: moniker-end

<span data-ttu-id="ce372-244">Ajoutez le routage au conteneur de service dans `Startup.ConfigureServices` :</span><span class="sxs-lookup"><span data-stu-id="ce372-244">Add routing to the service container in `Startup.ConfigureServices`:</span></span>

::: moniker range=">= aspnetcore-2.0"

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

::: moniker-end

::: moniker range="< aspnetcore-2.0"

[!code-csharp[](routing/samples/1.x/RoutingSample/Startup.cs?name=snippet_ConfigureServices&highlight=3)]

::: moniker-end

<span data-ttu-id="ce372-245">Les routes doivent être configurées dans la méthode `Startup.Configure`.</span><span class="sxs-lookup"><span data-stu-id="ce372-245">Routes must be configured in the `Startup.Configure` method.</span></span> <span data-ttu-id="ce372-246">L’exemple d’application utilise ces API :</span><span class="sxs-lookup"><span data-stu-id="ce372-246">The sample app uses these APIs:</span></span>

* `RouteBuilder`
* `Build`
* <span data-ttu-id="ce372-247">`MapGet` &ndash; Établit une correspondance uniquement avec les requêtes HTTP GET.</span><span class="sxs-lookup"><span data-stu-id="ce372-247">`MapGet` &ndash; Matches only HTTP GET requests.</span></span>
* `UseRouter`

::: moniker range=">= aspnetcore-2.0"

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

::: moniker-end

::: moniker range="< aspnetcore-2.0"

[!code-csharp[](routing/samples/1.x/RoutingSample/Startup.cs?name=snippet_RouteHandler)]

::: moniker-end

<span data-ttu-id="ce372-248">Le tableau suivant montre les réponses avec les URI donnés.</span><span class="sxs-lookup"><span data-stu-id="ce372-248">The following table shows the responses with the given URIs.</span></span>

| <span data-ttu-id="ce372-249">URI</span><span class="sxs-lookup"><span data-stu-id="ce372-249">URI</span></span>                  | <span data-ttu-id="ce372-250">Réponse</span><span class="sxs-lookup"><span data-stu-id="ce372-250">Response</span></span>                                          |
| -------------------- | ------------------------------------------------- |
| <span data-ttu-id="ce372-251">/package/create/3</span><span class="sxs-lookup"><span data-stu-id="ce372-251">/package/create/3</span></span>    | <span data-ttu-id="ce372-252">Hello!</span><span class="sxs-lookup"><span data-stu-id="ce372-252">Hello!</span></span> <span data-ttu-id="ce372-253">Valeurs de route : [operation, create], [id, 3]</span><span class="sxs-lookup"><span data-stu-id="ce372-253">Route values: [operation, create], [id, 3]</span></span> |
| <span data-ttu-id="ce372-254">/package/track/-3</span><span class="sxs-lookup"><span data-stu-id="ce372-254">/package/track/-3</span></span>    | <span data-ttu-id="ce372-255">Hello!</span><span class="sxs-lookup"><span data-stu-id="ce372-255">Hello!</span></span> <span data-ttu-id="ce372-256">Valeurs de route : [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="ce372-256">Route values: [operation, track], [id, -3]</span></span> |
| <span data-ttu-id="ce372-257">/package/track/-3/</span><span class="sxs-lookup"><span data-stu-id="ce372-257">/package/track/-3/</span></span>   | <span data-ttu-id="ce372-258">Hello!</span><span class="sxs-lookup"><span data-stu-id="ce372-258">Hello!</span></span> <span data-ttu-id="ce372-259">Valeurs de route : [operation, track], [id, -3]</span><span class="sxs-lookup"><span data-stu-id="ce372-259">Route values: [operation, track], [id, -3]</span></span> |
| <span data-ttu-id="ce372-260">/package/track/</span><span class="sxs-lookup"><span data-stu-id="ce372-260">/package/track/</span></span>      | <span data-ttu-id="ce372-261">&lt;Fourre-tout, aucune correspondance&gt;</span><span class="sxs-lookup"><span data-stu-id="ce372-261">&lt;Fall through, no match&gt;</span></span>                    |
| <span data-ttu-id="ce372-262">GET /hello/Joe</span><span class="sxs-lookup"><span data-stu-id="ce372-262">GET /hello/Joe</span></span>       | <span data-ttu-id="ce372-263">Hi, Joe!</span><span class="sxs-lookup"><span data-stu-id="ce372-263">Hi, Joe!</span></span>                                          |
| <span data-ttu-id="ce372-264">POST /hello/Joe</span><span class="sxs-lookup"><span data-stu-id="ce372-264">POST /hello/Joe</span></span>      | <span data-ttu-id="ce372-265">&lt;Fourre-tout, établir une correspondance avec HTTP GET uniquement&gt;</span><span class="sxs-lookup"><span data-stu-id="ce372-265">&lt;Fall through, matches HTTP GET only&gt;</span></span>       |
| <span data-ttu-id="ce372-266">GET /hello/Joe/Smith</span><span class="sxs-lookup"><span data-stu-id="ce372-266">GET /hello/Joe/Smith</span></span> | <span data-ttu-id="ce372-267">&lt;Fourre-tout, aucune correspondance&gt;</span><span class="sxs-lookup"><span data-stu-id="ce372-267">&lt;Fall through, no match&gt;</span></span>                    |

<span data-ttu-id="ce372-268">Si vous configurez une seule route, appelez <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*> en passant une instance `IRouter`.</span><span class="sxs-lookup"><span data-stu-id="ce372-268">If you're configuring a single route, call <xref:Microsoft.AspNetCore.Builder.RoutingBuilderExtensions.UseRouter*> passing in an `IRouter` instance.</span></span> <span data-ttu-id="ce372-269">Vous n’avez pas besoin d’utiliser <xref:Microsoft.AspNetCore.Routing.RouteBuilder>.</span><span class="sxs-lookup"><span data-stu-id="ce372-269">You won't need to use <xref:Microsoft.AspNetCore.Routing.RouteBuilder>.</span></span>

<span data-ttu-id="ce372-270">Le framework fournit un ensemble de méthodes d’extension pour la création de routes, notamment :</span><span class="sxs-lookup"><span data-stu-id="ce372-270">The framework provides a set of extension methods for creating routes, such as:</span></span>

* `MapRoute`
* `MapGet`
* `MapPost`
* `MapPut`
* `MapDelete`
* `MapVerb`

<span data-ttu-id="ce372-271">Certaines de ces méthodes, comme `MapGet`, nécessitent qu’un `RequestDelegate` soit fourni.</span><span class="sxs-lookup"><span data-stu-id="ce372-271">Some of these methods, such as `MapGet`, require a `RequestDelegate` to be provided.</span></span> <span data-ttu-id="ce372-272">`RequestDelegate` est utilisé comme *gestionnaire de routage* quand une correspondance est trouvée pour la route.</span><span class="sxs-lookup"><span data-stu-id="ce372-272">The `RequestDelegate` is used as the *route handler* when the route matches.</span></span> <span data-ttu-id="ce372-273">D’autres méthodes de cette famille permettent de configurer un pipeline de middleware utilisé comme gestionnaire de routage.</span><span class="sxs-lookup"><span data-stu-id="ce372-273">Other methods in this family allow configuring a middleware pipeline for use as the route handler.</span></span> <span data-ttu-id="ce372-274">Si la méthode *Map* n’accepte pas de gestionnaire, par exemple `MapRoute`, elle utilise <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span><span class="sxs-lookup"><span data-stu-id="ce372-274">If the *Map* method doesn't accept a handler, such as `MapRoute`, then it uses the <xref:Microsoft.AspNetCore.Routing.RouteBuilder.DefaultHandler*>.</span></span>

<span data-ttu-id="ce372-275">Les méthodes `Map[Verb]` utilisent des contraintes pour limiter la route au verbe HTTP dans le nom de la méthode.</span><span class="sxs-lookup"><span data-stu-id="ce372-275">The `Map[Verb]` methods use constraints to limit the route to the HTTP Verb in the method name.</span></span> <span data-ttu-id="ce372-276">Par exemple, consultez <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> et <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span><span class="sxs-lookup"><span data-stu-id="ce372-276">For example, see <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapGet*> and <xref:Microsoft.AspNetCore.Routing.RequestDelegateRouteBuilderExtensions.MapVerb*>.</span></span>

## <a name="route-template-reference"></a><span data-ttu-id="ce372-277">Informations de référence sur les modèles de routage</span><span class="sxs-lookup"><span data-stu-id="ce372-277">Route template reference</span></span>

<span data-ttu-id="ce372-278">Les jetons placés entre accolades (`{ ... }`) définissent des *paramètres de routage* qui sont liés si une correspondance est trouvée pour la route.</span><span class="sxs-lookup"><span data-stu-id="ce372-278">Tokens within curly braces (`{ ... }`) define *route parameters* that are bound if the route is matched.</span></span> <span data-ttu-id="ce372-279">Vous pouvez définir plusieurs paramètres de routage dans un segment de route, mais ils doivent être séparés par une valeur littérale.</span><span class="sxs-lookup"><span data-stu-id="ce372-279">You can define more than one route parameter in a route segment, but they must be separated by a literal value.</span></span> <span data-ttu-id="ce372-280">Par exemple `{controller=Home}{action=Index}` n’est pas une route valide, car il n’y a aucune valeur littérale entre `{controller}` et `{action}`.</span><span class="sxs-lookup"><span data-stu-id="ce372-280">For example, `{controller=Home}{action=Index}` isn't a valid route, since there's no literal value between `{controller}` and `{action}`.</span></span> <span data-ttu-id="ce372-281">Ces paramètres de routage doivent avoir un nom, et ils autorisent la spécification d’attributs supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="ce372-281">These route parameters must have a name and may have additional attributes specified.</span></span>

<span data-ttu-id="ce372-282">Un texte littéral autre que les paramètres de routage (par exemple, `{id}`) et le séparateur de chemin `/` doit correspondre au texte présent dans l’URL.</span><span class="sxs-lookup"><span data-stu-id="ce372-282">Literal text other than route parameters (for example, `{id}`) and the path separator `/` must match the text in the URL.</span></span> <span data-ttu-id="ce372-283">La correspondance de texte ne respecte pas la casse et est basée sur la représentation décodée du chemin des URL.</span><span class="sxs-lookup"><span data-stu-id="ce372-283">Text matching is case-insensitive and based on the decoded representation of the URLs path.</span></span> <span data-ttu-id="ce372-284">Pour mettre en correspondance le délimiteur de paramètre de routage littéral `{` ou `}`, placez-le dans une séquence d’échappement en répétant le caractère (`{{` ou `}}`).</span><span class="sxs-lookup"><span data-stu-id="ce372-284">To match the literal route parameter delimiter `{` or  `}`, escape it by repeating the character (`{{` or `}}`).</span></span>

<span data-ttu-id="ce372-285">Les modèles d’URL qui tentent de capturer un nom de fichier avec une extension de fichier facultative font l’objet de considérations supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="ce372-285">URL patterns that attempt to capture a filename with an optional file extension have additional considerations.</span></span> <span data-ttu-id="ce372-286">Prenez par exemple le modèle `files/{filename}.{ext?}`.</span><span class="sxs-lookup"><span data-stu-id="ce372-286">For example, consider the template `files/{filename}.{ext?}`.</span></span> <span data-ttu-id="ce372-287">Quand `filename` et `ext` existe tous deux, les deux valeurs sont remplies.</span><span class="sxs-lookup"><span data-stu-id="ce372-287">When both `filename` and `ext` exist, both values are populated.</span></span> <span data-ttu-id="ce372-288">Si seul `filename` existe dans l’URL, une correspondance est trouvée pour la route, car le point final `.` est facultatif.</span><span class="sxs-lookup"><span data-stu-id="ce372-288">If only `filename` exists in the URL, the route matches because the trailing period `.` is  optional.</span></span> <span data-ttu-id="ce372-289">Les URL suivantes correspondent à cette route :</span><span class="sxs-lookup"><span data-stu-id="ce372-289">The following URLs match this route:</span></span>

* `/files/myFile.txt`
* `/files/myFile`

<span data-ttu-id="ce372-290">Vous pouvez utiliser le caractère `*` comme préfixe d’un paramètre de routage à lier au reste de l’URI.</span><span class="sxs-lookup"><span data-stu-id="ce372-290">You can use the `*` character as a prefix to a route parameter to bind to the rest of the URI.</span></span> <span data-ttu-id="ce372-291">Cela s’appelle un paramètre *fourre-tout*.</span><span class="sxs-lookup"><span data-stu-id="ce372-291">This is called a *catch-all* parameter.</span></span> <span data-ttu-id="ce372-292">Par exemple, `blog/{*slug}` établit une correspondance avec n’importe quel URI commençant par `/blog` et suivi de n’importe quelle valeur (affectée à la valeur de route `slug`).</span><span class="sxs-lookup"><span data-stu-id="ce372-292">For example, `blog/{*slug}` matches any URI that starts with `/blog` and had any value following it (which is assigned to the `slug` route value).</span></span> <span data-ttu-id="ce372-293">Les paramètres fourre-tout peuvent également établir une correspondance avec la chaîne vide.</span><span class="sxs-lookup"><span data-stu-id="ce372-293">Catch-all parameters can also match the empty string.</span></span>

::: moniker range=">= aspnetcore-2.2"

<span data-ttu-id="ce372-294">Le paramètre fourre-tout place les caractères appropriés dans une séquence d’échappement lorsque la route est utilisée pour générer une URL, y compris les caractères de séparation de chemin (`/`).</span><span class="sxs-lookup"><span data-stu-id="ce372-294">The catch-all parameter escapes the appropriate characters when the route is used to generate a URL, including path separator (`/`) characters.</span></span> <span data-ttu-id="ce372-295">Par exemple, la route `foo/{*path}` avec les valeurs de route `{ path = "my/path" }` génère `foo/my%2Fpath`.</span><span class="sxs-lookup"><span data-stu-id="ce372-295">For example, the route `foo/{*path}` with route values `{ path = "my/path" }` generates `foo/my%2Fpath`.</span></span> <span data-ttu-id="ce372-296">Notez la barre oblique d’échappement.</span><span class="sxs-lookup"><span data-stu-id="ce372-296">Note the escaped forward slash.</span></span> <span data-ttu-id="ce372-297">Pour les séparateurs de chemin aller-retour, utilisez le préfixe de paramètre de routage `**`.</span><span class="sxs-lookup"><span data-stu-id="ce372-297">To round-trip path separator characters, use the `**` route parameter prefix.</span></span> <span data-ttu-id="ce372-298">La route `foo/{**path}` avec `{ path = "my/path" }` génère `foo/my/path`.</span><span class="sxs-lookup"><span data-stu-id="ce372-298">The route `foo/{**path}` with `{ path = "my/path" }` generates `foo/my/path`.</span></span>

::: moniker-end

<span data-ttu-id="ce372-299">Les paramètres de routage peuvent avoir des *valeurs par défaut*, désignées en spécifiant la valeur par défaut après le nom du paramètre, séparés par un signe égal (`=`).</span><span class="sxs-lookup"><span data-stu-id="ce372-299">Route parameters may have *default values*, designated by specifying the default after the parameter name, separated by an equals sign (`=`).</span></span> <span data-ttu-id="ce372-300">Par exemple, `{controller=Home}` définit `Home` comme valeur par défaut de `controller`.</span><span class="sxs-lookup"><span data-stu-id="ce372-300">For example, `{controller=Home}` defines `Home` as the default value for `controller`.</span></span> <span data-ttu-id="ce372-301">La valeur par défaut est utilisée si aucune valeur n’est présente dans l’URL pour le paramètre.</span><span class="sxs-lookup"><span data-stu-id="ce372-301">The default value is used if no value is present in the URL for the parameter.</span></span> <span data-ttu-id="ce372-302">En plus des valeurs par défaut, les paramètres de routage peuvent être facultatifs, spécifiés en ajoutant un point d’interrogation (`?`) à la fin du nom du paramètre, comme dans `id?`.</span><span class="sxs-lookup"><span data-stu-id="ce372-302">In addition to default values, route parameters may be optional, specified by appending a question mark (`?`) to the end of the parameter name, as in `id?`.</span></span> <span data-ttu-id="ce372-303">La différence entre les valeurs facultatives et les paramètres de routage par défaut est qu’un paramètre de routage ayant une valeur par défaut produit toujours une valeur, tandis qu’un paramètre facultatif a une valeur uniquement quand une valeur est fournie par l’URL de requête.</span><span class="sxs-lookup"><span data-stu-id="ce372-303">The difference between optional values and default route parameters is that a route parameter with a default value always produces a value; an optional parameter has a value only when a value is provided by the request URL.</span></span>

::: moniker range=">= aspnetcore-2.2"

<span data-ttu-id="ce372-304">Les paramètres de routage peuvent avoir des contraintes, qui doivent établir une correspondance avec la valeur de route liée à partir de l’URL.</span><span class="sxs-lookup"><span data-stu-id="ce372-304">Route parameters may have constraints, which must match the route value bound from the URL.</span></span> <span data-ttu-id="ce372-305">L’ajout d’un signe deux-points (`:`) et d’un nom de contrainte après le nom du paramètre de routage spécifie une *contrainte inline* sur un paramètre de routage.</span><span class="sxs-lookup"><span data-stu-id="ce372-305">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="ce372-306">Si la contrainte exige des arguments, ils sont fournis entre parenthèses `( )` après le nom de la contrainte.</span><span class="sxs-lookup"><span data-stu-id="ce372-306">If the constraint requires arguments, they're enclosed in parentheses `( )` after the constraint name.</span></span> <span data-ttu-id="ce372-307">Il est possible de spécifier plusieurs contraintes inline en ajoutant un autre signe deux-points (`:`) et le nom d’une autre contrainte.</span><span class="sxs-lookup"><span data-stu-id="ce372-307">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span> <span data-ttu-id="ce372-308">Le nom de la contrainte et les arguments sont passés au service <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> pour créer une instance de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> à utiliser dans le traitement des URL.</span><span class="sxs-lookup"><span data-stu-id="ce372-308">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="ce372-309">Si le constructeur de contrainte nécessite des services, ils sont résolus à partir des services d’application de l’injection de dépendance.</span><span class="sxs-lookup"><span data-stu-id="ce372-309">If the constraint constructor requires services, they're resolved from dependency injection's app services.</span></span> <span data-ttu-id="ce372-310">Par exemple, le modèle de routage `blog/{article:minlength(10)}` spécifie une contrainte `minlength` avec l’argument `10`.</span><span class="sxs-lookup"><span data-stu-id="ce372-310">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="ce372-311">Pour plus d’informations sur les contraintes de routage et pour obtenir la liste des contraintes fournies par le framework, consultez la section [Informations de référence sur les contraintes de routage](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="ce372-311">For more information on route constraints and a listing of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

::: moniker-end

::: moniker range="< aspnetcore-2.2"

<span data-ttu-id="ce372-312">Les paramètres de routage peuvent avoir des contraintes, qui doivent établir une correspondance avec la valeur de route liée à partir de l’URL.</span><span class="sxs-lookup"><span data-stu-id="ce372-312">Route parameters may have constraints, which must match the route value bound from the URL.</span></span> <span data-ttu-id="ce372-313">L’ajout d’un signe deux-points (`:`) et d’un nom de contrainte après le nom du paramètre de routage spécifie une *contrainte inline* sur un paramètre de routage.</span><span class="sxs-lookup"><span data-stu-id="ce372-313">Adding a colon (`:`) and constraint name after the route parameter name specifies an *inline constraint* on a route parameter.</span></span> <span data-ttu-id="ce372-314">Si la contrainte exige des arguments, ils sont fournis entre parenthèses `( )` après le nom de la contrainte.</span><span class="sxs-lookup"><span data-stu-id="ce372-314">If the constraint requires arguments, they're enclosed in parentheses `( )` after the constraint name.</span></span> <span data-ttu-id="ce372-315">Il est possible de spécifier plusieurs contraintes inline en ajoutant un autre signe deux-points (`:`) et le nom d’une autre contrainte.</span><span class="sxs-lookup"><span data-stu-id="ce372-315">Multiple inline constraints can be specified by appending another colon (`:`) and constraint name.</span></span> <span data-ttu-id="ce372-316">Le nom de la contrainte et les arguments sont passés au service <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> pour créer une instance de <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> à utiliser dans le traitement des URL.</span><span class="sxs-lookup"><span data-stu-id="ce372-316">The constraint name and arguments are passed to the <xref:Microsoft.AspNetCore.Routing.IInlineConstraintResolver> service to create an instance of <xref:Microsoft.AspNetCore.Routing.IRouteConstraint> to use in URL processing.</span></span> <span data-ttu-id="ce372-317">Par exemple, le modèle de routage `blog/{article:minlength(10)}` spécifie une contrainte `minlength` avec l’argument `10`.</span><span class="sxs-lookup"><span data-stu-id="ce372-317">For example, the route template `blog/{article:minlength(10)}` specifies a `minlength` constraint with the argument `10`.</span></span> <span data-ttu-id="ce372-318">Pour plus d’informations sur les contraintes de routage et pour obtenir la liste des contraintes fournies par le framework, consultez la section [Informations de référence sur les contraintes de routage](#route-constraint-reference).</span><span class="sxs-lookup"><span data-stu-id="ce372-318">For more information on route constraints and a listing of the constraints provided by the framework, see the [Route constraint reference](#route-constraint-reference) section.</span></span>

::: moniker-end

::: moniker range=">= aspnetcore-2.2"

<span data-ttu-id="ce372-319">Les paramètres de routage peuvent également contenir des transformateurs de paramètre, lesquels transforment une valeur de paramètre lors de la génération des liens et de la mise en correspondance des actions et des pages avec les URI.</span><span class="sxs-lookup"><span data-stu-id="ce372-319">Route parameters may also have parameter transformers, which transform a parameter's value when generating links and matching actions and pages to URIs.</span></span> <span data-ttu-id="ce372-320">À l’instar des contraintes, les transformateurs de paramètre peuvent être ajoutés inline à un paramètre de routage en ajoutant un signe deux-points (`:`) et le nom du transformateur après le nom du paramètre de routage.</span><span class="sxs-lookup"><span data-stu-id="ce372-320">Like constraints, parameter transformers can be added inline to a route parameter by adding a colon (`:`) and transformer name after the route parameter name.</span></span> <span data-ttu-id="ce372-321">Par exemple, le modèle de routage `blog/{article:slugify}` spécifie un transformateur `slugify`.</span><span class="sxs-lookup"><span data-stu-id="ce372-321">For example, the route template `blog/{article:slugify}` specifies a `slugify` transformer.</span></span>

::: moniker-end

<span data-ttu-id="ce372-322">Le tableau suivant illustre certains modèles de routage et leur comportement.</span><span class="sxs-lookup"><span data-stu-id="ce372-322">The following table demonstrates some route templates and their behavior.</span></span>

| <span data-ttu-id="ce372-323">Modèle de routage</span><span class="sxs-lookup"><span data-stu-id="ce372-323">Route Template</span></span>                         | <span data-ttu-id="ce372-324">Exemple d’URL correspondante</span><span class="sxs-lookup"><span data-stu-id="ce372-324">Example Matching URL</span></span>  | <span data-ttu-id="ce372-325">Notes</span><span class="sxs-lookup"><span data-stu-id="ce372-325">Notes</span></span>                                                                  |
| -------------------------------------- | --------------------- | ---------------------------------------------------------------------- |
| <span data-ttu-id="ce372-326">hello</span><span class="sxs-lookup"><span data-stu-id="ce372-326">hello</span></span>                                  | <span data-ttu-id="ce372-327">/hello</span><span class="sxs-lookup"><span data-stu-id="ce372-327">/hello</span></span>                | <span data-ttu-id="ce372-328">Correspond uniquement au chemin unique `/hello`</span><span class="sxs-lookup"><span data-stu-id="ce372-328">Only matches the single path `/hello`</span></span>                                  |
| <span data-ttu-id="ce372-329">{Page=Home}</span><span class="sxs-lookup"><span data-stu-id="ce372-329">{Page=Home}</span></span>                            | /                     | <span data-ttu-id="ce372-330">Correspond à `Page` et le définit sur `Home`</span><span class="sxs-lookup"><span data-stu-id="ce372-330">Matches and sets `Page` to `Home`</span></span>                                      |
| <span data-ttu-id="ce372-331">{Page=Home}</span><span class="sxs-lookup"><span data-stu-id="ce372-331">{Page=Home}</span></span>                            | <span data-ttu-id="ce372-332">/Contact</span><span class="sxs-lookup"><span data-stu-id="ce372-332">/Contact</span></span>              | <span data-ttu-id="ce372-333">Correspond à `Page` et le définit sur `Contact`</span><span class="sxs-lookup"><span data-stu-id="ce372-333">Matches and sets `Page` to `Contact`</span></span>                                   |
| <span data-ttu-id="ce372-334">{controller}/{action}/{id?}</span><span class="sxs-lookup"><span data-stu-id="ce372-334">{controller}/{action}/{id?}</span></span>            | <span data-ttu-id="ce372-335">/Products/List</span><span class="sxs-lookup"><span data-stu-id="ce372-335">/Products/List</span></span>        | <span data-ttu-id="ce372-336">Correspond au contrôleur `Products` et à l’action `List`</span><span class="sxs-lookup"><span data-stu-id="ce372-336">Maps to `Products` controller and `List`  action</span></span>                       |
| <span data-ttu-id="ce372-337">{controller}/{action}/{id?}</span><span class="sxs-lookup"><span data-stu-id="ce372-337">{controller}/{action}/{id?}</span></span>            | <span data-ttu-id="ce372-338">/Products/Details/123</span><span class="sxs-lookup"><span data-stu-id="ce372-338">/Products/Details/123</span></span> |  <span data-ttu-id="ce372-339">Correspond au contrôleur `Products` et à l’action `Details`.</span><span class="sxs-lookup"><span data-stu-id="ce372-339">Maps to `Products` controller and  `Details` action.</span></span>  <span data-ttu-id="ce372-340">`id` a la valeur 123</span><span class="sxs-lookup"><span data-stu-id="ce372-340">`id` set to 123</span></span> |
| <span data-ttu-id="ce372-341">{controller=Home}/{action=Index}/{id?}</span><span class="sxs-lookup"><span data-stu-id="ce372-341">{controller=Home}/{action=Index}/{id?}</span></span> | /                     |  <span data-ttu-id="ce372-342">Correspond au contrôleur `Home` et à la méthode `Index`. `id` est ignoré.</span><span class="sxs-lookup"><span data-stu-id="ce372-342">Maps to `Home` controller and `Index`  method; `id` is ignored.</span></span>       |

<span data-ttu-id="ce372-343">L’utilisation d’un modèle est généralement l’approche la plus simple pour le routage.</span><span class="sxs-lookup"><span data-stu-id="ce372-343">Using a template is generally the simplest approach to routing.</span></span> <span data-ttu-id="ce372-344">Il est également possible de spécifier des contraintes et des valeurs par défaut hors du modèle de routage.</span><span class="sxs-lookup"><span data-stu-id="ce372-344">Constraints and defaults can also be specified outside the route template.</span></span>

> [!TIP]
> <span data-ttu-id="ce372-345">Activez la [journalisation](xref:fundamentals/logging/index) pour voir comment les implémentations de routage intégrées, comme `Route`, établissent des correspondances avec des requêtes.</span><span class="sxs-lookup"><span data-stu-id="ce372-345">Enable [Logging](xref:fundamentals/logging/index) to see how the built in routing implementations, such as `Route`, match requests.</span></span>

## <a name="reserved-routing-names"></a><span data-ttu-id="ce372-346">Noms de routage réservés</span><span class="sxs-lookup"><span data-stu-id="ce372-346">Reserved routing names</span></span>

<span data-ttu-id="ce372-347">Les mots clés suivants sont des noms réservés qui ne peuvent pas être utilisés comme paramètres ou noms de routage :</span><span class="sxs-lookup"><span data-stu-id="ce372-347">The following keywords are reserved names and can't be used as route names or parameters:</span></span>

* `action`
* `area`
* `controller`
* `handler`
* `page`

## <a name="route-constraint-reference"></a><span data-ttu-id="ce372-348">Informations de référence sur les contraintes de routage</span><span class="sxs-lookup"><span data-stu-id="ce372-348">Route constraint reference</span></span>

<span data-ttu-id="ce372-349">Les contraintes de routage s’exécutent quand un `Route` correspond à la syntaxe de l’URL entrante et a décomposé le chemin de l’URL en valeurs de route.</span><span class="sxs-lookup"><span data-stu-id="ce372-349">Route constraints execute when a `Route` has matched the syntax of the incoming URL and tokenized the URL path into route values.</span></span> <span data-ttu-id="ce372-350">En général, les contraintes de routage inspectent la valeur de route associée par le biais du modèle de routage, et créent une décision oui/non indiquant si la valeur est, ou non, acceptable.</span><span class="sxs-lookup"><span data-stu-id="ce372-350">Route constraints generally inspect the route value associated via the route template and make a yes/no decision about whether or not the value is acceptable.</span></span> <span data-ttu-id="ce372-351">Certaines contraintes de routage utilisent des données hors de la valeur de route pour déterminer si la requête peut être routée.</span><span class="sxs-lookup"><span data-stu-id="ce372-351">Some route constraints use data outside the route value to consider whether the request can be routed.</span></span> <span data-ttu-id="ce372-352">Par exemple, <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> peut accepter ou rejeter une requête en fonction de son verbe HTTP.</span><span class="sxs-lookup"><span data-stu-id="ce372-352">For example, the <xref:Microsoft.AspNetCore.Routing.Constraints.HttpMethodRouteConstraint> can accept or reject a request based on its HTTP verb.</span></span>

> [!WARNING]
> <span data-ttu-id="ce372-353">Évitez d’utiliser des contraintes pour la **validation d’entrée**, car les entrées non valides génèrent alors une réponse *404 - Introuvable* au lieu d’une réponse *400 - Requête incorrecte* avec un message d’erreur approprié.</span><span class="sxs-lookup"><span data-stu-id="ce372-353">Avoid using constraints for **input validation** because doing so means that invalid input results in a *404 - Not Found* response instead of a *400 - Bad Request* with an appropriate error message.</span></span> <span data-ttu-id="ce372-354">Les contraintes de routage servent à **lever l’ambiguïté** entre des routes similaires, et non à valider les entrées d’une route particulière.</span><span class="sxs-lookup"><span data-stu-id="ce372-354">Route constraints are used to **disambiguate** between similar routes, not to validate the inputs for a particular route.</span></span>

<span data-ttu-id="ce372-355">Le tableau suivant illustre certaines contraintes de routage et leur comportement attendu.</span><span class="sxs-lookup"><span data-stu-id="ce372-355">The following table demonstrates some route constraints and their expected behavior.</span></span>

| <span data-ttu-id="ce372-356">contrainte</span><span class="sxs-lookup"><span data-stu-id="ce372-356">constraint</span></span> | <span data-ttu-id="ce372-357">Exemple</span><span class="sxs-lookup"><span data-stu-id="ce372-357">Example</span></span> | <span data-ttu-id="ce372-358">Exemples de correspondances</span><span class="sxs-lookup"><span data-stu-id="ce372-358">Example Matches</span></span> | <span data-ttu-id="ce372-359">Notes</span><span class="sxs-lookup"><span data-stu-id="ce372-359">Notes</span></span> |
| ---------- | ------- | --------------- | ----- |
| `int` | `{id:int}` | <span data-ttu-id="ce372-360">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="ce372-360">`123456789`, `-123456789`</span></span>  | <span data-ttu-id="ce372-361">Correspond à n’importe quel entier</span><span class="sxs-lookup"><span data-stu-id="ce372-361">Matches any integer</span></span> |
| `bool` | `{active:bool}` | <span data-ttu-id="ce372-362">`true`, `FALSE`</span><span class="sxs-lookup"><span data-stu-id="ce372-362">`true`, `FALSE`</span></span> | <span data-ttu-id="ce372-363">Correspond à `true` ou à `false` (non-respect de la casse)</span><span class="sxs-lookup"><span data-stu-id="ce372-363">Matches `true` or `false` (case-insensitive)</span></span> |
| `datetime` | `{dob:datetime}` | <span data-ttu-id="ce372-364">`2016-12-31`, `2016-12-31 7:32pm`</span><span class="sxs-lookup"><span data-stu-id="ce372-364">`2016-12-31`, `2016-12-31 7:32pm`</span></span>  | <span data-ttu-id="ce372-365">Correspond à une valeur `DateTime` valide (dans la culture invariante ; voir l’avertissement)</span><span class="sxs-lookup"><span data-stu-id="ce372-365">Matches a valid `DateTime` value (in the invariant culture - see warning)</span></span> |
| `decimal` | `{price:decimal}` | <span data-ttu-id="ce372-366">`49.99`, `-1,000.01`</span><span class="sxs-lookup"><span data-stu-id="ce372-366">`49.99`, `-1,000.01`</span></span> | <span data-ttu-id="ce372-367">Correspond à une valeur `decimal` valide (dans la culture invariante ; voir l’avertissement)</span><span class="sxs-lookup"><span data-stu-id="ce372-367">Matches a valid `decimal` value (in the invariant culture - see warning)</span></span> |
| `double` | `{weight:double}` | <span data-ttu-id="ce372-368">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="ce372-368">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="ce372-369">Correspond à une valeur `double` valide (dans la culture invariante ; voir l’avertissement)</span><span class="sxs-lookup"><span data-stu-id="ce372-369">Matches a valid `double` value (in the invariant culture - see warning)</span></span> |
| `float` | `{weight:float}` | <span data-ttu-id="ce372-370">`1.234`, `-1,001.01e8`</span><span class="sxs-lookup"><span data-stu-id="ce372-370">`1.234`, `-1,001.01e8`</span></span> | <span data-ttu-id="ce372-371">Correspond à une valeur `float` valide (dans la culture invariante ; voir l’avertissement)</span><span class="sxs-lookup"><span data-stu-id="ce372-371">Matches a valid `float` value (in the invariant culture - see warning)</span></span> |
| `guid` | `{id:guid}` | <span data-ttu-id="ce372-372">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span><span class="sxs-lookup"><span data-stu-id="ce372-372">`CD2C1638-1638-72D5-1638-DEADBEEF1638`, `{CD2C1638-1638-72D5-1638-DEADBEEF1638}`</span></span> | <span data-ttu-id="ce372-373">Correspond à une valeur `Guid` valide</span><span class="sxs-lookup"><span data-stu-id="ce372-373">Matches a valid `Guid` value</span></span> |
| `long` | `{ticks:long}` | <span data-ttu-id="ce372-374">`123456789`, `-123456789`</span><span class="sxs-lookup"><span data-stu-id="ce372-374">`123456789`, `-123456789`</span></span> | <span data-ttu-id="ce372-375">Correspond à une valeur `long` valide</span><span class="sxs-lookup"><span data-stu-id="ce372-375">Matches a valid `long` value</span></span> |
| `minlength(value)` | `{username:minlength(4)}` | `Rick` | <span data-ttu-id="ce372-376">La chaîne doit comporter au moins 4 caractères</span><span class="sxs-lookup"><span data-stu-id="ce372-376">String must be at least 4 characters</span></span> |
| `maxlength(value)` | `{filename:maxlength(8)}` | `Richard` | <span data-ttu-id="ce372-377">La chaîne ne doit pas comporter plus de 8 caractères</span><span class="sxs-lookup"><span data-stu-id="ce372-377">String must be no more than 8 characters</span></span> |
| `length(length)` | `{filename:length(12)}` | `somefile.txt` | <span data-ttu-id="ce372-378">La chaîne doit comporter exactement 12 caractères</span><span class="sxs-lookup"><span data-stu-id="ce372-378">String must be exactly 12 characters long</span></span> |
| `length(min,max)` | `{filename:length(8,16)}` | `somefile.txt` | <span data-ttu-id="ce372-379">La chaîne doit comporter au moins 8 caractères et pas plus de 16 caractères</span><span class="sxs-lookup"><span data-stu-id="ce372-379">String must be at least 8 and no more than 16 characters long</span></span> |
| `min(value)` | `{age:min(18)}` | `19` | <span data-ttu-id="ce372-380">La valeur entière doit être au moins égale à 18</span><span class="sxs-lookup"><span data-stu-id="ce372-380">Integer value must be at least 18</span></span> |
| `max(value)` | `{age:max(120)}` | `91` | <span data-ttu-id="ce372-381">La valeur entière ne doit pas être supérieure à 120</span><span class="sxs-lookup"><span data-stu-id="ce372-381">Integer value must be no more than 120</span></span> |
| `range(min,max)` | `{age:range(18,120)}` | `91` | <span data-ttu-id="ce372-382">La valeur entière doit être au moins égale à 18 mais ne doit pas être supérieure à 120</span><span class="sxs-lookup"><span data-stu-id="ce372-382">Integer value must be at least 18 but no more than 120</span></span> |
| `alpha` | `{name:alpha}` | `Rick` | <span data-ttu-id="ce372-383">La chaîne doit se composer d’un ou de plusieurs caractères alphabétiques (`a`-`z`, non-respect de la casse)</span><span class="sxs-lookup"><span data-stu-id="ce372-383">String must consist of one or more alphabetical characters (`a`-`z`, case-insensitive)</span></span> |
| `regex(expression)` | `{ssn:regex(^\\d{{3}}-\\d{{2}}-\\d{{4}}$)}` | `123-45-6789` | <span data-ttu-id="ce372-384">La chaîne doit correspondre à l’expression régulière (voir les conseils relatifs à la définition d’une expression régulière)</span><span class="sxs-lookup"><span data-stu-id="ce372-384">String must match the regular expression (see tips about defining a regular expression)</span></span> |
| `required` | `{name:required}` | `Rick` |  <span data-ttu-id="ce372-385">Utilisé pour garantir qu’une valeur autre qu’un paramètre est présente pendant la génération de l’URL</span><span class="sxs-lookup"><span data-stu-id="ce372-385">Used to enforce that a non-parameter value is present during URL generation</span></span> |

<span data-ttu-id="ce372-386">Il est possible d’appliquer plusieurs contraintes séparées par un point-virgule à un même paramètre.</span><span class="sxs-lookup"><span data-stu-id="ce372-386">Multiple, colon-delimited constraints can be applied to a single parameter.</span></span> <span data-ttu-id="ce372-387">Par exemple, la contrainte suivante limite un paramètre à une valeur entière supérieure ou égale à 1 :</span><span class="sxs-lookup"><span data-stu-id="ce372-387">For example, the following constraint restricts a parameter to an integer value of 1 or greater:</span></span>

```csharp
[Route("users/{id:int:min(1)}")]
public User GetUserById(int id) { }
```

> [!WARNING]
> <span data-ttu-id="ce372-388">Les contraintes de routage qui vérifient que l’URL peut être convertie en type CLR (comme `int` ou `DateTime`) utilisent toujours la culture invariant.</span><span class="sxs-lookup"><span data-stu-id="ce372-388">Route constraints that verify the URL and are converted to a CLR type (such as `int` or `DateTime`) always use the invariant culture.</span></span> <span data-ttu-id="ce372-389">ces contraintes partent du principe que l’URL n’est pas localisable.</span><span class="sxs-lookup"><span data-stu-id="ce372-389">These constraints assume that the URL is non-localizable.</span></span> <span data-ttu-id="ce372-390">Les contraintes de routage fournies par le framework ne modifient pas les valeurs stockées dans les valeurs de route.</span><span class="sxs-lookup"><span data-stu-id="ce372-390">The framework-provided route constraints don't modify the values stored in route values.</span></span> <span data-ttu-id="ce372-391">Toutes les valeurs de route analysées à partir de l’URL sont stockées sous forme de chaînes.</span><span class="sxs-lookup"><span data-stu-id="ce372-391">All route values parsed from the URL are stored as strings.</span></span> <span data-ttu-id="ce372-392">Par exemple, la contrainte `float` tente de convertir la valeur de route en valeur float, mais la valeur convertie est utilisée uniquement pour vérifier qu’elle peut être convertie en valeur float.</span><span class="sxs-lookup"><span data-stu-id="ce372-392">For example, the `float` constraint attempts to convert the route value to a float, but the converted value is used only to verify it can be converted to a float.</span></span>

## <a name="regular-expressions"></a><span data-ttu-id="ce372-393">Expressions régulières</span><span class="sxs-lookup"><span data-stu-id="ce372-393">Regular expressions</span></span>

<span data-ttu-id="ce372-394">Le framework ASP.NET Core ajoute `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` au constructeur d’expression régulière.</span><span class="sxs-lookup"><span data-stu-id="ce372-394">The ASP.NET Core framework adds `RegexOptions.IgnoreCase | RegexOptions.Compiled | RegexOptions.CultureInvariant` to the regular expression constructor.</span></span> <span data-ttu-id="ce372-395">Pour obtenir une description de ces membres, consultez <xref:System.Text.RegularExpressions.RegexOptions>.</span><span class="sxs-lookup"><span data-stu-id="ce372-395">See <xref:System.Text.RegularExpressions.RegexOptions> for a description of these members.</span></span>

<span data-ttu-id="ce372-396">Les expressions régulières utilisent les délimiteurs et des jetons semblables à ceux utilisés par le service de routage et le langage C#.</span><span class="sxs-lookup"><span data-stu-id="ce372-396">Regular expressions use delimiters and tokens similar to those used by Routing and the C# language.</span></span> <span data-ttu-id="ce372-397">Les jetons d’expression régulière doivent être placés dans une séquence d’échappement.</span><span class="sxs-lookup"><span data-stu-id="ce372-397">Regular expression tokens must be escaped.</span></span> <span data-ttu-id="ce372-398">Pour que vous puissiez utiliser l’expression régulière `^\d{3}-\d{2}-\d{4}$` dans le service de routage, il faut qu’elle ait les caractères `\` tapés sous la forme `\\` dans le fichier source C# afin de placer dans une séquence d’échappement le caractère d’échappement de chaîne `\` (sauf en cas d’utilisation de [littéraux de chaîne textuelle](/dotnet/csharp/language-reference/keywords/string).</span><span class="sxs-lookup"><span data-stu-id="ce372-398">To use the regular expression `^\d{3}-\d{2}-\d{4}$` in Routing, the expression must have the `\` characters typed in as `\\` in the C# source file to escape the `\` string escape character (unless using [verbatim string literals](/dotnet/csharp/language-reference/keywords/string).</span></span> <span data-ttu-id="ce372-399">Les caractères `{`, `}`, `[` et `]` doivent être placés en double dans une séquence d’échappement, afin de placer les délimiteurs de paramètre de routage dans une séquence d’échappement.</span><span class="sxs-lookup"><span data-stu-id="ce372-399">The `{`, `}`, `[`, and `]` characters must be escaped by doubling them to escape the Routing parameter delimiter characters.</span></span> <span data-ttu-id="ce372-400">Le tableau ci-dessous montre une expression régulière et la version placée dans une séquence d’échappement.</span><span class="sxs-lookup"><span data-stu-id="ce372-400">The table below shows a regular expression and the escaped version.</span></span>

| <span data-ttu-id="ce372-401">Expression</span><span class="sxs-lookup"><span data-stu-id="ce372-401">Expression</span></span>            | <span data-ttu-id="ce372-402">Dans une séquence d’échappement</span><span class="sxs-lookup"><span data-stu-id="ce372-402">Escaped</span></span>                        |
| --------------------- | ------------------------------ |
| `^\d{3}-\d{2}-\d{4}$` | `^\\d{{3}}-\\d{{2}}-\\d{{4}}$` |
| `^[a-z]{2}$`          | `^[[a-z]]{{2}}$`               |

<span data-ttu-id="ce372-403">Souvent, les expressions régulières utilisées dans le routage commencent par le caractère `^` (position de départ de correspondance de la chaîne) et se terminent par le caractère `$` (position de fin de correspondance de la chaîne).</span><span class="sxs-lookup"><span data-stu-id="ce372-403">Regular expressions used in routing often start with the `^` character (match starting position of the string) and end with the `$` character (match ending position of the string).</span></span> <span data-ttu-id="ce372-404">Les caractères `^` et `$` garantissent que l’expression régulière établit une correspondance avec la totalité de la valeur du paramètre de route.</span><span class="sxs-lookup"><span data-stu-id="ce372-404">The `^` and `$` characters ensure that the regular expression match the entire route parameter value.</span></span> <span data-ttu-id="ce372-405">Sans les caractères `^` et `$`, l’expression régulière peut correspondre à n’importe quelle sous-chaîne dans la chaîne, ce qui est souvent indésirable.</span><span class="sxs-lookup"><span data-stu-id="ce372-405">Without the `^` and `$` characters, the regular expression match any substring within the string, which is often undesirable.</span></span> <span data-ttu-id="ce372-406">Le tableau ci-dessous présente des exemples et explique pourquoi ils établissent, ou non, une correspondance.</span><span class="sxs-lookup"><span data-stu-id="ce372-406">The table below shows some examples and explains why they match or fail to match.</span></span>

| <span data-ttu-id="ce372-407">Expression</span><span class="sxs-lookup"><span data-stu-id="ce372-407">Expression</span></span>   | <span data-ttu-id="ce372-408">Chaîne</span><span class="sxs-lookup"><span data-stu-id="ce372-408">String</span></span>    | <span data-ttu-id="ce372-409">Faire correspondre à</span><span class="sxs-lookup"><span data-stu-id="ce372-409">Match</span></span> | <span data-ttu-id="ce372-410">Commentaire</span><span class="sxs-lookup"><span data-stu-id="ce372-410">Comment</span></span>               |
| ------------ | --------- |  ---- |  -------------------- |
| `[a-z]{2}`   | <span data-ttu-id="ce372-411">hello</span><span class="sxs-lookup"><span data-stu-id="ce372-411">hello</span></span>     | <span data-ttu-id="ce372-412">Oui</span><span class="sxs-lookup"><span data-stu-id="ce372-412">Yes</span></span>   | <span data-ttu-id="ce372-413">Correspondances de sous-chaînes</span><span class="sxs-lookup"><span data-stu-id="ce372-413">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="ce372-414">123abc456</span><span class="sxs-lookup"><span data-stu-id="ce372-414">123abc456</span></span> | <span data-ttu-id="ce372-415">Oui</span><span class="sxs-lookup"><span data-stu-id="ce372-415">Yes</span></span>   | <span data-ttu-id="ce372-416">Correspondances de sous-chaînes</span><span class="sxs-lookup"><span data-stu-id="ce372-416">Substring matches</span></span>     |
| `[a-z]{2}`   | <span data-ttu-id="ce372-417">mz</span><span class="sxs-lookup"><span data-stu-id="ce372-417">mz</span></span>        | <span data-ttu-id="ce372-418">Oui</span><span class="sxs-lookup"><span data-stu-id="ce372-418">Yes</span></span>   | <span data-ttu-id="ce372-419">Correspondance avec l’expression</span><span class="sxs-lookup"><span data-stu-id="ce372-419">Matches expression</span></span>    |
| `[a-z]{2}`   | <span data-ttu-id="ce372-420">MZ</span><span class="sxs-lookup"><span data-stu-id="ce372-420">MZ</span></span>        | <span data-ttu-id="ce372-421">Oui</span><span class="sxs-lookup"><span data-stu-id="ce372-421">Yes</span></span>   | <span data-ttu-id="ce372-422">Non-respect de la casse</span><span class="sxs-lookup"><span data-stu-id="ce372-422">Not case sensitive</span></span>    |
| `^[a-z]{2}$` |  <span data-ttu-id="ce372-423">hello</span><span class="sxs-lookup"><span data-stu-id="ce372-423">hello</span></span>    | <span data-ttu-id="ce372-424">Non</span><span class="sxs-lookup"><span data-stu-id="ce372-424">No</span></span>    | <span data-ttu-id="ce372-425">Voir `^` et `$` ci-dessus</span><span class="sxs-lookup"><span data-stu-id="ce372-425">See `^` and `$` above</span></span> |
| `^[a-z]{2}$` | <span data-ttu-id="ce372-426">123abc456</span><span class="sxs-lookup"><span data-stu-id="ce372-426">123abc456</span></span> | <span data-ttu-id="ce372-427">Non</span><span class="sxs-lookup"><span data-stu-id="ce372-427">No</span></span>    | <span data-ttu-id="ce372-428">Voir `^` et `$` ci-dessus</span><span class="sxs-lookup"><span data-stu-id="ce372-428">See `^` and `$` above</span></span> |

<span data-ttu-id="ce372-429">Pour plus d’informations sur la syntaxe des expressions régulières, consultez [Expressions régulières du .NET Framework](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span><span class="sxs-lookup"><span data-stu-id="ce372-429">For more information on regular expression syntax, see [.NET Framework Regular Expressions](/dotnet/standard/base-types/regular-expression-language-quick-reference).</span></span>

<span data-ttu-id="ce372-430">Pour contraindre un paramètre à un ensemble connu de valeurs possibles, utilisez une expression régulière.</span><span class="sxs-lookup"><span data-stu-id="ce372-430">To constrain a parameter to a known set of possible values, use a regular expression.</span></span> <span data-ttu-id="ce372-431">Par exemple, `{action:regex(^(list|get|create)$)}` établit une correspondance avec la valeur de route `action` uniquement pour `list`, `get` ou `create`.</span><span class="sxs-lookup"><span data-stu-id="ce372-431">For example, `{action:regex(^(list|get|create)$)}` only matches the `action` route value to `list`, `get`, or `create`.</span></span> <span data-ttu-id="ce372-432">Si elle est passée dans le dictionnaire de contraintes, la chaîne `^(list|get|create)$` est équivalente.</span><span class="sxs-lookup"><span data-stu-id="ce372-432">If passed into the constraints dictionary, the string `^(list|get|create)$` is equivalent.</span></span> <span data-ttu-id="ce372-433">Les contraintes passées dans le dictionnaire de contraintes (c’est-à-dire qui ne sont pas inline dans un modèle) qui ne correspondent pas à l’une des contraintes connues sont également traitées comme des expressions régulières.</span><span class="sxs-lookup"><span data-stu-id="ce372-433">Constraints that are passed in the constraints dictionary (not inline within a template) that don't match one of the known constraints are also treated as regular expressions.</span></span>

::: moniker range=">= aspnetcore-2.2"

## <a name="parameter-transformer-reference"></a><span data-ttu-id="ce372-434">Informations de référence sur le transformateur de paramètre</span><span class="sxs-lookup"><span data-stu-id="ce372-434">Parameter transformer reference</span></span>

<span data-ttu-id="ce372-435">Transformateurs de paramètre :</span><span class="sxs-lookup"><span data-stu-id="ce372-435">Parameter transformers:</span></span>

* <span data-ttu-id="ce372-436">Sont exécutés lors de la génération d’un lien pour un `Route`.</span><span class="sxs-lookup"><span data-stu-id="ce372-436">Execute when generating a link for a `Route`.</span></span>
* <span data-ttu-id="ce372-437">Implémentez `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span><span class="sxs-lookup"><span data-stu-id="ce372-437">Implement `Microsoft.AspNetCore.Routing.IOutboundParameterTransformer`.</span></span>
* <span data-ttu-id="ce372-438">Sont configurés à l’aide de <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span><span class="sxs-lookup"><span data-stu-id="ce372-438">Are configured using <xref:Microsoft.AspNetCore.Routing.RouteOptions.ConstraintMap>.</span></span>
* <span data-ttu-id="ce372-439">Prennent la valeur de routage du paramètre et la convertissent en une nouvelle valeur de chaîne.</span><span class="sxs-lookup"><span data-stu-id="ce372-439">Take the parameter's route value and transform it to a new string value.</span></span>
* <span data-ttu-id="ce372-440">La valeur transformée est utilisée dans le lien généré.</span><span class="sxs-lookup"><span data-stu-id="ce372-440">The transformed value is used in the generated link.</span></span>

<span data-ttu-id="ce372-441">Par exemple, un transformateur de paramètre `slugify` personnalisé dans le modèle d’itinéraire `blog\{article:slugify}` avec `Url.Action(new { article = "MyTestArticle" })` génère `blog\my-test-article`.</span><span class="sxs-lookup"><span data-stu-id="ce372-441">For example, a custom `slugify` parameter transformer in route pattern `blog\{article:slugify}` with `Url.Action(new { article = "MyTestArticle" })` generates `blog\my-test-article`.</span></span>

<span data-ttu-id="ce372-442">Les transformateurs de paramètre sont également utilisés par les frameworks pour transformer l’URI vers lequel un point de terminaison est résolu.</span><span class="sxs-lookup"><span data-stu-id="ce372-442">Parameter transformers are also used by frameworks to transform the URI to which an endpoint resolves.</span></span> <span data-ttu-id="ce372-443">Par exemple, ASP.NET Core MVC utilise des transformateurs de paramètre pour convertir la valeur de routage utilisée et la faire correspondre à un `area`, `controller`, `action` et `page`.</span><span class="sxs-lookup"><span data-stu-id="ce372-443">For example, ASP.NET Core MVC uses parameter transformers to transform the route value used to match an `area`, `controller`, `action`, and `page`.</span></span>

```csharp
routes.MapRoute(
    name: "default",
    template: "{controller=Home:slugify}/{action=Index:slugify}/{id?}");
```

<span data-ttu-id="ce372-444">Avec la route précédente, l’action `SubscriptionManagementController.GetAll()` est mise en correspondance avec l’URI `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="ce372-444">With the preceding route, the action `SubscriptionManagementController.GetAll()` is matched with the URI `/subscription-management/get-all`.</span></span> <span data-ttu-id="ce372-445">Un transformateur de paramètre ne modifie pas les valeurs de routage utilisées pour générer un lien.</span><span class="sxs-lookup"><span data-stu-id="ce372-445">A parameter transformer doesn't change the route values used to generate a link.</span></span> <span data-ttu-id="ce372-446">`Url.Action("GetAll", "SubscriptionManagement")` obtient en sortie `/subscription-management/get-all`.</span><span class="sxs-lookup"><span data-stu-id="ce372-446">`Url.Action("GetAll", "SubscriptionManagement")` outputs `/subscription-management/get-all`.</span></span>

<span data-ttu-id="ce372-447">ASP.NET Core fournit des conventions d’API pour l’utilisation des transformateurs de paramètre avec des routages générés :</span><span class="sxs-lookup"><span data-stu-id="ce372-447">ASP.NET Core provides API conventions for using a parameter transformers with generated routes:</span></span>

* <span data-ttu-id="ce372-448">La convention de l’API `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention` est fournie avec ASP.NET Core MVC.</span><span class="sxs-lookup"><span data-stu-id="ce372-448">ASP.NET Core MVC has the `Microsoft.AspNetCore.Mvc.ApplicationModels.RouteTokenTransformerConvention` API convention.</span></span> <span data-ttu-id="ce372-449">Cette convention applique un transformateur de paramètre spécifié à tous les routages d’attributs dans l’application.</span><span class="sxs-lookup"><span data-stu-id="ce372-449">This convention applies a specified parameter transformer to all attribute routes in the app.</span></span> <span data-ttu-id="ce372-450">Le transformateur de paramètre transforme les jetons de routage d’attribut quand ils sont remplacés.</span><span class="sxs-lookup"><span data-stu-id="ce372-450">The parameter transformer transforms attribute route tokens as they are replaced.</span></span> <span data-ttu-id="ce372-451">Pour plus d’informations, consultez [Utiliser un transformateur de paramètre pour personnaliser le remplacement des jetons](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span><span class="sxs-lookup"><span data-stu-id="ce372-451">For more information, see [Use a parameter transformer to customize token replacement](/aspnet/core/mvc/controllers/routing#use-a-parameter-transformer-to-customize-token-replacement).</span></span>
* <span data-ttu-id="ce372-452">La convention de l’API `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` est fournie avec les pages Razor.</span><span class="sxs-lookup"><span data-stu-id="ce372-452">Razor pages has the `Microsoft.AspNetCore.Mvc.ApplicationModels.PageRouteTransformerConvention` API convention.</span></span> <span data-ttu-id="ce372-453">Cette convention applique un transformateur de paramètre spécifié à toutes les pages Razor découvertes automatiquement.</span><span class="sxs-lookup"><span data-stu-id="ce372-453">This convention applies a specified parameter transformer to all automatically discovered Razor pages.</span></span> <span data-ttu-id="ce372-454">Le transformateur de paramètre transforme les segments du nom de dossier et du nom de fichier des routages de pages Razor.</span><span class="sxs-lookup"><span data-stu-id="ce372-454">The parameter transformer transforms the folder and file name segments of Razor page routes.</span></span> <span data-ttu-id="ce372-455">Pour plus d’informations, consultez [Utiliser un transformateur de paramètre pour personnaliser les routages de pages](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span><span class="sxs-lookup"><span data-stu-id="ce372-455">For more information, see [Use a parameter transformer to customize page routes](/aspnet/core/razor-pages/razor-pages-conventions#use-a-parameter-transformer-to-customize-page-routes).</span></span>

::: moniker-end

## <a name="url-generation-reference"></a><span data-ttu-id="ce372-456">Informations de référence sur la génération d’URL</span><span class="sxs-lookup"><span data-stu-id="ce372-456">URL generation reference</span></span>

<span data-ttu-id="ce372-457">L’exemple suivant montre comment générer un lien vers une route selon un dictionnaire de valeurs de route et un <xref:Microsoft.AspNetCore.Routing.RouteCollection> données.</span><span class="sxs-lookup"><span data-stu-id="ce372-457">The following example shows how to generate a link to a route given a dictionary of route values and a <xref:Microsoft.AspNetCore.Routing.RouteCollection>.</span></span>

::: moniker range=">= aspnetcore-2.0"

[!code-csharp[](routing/samples/2.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

::: moniker-end

::: moniker range="< aspnetcore-2.0"

[!code-csharp[](routing/samples/1.x/RoutingSample/Startup.cs?name=snippet_Dictionary)]

::: moniker-end

<span data-ttu-id="ce372-458">Le `VirtualPath` généré à la fin de l’exemple précédent est `/package/create/123`.</span><span class="sxs-lookup"><span data-stu-id="ce372-458">The `VirtualPath` generated at the end of the preceding sample is `/package/create/123`.</span></span> <span data-ttu-id="ce372-459">Le dictionnaire fournit les valeurs de route `operation` et `id` du modèle « Suivi de package de route », `package/{operation}/{id}`.</span><span class="sxs-lookup"><span data-stu-id="ce372-459">The dictionary supplies the `operation` and `id` route values of the "Track Package Route" template, `package/{operation}/{id}`.</span></span> <span data-ttu-id="ce372-460">Pour plus d’informations, consultez l’exemple de code dans la section [Utilisation du middleware de routage](#use-routing-middleware) ou l’[exemple d’application](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span><span class="sxs-lookup"><span data-stu-id="ce372-460">For details, see the sample code in the [Use Routing Middleware](#use-routing-middleware) section or the [sample app](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/routing/samples).</span></span>

<span data-ttu-id="ce372-461">Le deuxième paramètre pour le constructeur `VirtualPathContext` est une collection de *valeurs ambiantes*.</span><span class="sxs-lookup"><span data-stu-id="ce372-461">The second parameter to the `VirtualPathContext` constructor is a collection of *ambient values*.</span></span> <span data-ttu-id="ce372-462">Les valeurs ambiantes offre beaucoup de souplesse en limitant le nombre de valeurs qu’un développeur doit spécifier dans un contexte de requête donné.</span><span class="sxs-lookup"><span data-stu-id="ce372-462">Ambient values provide convenience by limiting the number of values a developer must specify within a certain request context.</span></span> <span data-ttu-id="ce372-463">Les valeurs de route actuelles de la requête actuelle sont considérées comme des valeurs ambiantes pour la génération de liens.</span><span class="sxs-lookup"><span data-stu-id="ce372-463">The current route values of the current request are considered ambient values for link generation.</span></span> <span data-ttu-id="ce372-464">Dans une application ASP.NET Core MVC, si vous êtes dans l’action `About` de `HomeController`, vous n’avez pas besoin de spécifier la valeur de route du contrôleur pour créer un lien vers l’action `Index` (la valeur ambiante de `Home` est utilisée).</span><span class="sxs-lookup"><span data-stu-id="ce372-464">In an ASP.NET Core MVC app if you are in the `About` action of the `HomeController`, you don't need to specify the controller route value to link to the `Index` action&mdash;the ambient value of `Home` is used.</span></span>

<span data-ttu-id="ce372-465">Les valeurs ambiantes qui ne correspondent pas à un paramètre sont ignorées. De plus, les valeurs ambiantes sont également ignorées quand une valeur fournie explicitement le remplace, en procédant de gauche à droite dans l’URL.</span><span class="sxs-lookup"><span data-stu-id="ce372-465">Ambient values that don't match a parameter are ignored, and ambient values are also ignored when an explicitly provided value overrides it, going from left to right in the URL.</span></span>

<span data-ttu-id="ce372-466">Les valeurs qui sont fournis explicitement mais qui n’ont pas de correspondance sont ajoutées à la chaîne de requête.</span><span class="sxs-lookup"><span data-stu-id="ce372-466">Values that are explicitly provided but which don't match anything are added to the query string.</span></span> <span data-ttu-id="ce372-467">Le tableau suivant présente le résultat en cas d’utilisation du modèle de routage `{controller}/{action}/{id?}`.</span><span class="sxs-lookup"><span data-stu-id="ce372-467">The following table shows the result when using the route template `{controller}/{action}/{id?}`.</span></span>

| <span data-ttu-id="ce372-468">Valeurs ambiantes</span><span class="sxs-lookup"><span data-stu-id="ce372-468">Ambient Values</span></span>                | <span data-ttu-id="ce372-469">Valeurs explicites</span><span class="sxs-lookup"><span data-stu-id="ce372-469">Explicit Values</span></span>                   | <span data-ttu-id="ce372-470">Résultat</span><span class="sxs-lookup"><span data-stu-id="ce372-470">Result</span></span>                  |
| ----------------------------- | --------------------------------- | ----------------------- |
| <span data-ttu-id="ce372-471">controller="Home"</span><span class="sxs-lookup"><span data-stu-id="ce372-471">controller="Home"</span></span>             | <span data-ttu-id="ce372-472">action="About"</span><span class="sxs-lookup"><span data-stu-id="ce372-472">action="About"</span></span>                    | `/Home/About`           |
| <span data-ttu-id="ce372-473">controller="Home"</span><span class="sxs-lookup"><span data-stu-id="ce372-473">controller="Home"</span></span>             | <span data-ttu-id="ce372-474">controller="Order",action="About"</span><span class="sxs-lookup"><span data-stu-id="ce372-474">controller="Order",action="About"</span></span> | `/Order/About`          |
| <span data-ttu-id="ce372-475">controller="Home",color="Red"</span><span class="sxs-lookup"><span data-stu-id="ce372-475">controller="Home",color="Red"</span></span> | <span data-ttu-id="ce372-476">action="About"</span><span class="sxs-lookup"><span data-stu-id="ce372-476">action="About"</span></span>                    | `/Home/About`           |
| <span data-ttu-id="ce372-477">controller="Home"</span><span class="sxs-lookup"><span data-stu-id="ce372-477">controller="Home"</span></span>             | <span data-ttu-id="ce372-478">action="About",color="Red"</span><span class="sxs-lookup"><span data-stu-id="ce372-478">action="About",color="Red"</span></span>        | `/Home/About?color=Red` |

<span data-ttu-id="ce372-479">Si une route a une valeur par défaut qui ne correspond pas à un paramètre et que cette valeur est explicitement fournie, elle doit correspondre à la valeur par défaut :</span><span class="sxs-lookup"><span data-stu-id="ce372-479">If a route has a default value that doesn't correspond to a parameter and that value is explicitly provided, it must match the default value:</span></span>

```csharp
routes.MapRoute("blog_route", "blog/{*slug}",
    defaults: new { controller = "Blog", action = "ReadPost" });
```

<span data-ttu-id="ce372-480">La génération de liens génère un lien pour cette route uniquement quand les valeurs correspondantes pour le contrôleur et l’action sont fournies.</span><span class="sxs-lookup"><span data-stu-id="ce372-480">Link generation only generates a link for this route when the matching values for controller and action are provided.</span></span>
